function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){o=!0,i=u}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _construct(e,t,n){return(_construct=isNativeReflectConstruct()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&_setPrototypeOf(o,n.prototype),o}).apply(null,arguments)}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=_superPropBase(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"+7AZ":function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",(function(){return o})),n.d(t,"__assign",(function(){return i})),n.d(t,"__rest",(function(){return a})),n.d(t,"__decorate",(function(){return s})),n.d(t,"__param",(function(){return u})),n.d(t,"__metadata",(function(){return c})),n.d(t,"__awaiter",(function(){return l})),n.d(t,"__generator",(function(){return h})),n.d(t,"__exportStar",(function(){return f})),n.d(t,"__values",(function(){return d})),n.d(t,"__read",(function(){return p})),n.d(t,"__spread",(function(){return y})),n.d(t,"__spreadArrays",(function(){return v})),n.d(t,"__await",(function(){return m})),n.d(t,"__asyncGenerator",(function(){return g})),n.d(t,"__asyncDelegator",(function(){return b})),n.d(t,"__asyncValues",(function(){return _})),n.d(t,"__makeTemplateObject",(function(){return w})),n.d(t,"__importStar",(function(){return C})),n.d(t,"__importDefault",(function(){return k}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function s(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function u(e,t){return function(n,r){t(n,r,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function h(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function f(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function d(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function p(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(s){o={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}function v(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}function m(e){return this instanceof m?(this.v=e,this):new m(e)}function g(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),i=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){i.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=o[e](t)).value instanceof m?Promise.resolve(n.value.v).then(u,c):l(i[0][2],n)}catch(r){l(i[0][3],r)}var n}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function b(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,o){t[r]=e[r]?function(t){return(n=!n)?{value:m(e[r](t)),done:"return"===r}:o?o(t):t}:o}}function _(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=d(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,o,(t=e[n](t)).done,t.value)}))}}}function w(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function k(e){return e&&e.__esModule?e:{default:e}}},"/7f5":function(e,t,n){"use strict";function r(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+"]"})).join(",")+"}")}n.r(t);var o=function(e){var t=new RegExp('["'+e+"\n]"),n=e.charCodeAt(0);function o(e,t){var r,o,i={},a={},s=[],u=e.length,c=0,l=0;function h(){if(c>=u)return a;if(o)return o=!1,i;var t,r=c;if(34===e.charCodeAt(r)){for(var s=r;s++<u;)if(34===e.charCodeAt(s)){if(34!==e.charCodeAt(s+1))break;++s}return c=s+2,13===(t=e.charCodeAt(s+1))?(o=!0,10===e.charCodeAt(s+2)&&++c):10===t&&(o=!0),e.slice(r+1,s).replace(/""/g,'"')}for(;c<u;){var l=1;if(10===(t=e.charCodeAt(c++)))o=!0;else if(13===t)o=!0,10===e.charCodeAt(c)&&(++c,++l);else if(t!==n)continue;return e.slice(r,c-l)}return e.slice(r)}for(;(r=h())!==a;){for(var f=[];r!==i&&r!==a;)f.push(r),r=h();t&&null==(f=t(f,l++))||s.push(f)}return s}function i(t){return t.map(a).join(e)}function a(e){return null==e?"":t.test(e+="")?'"'+e.replace(/\"/g,'""')+'"':e}return{parse:function(e,t){var n,i,a=o(e,(function(e,o){if(n)return n(e,o-1);i=e,n=t?function(e,t){var n=r(e);return function(r,o){return t(n(r),o,e)}}(e,t):r(e)}));return a.columns=i,a},parseRows:o,format:function(t,n){return null==n&&(n=function(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}(t)),[n.map(a).join(e)].concat(t.map((function(t){return n.map((function(e){return a(t[e])})).join(e)}))).join("\n")},formatRows:function(e){return e.map(i).join("\n")}}},i=o(","),a=i.parse,s=i.parseRows,u=i.format,c=i.formatRows,l=o("\t"),h=l.parse,f=l.parseRows,d=l.format,p=l.formatRows;n.d(t,"dsvFormat",(function(){return o})),n.d(t,"csvParse",(function(){return a})),n.d(t,"csvParseRows",(function(){return s})),n.d(t,"csvFormat",(function(){return u})),n.d(t,"csvFormatRows",(function(){return c})),n.d(t,"tsvParse",(function(){return h})),n.d(t,"tsvParseRows",(function(){return f})),n.d(t,"tsvFormat",(function(){return d})),n.d(t,"tsvFormatRows",(function(){return p}))},0:function(e,t,n){e.exports=n("zUnb")},1:function(e,t){},"30Go":function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",(function(){return o})),n.d(t,"__assign",(function(){return i})),n.d(t,"__rest",(function(){return a})),n.d(t,"__decorate",(function(){return s})),n.d(t,"__param",(function(){return u})),n.d(t,"__metadata",(function(){return c})),n.d(t,"__awaiter",(function(){return l})),n.d(t,"__generator",(function(){return h})),n.d(t,"__exportStar",(function(){return f})),n.d(t,"__values",(function(){return d})),n.d(t,"__read",(function(){return p})),n.d(t,"__spread",(function(){return y})),n.d(t,"__spreadArrays",(function(){return v})),n.d(t,"__await",(function(){return m})),n.d(t,"__asyncGenerator",(function(){return g})),n.d(t,"__asyncDelegator",(function(){return b})),n.d(t,"__asyncValues",(function(){return _})),n.d(t,"__makeTemplateObject",(function(){return w})),n.d(t,"__importStar",(function(){return C})),n.d(t,"__importDefault",(function(){return k}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function s(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function u(e,t){return function(n,r){t(n,r,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function h(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function f(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function d(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function p(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(s){o={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}function v(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}function m(e){return this instanceof m?(this.v=e,this):new m(e)}function g(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),i=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){i.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=o[e](t)).value instanceof m?Promise.resolve(n.value.v).then(u,c):l(i[0][2],n)}catch(r){l(i[0][3],r)}var n}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function b(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,o){t[r]=e[r]?function(t){return(n=!n)?{value:m(e[r](t)),done:"return"===r}:o?o(t):t}:o}}function _(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=d(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,o,(t=e[n](t)).done,t.value)}))}}}function w(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function k(e){return e&&e.__esModule?e:{default:e}}},"6Joi":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=(r=n("wj3C"))&&"object"==typeof r&&"default"in r?r.default:r,i=n("q/0M"),a=n("os0x"),s=n("zVF4"),u=n("x7I3"),c=o.SDK_VERSION,l=new i.Logger("@firebase/firestore"),h=function(e){return e[e.DEBUG=0]="DEBUG",e[e.ERROR=1]="ERROR",e[e.SILENT=2]="SILENT",e}({});function f(){return l.logLevel===i.LogLevel.DEBUG?h.DEBUG:l.logLevel===i.LogLevel.SILENT?h.SILENT:h.ERROR}function d(e){switch(e){case h.DEBUG:l.logLevel=i.LogLevel.DEBUG;break;case h.ERROR:l.logLevel=i.LogLevel.ERROR;break;case h.SILENT:l.logLevel=i.LogLevel.SILENT;break;default:l.error("Firestore ("+c+"): Invalid value passed to `setLogLevel`")}}function p(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(l.logLevel<=i.LogLevel.DEBUG){var o=n.map(v);l.debug.apply(l,["Firestore ("+c+") ["+e+"]: "+t].concat(o))}}function y(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(l.logLevel<=i.LogLevel.ERROR){var r=t.map(v);l.error.apply(l,["Firestore ("+c+"): "+e].concat(r))}}function v(e){if("string"==typeof e)return e;var t=b.getPlatform();try{return t.formatJSON(e)}catch(n){return e}}function m(e){var t="FIRESTORE ("+c+") INTERNAL ASSERTION FAILED: "+e;throw y(t),new Error(t)}function g(e,t){e||m(t)}var b=function(){function e(){}return e.setPlatform=function(t){e.platform&&m("Platform already defined"),e.platform=t},e.getPlatform=function(){return e.platform||m("Platform not set"),e.platform},e}();function _(){return b.getPlatform().emptyByteString}var w={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},C=function(e){function t(t,n){var r=e.call(this,n)||this;return r.code=t,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return a.__extends(t,e),t}(Error);function k(e,t){function n(){var e="This constructor is private.";throw t&&(e+=" ",e+=t),new C(w.INVALID_ARGUMENT,e)}for(var r in n.prototype=e.prototype,e)e.hasOwnProperty(r)&&(n[r]=e[r]);return n}function S(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function E(e,t){return void 0!==e?e:t}function T(e,t){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Number(n);isNaN(r)||t(r,e[n])}}function I(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function A(e){for(var t in g(null!=e&&"object"==typeof e,"isEmpty() expects object parameter."),e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function D(e,t){if(0!==t.length)throw new C(w.INVALID_ARGUMENT,"Function "+e+"() does not support arguments, but was called with "+Q(t.length,"argument")+".")}function N(e,t,n){if(t.length!==n)throw new C(w.INVALID_ARGUMENT,"Function "+e+"() requires "+Q(n,"argument")+", but was called with "+Q(t.length,"argument")+".")}function P(e,t,n){if(t.length<n)throw new C(w.INVALID_ARGUMENT,"Function "+e+"() requires at least "+Q(n,"argument")+", but was called with "+Q(t.length,"argument")+".")}function x(e,t,n,r){if(t.length<n||t.length>r)throw new C(w.INVALID_ARGUMENT,"Function "+e+"() requires between "+n+" and "+r+" arguments, but was called with "+Q(t.length,"argument")+".")}function O(e,t,n,r){if(!(t instanceof Array)||t.length<r)throw new C(w.INVALID_ARGUMENT,"Function "+e+"() requires its "+n+" argument to be an array with at least "+Q(r,"element")+".")}function M(e,t,n,r){q(e,t,H(n)+" argument",r)}function R(e,t,n,r){void 0!==r&&M(e,t,n,r)}function L(e,t,n,r){q(e,t,n+" option",r)}function F(e,t,n,r){void 0!==r&&L(e,t,n,r)}function V(e,t,n,r,o){void 0!==r&&function(e,t,n,r,o){for(var i=[],a=0,s=o;a<s.length;a++){var u=s[a];if(u===r)return;i.push(U(u))}var c=U(r);throw new C(w.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+e+'() for option "'+n+'". Acceptable values: '+i.join(", "))}(e,0,n,r,o)}function B(e,t,n,r){if(!t.some((function(e){return e===r})))throw new C(w.INVALID_ARGUMENT,"Invalid value "+U(r)+" provided to function "+e+"() for its "+H(n)+" argument. Acceptable values: "+t.join(", "))}function q(e,t,n,r){if(!("object"===t?j(r):"non-empty string"===t?"string"==typeof r&&""!==r:typeof r===t)){var o=U(r);throw new C(w.INVALID_ARGUMENT,"Function "+e+"() requires its "+n+" to be of type "+t+", but it was: "+o)}}function j(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function U(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=function(e){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&t.length>1)return t[1]}return null}(e);return t?"a custom "+t+" object":"an object"}return"function"==typeof e?"a function":m("Unknown wrong type: "+typeof e)}function G(e,t,n){if(void 0===n)throw new C(w.INVALID_ARGUMENT,"Function "+e+"() requires a valid "+H(t)+" argument, but it was undefined.")}function z(e,t,n){I(t,(function(t,r){if(n.indexOf(t)<0)throw new C(w.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+e+"(). Available options: "+n.join(", "))}))}function W(e,t,n,r){var o=U(r);return new C(w.INVALID_ARGUMENT,"Function "+e+"() requires its "+H(n)+" argument to be a "+t+", but it was: "+o)}function H(e){switch(e){case 1:return"first";case 2:return"second";case 3:return"third";default:return e+"th"}}function Q(e,t){return e+" "+t+(1===e?"":"s")}var K=function(){function e(){}return e.newId=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="",n=0;n<20;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return g(20===t.length,"Invalid auto ID: "+t),t},e}();function Y(e,t){return e<t?-1:e>t?1:0}function J(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].isEqual(t[n]))return!1;return!0}function $(e){return e+"\0"}function Z(){if("undefined"==typeof Uint8Array)throw new C(w.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function X(){if(!b.getPlatform().base64Available)throw new C(w.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var ee=function(){function e(e){X(),this._binaryString=e}return e.fromBase64String=function(t){N("Blob.fromBase64String",arguments,1),M("Blob.fromBase64String","string",1,t),X();try{var n=b.getPlatform().atob(t);return new e(n)}catch(r){throw new C(w.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+r)}},e.fromUint8Array=function(t){if(N("Blob.fromUint8Array",arguments,1),Z(),!(t instanceof Uint8Array))throw W("Blob.fromUint8Array","Uint8Array",1,t);var n=Array.prototype.map.call(t,(function(e){return String.fromCharCode(e)})).join("");return new e(n)},e.prototype.toBase64=function(){return N("Blob.toBase64",arguments,0),X(),b.getPlatform().btoa(this._binaryString)},e.prototype.toUint8Array=function(){N("Blob.toUint8Array",arguments,0),Z();for(var e=new Uint8Array(this._binaryString.length),t=0;t<this._binaryString.length;t++)e[t]=this._binaryString.charCodeAt(t);return e},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e.prototype.isEqual=function(e){return this._binaryString===e._binaryString},e.prototype._compareTo=function(e){return Y(this._binaryString,e._binaryString)},e}(),te=k(ee,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),ne=function(e,t,n,r,o){this.databaseId=e,this.persistenceKey=t,this.host=n,this.ssl=r,this.forceLongPolling=o},re=function(){function e(e,t){this.projectId=e,this.database=t||"(default)"}return Object.defineProperty(e.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database},e.prototype.compareTo=function(e){return Y(this.projectId,e.projectId)||Y(this.database,e.database)},e}(),oe=function(){function e(e,t){var n=this;this.previousValue=e,t&&(t.sequenceNumberHandler=function(e){return n.setPreviousValue(e)},this.writeNewSequenceNumber=function(e){return t.writeSequenceNumber(e)})}return e.prototype.setPreviousValue=function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue},e.prototype.next=function(){var e=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(e),e},e.INVALID=-1,e}(),ie=function(){function e(e,t,n){void 0===t?t=0:t>e.length&&m("offset "+t+" out of range "+e.length),void 0===n?n=e.length-t:n>e.length-t&&m("length "+n+" out of range "+(e.length-t)),this.segments=e,this.offset=t,this.len=n}return Object.defineProperty(e.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return 0===e.comparator(this,t)},e.prototype.child=function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach((function(e){n.push(e)})):n.push(t),this.construct(n)},e.prototype.limit=function(){return this.offset+this.length},e.prototype.popFirst=function(e){return g(this.length>=(e=void 0===e?1:e),"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+e,this.length-e)},e.prototype.popLast=function(){return g(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},e.prototype.firstSegment=function(){return g(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},e.prototype.lastSegment=function(){return this.get(this.length-1)},e.prototype.get=function(e){return g(e<this.length,"Index out of range"),this.segments[this.offset+e]},e.prototype.isEmpty=function(){return 0===this.length},e.prototype.isPrefixOf=function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},e.prototype.isImmediateParentOf=function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},e.prototype.forEach=function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])},e.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},e.comparator=function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var o=e.get(r),i=t.get(r);if(o<i)return-1;if(o>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0},e}(),ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.construct=function(e,n,r){return new t(e,n,r)},t.prototype.canonicalString=function(){return this.toArray().join("/")},t.prototype.toString=function(){return this.canonicalString()},t.fromString=function(e){if(e.indexOf("//")>=0)throw new C(w.INVALID_ARGUMENT,"Invalid path ("+e+"). Paths must not contain // in them.");return new t(e.split("/").filter((function(e){return e.length>0})))},t.EMPTY_PATH=new t([]),t}(ie),se=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.construct=function(e,n,r){return new t(e,n,r)},t.isValidIdentifier=function(e){return se.test(e)},t.prototype.canonicalString=function(){return this.toArray().map((function(e){return e=e.replace("\\","\\\\").replace("`","\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e})).join(".")},t.prototype.toString=function(){return this.canonicalString()},t.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},t.keyField=function(){return new t(["__name__"])},t.fromServerFormat=function(e){for(var n=[],r="",o=0,i=function(){if(0===r.length)throw new C(w.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;o<e.length;){var s=e[o];if("\\"===s){if(o+1===e.length)throw new C(w.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[o+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new C(w.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,o+=2}else"`"===s?(a=!a,o++):"."!==s||a?(r+=s,o++):(i(),o++)}if(i(),a)throw new C(w.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)},t.EMPTY_PATH=new t([]),t}(ie),ce=function(){function e(t){this.path=t,g(e.isDocumentKey(t),"Invalid DocumentKey with an odd number of segments: "+t.toArray().join("/"))}return e.prototype.hasCollectionId=function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e},e.prototype.isEqual=function(e){return null!==e&&0===ae.comparator(this.path,e.path)},e.prototype.toString=function(){return this.path.toString()},e.comparator=function(e,t){return ae.comparator(e.path,t.path)},e.isDocumentKey=function(e){return e.length%2==0},e.fromSegments=function(t){return new e(new ae(t.slice()))},e.fromPathString=function(t){return new e(ae.fromString(t))},e.EMPTY=new e(new ae([])),e}(),le=function(){var e=this;this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))},he=function(e){return e.All="all",e.ListenStreamIdle="listen_stream_idle",e.ListenStreamConnectionBackoff="listen_stream_connection_backoff",e.WriteStreamIdle="write_stream_idle",e.WriteStreamConnectionBackoff="write_stream_connection_backoff",e.OnlineStateTimeout="online_state_timeout",e.ClientMetadataRefresh="client_metadata_refresh",e.LruGarbageCollection="lru_garbage_collection",e.RetryTransaction="retry_transaction",e}({}),fe=function(){function e(e,t,n,r,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=o,this.deferred=new le,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch((function(e){}))}return e.createAndSchedule=function(t,n,r,o,i){var a=new e(t,n,Date.now()+r,o,i);return a.start(r),a},e.prototype.start=function(e){var t=this;this.timerHandle=setTimeout((function(){return t.handleDelayElapsed()}),e)},e.prototype.skipDelay=function(){return this.handleDelayElapsed()},e.prototype.cancel=function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new C(w.CANCELLED,"Operation cancelled"+(e?": "+e:""))))},e.prototype.handleDelayElapsed=function(){var e=this;this.asyncQueue.enqueueAndForget((function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then((function(t){return e.deferred.resolve(t)}))):Promise.resolve()}))},e.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},e}(),de=function(){function e(){this.tail=Promise.resolve(),this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.timerIdsToSkip=[]}return Object.defineProperty(e.prototype,"isShuttingDown",{get:function(){return this._isShuttingDown},enumerable:!0,configurable:!0}),e.prototype.enqueueAndForget=function(e){this.enqueue(e)},e.prototype.enqueueAndForgetEvenAfterShutdown=function(e){this.verifyNotFailed(),this.enqueueInternal(e)},e.prototype.enqueueEvenAfterShutdown=function(e){return this.verifyNotFailed(),this.enqueueInternal(e)},e.prototype.enqueueAndInitiateShutdown=function(e){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return this.verifyNotFailed(),this._isShuttingDown?[3,2]:(this._isShuttingDown=!0,[4,this.enqueueEvenAfterShutdown(e)]);case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},e.prototype.enqueue=function(e){return this.verifyNotFailed(),this._isShuttingDown?new Promise((function(e){})):this.enqueueInternal(e)},e.prototype.enqueueInternal=function(e){var t=this,n=this.tail.then((function(){return t.operationInProgress=!0,e().catch((function(e){t.failure=e,t.operationInProgress=!1;var n=e.stack||e.message||"";throw y("INTERNAL UNHANDLED ERROR: ",n),n.indexOf("Firestore Test Simulated Error")<0&&setTimeout((function(){throw e}),0),e})).then((function(e){return t.operationInProgress=!1,e}))}));return this.tail=n,n},e.prototype.enqueueAfterDelay=function(e,t,n){var r=this;this.verifyNotFailed(),g(t>=0,"Attempted to schedule an operation with a negative delay of "+t),this.timerIdsToSkip.indexOf(e)>-1&&(t=0);var o=fe.createAndSchedule(this,e,t,n,(function(e){return r.removeDelayedOperation(e)}));return this.delayedOperations.push(o),o},e.prototype.verifyNotFailed=function(){this.failure&&m("AsyncQueue is already failed: "+(this.failure.stack||this.failure.message))},e.prototype.verifyOperationInProgress=function(){g(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},e.prototype.drain=function(){return this.enqueueEvenAfterShutdown((function(){return Promise.resolve()}))},e.prototype.containsDelayedOperation=function(e){for(var t=0,n=this.delayedOperations;t<n.length;t++)if(n[t].timerId===e)return!0;return!1},e.prototype.runDelayedOperationsEarly=function(e){var t=this;return this.drain().then((function(){g(e===he.All||t.containsDelayedOperation(e),"Attempted to drain to missing operation "+e),t.delayedOperations.sort((function(e,t){return e.targetTimeMs-t.targetTimeMs}));for(var n=0,r=t.delayedOperations;n<r.length;n++){var o=r[n];if(o.skipDelay(),e!==he.All&&o.timerId===e)break}return t.drain()}))},e.prototype.skipDelaysForTimerId=function(e){this.timerIdsToSkip.push(e)},e.prototype.removeDelayedOperation=function(e){var t=this.delayedOperations.indexOf(e);g(t>=0,"Delayed operation not found."),this.delayedOperations.splice(t,1)},e}();function pe(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=ve(t)),t=ye(e.get(n),t);return ve(t)}function ye(e,t){for(var n=t,r=e.length,o=0;o<r;o++){var i=e.charAt(o);switch(i){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=i}}return n}function ve(e){return e+"\x01\x01"}function me(e){var t=e.length;if(g(t>=2,"Invalid path "+e),2===t)return g("\x01"===e.charAt(0)&&"\x01"===e.charAt(1),"Non-empty path "+e+" had length 2"),ae.EMPTY_PATH;for(var n=t-2,r=[],o="",i=0;i<t;){var a=e.indexOf("\x01",i);switch((a<0||a>n)&&m('Invalid encoded resource path: "'+e+'"'),e.charAt(a+1)){case"\x01":var s=e.substring(i,a),u=void 0;0===o.length?u=s:(u=o+=s,o=""),r.push(u);break;case"\x10":o+=e.substring(i,a),o+="\0";break;case"\x11":o+=e.substring(i,a+1);break;default:m('Invalid encoded resource path: "'+e+'"')}i=a+2}return new ae(r)}var ge=function(){function e(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new C(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new C(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new C(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new C(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}return e.now=function(){return e.fromMillis(Date.now())},e.fromDate=function(t){return e.fromMillis(t.getTime())},e.fromMillis=function(t){var n=Math.floor(t/1e3);return new e(n,1e6*(t-1e3*n))},e.prototype.toDate=function(){return new Date(this.toMillis())},e.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},e.prototype._compareTo=function(e){return this.seconds===e.seconds?Y(this.nanoseconds,e.nanoseconds):Y(this.seconds,e.seconds)},e.prototype.isEqual=function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds},e.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},e}(),be=function(){function e(e){this.timestamp=e}return e.fromMicroseconds=function(t){var n=Math.floor(t/1e6);return new e(new ge(n,t%1e6*1e3))},e.fromTimestamp=function(t){return new e(t)},e.forDeletedDoc=function(){return e.MIN},e.prototype.compareTo=function(e){return this.timestamp._compareTo(e.timestamp)},e.prototype.isEqual=function(e){return this.timestamp.isEqual(e.timestamp)},e.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},e.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},e.prototype.toTimestamp=function(){return this.timestamp},e.MIN=new e(new ge(0,0)),e}(),_e=function(){function e(e,t){this.comparator=e,this.root=t||Ce.EMPTY}return e.prototype.insert=function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Ce.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Ce.BLACK,null,null))},e.prototype.get=function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null},e.prototype.indexOf=function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1},e.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(e.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),e.prototype.minKey=function(){return this.root.minKey()},e.prototype.maxKey=function(){return this.root.maxKey()},e.prototype.inorderTraversal=function(e){return this.root.inorderTraversal(e)},e.prototype.forEach=function(e){this.inorderTraversal((function(t,n){return e(t,n),!1}))},e.prototype.toString=function(){var e=[];return this.inorderTraversal((function(t,n){return e.push(t+":"+n),!1})),"{"+e.join(", ")+"}"},e.prototype.reverseTraversal=function(e){return this.root.reverseTraversal(e)},e.prototype.getIterator=function(){return new we(this.root,null,this.comparator,!1)},e.prototype.getIteratorFrom=function(e){return new we(this.root,e,this.comparator,!1)},e.prototype.getReverseIterator=function(){return new we(this.root,null,this.comparator,!0)},e.prototype.getReverseIteratorFrom=function(e){return new we(this.root,e,this.comparator,!0)},e}(),we=function(){function e(e,t,n,r){this.isReverse=r,this.nodeStack=[];for(var o=1;!e.isEmpty();)if(o=t?n(e.key,t):1,r&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(0===o){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}return e.prototype.getNext=function(){g(this.nodeStack.length>0,"getNext() called on iterator when hasNext() is false.");var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t},e.prototype.hasNext=function(){return this.nodeStack.length>0},e.prototype.peek=function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}},e}(),Ce=function(){function e(t,n,r,o,i){this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=o?o:e.EMPTY,this.right=null!=i?i:e.EMPTY,this.size=this.left.size+1+this.right.size}return e.prototype.copy=function(t,n,r,o,i){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=o?o:this.left,null!=i?i:this.right)},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},e.prototype.minKey=function(){return this.min().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,n){var r=this,o=n(e,r.key);return(r=o<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===o?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()},e.prototype.removeMin=function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()},e.prototype.remove=function(t,n){var r,o=this;if(n(t,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(t,n),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),0===n(t,o.key)){if(o.right.isEmpty())return e.EMPTY;r=o.right.min(),o=o.copy(r.key,r.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(t,n))}return o.fixUp()},e.prototype.isRed=function(){return this.color},e.prototype.fixUp=function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e},e.prototype.moveRedLeft=function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e},e.prototype.moveRedRight=function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e},e.prototype.rotateLeft=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth=function(){var e=this.check();return Math.pow(2,e)<=this.size+1},e.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw m("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw m("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check();if(e!==this.right.check())throw m("Black depths differ");return e+(this.isRed()?0:1)},e.EMPTY=null,e.RED=!0,e.BLACK=!1,e}(),ke=function(){function e(){this.size=0}return Object.defineProperty(e.prototype,"key",{get:function(){throw m("LLRBEmptyNode has no key.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){throw m("LLRBEmptyNode has no value.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){throw m("LLRBEmptyNode has no color.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){throw m("LLRBEmptyNode has no left child.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){throw m("LLRBEmptyNode has no right child.")},enumerable:!0,configurable:!0}),e.prototype.copy=function(e,t,n,r,o){return this},e.prototype.insert=function(e,t,n){return new Ce(e,t)},e.prototype.remove=function(e,t){return this},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.isRed=function(){return!1},e.prototype.checkMaxDepth=function(){return!0},e.prototype.check=function(){return 0},e}();Ce.EMPTY=new ke;var Se=function(){function e(e){this.comparator=e,this.data=new _e(this.comparator)}return e.fromMapKeys=function(t){var n=new e(t.comparator);return t.forEach((function(e){n=n.add(e)})),n},e.prototype.has=function(e){return null!==this.data.get(e)},e.prototype.first=function(){return this.data.minKey()},e.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(e.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),e.prototype.indexOf=function(e){return this.data.indexOf(e)},e.prototype.forEach=function(e){this.data.inorderTraversal((function(t,n){return e(t),!1}))},e.prototype.forEachInRange=function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}},e.prototype.forEachWhile=function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return},e.prototype.firstAfterOrEqual=function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null},e.prototype.getIterator=function(){return new Ee(this.data.getIterator())},e.prototype.getIteratorFrom=function(e){return new Ee(this.data.getIteratorFrom(e))},e.prototype.add=function(e){return this.copy(this.data.remove(e).insert(e,!0))},e.prototype.delete=function(e){return this.has(e)?this.copy(this.data.remove(e)):this},e.prototype.isEmpty=function(){return this.data.isEmpty()},e.prototype.unionWith=function(e){var t=this;return e.forEach((function(e){t=t.add(e)})),t},e.prototype.isEqual=function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var o=n.getNext().key,i=r.getNext().key;if(0!==this.comparator(o,i))return!1}return!0},e.prototype.toArray=function(){var e=[];return this.forEach((function(t){e.push(t)})),e},e.prototype.toString=function(){var e=[];return this.forEach((function(t){return e.push(t)})),"SortedSet("+e.toString()+")"},e.prototype.copy=function(t){var n=new e(this.comparator);return n.data=t,n},e}(),Ee=function(){function e(e){this.iter=e}return e.prototype.getNext=function(){return this.iter.getNext().key},e.prototype.hasNext=function(){return this.iter.hasNext()},e}(),Te=new _e(ce.comparator);function Ie(){return Te}function Ae(){return Ie()}var De=new _e(ce.comparator);function Ne(){return De}var Pe=new _e(ce.comparator);function xe(){return Pe}var Oe=new Se(ce.comparator);function Me(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=Oe,r=0,o=e;r<o.length;r++){var i=o[r];n=n.add(i)}return n}var Re=new Se(Y);function Le(){return Re}var Fe=function(){function e(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r,g(r.length>0,"Cannot create an empty mutation batch")}return e.prototype.applyToRemoteDocument=function(e,t,n){t&&g(t.key.isEqual(e),"applyToRemoteDocument: key "+e+" should match maybeDoc key\n        "+t.key);var r=n.mutationResults;g(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var o=0;o<this.mutations.length;o++){var i=this.mutations[o];i.key.isEqual(e)&&(t=i.applyToRemoteDocument(t,r[o]))}return t},e.prototype.applyToLocalView=function(e,t){t&&g(t.key.isEqual(e),"applyToLocalDocument: key "+e+" should match maybeDoc key\n        "+t.key);for(var n=0,r=this.baseMutations;n<r.length;n++)(s=r[n]).key.isEqual(e)&&(t=s.applyToLocalView(t,t,this.localWriteTime));for(var o=t,i=0,a=this.mutations;i<a.length;i++){var s;(s=a[i]).key.isEqual(e)&&(t=s.applyToLocalView(t,o,this.localWriteTime))}return t},e.prototype.applyToLocalDocumentSet=function(e){var t=this,n=e;return this.mutations.forEach((function(r){var o=t.applyToLocalView(r.key,e.get(r.key));o&&(n=n.insert(r.key,o))})),n},e.prototype.keys=function(){return this.mutations.reduce((function(e,t){return e.add(t.key)}),Me())},e.prototype.isEqual=function(e){return this.batchId===e.batchId&&J(this.mutations,e.mutations)&&J(this.baseMutations,e.baseMutations)},e}(),Ve=function(){function e(e,t,n,r,o){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.streamToken=r,this.docVersions=o}return e.from=function(t,n,r,o){g(t.mutations.length===r.length,"Mutations sent "+t.mutations.length+" must equal results received "+r.length);for(var i=xe(),a=t.mutations,s=0;s<a.length;s++)i=i.insert(a[s].key,r[s].version);return new e(t,n,r,o,i)},e}(),Be=function(){function e(e){var t=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((function(e){t.isDone=!0,t.result=e,t.nextCallback&&t.nextCallback(e)}),(function(e){t.isDone=!0,t.error=e,t.catchCallback&&t.catchCallback(e)}))}return e.prototype.catch=function(e){return this.next(void 0,e)},e.prototype.next=function(t,n){var r=this;return this.callbackAttached&&m("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e((function(e,o){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,o)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,o)}}))},e.prototype.toPromise=function(){var e=this;return new Promise((function(t,n){e.next(t,n)}))},e.prototype.wrapUserFunction=function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(r){return e.reject(r)}},e.prototype.wrapSuccess=function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.resolve(n)},e.prototype.wrapFailure=function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.reject(n)},e.resolve=function(t){return new e((function(e,n){e(t)}))},e.reject=function(t){return new e((function(e,n){n(t)}))},e.waitFor=function(t){return new e((function(e,n){var r=0,o=0,i=!1;t.forEach((function(t){++r,t.next((function(){++o,i&&o===r&&e()}),(function(e){return n(e)}))})),i=!0,o===r&&e()}))},e.or=function(t){for(var n=e.resolve(!1),r=function(t){n=n.next((function(n){return n?e.resolve(n):t()}))},o=0,i=t;o<i.length;o++)r(i[o]);return n},e.forEach=function(e,t){var n=this,r=[];return e.forEach((function(e,o){r.push(t.call(n,e,o))})),this.waitFor(r)},e}(),qe=function(){function e(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.documentKeysByBatchId={}}return e.forUser=function(t,n,r,o){return g(""!==t.uid,"UserID must not be an empty string."),new e(t.isAuthenticated()?t.uid:"",n,r,o)},e.prototype.checkEmpty=function(e){var t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ze(e).iterate({index:nn.userMutationsIndex,range:n},(function(e,n,r){t=!1,r.done()})).next((function(){return t}))},e.prototype.acknowledgeBatch=function(e,t,n){return this.getMutationQueueMetadata(e).next((function(t){return t.lastStreamToken=Ge(n),He(e).put(t)}))},e.prototype.getLastStreamToken=function(e){return this.getMutationQueueMetadata(e).next((function(e){return e.lastStreamToken}))},e.prototype.setLastStreamToken=function(e,t){return this.getMutationQueueMetadata(e).next((function(n){return n.lastStreamToken=Ge(t),He(e).put(n)}))},e.prototype.addMutationBatch=function(e,t,n,r){var o=this,i=We(e),a=ze(e);return a.add({}).next((function(s){g("number"==typeof s,"Auto-generated key is not a number");var u=new Fe(s,t,n,r),c=o.serializer.toDbMutationBatch(o.userId,u);o.documentKeysByBatchId[s]=u.keys();for(var l=[],h=0,f=r;h<f.length;h++){var d=f[h],p=rn.key(o.userId,d.key.path,s);l.push(a.put(c)),l.push(i.put(p,rn.PLACEHOLDER)),l.push(o.indexManager.addToCollectionParentIndex(e,d.key.path.popLast()))}return Be.waitFor(l).next((function(){return u}))}))},e.prototype.lookupMutationBatch=function(e,t){var n=this;return ze(e).get(t).next((function(e){return e?(g(e.userId===n.userId,"Unexpected user '"+e.userId+"' for mutation batch "+t),n.serializer.fromDbMutationBatch(e)):null}))},e.prototype.lookupMutationKeys=function(e,t){var n=this;return this.documentKeysByBatchId[t]?Be.resolve(this.documentKeysByBatchId[t]):this.lookupMutationBatch(e,t).next((function(e){if(e){var r=e.keys();return n.documentKeysByBatchId[t]=r,r}return null}))},e.prototype.getNextMutationBatchAfterBatchId=function(e,t){var n=this,r=t+1,o=IDBKeyRange.lowerBound([this.userId,r]),i=null;return ze(e).iterate({index:nn.userMutationsIndex,range:o},(function(e,t,o){t.userId===n.userId&&(g(t.batchId>=r,"Should have found mutation after "+r),i=n.serializer.fromDbMutationBatch(t)),o.done()})).next((function(){return i}))},e.prototype.getHighestUnacknowledgedBatchId=function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return ze(e).iterate({index:nn.userMutationsIndex,range:t,reverse:!0},(function(e,t,r){n=t.batchId,r.done()})).next((function(){return n}))},e.prototype.getAllMutationBatches=function(e){var t=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ze(e).loadAll(nn.userMutationsIndex,n).next((function(e){return e.map((function(e){return t.serializer.fromDbMutationBatch(e)}))}))},e.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,t){var n=this,r=rn.prefixForPath(this.userId,t.path),o=IDBKeyRange.lowerBound(r),i=[];return We(e).iterate({range:o},(function(r,o,a){var s=r[0],u=r[2],c=me(r[1]);if(s===n.userId&&t.path.isEqual(c))return ze(e).get(u).next((function(e){if(!e)throw m("Dangling document-mutation reference found: "+r+" which points to "+u);g(e.userId===n.userId,"Unexpected user '"+e.userId+"' for mutation batch "+u),i.push(n.serializer.fromDbMutationBatch(e))}));a.done()})).next((function(){return i}))},e.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,t){var n=this,r=new Se(Y),o=[];return t.forEach((function(t){var i=rn.prefixForPath(n.userId,t.path),a=IDBKeyRange.lowerBound(i),s=We(e).iterate({range:a},(function(e,o,i){var a=e[0],s=e[2],u=me(e[1]);a===n.userId&&t.path.isEqual(u)?r=r.add(s):i.done()}));o.push(s)})),Be.waitFor(o).next((function(){return n.lookupMutationBatches(e,r)}))},e.prototype.getAllMutationBatchesAffectingQuery=function(e,t){var n=this;g(!t.isDocumentQuery(),"Document queries shouldn't go down this path"),g(!t.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var r=t.path,o=r.length+1,i=rn.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(i),s=new Se(Y);return We(e).iterate({range:a},(function(e,t,i){var a=e[0],u=e[2],c=me(e[1]);a===n.userId&&r.isPrefixOf(c)?c.length===o&&(s=s.add(u)):i.done()})).next((function(){return n.lookupMutationBatches(e,s)}))},e.prototype.lookupMutationBatches=function(e,t){var n=this,r=[],o=[];return t.forEach((function(t){o.push(ze(e).get(t).next((function(e){if(null===e)throw m("Dangling document-mutation reference found, which points to "+t);g(e.userId===n.userId,"Unexpected user '"+e.userId+"' for mutation batch "+t),r.push(n.serializer.fromDbMutationBatch(e))})))})),Be.waitFor(o).next((function(){return r}))},e.prototype.removeMutationBatch=function(e,t){var n=this;return Ue(e.simpleDbTransaction,this.userId,t).next((function(r){return n.removeCachedMutationKeys(t.batchId),Be.forEach(r,(function(t){return n.referenceDelegate.removeMutationReference(e,t)}))}))},e.prototype.removeCachedMutationKeys=function(e){delete this.documentKeysByBatchId[e]},e.prototype.performConsistencyCheck=function(e){var t=this;return this.checkEmpty(e).next((function(n){if(!n)return Be.resolve();var r=IDBKeyRange.lowerBound(rn.prefixForUser(t.userId)),o=[];return We(e).iterate({range:r},(function(e,n,r){if(e[0]===t.userId){var i=me(e[1]);o.push(i)}else r.done()})).next((function(){g(0===o.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+o.map((function(e){return e.canonicalString()})))}))}))},e.prototype.containsKey=function(e,t){return je(e,this.userId,t)},e.prototype.getMutationQueueMetadata=function(e){var t=this;return He(e).get(this.userId).next((function(e){return e||new tn(t.userId,-1,"")}))},e}();function je(e,t,n){var r=rn.prefixForPath(t,n.path),o=r[1],i=IDBKeyRange.lowerBound(r),a=!1;return We(e).iterate({range:i,keysOnly:!0},(function(e,n,r){e[0]===t&&e[1]===o&&(a=!0),r.done()})).next((function(){return a}))}function Ue(e,t,n){var r=e.store(nn.store),o=e.store(rn.store),i=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.iterate({range:a},(function(e,t,n){return s++,n.delete()}));i.push(u.next((function(){g(1===s,"Dangling document-mutation reference found: Missing batch "+n.batchId)})));for(var c=[],l=0,h=n.mutations;l<h.length;l++){var f=h[l],d=rn.key(t,f.key.path,n.batchId);i.push(o.delete(d)),c.push(f.key)}return Be.waitFor(i).next((function(){return c}))}function Ge(e){return e instanceof Uint8Array?(g("YES"===process.env.USE_MOCK_PERSISTENCE,"Persisting non-string stream tokens is only supported with mock persistence."),e.toString()):e}function ze(e){return xn.getStore(e,nn.store)}function We(e){return xn.getStore(e,rn.store)}function He(e){return xn.getStore(e,tn.store)}var Qe=function(e){return e[e.QueryCache=0]="QueryCache",e[e.SyncEngine=1]="SyncEngine",e}({}),Ke=function(){function e(e,t){this.generatorId=e,g((1&e)===e,"Generator ID "+e+" contains more than 1 reserved bits"),this.seek(void 0!==t?t:this.generatorId)}return e.prototype.next=function(){var e=this.nextId;return this.nextId+=2,e},e.prototype.after=function(e){return this.seek(e+2),this.next()},e.prototype.seek=function(e){g((1&e)===this.generatorId,"Cannot supply target ID from different generator ID"),this.nextId=e},e.forQueryCache=function(){return new e(Qe.QueryCache,2)},e.forSyncEngine=function(){return new e(Qe.SyncEngine)},e}(),Ye="SimpleDb",Je=function(){function e(t){this.db=t,12.2===e.getIOSVersion(s.getUA())&&y("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e.openOrCreate=function(t,n,r){return g(e.isAvailable(),"IndexedDB not supported in current environment."),p(Ye,"Opening database:",t),new Be((function(o,i){var a=window.indexedDB.open(t,n);a.onsuccess=function(t){o(new e(t.target.result))},a.onblocked=function(){i(new C(w.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=function(e){var t=e.target.error;i("VersionError"===t.name?new C(w.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):t)},a.onupgradeneeded=function(e){p(Ye,'Database "'+t+'" requires upgrade from version:',e.oldVersion);var n=e.target.result,o=new Ze(a.transaction);r.createOrUpgrade(n,o,e.oldVersion,$t).next((function(){p(Ye,"Database upgrade to version "+$t+" complete")}))}})).toPromise()},e.delete=function(e){return p(Ye,"Removing database:",e),et(window.indexedDB.deleteDatabase(e)).toPromise()},e.isAvailable=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(void 0===window.navigator)return"YES"===process.env.USE_MOCK_PERSISTENCE;var t=s.getUA(),n=e.getIOSVersion(t),r=0<n&&n<10,o=e.getAndroidVersion(t),i=0<o&&o<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||i)},e.getStore=function(e,t){return e.store(t)},e.getIOSVersion=function(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)},e.getAndroidVersion=function(e){var t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)},e.prototype.setVersionChangeListener=function(e){this.db.onversionchange=function(t){return e(t)}},e.prototype.runTransaction=function(e,t,n){var r=Ze.open(this.db,e,t),o=n(r).catch((function(e){return r.abort(e),Be.reject(e)})).toPromise();return o.catch((function(){})),r.completionPromise.then((function(){return o}))},e.prototype.close=function(){this.db.close()},e}(),$e=function(){function e(e){this.dbCursor=e,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(e.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cursor",{set:function(e){this.dbCursor=e},enumerable:!0,configurable:!0}),e.prototype.done=function(){this.shouldStop=!0},e.prototype.skip=function(e){this.nextKey=e},e.prototype.delete=function(){return et(this.dbCursor.delete())},e}(),Ze=function(){function e(e){var t=this;this.transaction=e,this.aborted=!1,this.completionDeferred=new le,this.transaction.oncomplete=function(){t.completionDeferred.resolve()},this.transaction.onabort=function(){e.error?t.completionDeferred.reject(e.error):t.completionDeferred.resolve()},this.transaction.onerror=function(e){var n=nt(e.target.error);t.completionDeferred.reject(n)}}return e.open=function(t,n,r){return new e(t.transaction(r,n))},Object.defineProperty(e.prototype,"completionPromise",{get:function(){return this.completionDeferred.promise},enumerable:!0,configurable:!0}),e.prototype.abort=function(e){e&&this.completionDeferred.reject(e),this.aborted||(p(Ye,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},e.prototype.store=function(e){var t=this.transaction.objectStore(e);return g(!!t,"Object store not part of transaction: "+e),new Xe(t)},e}(),Xe=function(){function e(e){this.store=e}return e.prototype.put=function(e,t){var n;return void 0!==t?(p(Ye,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(p(Ye,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),et(n)},e.prototype.add=function(e){return p(Ye,"ADD",this.store.name,e,e),et(this.store.add(e))},e.prototype.get=function(e){var t=this;return et(this.store.get(e)).next((function(n){return void 0===n&&(n=null),p(Ye,"GET",t.store.name,e,n),n}))},e.prototype.delete=function(e){return p(Ye,"DELETE",this.store.name,e),et(this.store.delete(e))},e.prototype.count=function(){return p(Ye,"COUNT",this.store.name),et(this.store.count())},e.prototype.loadAll=function(e,t){var n=this.cursor(this.options(e,t)),r=[];return this.iterateCursor(n,(function(e,t){r.push(t)})).next((function(){return r}))},e.prototype.deleteAll=function(e,t){p(Ye,"DELETE ALL",this.store.name);var n=this.options(e,t);n.keysOnly=!1;var r=this.cursor(n);return this.iterateCursor(r,(function(e,t,n){return n.delete()}))},e.prototype.iterate=function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.iterateCursor(r,t)},e.prototype.iterateSerial=function(e){var t=this.cursor({});return new Be((function(n,r){t.onerror=function(e){var t=nt(e.target.error);r(t)},t.onsuccess=function(t){var r=t.target.result;r?e(r.primaryKey,r.value).next((function(e){e?r.continue():n()})):n()}}))},e.prototype.iterateCursor=function(e,t){var n=[];return new Be((function(r,o){e.onerror=function(e){o(e.target.error)},e.onsuccess=function(e){var o=e.target.result;if(o){var i=new $e(o),a=t(o.primaryKey,o.value,i);if(a instanceof Be){var s=a.catch((function(e){return i.done(),Be.reject(e)}));n.push(s)}i.isDone?r():null===i.skipToKey?o.continue():o.continue(i.skipToKey)}else r()}})).next((function(){return Be.waitFor(n)}))},e.prototype.options=function(e,t){var n=void 0;return void 0!==e&&("string"==typeof e?n=e:(g(void 0===t,"3rd argument must not be defined if 2nd is a range."),t=e)),{index:n,range:t}},e.prototype.cursor=function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.keysOnly?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)},e}();function et(e){return new Be((function(t,n){e.onsuccess=function(e){t(e.target.result)},e.onerror=function(e){var t=nt(e.target.error);n(t)}}))}var tt=!1;function nt(e){var t=Je.getIOSVersion(s.getUA());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var r=new C("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return tt||(tt=!0,setTimeout((function(){throw r}),0)),r}}return e}var rt=function(){function e(e,t){this.referenceDelegate=e,this.serializer=t,this.targetIdGenerator=Ke.forQueryCache()}return e.prototype.allocateTargetId=function(e){var t=this;return this.retrieveMetadata(e).next((function(n){return n.highestTargetId=t.targetIdGenerator.after(n.highestTargetId),t.saveMetadata(e,n).next((function(){return n.highestTargetId}))}))},e.prototype.getLastRemoteSnapshotVersion=function(e){return this.retrieveMetadata(e).next((function(e){return be.fromTimestamp(new ge(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))}))},e.prototype.getHighestSequenceNumber=function(e){return at(e.simpleDbTransaction)},e.prototype.setTargetsMetadata=function(e,t,n){var r=this;return this.retrieveMetadata(e).next((function(o){return o.highestListenSequenceNumber=t,n&&(o.lastRemoteSnapshotVersion=n.toTimestamp()),t>o.highestListenSequenceNumber&&(o.highestListenSequenceNumber=t),r.saveMetadata(e,o)}))},e.prototype.addQueryData=function(e,t){var n=this;return this.saveQueryData(e,t).next((function(){return n.retrieveMetadata(e).next((function(r){return r.targetCount+=1,n.updateMetadataFromQueryData(t,r),n.saveMetadata(e,r)}))}))},e.prototype.updateQueryData=function(e,t){return this.saveQueryData(e,t)},e.prototype.removeQueryData=function(e,t){var n=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next((function(){return ot(e).delete(t.targetId)})).next((function(){return n.retrieveMetadata(e)})).next((function(t){return g(t.targetCount>0,"Removing from an empty query cache"),t.targetCount-=1,n.saveMetadata(e,t)}))},e.prototype.removeTargets=function(e,t,n){var r=this,o=0,i=[];return ot(e).iterate((function(a,s){var u=r.serializer.fromDbTarget(s);u.sequenceNumber<=t&&void 0===n[u.targetId]&&(o++,i.push(r.removeQueryData(e,u)))})).next((function(){return Be.waitFor(i)})).next((function(){return o}))},e.prototype.forEachTarget=function(e,t){var n=this;return ot(e).iterate((function(e,r){var o=n.serializer.fromDbTarget(r);t(o)}))},e.prototype.retrieveMetadata=function(e){return it(e.simpleDbTransaction)},e.prototype.saveMetadata=function(e,t){return(n=e,xn.getStore(n,hn.store)).put(hn.key,t);var n},e.prototype.saveQueryData=function(e,t){return ot(e).put(this.serializer.toDbTarget(t))},e.prototype.updateMetadataFromQueryData=function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n},e.prototype.getQueryCount=function(e){return this.retrieveMetadata(e).next((function(e){return e.targetCount}))},e.prototype.getQueryData=function(e,t){var n=this,r=t.canonicalId(),o=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),i=null;return ot(e).iterate({range:o,index:cn.queryTargetsIndexName},(function(e,r,o){var a=n.serializer.fromDbTarget(r);t.isEqual(a.query)&&(i=a,o.done())})).next((function(){return i}))},e.prototype.addMatchingKeys=function(e,t,n){var r=this,o=[],i=st(e);return t.forEach((function(t){var a=pe(t.path);o.push(i.put(new ln(n,a))),o.push(r.referenceDelegate.addReference(e,t))})),Be.waitFor(o)},e.prototype.removeMatchingKeys=function(e,t,n){var r=this,o=st(e);return Be.forEach(t,(function(t){var i=pe(t.path);return Be.waitFor([o.delete([n,i]),r.referenceDelegate.removeReference(e,t)])}))},e.prototype.removeMatchingKeysForTargetId=function(e,t){var n=st(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)},e.prototype.getMatchingKeysForTargetId=function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=st(e),o=Me();return r.iterate({range:n,keysOnly:!0},(function(e,t,n){var r=me(e[1]),i=new ce(r);o=o.add(i)})).next((function(){return o}))},e.prototype.containsKey=function(e,t){var n=pe(t.path),r=IDBKeyRange.bound([n],[$(n)],!1,!0),o=0;return st(e).iterate({index:ln.documentTargetsIndex,keysOnly:!0,range:r},(function(e,t,n){0!==e[0]&&(o++,n.done())})).next((function(){return o>0}))},e.prototype.getQueryDataForTarget=function(e,t){var n=this;return ot(e).get(t).next((function(e){return e?n.serializer.fromDbTarget(e):null}))},e}();function ot(e){return xn.getStore(e,cn.store)}function it(e){return Je.getStore(e,hn.store).get(hn.key).next((function(e){return g(null!==e,"Missing metadata row."),e}))}function at(e){return it(e).next((function(e){return e.highestListenSequenceNumber}))}function st(e){return xn.getStore(e,ln.store)}var ut=function(){function e(e){this.fields=e}return e.fromSet=function(t){return new e(t)},e.fromArray=function(t){var n=new Se(ue.comparator);return t.forEach((function(e){return n=n.add(e)})),new e(n)},e.prototype.covers=function(e){var t=!1;return this.fields.forEach((function(n){n.isPrefixOf(e)&&(t=!0)})),t},e.prototype.isEqual=function(e){return this.fields.isEqual(e.fields)},e}(),ct=function(){function e(e,t){this.field=e,this.transform=t}return e.prototype.isEqual=function(e){return this.field.isEqual(e.field)&&this.transform.isEqual(e.transform)},e}(),lt=function(e,t){this.version=e,this.transformResults=t},ht=function(e){return e[e.Set=0]="Set",e[e.Patch=1]="Patch",e[e.Transform=2]="Transform",e[e.Delete=3]="Delete",e}({}),ft=function(){function e(e,t){this.updateTime=e,this.exists=t,g(void 0===e||void 0===t,'Precondition can specify "exists" or "updateTime" but not both')}return e.exists=function(t){return new e(void 0,t)},e.updateTime=function(t){return new e(t)},Object.defineProperty(e.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),e.prototype.isValidFor=function(e){return void 0!==this.updateTime?e instanceof Ft&&e.version.isEqual(this.updateTime):void 0!==this.exists?this.exists===e instanceof Ft:(g(this.isNone,"Precondition should be empty"),!0)},e.prototype.isEqual=function(e){return n=e.updateTime,(null!=(t=this.updateTime)?!(!n||!t.isEqual(n)):t===n)&&this.exists===e.exists;var t,n},e.NONE=new e,e}(),dt=function(){function e(){}return e.prototype.verifyKeyMatches=function(e){null!=e&&g(e.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},e.getPostMutationVersion=function(e){return e instanceof Ft?e.version:be.MIN},e}(),pt=function(e){function t(t,n,r){var o=e.call(this)||this;return o.key=t,o.value=n,o.precondition=r,o.type=ht.Set,o}return a.__extends(t,e),t.prototype.applyToRemoteDocument=function(e,t){return this.verifyKeyMatches(e),g(null==t.transformResults,"Transform results received by SetMutation."),new Ft(this.key,t.version,{hasCommittedMutations:!0},this.value)},t.prototype.applyToLocalView=function(e,t,n){if(this.verifyKeyMatches(e),!this.precondition.isValidFor(e))return e;var r=dt.getPostMutationVersion(e);return new Ft(this.key,r,{hasLocalMutations:!0},this.value)},t.prototype.extractBaseValue=function(e){return null},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.value.isEqual(e.value)&&this.precondition.isEqual(e.precondition)},t}(dt),yt=function(e){function t(t,n,r,o){var i=e.call(this)||this;return i.key=t,i.data=n,i.fieldMask=r,i.precondition=o,i.type=ht.Patch,i}return a.__extends(t,e),t.prototype.applyToRemoteDocument=function(e,t){if(this.verifyKeyMatches(e),g(null==t.transformResults,"Transform results received by PatchMutation."),!this.precondition.isValidFor(e))return new Bt(this.key,t.version);var n=this.patchDocument(e);return new Ft(this.key,t.version,{hasCommittedMutations:!0},n)},t.prototype.applyToLocalView=function(e,t,n){if(this.verifyKeyMatches(e),!this.precondition.isValidFor(e))return e;var r=dt.getPostMutationVersion(e),o=this.patchDocument(e);return new Ft(this.key,r,{hasLocalMutations:!0},o)},t.prototype.extractBaseValue=function(e){return null},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.fieldMask.isEqual(e.fieldMask)&&this.precondition.isEqual(e.precondition)},t.prototype.patchDocument=function(e){var t;return t=e instanceof Ft?e.data():Mt.EMPTY,this.patchObject(t)},t.prototype.patchObject=function(e){var t=this;return this.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e=null!==r?e.set(n,r):e.delete(n)}})),e},t}(dt),vt=function(e){function t(t,n){var r=e.call(this)||this;return r.key=t,r.fieldTransforms=n,r.type=ht.Transform,r.precondition=ft.exists(!0),r}return a.__extends(t,e),t.prototype.applyToRemoteDocument=function(e,t){if(this.verifyKeyMatches(e),g(null!=t.transformResults,"Transform results missing for TransformMutation."),!this.precondition.isValidFor(e))return new Bt(this.key,t.version);var n=this.requireDocument(e),r=this.serverTransformResults(e,t.transformResults),o=t.version,i=this.transformObject(n.data(),r);return new Ft(this.key,o,{hasCommittedMutations:!0},i)},t.prototype.applyToLocalView=function(e,t,n){if(this.verifyKeyMatches(e),!this.precondition.isValidFor(e))return e;var r=this.requireDocument(e),o=this.localTransformResults(n,e,t),i=this.transformObject(r.data(),o);return new Ft(this.key,r.version,{hasLocalMutations:!0},i)},t.prototype.extractBaseValue=function(e){for(var t=null,n=0,r=this.fieldTransforms;n<r.length;n++){var o=r[n],i=e instanceof Ft?e.field(o.field):void 0,a=o.transform.computeBaseValue(i||null);null!=a&&(t=null==t?Mt.EMPTY.set(o.field,a):t.set(o.field,a))}return t},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&J(this.fieldTransforms,e.fieldTransforms)&&this.precondition.isEqual(e.precondition)},t.prototype.requireDocument=function(e){g(e instanceof Ft,"Unknown MaybeDocument type "+e);var t=e;return g(t.key.isEqual(this.key),"Can only transform a document with the same key"),t},t.prototype.serverTransformResults=function(e,t){var n=[];g(this.fieldTransforms.length===t.length,"server transform result count ("+t.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var r=0;r<t.length;r++){var o=this.fieldTransforms[r],i=o.transform,a=null;e instanceof Ft&&(a=e.field(o.field)),n.push(i.applyToRemoteDocument(a,t[r]))}return n},t.prototype.localTransformResults=function(e,t,n){for(var r=[],o=0,i=this.fieldTransforms;o<i.length;o++){var a=i[o],s=a.transform,u=null;t instanceof Ft&&(u=t.field(a.field)),null===u&&n instanceof Ft&&(u=n.field(a.field)),r.push(s.applyToLocalView(u,e))}return r},t.prototype.transformObject=function(e,t){g(t.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=0;n<this.fieldTransforms.length;n++)e=e.set(this.fieldTransforms[n].field,t[n]);return e},t}(dt),mt=function(e){function t(t,n){var r=e.call(this)||this;return r.key=t,r.precondition=n,r.type=ht.Delete,r}return a.__extends(t,e),t.prototype.applyToRemoteDocument=function(e,t){return this.verifyKeyMatches(e),g(null==t.transformResults,"Transform results received by DeleteMutation."),new Vt(this.key,t.version,{hasCommittedMutations:!0})},t.prototype.applyToLocalView=function(e,t,n){return this.verifyKeyMatches(e),this.precondition.isValidFor(e)?(e&&g(e.key.isEqual(this.key),"Can only apply mutation to document with same key"),new Vt(this.key,be.forDeletedDoc())):e},t.prototype.extractBaseValue=function(e){return null},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.precondition.isEqual(e.precondition)},t}(dt),gt=function(e){return e[e.NullValue=0]="NullValue",e[e.BooleanValue=1]="BooleanValue",e[e.NumberValue=2]="NumberValue",e[e.TimestampValue=3]="TimestampValue",e[e.StringValue=4]="StringValue",e[e.BlobValue=5]="BlobValue",e[e.RefValue=6]="RefValue",e[e.GeoPointValue=7]="GeoPointValue",e[e.ArrayValue=8]="ArrayValue",e[e.ObjectValue=9]="ObjectValue",e}({}),bt=function(e){return e[e.Default=0]="Default",e[e.Estimate=1]="Estimate",e[e.Previous=2]="Previous",e}({}),_t=function(){function e(e,t){this.serverTimestampBehavior=e,this.timestampsInSnapshots=t}return e.fromSnapshotOptions=function(t,n){switch(t.serverTimestamps){case"estimate":return new e(bt.Estimate,n);case"previous":return new e(bt.Previous,n);case"none":case void 0:return new e(bt.Default,n);default:return m("fromSnapshotOptions() called with invalid options.")}},e}(),wt=function(){function e(){}return e.prototype.toString=function(){var e=this.value();return null===e?"null":e.toString()},e.prototype.defaultCompareTo=function(e){return g(this.typeOrder!==e.typeOrder,"Default compareTo should not be used for values of same type."),Y(this.typeOrder,e.typeOrder)},e}(),Ct=function(e){function t(){var t=e.call(this)||this;return t.typeOrder=gt.NullValue,t.internalValue=null,t}return a.__extends(t,e),t.prototype.value=function(e){return null},t.prototype.isEqual=function(e){return e instanceof t},t.prototype.compareTo=function(e){return e instanceof t?0:this.defaultCompareTo(e)},t.INSTANCE=new t,t}(wt),kt=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=gt.BooleanValue,n}return a.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue===e.internalValue},t.prototype.compareTo=function(e){return e instanceof t?Y(this,e):this.defaultCompareTo(e)},t.of=function(e){return e?t.TRUE:t.FALSE},t.TRUE=new t(!0),t.FALSE=new t(!1),t}(wt),St=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=gt.NumberValue,n}return a.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.compareTo=function(e){return e instanceof t?(n=this.internalValue)<(r=e.internalValue)?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1:this.defaultCompareTo(e);var n,r},t}(wt);function Et(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}var Tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.isEqual=function(e){return e instanceof t&&Et(this.internalValue,e.internalValue)},t}(St),It=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.isEqual=function(e){return e instanceof t&&Et(this.internalValue,e.internalValue)},t.NAN=new t(NaN),t.POSITIVE_INFINITY=new t(1/0),t.NEGATIVE_INFINITY=new t(-1/0),t}(St),At=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=gt.StringValue,n}return a.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue===e.internalValue},t.prototype.compareTo=function(e){return e instanceof t?Y(this.internalValue,e.internalValue):this.defaultCompareTo(e)},t}(wt),Dt=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=gt.TimestampValue,n}return a.__extends(t,e),t.prototype.value=function(e){return!e||e.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue.isEqual(e.internalValue)},t.prototype.compareTo=function(e){return e instanceof t?this.internalValue._compareTo(e.internalValue):e instanceof Nt?-1:this.defaultCompareTo(e)},t}(wt),Nt=function(e){function t(t,n){var r=e.call(this)||this;return r.localWriteTime=t,r.previousValue=n,r.typeOrder=gt.TimestampValue,r}return a.__extends(t,e),t.prototype.value=function(e){return e&&e.serverTimestampBehavior===bt.Estimate?new Dt(this.localWriteTime).value(e):e&&e.serverTimestampBehavior===bt.Previous&&this.previousValue?this.previousValue.value(e):null},t.prototype.isEqual=function(e){return e instanceof t&&this.localWriteTime.isEqual(e.localWriteTime)},t.prototype.compareTo=function(e){return e instanceof t?this.localWriteTime._compareTo(e.localWriteTime):e instanceof Dt?1:this.defaultCompareTo(e)},t.prototype.toString=function(){return"<ServerTimestamp localTime="+this.localWriteTime.toString()+">"},t}(wt),Pt=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=gt.BlobValue,n}return a.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue.isEqual(e.internalValue)},t.prototype.compareTo=function(e){return e instanceof t?this.internalValue._compareTo(e.internalValue):this.defaultCompareTo(e)},t}(wt),xt=function(e){function t(t,n){var r=e.call(this)||this;return r.databaseId=t,r.key=n,r.typeOrder=gt.RefValue,r}return a.__extends(t,e),t.prototype.value=function(e){return this.key},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.databaseId.isEqual(e.databaseId)},t.prototype.compareTo=function(e){if(e instanceof t){var n=this.databaseId.compareTo(e.databaseId);return 0!==n?n:ce.comparator(this.key,e.key)}return this.defaultCompareTo(e)},t}(wt),Ot=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=gt.GeoPointValue,n}return a.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue.isEqual(e.internalValue)},t.prototype.compareTo=function(e){return e instanceof t?this.internalValue._compareTo(e.internalValue):this.defaultCompareTo(e)},t}(wt),Mt=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=gt.ObjectValue,n}return a.__extends(t,e),t.prototype.value=function(e){var t={};return this.internalValue.inorderTraversal((function(n,r){t[n]=r.value(e)})),t},t.prototype.forEach=function(e){this.internalValue.inorderTraversal(e)},t.prototype.isEqual=function(e){if(e instanceof t){for(var n=this.internalValue.getIterator(),r=e.internalValue.getIterator();n.hasNext()&&r.hasNext();){var o=n.getNext(),i=r.getNext();if(o.key!==i.key||!o.value.isEqual(i.value))return!1}return!n.hasNext()&&!r.hasNext()}return!1},t.prototype.compareTo=function(e){if(e instanceof t){for(var n=this.internalValue.getIterator(),r=e.internalValue.getIterator();n.hasNext()&&r.hasNext();){var o=n.getNext(),i=r.getNext(),a=Y(o.key,i.key)||o.value.compareTo(i.value);if(a)return a}return Y(n.hasNext(),r.hasNext())}return this.defaultCompareTo(e)},t.prototype.set=function(e,n){if(g(!e.isEmpty(),"Cannot set field for empty path on ObjectValue"),1===e.length)return this.setChild(e.firstSegment(),n);var r=this.child(e.firstSegment());r instanceof t||(r=t.EMPTY);var o=r.set(e.popFirst(),n);return this.setChild(e.firstSegment(),o)},t.prototype.delete=function(e){if(g(!e.isEmpty(),"Cannot delete field for empty path on ObjectValue"),1===e.length)return new t(this.internalValue.remove(e.firstSegment()));var n=this.child(e.firstSegment());if(n instanceof t){var r=n.delete(e.popFirst());return new t(this.internalValue.insert(e.firstSegment(),r))}return this},t.prototype.contains=function(e){return null!==this.field(e)},t.prototype.field=function(e){g(!e.isEmpty(),"Can't get field of empty path");var n=this;return e.forEach((function(e){n=n instanceof t?n.internalValue.get(e):null})),n},t.prototype.fieldMask=function(){var e=new Se(ue.comparator);return this.internalValue.forEach((function(n,r){var o=new ue([n]);if(r instanceof t){var i=r.fieldMask().fields;i.isEmpty()?e=e.add(o):i.forEach((function(t){e=e.add(o.child(t))}))}else e=e.add(o)})),ut.fromSet(e)},t.prototype.toString=function(){return this.internalValue.toString()},t.prototype.child=function(e){return this.internalValue.get(e)||void 0},t.prototype.setChild=function(e,n){return new t(this.internalValue.insert(e,n))},t.EMPTY=new t(new _e(Y)),t}(wt),Rt=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=gt.ArrayValue,n}return a.__extends(t,e),t.prototype.value=function(e){return this.internalValue.map((function(t){return t.value(e)}))},t.prototype.contains=function(e){for(var t=0,n=this.internalValue;t<n.length;t++)if(n[t].isEqual(e))return!0;return!1},t.prototype.forEach=function(e){this.internalValue.forEach(e)},t.prototype.isEqual=function(e){if(e instanceof t){if(this.internalValue.length!==e.internalValue.length)return!1;for(var n=0;n<this.internalValue.length;n++)if(!this.internalValue[n].isEqual(e.internalValue[n]))return!1;return!0}return!1},t.prototype.compareTo=function(e){if(e instanceof t){for(var n=Math.min(this.internalValue.length,e.internalValue.length),r=0;r<n;r++){var o=this.internalValue[r].compareTo(e.internalValue[r]);if(o)return o}return Y(this.internalValue.length,e.internalValue.length)}return this.defaultCompareTo(e)},t.prototype.toString=function(){return"["+this.internalValue.map((function(e){return e.toString()})).join(",")+"]"},t}(wt),Lt=function(){function e(e,t){this.key=e,this.version=t}return e.compareByKey=function(e,t){return ce.comparator(e.key,t.key)},e}(),Ft=function(e){function t(t,n,r,o,i,a){var s=e.call(this,t,n)||this;return s.objectValue=o,s.proto=i,s.converter=a,g(void 0!==s.objectValue||void 0!==s.proto&&void 0!==s.converter,"If objectValue is not defined, proto and converter need to be set."),s.hasLocalMutations=!!r.hasLocalMutations,s.hasCommittedMutations=!!r.hasCommittedMutations,s}return a.__extends(t,e),t.prototype.field=function(e){if(this.objectValue)return this.objectValue.field(e);this.fieldValueCache||(this.fieldValueCache=new Map);var t=e.canonicalString(),n=this.fieldValueCache.get(t);if(void 0===n){var r=this.getProtoField(e);n=void 0===r?null:this.converter(r),this.fieldValueCache.set(t,n)}return n},t.prototype.data=function(){var e=this;if(!this.objectValue){var t=Mt.EMPTY;I(this.proto.fields,(function(n,r){t=t.set(new ue([n]),e.converter(r))})),this.objectValue=t,this.fieldValueCache=void 0}return this.objectValue},t.prototype.value=function(){return this.data().value()},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.hasLocalMutations===e.hasLocalMutations&&this.hasCommittedMutations===e.hasCommittedMutations&&this.data().isEqual(e.data())},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data().toString()+", {hasLocalMutations: "+this.hasLocalMutations+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!0,configurable:!0}),t.prototype.getProtoField=function(e){g(void 0!==this.proto,"Can only call getProtoField() when proto is defined");for(var t=this.proto.fields[e.firstSegment()],n=1;n<e.length;++n){if(!t||!t.mapValue)return;t=t.mapValue.fields[e.get(n)]}return t},t.compareByField=function(e,t,n){var r=t.field(e),o=n.field(e);return null!==r&&null!==o?r.compareTo(o):m("Trying to compare documents on fields that don't exist")},t}(Lt),Vt=function(e){function t(t,n,r){var o=e.call(this,t,n)||this;return o.hasCommittedMutations=!(!r||!r.hasCommittedMutations),o}return a.__extends(t,e),t.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.hasCommittedMutations===this.hasCommittedMutations&&e.version.isEqual(this.version)&&e.key.isEqual(this.key)},t}(Lt),Bt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.version.isEqual(this.version)&&e.key.isEqual(this.key)},t}(Lt),qt=function(){function e(e){this.mapKeyFn=e,this.inner={}}return e.prototype.get=function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(var r=0,o=n;r<o.length;r++){var i=o[r],a=i[1];if(i[0].isEqual(e))return a}},e.prototype.has=function(e){return void 0!==this.get(e)},e.prototype.set=function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){for(var o=0;o<r.length;o++)if(r[o][0].isEqual(e))return void(r[o]=[e,t]);r.push([e,t])}else this.inner[n]=[[e,t]]},e.prototype.delete=function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(e))return 1===n.length?delete this.inner[t]:n.splice(r,1),!0;return!1},e.prototype.forEach=function(e){I(this.inner,(function(t,n){for(var r=0,o=n;r<o.length;r++){var i=o[r];e(i[0],i[1])}}))},e.prototype.isEmpty=function(){return A(this.inner)},e}(),jt=function(){function e(){this.changes=new qt((function(e){return e.toString()})),this.changesApplied=!1}return e.prototype.addEntry=function(e){this.assertNotApplied(),this.changes.set(e.key,e)},e.prototype.removeEntry=function(e){this.assertNotApplied(),this.changes.set(e,null)},e.prototype.getEntry=function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?Be.resolve(n):this.getFromCache(e,t)},e.prototype.getEntries=function(e,t){return this.getAllFromCache(e,t)},e.prototype.apply=function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)},e.prototype.assertNotApplied=function(){g(!this.changesApplied,"Changes have already been applied.")},e}(),Ut="The remote document changelog no longer contains all changes for all local query views. It may be necessary to rebuild these views.",Gt=function(){function e(e,t,n){this.serializer=e,this.indexManager=t,this.keepDocumentChangeLog=n,this._lastProcessedDocumentChangeId=0}return Object.defineProperty(e.prototype,"lastProcessedDocumentChangeId",{get:function(){return this._lastProcessedDocumentChangeId},enumerable:!0,configurable:!0}),e.prototype.start=function(e){var t=Je.getStore(e,pn.store);return this.synchronizeLastDocumentChangeId(t)},e.prototype.addEntry=function(e,t,n){var r=this;return Wt(e).put(Qt(t),n).next((function(){r.indexManager.addToCollectionParentIndex(e,t.path.popLast())}))},e.prototype.removeEntry=function(e,t){var n=Wt(e),r=Qt(t);return n.delete(r)},e.prototype.updateMetadata=function(e,t,n){var r=this;return this.getMetadata(e).next((function(o){return o.byteSize+=n,r.setMetadata(e,o).next((function(){if(r.keepDocumentChangeLog)return Ht(e).put({changes:r.serializer.toDbResourcePaths(t)})}))}))},e.prototype.getEntry=function(e,t){var n=this;return Wt(e).get(Qt(t)).next((function(e){return e?n.serializer.fromDbRemoteDocument(e):null}))},e.prototype.getSizedEntry=function(e,t){var n=this;return Wt(e).get(Qt(t)).next((function(e){return e?{maybeDocument:n.serializer.fromDbRemoteDocument(e),size:Kt(e)}:null}))},e.prototype.getEntries=function(e,t){var n=this,r=Ae();return this.forEachDbEntry(e,t,(function(e,t){r=r.insert(e,t?n.serializer.fromDbRemoteDocument(t):null)})).next((function(){return r}))},e.prototype.getSizedEntries=function(e,t){var n=this,r=Ae(),o=new _e(ce.comparator);return this.forEachDbEntry(e,t,(function(e,t){t?(r=r.insert(e,n.serializer.fromDbRemoteDocument(t)),o=o.insert(e,Kt(t))):(r=r.insert(e,null),o=o.insert(e,0))})).next((function(){return{maybeDocuments:r,sizeMap:o}}))},e.prototype.forEachDbEntry=function(e,t,n){if(t.isEmpty())return Be.resolve();var r=IDBKeyRange.bound(t.first().path.toArray(),t.last().path.toArray()),o=t.getIterator(),i=o.getNext();return Wt(e).iterate({range:r},(function(e,t,r){for(var a=ce.fromSegments(e);i&&ce.comparator(i,a)<0;)n(i,null),i=o.getNext();i&&i.isEqual(a)&&(n(i,t),i=o.hasNext()?o.getNext():null),i?r.skip(i.path.toArray()):r.done()})).next((function(){for(;i;)n(i,null),i=o.hasNext()?o.getNext():null}))},e.prototype.getDocumentsMatchingQuery=function(e,t){var n=this;g(!t.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var r=Ne(),o=t.path.length+1,i=t.path.toArray(),a=IDBKeyRange.lowerBound(i);return Wt(e).iterate({range:a},(function(e,i,a){if(e.length===o){var s=n.serializer.fromDbRemoteDocument(i);t.path.isPrefixOf(s.key.path)?s instanceof Ft&&t.matches(s)&&(r=r.insert(s.key,s)):a.done()}})).next((function(){return r}))},e.prototype.getNewDocumentChanges=function(e){var t=this;g(this.keepDocumentChangeLog,"Can only call getNewDocumentChanges() when document change log is enabled");var n=Me(),r=Ie(),o=IDBKeyRange.lowerBound(this._lastProcessedDocumentChangeId+1),i=!0,a=Ht(e);return a.iterate({range:o},(function(e,r){if(i&&(i=!1,t._lastProcessedDocumentChangeId+1!==r.id))return t.synchronizeLastDocumentChangeId(a).next((function(){return Be.reject(new C(w.DATA_LOSS,Ut))}));n=n.unionWith(t.serializer.fromDbResourcePaths(r.changes)),t._lastProcessedDocumentChangeId=r.id})).next((function(){var o=[];return n.forEach((function(n){o.push(t.getEntry(e,n).next((function(e){var t=e||new Vt(n,be.forDeletedDoc());r=r.insert(n,t)})))})),Be.waitFor(o)})).next((function(){return r}))},e.prototype.removeDocumentChangesThroughChangeId=function(e,t){var n=IDBKeyRange.upperBound(t);return Ht(e).delete(n)},e.prototype.synchronizeLastDocumentChangeId=function(e){var t=this;return this._lastProcessedDocumentChangeId=0,e.iterate({keysOnly:!0,reverse:!0},(function(e,n,r){t._lastProcessedDocumentChangeId=e,r.done()}))},e.prototype.newChangeBuffer=function(){return new e.RemoteDocumentChangeBuffer(this)},e.prototype.getSize=function(e){return this.getMetadata(e).next((function(e){return e.byteSize}))},e.prototype.getMetadata=function(e){return zt(e).get(un.key).next((function(e){return g(!!e,"Missing document cache metadata"),e}))},e.prototype.setMetadata=function(e,t){return zt(e).put(un.key,t)},e.RemoteDocumentChangeBuffer=function(e){function t(t){var n=e.call(this)||this;return n.documentCache=t,n.documentSizes=new qt((function(e){return e.toString()})),n}return a.__extends(t,e),t.prototype.applyChanges=function(e){var t=this,n=[],r=0,o=Me();return this.changes.forEach((function(i,a){var s=t.documentSizes.get(i);if(g(void 0!==s,"Cannot modify a document that wasn't read (for "+i+")"),a){var u=t.documentCache.serializer.toDbRemoteDocument(a),c=Kt(u);r+=c-s,n.push(t.documentCache.addEntry(e,i,u))}else r-=s,n.push(t.documentCache.removeEntry(e,i));o=o.add(i)})),n.push(this.documentCache.updateMetadata(e,o,r)),Be.waitFor(n)},t.prototype.getFromCache=function(e,t){var n=this;return this.documentCache.getSizedEntry(e,t).next((function(e){return null===e?(n.documentSizes.set(t,0),null):(n.documentSizes.set(t,e.size),e.maybeDocument)}))},t.prototype.getAllFromCache=function(e,t){var n=this;return this.documentCache.getSizedEntries(e,t).next((function(e){var t=e.maybeDocuments;return e.sizeMap.forEach((function(e,t){n.documentSizes.set(e,t)})),t}))},t}(jt),e}();function zt(e){return xn.getStore(e,un.store)}function Wt(e){return xn.getStore(e,sn.store)}function Ht(e){return xn.getStore(e,pn.store)}function Qt(e){return e.path.toArray()}function Kt(e){var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw m("Unknown remote document type");t=e.noDocument}return JSON.stringify(t).length}var Yt=function(){function e(){this.collectionParentIndex=new Jt}return e.prototype.addToCollectionParentIndex=function(e,t){return this.collectionParentIndex.add(t),Be.resolve()},e.prototype.getCollectionParents=function(e,t){return Be.resolve(this.collectionParentIndex.getEntries(t))},e}(),Jt=function(){function e(){this.index={}}return e.prototype.add=function(e){g(e.length%2==1,"Expected a collection path.");var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Se(ae.comparator),o=!r.has(n);return this.index[t]=r.add(n),o},e.prototype.getEntries=function(e){return(this.index[e]||new Se(ae.comparator)).toArray()},e}(),$t=8,Zt=function(){function e(e){this.serializer=e}return e.prototype.createOrUpgrade=function(e,t,n,r){var o=this;g(n<r&&n>=0&&r<=$t,"Unexpected schema upgrade from v"+n+" to v{toVersion}."),n<1&&r>=1&&(function(e){e.createObjectStore(en.store)}(e),function(e){e.createObjectStore(tn.store,{keyPath:tn.keyPath}),e.createObjectStore(nn.store,{keyPath:nn.keyPath,autoIncrement:!0}).createIndex(nn.userMutationsIndex,nn.userMutationsKeyPath,{unique:!0}),e.createObjectStore(rn.store)}(e),dn(e),function(e){e.createObjectStore(sn.store)}(e));var i=Be.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore(ln.store),e.deleteObjectStore(cn.store),e.deleteObjectStore(hn.store)}(e),dn(e)),i=i.next((function(){return function(e){var t=e.store(hn.store),n=new hn(0,0,be.MIN.toTimestamp(),0);return t.put(hn.key,n)}(t)}))),n<4&&r>=4&&(0!==n&&(i=i.next((function(){return function(e,t){return t.store(nn.store).loadAll().next((function(n){e.deleteObjectStore(nn.store),e.createObjectStore(nn.store,{keyPath:nn.keyPath,autoIncrement:!0}).createIndex(nn.userMutationsIndex,nn.userMutationsKeyPath,{unique:!0});var r=t.store(nn.store),o=n.map((function(e){return r.put(e)}));return Be.waitFor(o)}))}(e,t)}))),i=i.next((function(){!function(e){e.createObjectStore(yn.store,{keyPath:yn.keyPath})}(e),function(e){e.createObjectStore(pn.store,{keyPath:"id",autoIncrement:!0})}(e)}))),n<5&&r>=5&&(i=i.next((function(){return o.removeAcknowledgedMutations(t)}))),n<6&&r>=6&&(i=i.next((function(){return function(e){e.createObjectStore(un.store)}(e),o.addDocumentGlobal(t)}))),n<7&&r>=7&&(i=i.next((function(){return o.ensureSequenceNumbers(t)}))),n<8&&r>=8&&(i=i.next((function(){return o.createCollectionParentIndex(e,t)}))),i},e.prototype.addDocumentGlobal=function(e){var t=0;return e.store(sn.store).iterate((function(e,n){t+=Kt(n)})).next((function(){var n=new un(t);return e.store(un.store).put(un.key,n)}))},e.prototype.removeAcknowledgedMutations=function(e){var t=this,n=e.store(tn.store),r=e.store(nn.store);return n.loadAll().next((function(n){return Be.forEach(n,(function(n){var o=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.loadAll(nn.userMutationsIndex,o).next((function(r){return Be.forEach(r,(function(r){g(r.userId===n.userId,"Cannot process batch "+r.batchId+" from unexpected user");var o=t.serializer.fromDbMutationBatch(r);return Ue(e,n.userId,o).next((function(){}))}))}))}))}))},e.prototype.ensureSequenceNumbers=function(e){var t=e.store(ln.store),n=e.store(sn.store);return at(e).next((function(e){var r=[];return n.iterate((function(n,o){var i=new ae(n),a=function(e){return[0,pe(e)]}(i);r.push(t.get(a).next((function(n){return n?Be.resolve():function(n){return t.put(new ln(0,pe(n),e))}(i)})))})).next((function(){return Be.waitFor(r)}))}))},e.prototype.createCollectionParentIndex=function(e,t){e.createObjectStore(fn.store,{keyPath:fn.keyPath});var n=t.store(fn.store),r=new Jt,o=function(e){if(r.add(e)){var t=e.lastSegment(),o=e.popLast();return n.put({collectionId:t,parent:pe(o)})}};return t.store(sn.store).iterate({keysOnly:!0},(function(e,t){var n=new ae(e);return o(n.popLast())})).next((function(){return t.store(rn.store).iterate({keysOnly:!0},(function(e,t){var n=me(e[1]);return o(n.popLast())}))}))},e}(),Xt=function(e,t){this.seconds=e,this.nanoseconds=t},en=function(){function e(e,t,n){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=n}return e.store="owner",e.key="owner",e}(),tn=function(){function e(e,t,n){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=n}return e.store="mutationQueues",e.keyPath="userId",e}(),nn=function(){function e(e,t,n,r,o){this.userId=e,this.batchId=t,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=o}return e.store="mutations",e.keyPath="batchId",e.userMutationsIndex="userMutationsIndex",e.userMutationsKeyPath=["userId","batchId"],e}(),rn=function(){function e(){}return e.prefixForUser=function(e){return[e]},e.prefixForPath=function(e,t){return[e,pe(t)]},e.key=function(e,t,n){return[e,pe(t),n]},e.store="documentMutations",e.PLACEHOLDER=new e,e}(),on=function(e,t){this.path=e,this.readTime=t},an=function(e,t){this.path=e,this.version=t},sn=function(){function e(e,t,n,r){this.unknownDocument=e,this.noDocument=t,this.document=n,this.hasCommittedMutations=r}return e.store="remoteDocuments",e}(),un=function(){function e(e){this.byteSize=e}return e.store="remoteDocumentGlobal",e.key="remoteDocumentGlobalKey",e}(),cn=function(){function e(e,t,n,r,o,i){this.targetId=e,this.canonicalId=t,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=o,this.query=i}return e.store="targets",e.keyPath="targetId",e.queryTargetsIndexName="queryTargetsIndex",e.queryTargetsKeyPath=["canonicalId","targetId"],e}(),ln=function(){function e(e,t,n){this.targetId=e,this.path=t,this.sequenceNumber=n,g(0===e==(void 0!==n),"A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number")}return e.store="targetDocuments",e.keyPath=["targetId","path"],e.documentTargetsIndex="documentTargetsIndex",e.documentTargetsKeyPath=["path","targetId"],e}(),hn=function(){function e(e,t,n,r){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=n,this.targetCount=r}return e.key="targetGlobalKey",e.store="targetGlobal",e}(),fn=function(){function e(e,t){this.collectionId=e,this.parent=t}return e.store="collectionParents",e.keyPath=["collectionId","parent"],e}();function dn(e){e.createObjectStore(ln.store,{keyPath:ln.keyPath}).createIndex(ln.documentTargetsIndex,ln.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(cn.store,{keyPath:cn.keyPath}).createIndex(cn.queryTargetsIndexName,cn.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(hn.store)}var pn=function(){function e(e){this.changes=e}return e.store="remoteDocumentChanges",e.keyPath="id",e}(),yn=function(){function e(e,t,n,r,o){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=n,this.inForeground=r,this.lastProcessedDocumentChangeId=o}return e.store="clientMetadata",e.keyPath="clientId",e}(),vn=[tn.store,nn.store,rn.store,sn.store,cn.store,en.store,hn.store,ln.store].concat([yn.store,pn.store]).concat([un.store]).concat([fn.store]),mn=function(){function e(){this.collectionParentsCache=new Jt}return e.prototype.addToCollectionParentIndex=function(e,t){if(g(t.length%2==1,"Expected a collection path."),this.collectionParentsCache.add(t)){g(t.length>=1,"Invalid collection path.");var n=t.lastSegment(),r=t.popLast();return gn(e).put({collectionId:n,parent:pe(r)})}return Be.resolve()},e.prototype.getCollectionParents=function(e,t){var n=[],r=IDBKeyRange.bound([t,""],[$(t),""],!1,!0);return gn(e).loadAll(r).next((function(e){for(var r=0,o=e;r<o.length;r++){var i=o[r];if(i.collectionId!==t)break;n.push(me(i.parent))}return n}))},e}();function gn(e){return xn.getStore(e,fn.store)}var bn=function(e){return e[e.Listen=0]="Listen",e[e.ExistenceFilterMismatch=1]="ExistenceFilterMismatch",e[e.LimboResolution=2]="LimboResolution",e}({}),_n=function(){function e(e,t,n,r,o,i){void 0===o&&(o=be.MIN),void 0===i&&(i=_()),this.query=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=o,this.resumeToken=i}return e.prototype.withSequenceNumber=function(t){return new e(this.query,this.targetId,this.purpose,t,this.snapshotVersion,this.resumeToken)},e.prototype.withResumeToken=function(t,n){return new e(this.query,this.targetId,this.purpose,this.sequenceNumber,n,t)},e.prototype.isEqual=function(e){return this.targetId===e.targetId&&this.purpose===e.purpose&&this.sequenceNumber===e.sequenceNumber&&this.snapshotVersion.isEqual(e.snapshotVersion)&&this.resumeToken===e.resumeToken&&this.query.isEqual(e.query)},e}(),wn=function(){function e(e){this.remoteSerializer=e}return e.prototype.fromDbRemoteDocument=function(e){if(e.document)return this.remoteSerializer.fromDocument(e.document,!!e.hasCommittedMutations);if(e.noDocument){var t=ce.fromSegments(e.noDocument.path),n=this.fromDbTimestamp(e.noDocument.readTime);return new Vt(t,n,{hasCommittedMutations:!!e.hasCommittedMutations})}return e.unknownDocument?(t=ce.fromSegments(e.unknownDocument.path),n=this.fromDbTimestamp(e.unknownDocument.version),new Bt(t,n)):m("Unexpected DbRemoteDocument")},e.prototype.toDbRemoteDocument=function(e){if(e instanceof Ft){var t=e.proto?e.proto:this.remoteSerializer.toDocument(e);return new sn(null,null,t,o=e.hasCommittedMutations)}if(e instanceof Vt){var n=e.key.path.toArray(),r=this.toDbTimestamp(e.version),o=e.hasCommittedMutations;return new sn(null,new on(n,r),null,o)}return e instanceof Bt?(n=e.key.path.toArray(),r=this.toDbTimestamp(e.version),new sn(new an(n,r),null,null,!0)):m("Unexpected MaybeDocumment")},e.prototype.toDbTimestamp=function(e){var t=e.toTimestamp();return new Xt(t.seconds,t.nanoseconds)},e.prototype.fromDbTimestamp=function(e){var t=new ge(e.seconds,e.nanoseconds);return be.fromTimestamp(t)},e.prototype.toDbMutationBatch=function(e,t){var n=this,r=t.baseMutations.map((function(e){return n.remoteSerializer.toMutation(e)})),o=t.mutations.map((function(e){return n.remoteSerializer.toMutation(e)}));return new nn(e,t.batchId,t.localWriteTime.toMillis(),r,o)},e.prototype.fromDbMutationBatch=function(e){var t=this,n=(e.baseMutations||[]).map((function(e){return t.remoteSerializer.fromMutation(e)})),r=e.mutations.map((function(e){return t.remoteSerializer.fromMutation(e)})),o=ge.fromMillis(e.localWriteTimeMs);return new Fe(e.batchId,o,n,r)},e.prototype.toDbResourcePaths=function(e){var t=[];return e.forEach((function(e){t.push(pe(e.path))})),t},e.prototype.fromDbResourcePaths=function(e){for(var t=Me(),n=0,r=e;n<r.length;n++)t=t.add(new ce(me(r[n])));return t},e.prototype.fromDbTarget=function(e){var t,n=this.fromDbTimestamp(e.readTime);return t=void 0!==e.query.documents?this.remoteSerializer.fromDocumentsTarget(e.query):this.remoteSerializer.fromQueryTarget(e.query),new _n(t,e.targetId,bn.Listen,e.lastListenSequenceNumber,n,e.resumeToken)},e.prototype.toDbTarget=function(e){g(bn.Listen===e.purpose,"Only queries with purpose "+bn.Listen+" may be stored, got "+e.purpose);var t,n,r=this.toDbTimestamp(e.snapshotVersion);return t=e.query.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(e.query):this.remoteSerializer.toQueryTarget(e.query),e.resumeToken instanceof Uint8Array?(g("YES"===process.env.USE_MOCK_PERSISTENCE,"Persisting non-string stream tokens is only supported with mock persistence ."),n=e.resumeToken.toString()):n=e.resumeToken,new cn(e.targetId,e.query.canonicalId(),r,n,e.sequenceNumber,t)},e}();function Cn(e,t){var n=e[1],r=t[1],o=Y(e[0],t[0]);return 0===o?Y(n,r):o}var kn=function(){function e(e){this.maxElements=e,this.buffer=new Se(Cn),this.previousIndex=0}return e.prototype.nextIndex=function(){return++this.previousIndex},e.prototype.addElement=function(e){var t=[e,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(t);else{var n=this.buffer.last();Cn(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}},Object.defineProperty(e.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),e}(),Sn={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},En=function(){function e(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}return e.withCacheSize=function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},e.COLLECTION_DISABLED=-1,e.MINIMUM_CACHE_SIZE_BYTES=1048576,e.DEFAULT=new e(e.DEFAULT_CACHE_SIZE_BYTES=41943040,e.DEFAULT_COLLECTION_PERCENTILE=10,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3),e.DISABLED=new e(e.COLLECTION_DISABLED,0,0),e}(),Tn=function(){function e(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.hasRun=!1,this.gcTask=null}return e.prototype.start=function(){g(null===this.gcTask,"Cannot start an already started LruScheduler"),this.garbageCollector.params.cacheSizeCollectionThreshold!==En.COLLECTION_DISABLED&&this.scheduleGC()},e.prototype.stop=function(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)},Object.defineProperty(e.prototype,"started",{get:function(){return null!==this.gcTask},enumerable:!0,configurable:!0}),e.prototype.scheduleGC=function(){var e=this;g(null===this.gcTask,"Cannot schedule GC while a task is pending");var t=this.hasRun?3e5:6e4;p("LruGarbageCollector","Garbage collection scheduled in "+t+"ms"),this.gcTask=this.asyncQueue.enqueueAfterDelay(he.LruGarbageCollection,t,(function(){return e.gcTask=null,e.hasRun=!0,e.localStore.collectGarbage(e.garbageCollector).then((function(){return e.scheduleGC()})).catch(On)}))},e}(),In=function(){function e(e,t){this.delegate=e,this.params=t}return e.prototype.calculateTargetCount=function(e,t){return this.delegate.getSequenceNumberCount(e).next((function(e){return Math.floor(t/100*e)}))},e.prototype.nthSequenceNumber=function(e,t){var n=this;if(0===t)return Be.resolve(oe.INVALID);var r=new kn(t);return this.delegate.forEachTarget(e,(function(e){return r.addElement(e.sequenceNumber)})).next((function(){return n.delegate.forEachOrphanedDocumentSequenceNumber(e,(function(e){return r.addElement(e)}))})).next((function(){return r.maxValue}))},e.prototype.removeTargets=function(e,t,n){return this.delegate.removeTargets(e,t,n)},e.prototype.removeOrphanedDocuments=function(e,t){return this.delegate.removeOrphanedDocuments(e,t)},e.prototype.collect=function(e,t){var n=this;return this.params.cacheSizeCollectionThreshold===En.COLLECTION_DISABLED?(p("LruGarbageCollector","Garbage collection skipped; disabled"),Be.resolve(Sn)):this.getCacheSize(e).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(p("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),Sn):n.runGarbageCollection(e,t)}))},e.prototype.getCacheSize=function(e){return this.delegate.getCacheSize(e)},e.prototype.runGarbageCollection=function(e,t){var n,r,o,i,a,s,u,c=this,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((function(t){return t>c.params.maximumSequenceNumbersToCollect?(p("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+t),r=c.params.maximumSequenceNumbersToCollect):r=t,i=Date.now(),c.nthSequenceNumber(e,r)})).next((function(r){return n=r,a=Date.now(),c.removeTargets(e,n,t)})).next((function(t){return o=t,s=Date.now(),c.removeOrphanedDocuments(e,n)})).next((function(e){return u=Date.now(),f()<=h.DEBUG&&p("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(i-l)+"ms\n\tDetermined least recently used "+r+" in "+(a-i)+"ms\n\tRemoved "+o+" targets in "+(s-a)+"ms\n\tRemoved "+e+" documents in "+(u-s)+"ms\nTotal Duration: "+(u-l)+"ms"),Be.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:e})}))},e}(),An="IndexedDbPersistence",Dn="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Nn="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",Pn=function(e){function t(t,n){var r=e.call(this)||this;return r.simpleDbTransaction=t,r.currentSequenceNumber=n,r}return a.__extends(t,e),t}((function(){})),xn=function(){function e(t,n,r,o,i,a,s,u){if(this.allowTabSynchronization=t,this.persistenceKey=n,this.clientId=r,this.queue=a,this.sequenceNumberSyncer=u,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=function(e){return Promise.resolve()},this.referenceDelegate=new Ln(this,i),this.dbName=n+e.MAIN_DATABASE,this.serializer=new wn(s),this.document=o.document,this.queryCache=new rt(this.referenceDelegate,this.serializer),this.indexManager=new mn,this.remoteDocumentCache=new Gt(this.serializer,this.indexManager,this.allowTabSynchronization),!o.window||!o.window.localStorage)throw new C(w.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=o.window,this.webStorage=this.window.localStorage}return e.getStore=function(e,t){if(e instanceof Pn)return Je.getStore(e.simpleDbTransaction,t);throw m("IndexedDbPersistence must use instances of IndexedDbTransaction")},e.createIndexedDbPersistence=function(t){return a.__awaiter(this,void 0,void 0,(function(){var n;return a.__generator(this,(function(r){switch(r.label){case 0:if(!e.isAvailable())throw new C(w.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");return[4,(n=new e(t.allowTabSynchronization,t.persistenceKey,t.clientId,t.platform,t.lruParams,t.queue,t.serializer,t.sequenceNumberSyncer)).start()];case 1:return r.sent(),[2,n]}}))}))},e.prototype.start=function(){var e=this;return g(!this.started,"IndexedDbPersistence double-started!"),g(null!==this.window,"Expected 'window' to be defined"),Je.openOrCreate(this.dbName,$t,new Zt(this.serializer)).then((function(t){return e.simpleDb=t,e.updateClientMetadataAndTryBecomePrimary()})).then((function(){return e.attachVisibilityHandler(),e.attachWindowUnloadHook(),e.scheduleClientMetadataAndPrimaryLeaseRefreshes(),e.startRemoteDocumentCache()})).then((function(){return e.simpleDb.runTransaction("readonly",[hn.store],(function(t){return at(t).next((function(t){e.listenSequence=new oe(t,e.sequenceNumberSyncer)}))}))})).then((function(){e._started=!0})).catch((function(t){return e.simpleDb&&e.simpleDb.close(),Promise.reject(t)}))},e.prototype.startRemoteDocumentCache=function(){var e=this;return this.simpleDb.runTransaction("readonly",vn,(function(t){return e.remoteDocumentCache.start(t)}))},e.prototype.setPrimaryStateListener=function(e){var t=this;return this.primaryStateListener=function(n){return a.__awaiter(t,void 0,void 0,(function(){return a.__generator(this,(function(t){return this.started?[2,e(n)]:[2]}))}))},e(this.isPrimary)},e.prototype.setDatabaseDeletedListener=function(e){var t=this;this.simpleDb.setVersionChangeListener((function(n){return a.__awaiter(t,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return null!==n.newVersion?[3,2]:[4,e()];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))},e.prototype.setNetworkEnabled=function(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.queue.enqueueAndForget((function(){return a.__awaiter(t,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return this.started?[4,this.updateClientMetadataAndTryBecomePrimary()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))})))},e.prototype.updateClientMetadataAndTryBecomePrimary=function(){var e=this;return this.simpleDb.runTransaction("readwrite",vn,(function(t){return Rn(t).put(new yn(e.clientId,Date.now(),e.networkEnabled,e.inForeground,e.remoteDocumentCache.lastProcessedDocumentChangeId)).next((function(){if(e.isPrimary)return e.verifyPrimaryLease(t).next((function(t){t||(e.isPrimary=!1,e.queue.enqueueAndForget((function(){return e.primaryStateListener(!1)})))}))})).next((function(){return e.canActAsPrimary(t)})).next((function(n){var r=e.isPrimary;return e.isPrimary=n,r!==e.isPrimary&&e.queue.enqueueAndForget((function(){return e.primaryStateListener(e.isPrimary)})),r&&!e.isPrimary?e.releasePrimaryLeaseIfHeld(t):e.isPrimary?e.acquireOrExtendPrimaryLease(t):void 0}))}))},e.prototype.verifyPrimaryLease=function(e){var t=this;return Mn(e).get(en.key).next((function(e){return Be.resolve(t.isLocalClient(e))}))},e.prototype.removeClientMetadata=function(e){return Rn(e).delete(this.clientId)},e.prototype.maybeGarbageCollectMultiClientState=function(){return a.__awaiter(this,void 0,void 0,(function(){var t,n,r=this;return a.__generator(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.isWithinAge(this.lastGarbageCollectionTime,18e5)?[3,2]:(this.lastGarbageCollectionTime=Date.now(),n=[],[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(o){var i=e.getStore(o,yn.store);return i.loadAll().next((function(e){t=r.filterActiveClients(e,18e5),n=e.filter((function(e){return-1===t.indexOf(e)}))})).next((function(){return Be.forEach(n,(function(e){return i.delete(e.clientId)}))})).next((function(){if((t=t.filter((function(e){return e.clientId!==r.clientId}))).length>0){var e=t.map((function(e){return e.lastProcessedDocumentChangeId||0})),n=Math.min.apply(Math,e);return r.remoteDocumentCache.removeDocumentChangesThroughChangeId(o,n)}}))}))]);case 1:o.sent(),n.forEach((function(e){r.window.localStorage.removeItem(r.zombiedClientLocalStorageKey(e.clientId))})),o.label=2;case 2:return[2]}}))}))},e.prototype.scheduleClientMetadataAndPrimaryLeaseRefreshes=function(){var e=this;this.clientMetadataRefresher=this.queue.enqueueAfterDelay(he.ClientMetadataRefresh,4e3,(function(){return e.updateClientMetadataAndTryBecomePrimary().then((function(){return e.maybeGarbageCollectMultiClientState()})).then((function(){return e.scheduleClientMetadataAndPrimaryLeaseRefreshes()}))}))},e.prototype.isLocalClient=function(e){return!!e&&e.ownerId===this.clientId},e.prototype.canActAsPrimary=function(e){var t=this;return Mn(e).get(en.key).next((function(n){if(null!==n&&t.isWithinAge(n.leaseTimestampMs,5e3)&&!t.isClientZombied(n.ownerId)){if(t.isLocalClient(n)&&t.networkEnabled)return!0;if(!t.isLocalClient(n)){if(!n.allowTabSynchronization)throw new C(w.FAILED_PRECONDITION,Nn);return!1}}return!(!t.networkEnabled||!t.inForeground)||Rn(e).loadAll().next((function(e){return void 0===t.filterActiveClients(e,5e3).find((function(e){return!(t.clientId===e.clientId||!(!t.networkEnabled&&e.networkEnabled||!t.inForeground&&e.inForeground&&t.networkEnabled===e.networkEnabled))}))}))})).next((function(e){return t.isPrimary!==e&&p(An,"Client "+(e?"is":"is not")+" eligible for a primary lease."),e}))},e.prototype.shutdown=function(){return a.__awaiter(this,void 0,void 0,(function(){var e=this;return a.__generator(this,(function(t){switch(t.label){case 0:return this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),[4,this.simpleDb.runTransaction("readwrite",[en.store,yn.store],(function(t){return e.releasePrimaryLeaseIfHeld(t).next((function(){return e.removeClientMetadata(t)}))}))];case 1:return t.sent(),this.simpleDb.close(),this.removeClientZombiedEntry(),[2]}}))}))},e.prototype.filterActiveClients=function(e,t){var n=this;return e.filter((function(e){return n.isWithinAge(e.updateTimeMs,t)&&!n.isClientZombied(e.clientId)}))},e.prototype.getActiveClients=function(){var e=this;return this.simpleDb.runTransaction("readonly",[yn.store],(function(t){return Rn(t).loadAll().next((function(t){return e.filterActiveClients(t,18e5).map((function(e){return e.clientId}))}))}))},e.clearPersistence=function(t){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(n){switch(n.label){case 0:return e.isAvailable()?[4,Je.delete(t+e.MAIN_DATABASE)]:[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))},Object.defineProperty(e.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),e.prototype.getMutationQueue=function(e){return g(this.started,"Cannot initialize MutationQueue before persistence is started."),qe.forUser(e,this.serializer,this.indexManager,this.referenceDelegate)},e.prototype.getQueryCache=function(){return g(this.started,"Cannot initialize QueryCache before persistence is started."),this.queryCache},e.prototype.getRemoteDocumentCache=function(){return g(this.started,"Cannot initialize RemoteDocumentCache before persistence is started."),this.remoteDocumentCache},e.prototype.getIndexManager=function(){return g(this.started,"Cannot initialize IndexManager before persistence is started."),this.indexManager},e.prototype.runTransaction=function(e,t,n){var r=this;return p(An,"Starting transaction:",e),this.simpleDb.runTransaction("readonly"===t?"readonly":"readwrite",vn,(function(o){return"readwrite-primary"===t?r.verifyPrimaryLease(o).next((function(t){if(!t)throw y("Failed to obtain primary lease for action '"+e+"'."),r.isPrimary=!1,r.queue.enqueueAndForget((function(){return r.primaryStateListener(!1)})),new C(w.FAILED_PRECONDITION,Dn);return n(new Pn(o,r.listenSequence.next()))})).next((function(e){return r.acquireOrExtendPrimaryLease(o).next((function(){return e}))})):r.verifyAllowTabSynchronization(o).next((function(){return n(new Pn(o,r.listenSequence.next()))}))}))},e.prototype.verifyAllowTabSynchronization=function(e){var t=this;return Mn(e).get(en.key).next((function(e){if(null!==e&&t.isWithinAge(e.leaseTimestampMs,5e3)&&!t.isClientZombied(e.ownerId)&&!t.isLocalClient(e)&&!e.allowTabSynchronization)throw new C(w.FAILED_PRECONDITION,Nn)}))},e.prototype.acquireOrExtendPrimaryLease=function(e){var t=new en(this.clientId,this.allowTabSynchronization,Date.now());return Mn(e).put(en.key,t)},e.isAvailable=function(){return Je.isAvailable()},e.buildStoragePrefix=function(e){var t=e.databaseId.projectId;return e.databaseId.isDefaultDatabase||(t+="."+e.databaseId.database),"firestore/"+e.persistenceKey+"/"+t+"/"},e.prototype.releasePrimaryLeaseIfHeld=function(e){var t=this,n=Mn(e);return n.get(en.key).next((function(e){return t.isLocalClient(e)?(p(An,"Releasing primary lease."),n.delete(en.key)):Be.resolve()}))},e.prototype.isWithinAge=function(e,t){var n=Date.now();return!(e<n-t||e>n&&(y("Detected an update time that is in the future: "+e+" > "+n),1))},e.prototype.attachVisibilityHandler=function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=function(){e.queue.enqueueAndForget((function(){return e.inForeground="visible"===e.document.visibilityState,e.updateClientMetadataAndTryBecomePrimary()}))},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)},e.prototype.detachVisibilityHandler=function(){this.documentVisibilityHandler&&(g(null!==this.document&&"function"==typeof this.document.addEventListener,"Expected 'document.addEventListener' to be a function"),this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)},e.prototype.attachWindowUnloadHook=function(){var e=this;"function"==typeof this.window.addEventListener&&(this.windowUnloadHandler=function(){e.markClientZombied(),e.queue.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("unload",this.windowUnloadHandler))},e.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(g("function"==typeof this.window.removeEventListener,"Expected 'window.removeEventListener' to be a function"),this.window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},e.prototype.isClientZombied=function(e){try{var t=null!==this.webStorage.getItem(this.zombiedClientLocalStorageKey(e));return p(An,"Client '"+e+"' "+(t?"is":"is not")+" zombied in LocalStorage"),t}catch(n){return y(An,"Failed to get zombied client id.",n),!1}},e.prototype.markClientZombied=function(){try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(e){y("Failed to set zombie client id.",e)}},e.prototype.removeClientZombiedEntry=function(){try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(e){}},e.prototype.zombiedClientLocalStorageKey=function(e){return"firestore_zombie_"+this.persistenceKey+"_"+e},e.MAIN_DATABASE="main",e}();function On(e){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){if(!function(e){return e.code===w.FAILED_PRECONDITION&&e.message===Dn}(e))throw e;return p(An,"Unexpectedly lost primary lease"),[2]}))}))}function Mn(e){return e.store(en.store)}function Rn(e){return e.store(yn.store)}var Ln=function(){function e(e,t){this.db=e,this.inMemoryPins=null,this.garbageCollector=new In(this,t)}return e.prototype.getSequenceNumberCount=function(e){var t=this.orphanedDocmentCount(e);return this.db.getQueryCache().getQueryCount(e).next((function(e){return t.next((function(t){return e+t}))}))},e.prototype.orphanedDocmentCount=function(e){var t=0;return this.forEachOrphanedDocumentSequenceNumber(e,(function(e){t++})).next((function(){return t}))},e.prototype.forEachTarget=function(e,t){return this.db.getQueryCache().forEachTarget(e,t)},e.prototype.forEachOrphanedDocumentSequenceNumber=function(e,t){return this.forEachOrphanedDocument(e,(function(e,n){return t(n)}))},e.prototype.setInMemoryPins=function(e){this.inMemoryPins=e},e.prototype.addReference=function(e,t){return Fn(e,t)},e.prototype.removeReference=function(e,t){return Fn(e,t)},e.prototype.removeTargets=function(e,t,n){return this.db.getQueryCache().removeTargets(e,t,n)},e.prototype.removeMutationReference=function(e,t){return Fn(e,t)},e.prototype.isPinned=function(e,t){return this.inMemoryPins.containsKey(t)?Be.resolve(!0):function(e,t){var n=!1;return He(e).iterateSerial((function(r){return je(e,r,t).next((function(e){return e&&(n=!0),Be.resolve(!e)}))})).next((function(){return n}))}(e,t)},e.prototype.removeOrphanedDocuments=function(e,t){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),o=[],i=0;return this.forEachOrphanedDocument(e,(function(a,s){if(s<=t){var u=n.isPinned(e,a).next((function(t){if(!t)return i++,r.getEntry(e,a).next((function(){return r.removeEntry(a),st(e).delete([0,pe(a.path)])}))}));o.push(u)}})).next((function(){return Be.waitFor(o)})).next((function(){return r.apply(e)})).next((function(){return i}))},e.prototype.removeTarget=function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getQueryCache().updateQueryData(e,n)},e.prototype.updateLimboDocument=function(e,t){return Fn(e,t)},e.prototype.forEachOrphanedDocument=function(e,t){var n,r=st(e),o=oe.INVALID;return r.iterate({index:ln.documentTargetsIndex},(function(e,r){var i=r.path,a=r.sequenceNumber;0===e[0]?(o!==oe.INVALID&&t(new ce(me(n)),o),o=a,n=i):o=oe.INVALID})).next((function(){o!==oe.INVALID&&t(new ce(me(n)),o)}))},e.prototype.getCacheSize=function(e){return this.db.getRemoteDocumentCache().getSize(e)},e}();function Fn(e,t){return st(e).put(function(e,t){return new ln(0,pe(e.path),t)}(t,e.currentSequenceNumber))}var Vn=function(){function e(e,t,n){this.remoteDocumentCache=e,this.mutationQueue=t,this.indexManager=n}return e.prototype.getDocument=function(e,t){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(e,t).next((function(r){return n.getDocumentInternal(e,t,r)}))},e.prototype.getDocumentInternal=function(e,t,n){return this.remoteDocumentCache.getEntry(e,t).next((function(e){for(var r=0,o=n;r<o.length;r++)e=o[r].applyToLocalView(t,e);return e}))},e.prototype.applyLocalMutationsToDocuments=function(e,t,n){var r=Ae();return t.forEach((function(e,t){for(var o=0,i=n;o<i.length;o++)t=i[o].applyToLocalView(e,t);r=r.insert(e,t)})),r},e.prototype.getDocuments=function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.getLocalViewOfDocuments(e,t)}))},e.prototype.getLocalViewOfDocuments=function(e,t){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((function(r){var o=n.applyLocalMutationsToDocuments(e,t,r),i=Ie();return o.forEach((function(e,t){t||(t=new Vt(e,be.forDeletedDoc())),i=i.insert(e,t)})),i}))},e.prototype.getDocumentsMatchingQuery=function(e,t){return t.isDocumentQuery()?this.getDocumentsMatchingDocumentQuery(e,t.path):t.isCollectionGroupQuery()?this.getDocumentsMatchingCollectionGroupQuery(e,t):this.getDocumentsMatchingCollectionQuery(e,t)},e.prototype.getDocumentsMatchingDocumentQuery=function(e,t){return this.getDocument(e,new ce(t)).next((function(e){var t=Ne();return e instanceof Ft&&(t=t.insert(e.key,e)),t}))},e.prototype.getDocumentsMatchingCollectionGroupQuery=function(e,t){var n=this;g(t.path.isEmpty(),"Currently we only support collection group queries at the root.");var r=t.collectionGroup,o=Ne();return this.indexManager.getCollectionParents(e,r).next((function(i){return Be.forEach(i,(function(i){var a=t.asCollectionQueryAtPath(i.child(r));return n.getDocumentsMatchingCollectionQuery(e,a).next((function(e){e.forEach((function(e,t){o=o.insert(e,t)}))}))})).next((function(){return o}))}))},e.prototype.getDocumentsMatchingCollectionQuery=function(e,t){var n,r,o=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(e,t).next((function(r){return n=r,o.mutationQueue.getAllMutationBatchesAffectingQuery(e,t)})).next((function(t){return o.addMissingBaseDocuments(e,r=t,n).next((function(e){n=e;for(var t=0,o=r;t<o.length;t++)for(var i=o[t],a=0,s=i.mutations;a<s.length;a++){var u=s[a],c=u.key,l=n.get(c),h=u.applyToLocalView(l,l,i.localWriteTime);n=h instanceof Ft?n.insert(c,h):n.remove(c)}}))})).next((function(){return n.forEach((function(e,r){t.matches(r)||(n=n.remove(e))})),n}))},e.prototype.addMissingBaseDocuments=function(e,t,n){for(var r=Me(),o=0,i=t;o<i.length;o++)for(var a=0,s=i[o].mutations;a<s.length;a++){var u=s[a];u instanceof yt&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.remoteDocumentCache.getEntries(e,r).next((function(e){return e.forEach((function(e,t){null!==t&&t instanceof Ft&&(c=c.insert(e,t))})),c}))},e}(),Bn=function(){function e(){this.refsByKey=new Se(qn.compareByKey),this.refsByTarget=new Se(qn.compareByTargetId)}return e.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},e.prototype.addReference=function(e,t){var n=new qn(e,t);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)},e.prototype.addReferences=function(e,t){var n=this;e.forEach((function(e){return n.addReference(e,t)}))},e.prototype.removeReference=function(e,t){this.removeRef(new qn(e,t))},e.prototype.removeReferences=function(e,t){var n=this;e.forEach((function(e){return n.removeReference(e,t)}))},e.prototype.removeReferencesForId=function(e){var t=this,n=ce.EMPTY,r=new qn(n,e),o=new qn(n,e+1),i=[];return this.refsByTarget.forEachInRange([r,o],(function(e){t.removeRef(e),i.push(e.key)})),i},e.prototype.removeAllReferences=function(){var e=this;this.refsByKey.forEach((function(t){return e.removeRef(t)}))},e.prototype.removeRef=function(e){this.refsByKey=this.refsByKey.delete(e),this.refsByTarget=this.refsByTarget.delete(e)},e.prototype.referencesForId=function(e){var t=ce.EMPTY,n=new qn(t,e),r=new qn(t,e+1),o=Me();return this.refsByTarget.forEachInRange([n,r],(function(e){o=o.add(e.key)})),o},e.prototype.containsKey=function(e){var t=new qn(e,0),n=this.refsByKey.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)},e}(),qn=function(){function e(e,t){this.key=e,this.targetOrBatchId=t}return e.compareByKey=function(e,t){return ce.comparator(e.key,t.key)||Y(e.targetOrBatchId,t.targetOrBatchId)},e.compareByTargetId=function(e,t){return Y(e.targetOrBatchId,t.targetOrBatchId)||ce.comparator(e.key,t.key)},e}(),jn=function(){function e(e,t){this.persistence=e,this.localViewReferences=new Bn,this.queryDataByTarget={},g(e.started,"LocalStore was passed an unstarted persistence implementation"),this.persistence.referenceDelegate.setInMemoryPins(this.localViewReferences),this.mutationQueue=e.getMutationQueue(t),this.remoteDocuments=e.getRemoteDocumentCache(),this.queryCache=e.getQueryCache(),this.localDocuments=new Vn(this.remoteDocuments,this.mutationQueue,this.persistence.getIndexManager())}return e.prototype.handleUserChange=function(e){var t=this;return this.persistence.runTransaction("Handle user change","readonly",(function(n){var r;return t.mutationQueue.getAllMutationBatches(n).next((function(o){return r=o,t.mutationQueue=t.persistence.getMutationQueue(e),t.localDocuments=new Vn(t.remoteDocuments,t.mutationQueue,t.persistence.getIndexManager()),t.mutationQueue.getAllMutationBatches(n)})).next((function(e){for(var o=[],i=[],a=Me(),s=0,u=r;s<u.length;s++){o.push((d=u[s]).batchId);for(var c=0,l=d.mutations;c<l.length;c++)a=a.add(l[c].key)}for(var h=0,f=e;h<f.length;h++){var d;i.push((d=f[h]).batchId);for(var p=0,y=d.mutations;p<y.length;p++)a=a.add(y[p].key)}return t.localDocuments.getDocuments(n,a).next((function(e){return{affectedDocuments:e,removedBatchIds:o,addedBatchIds:i}}))}))}))},e.prototype.localWrite=function(e){var t=this,n=ge.now(),r=e.reduce((function(e,t){return e.add(t.key)}),Me());return this.persistence.runTransaction("Locally write mutations","readwrite",(function(o){return t.localDocuments.getDocuments(o,r).next((function(r){for(var i=[],a=0,s=e;a<s.length;a++){var u=s[a],c=u.extractBaseValue(r.get(u.key));null!=c&&i.push(new yt(u.key,c,c.fieldMask(),ft.exists(!0)))}return t.mutationQueue.addMutationBatch(o,n,i,e).next((function(e){var t=e.applyToLocalDocumentSet(r);return{batchId:e.batchId,changes:t}}))}))}))},e.prototype.lookupMutationDocuments=function(e){var t=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",(function(n){return t.mutationQueue.lookupMutationKeys(n,e).next((function(e){return e?t.localDocuments.getDocuments(n,e):Be.resolve(null)}))}))},e.prototype.acknowledgeBatch=function(e){var t=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(n){var r=e.batch.keys(),o=t.remoteDocuments.newChangeBuffer();return t.mutationQueue.acknowledgeBatch(n,e.batch,e.streamToken).next((function(){return t.applyWriteToRemoteDocuments(n,e,o)})).next((function(){return o.apply(n)})).next((function(){return t.mutationQueue.performConsistencyCheck(n)})).next((function(){return t.localDocuments.getDocuments(n,r)}))}))},e.prototype.rejectBatch=function(e){var t=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",(function(n){var r;return t.mutationQueue.lookupMutationBatch(n,e).next((function(e){return g(null!==e,"Attempt to reject nonexistent batch!"),r=e.keys(),t.mutationQueue.removeMutationBatch(n,e)})).next((function(){return t.mutationQueue.performConsistencyCheck(n)})).next((function(){return t.localDocuments.getDocuments(n,r)}))}))},e.prototype.getHighestUnacknowledgedBatchId=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e.mutationQueue.getHighestUnacknowledgedBatchId(t)}))},e.prototype.getLastStreamToken=function(){var e=this;return this.persistence.runTransaction("Get last stream token","readonly",(function(t){return e.mutationQueue.getLastStreamToken(t)}))},e.prototype.setLastStreamToken=function(e){var t=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",(function(n){return t.mutationQueue.setLastStreamToken(n,e)}))},e.prototype.getLastRemoteSnapshotVersion=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.queryCache.getLastRemoteSnapshotVersion(t)}))},e.prototype.applyRemoteEvent=function(t){var n=this,r=this.remoteDocuments.newChangeBuffer(),o=t.snapshotVersion;return this.persistence.runTransaction("Apply remote event","readwrite-primary",(function(i){var a=[];T(t.targetChanges,(function(t,r){var s=n.queryDataByTarget[t];if(s){a.push(n.queryCache.removeMatchingKeys(i,r.removedDocuments,t).next((function(){return n.queryCache.addMatchingKeys(i,r.addedDocuments,t)})));var u=r.resumeToken;if(u.length>0){var c=s.withResumeToken(u,o);n.queryDataByTarget[t]=c,e.shouldPersistQueryData(s,c,r)&&a.push(n.queryCache.updateQueryData(i,c))}}}));var s=Ie(),u=Me();if(t.documentUpdates.forEach((function(e,t){u=u.add(e)})),a.push(r.getEntries(i,u).next((function(e){t.documentUpdates.forEach((function(o,u){var c=e.get(o);u instanceof Vt&&u.version.isEqual(be.MIN)?(r.removeEntry(o),s=s.insert(o,u)):null==c||u.version.compareTo(c.version)>0||0===u.version.compareTo(c.version)&&c.hasPendingWrites?(be.MIN.isEqual(t.snapshotVersion)&&y("LocalStore","Cannot add a document when the remote version is zero"),r.addEntry(u),s=s.insert(o,u)):p("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",u.version),t.resolvedLimboDocuments.has(o)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,o))}))}))),!o.isEqual(be.MIN)){var c=n.queryCache.getLastRemoteSnapshotVersion(i).next((function(e){return g(o.compareTo(e)>=0,"Watch stream reverted to previous snapshot?? "+o+" < "+e),n.queryCache.setTargetsMetadata(i,i.currentSequenceNumber,o)}));a.push(c)}return Be.waitFor(a).next((function(){return r.apply(i)})).next((function(){return n.localDocuments.getLocalViewOfDocuments(i,s)}))}))},e.shouldPersistQueryData=function(e,t,n){return g(t.resumeToken.length>0,"Attempted to persist query data with no resume token"),0===e.resumeToken.length||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=this.RESUME_TOKEN_MAX_AGE_MICROS||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0},e.prototype.notifyLocalViewChanges=function(e){var t=this;return this.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(n){return Be.forEach(e,(function(e){return t.localViewReferences.addReferences(e.addedKeys,e.targetId),t.localViewReferences.removeReferences(e.removedKeys,e.targetId),Be.forEach(e.removedKeys,(function(e){return t.persistence.referenceDelegate.removeReference(n,e)}))}))}))},e.prototype.nextMutationBatch=function(e){var t=this;return this.persistence.runTransaction("Get next mutation batch","readonly",(function(n){return void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)}))},e.prototype.readDocument=function(e){var t=this;return this.persistence.runTransaction("read document","readonly",(function(n){return t.localDocuments.getDocument(n,e)}))},e.prototype.allocateQuery=function(e){var t=this;return this.persistence.runTransaction("Allocate query","readwrite",(function(n){var r;return t.queryCache.getQueryData(n,e).next((function(o){return o?(r=o,Be.resolve()):t.queryCache.allocateTargetId(n).next((function(o){return r=new _n(e,o,bn.Listen,n.currentSequenceNumber),t.queryCache.addQueryData(n,r)}))})).next((function(){return g(!t.queryDataByTarget[r.targetId],"Tried to allocate an already allocated query: "+e),t.queryDataByTarget[r.targetId]=r,r}))}))},e.prototype.releaseQuery=function(e,t){var n=this;return this.persistence.runTransaction("Release query",t?"readwrite":"readwrite-primary",(function(r){return n.queryCache.getQueryData(r,e).next((function(o){g(null!=o,"Tried to release nonexistent query: "+e);var i=o.targetId,a=n.queryDataByTarget[i],s=n.localViewReferences.removeReferencesForId(i);return delete n.queryDataByTarget[i],t?Be.resolve():Be.forEach(s,(function(e){return n.persistence.referenceDelegate.removeReference(r,e)})).next((function(){return n.persistence.referenceDelegate.removeTarget(r,a)}))}))}))},e.prototype.executeQuery=function(e){var t=this;return this.persistence.runTransaction("Execute query","readonly",(function(n){return t.localDocuments.getDocumentsMatchingQuery(n,e)}))},e.prototype.remoteDocumentKeys=function(e){var t=this;return this.persistence.runTransaction("Remote document keys","readonly",(function(n){return t.queryCache.getMatchingKeysForTargetId(n,e)}))},e.prototype.getActiveClients=function(){return this.persistence.getActiveClients()},e.prototype.removeCachedMutationBatchMetadata=function(e){this.mutationQueue.removeCachedMutationKeys(e)},e.prototype.setNetworkEnabled=function(e){this.persistence.setNetworkEnabled(e)},e.prototype.applyWriteToRemoteDocuments=function(e,t,n){var r=this,o=t.batch,i=o.keys(),a=Be.resolve();return i.forEach((function(r){a=a.next((function(){return n.getEntry(e,r)})).next((function(e){var i=e,a=t.docVersions.get(r);g(null!==a,"ackVersions should contain every doc in the write."),(!i||i.version.compareTo(a)<0)&&((i=o.applyToRemoteDocument(r,i,t))?n.addEntry(i):g(!e,"Mutation batch "+o+" applied to document "+e+" resulted in null"))}))})),a.next((function(){return r.mutationQueue.removeMutationBatch(e,o)}))},e.prototype.collectGarbage=function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return e.collect(n,t.queryDataByTarget)}))},e.prototype.getQueryForTarget=function(e){var t=this;return this.queryDataByTarget[e]?Promise.resolve(this.queryDataByTarget[e].query):this.persistence.runTransaction("Get query data","readonly",(function(n){return t.queryCache.getQueryDataForTarget(n,e).next((function(e){return e?e.query:null}))}))},e.prototype.getNewDocumentChanges=function(){var e=this;return this.persistence.runTransaction("Get new document changes","readonly",(function(t){return e.remoteDocuments.getNewDocumentChanges(t)}))},e.RESUME_TOKEN_MAX_AGE_MICROS=3e8,e}(),Un=function(){function e(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nextBatchId=1,this.lastStreamToken=_(),this.batchesByDocumentKey=new Se(qn.compareByKey)}return e.prototype.checkEmpty=function(e){return Be.resolve(0===this.mutationQueue.length)},e.prototype.acknowledgeBatch=function(e,t,n){var r=t.batchId,o=this.indexOfExistingBatchId(r,"acknowledged");g(0===o,"Can only acknowledge the first batch in the mutation queue");var i=this.mutationQueue[o];return g(r===i.batchId,"Queue ordering failure: expected batch "+r+", got batch "+i.batchId),this.lastStreamToken=n,Be.resolve()},e.prototype.getLastStreamToken=function(e){return Be.resolve(this.lastStreamToken)},e.prototype.setLastStreamToken=function(e,t){return this.lastStreamToken=t,Be.resolve()},e.prototype.addMutationBatch=function(e,t,n,r){g(0!==r.length,"Mutation batches should not be empty");var o=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&g(this.mutationQueue[this.mutationQueue.length-1].batchId<o,"Mutation batchIDs must be monotonically increasing order");var i=new Fe(o,t,n,r);this.mutationQueue.push(i);for(var a=0,s=r;a<s.length;a++){var u=s[a];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new qn(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast())}return Be.resolve(i)},e.prototype.lookupMutationBatch=function(e,t){return Be.resolve(this.findMutationBatch(t))},e.prototype.lookupMutationKeys=function(e,t){var n=this.findMutationBatch(t);return g(null!=n,"Failed to find local mutation batch."),Be.resolve(n.keys())},e.prototype.getNextMutationBatchAfterBatchId=function(e,t){var n=this.indexOfBatchId(t+1),r=n<0?0:n;return Be.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)},e.prototype.getHighestUnacknowledgedBatchId=function(){return Be.resolve(0===this.mutationQueue.length?-1:this.nextBatchId-1)},e.prototype.getAllMutationBatches=function(e){return Be.resolve(this.mutationQueue.slice())},e.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,t){var n=this,r=new qn(t,0),o=new qn(t,Number.POSITIVE_INFINITY),i=[];return this.batchesByDocumentKey.forEachInRange([r,o],(function(e){g(t.isEqual(e.key),"Should only iterate over a single key's batches");var r=n.findMutationBatch(e.targetOrBatchId);g(null!==r,"Batches in the index must exist in the main table"),i.push(r)})),Be.resolve(i)},e.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,t){var n=this,r=new Se(Y);return t.forEach((function(e){var t=new qn(e,0),o=new qn(e,Number.POSITIVE_INFINITY);n.batchesByDocumentKey.forEachInRange([t,o],(function(t){g(e.isEqual(t.key),"For each key, should only iterate over a single key's batches"),r=r.add(t.targetOrBatchId)}))})),Be.resolve(this.findMutationBatches(r))},e.prototype.getAllMutationBatchesAffectingQuery=function(e,t){g(!t.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var n=t.path,r=n.length+1,o=n;ce.isDocumentKey(o)||(o=o.child(""));var i=new qn(new ce(o),0),a=new Se(Y);return this.batchesByDocumentKey.forEachWhile((function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(a=a.add(e.targetOrBatchId)),!0)}),i),Be.resolve(this.findMutationBatches(a))},e.prototype.findMutationBatches=function(e){var t=this,n=[];return e.forEach((function(e){var r=t.findMutationBatch(e);null!==r&&n.push(r)})),n},e.prototype.removeMutationBatch=function(e,t){var n=this;g(0===this.indexOfExistingBatchId(t.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.mutationQueue.shift();var r=this.batchesByDocumentKey;return Be.forEach(t.mutations,(function(o){var i=new qn(o.key,t.batchId);return r=r.delete(i),n.referenceDelegate.removeMutationReference(e,o.key)})).next((function(){n.batchesByDocumentKey=r}))},e.prototype.removeCachedMutationKeys=function(e){},e.prototype.containsKey=function(e,t){var n=new qn(t,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return Be.resolve(t.isEqual(r&&r.key))},e.prototype.performConsistencyCheck=function(e){return 0===this.mutationQueue.length&&g(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),Be.resolve()},e.prototype.indexOfExistingBatchId=function(e,t){var n=this.indexOfBatchId(e);return g(n>=0&&n<this.mutationQueue.length,"Batches must exist to be "+t),n},e.prototype.indexOfBatchId=function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId},e.prototype.findMutationBatch=function(e){var t=this.indexOfBatchId(e);if(t<0||t>=this.mutationQueue.length)return null;var n=this.mutationQueue[t];return g(n.batchId===e,"If found batch must match"),n},e}(),Gn=function(){function e(e){this.persistence=e,this.queries=new qt((function(e){return e.canonicalId()})),this.lastRemoteSnapshotVersion=be.MIN,this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new Bn,this.targetCount=0,this.targetIdGenerator=Ke.forQueryCache()}return e.prototype.getTargetCount=function(e){return Be.resolve(this.targetCount)},e.prototype.forEachTarget=function(e,t){return this.queries.forEach((function(e,n){return t(n)})),Be.resolve()},e.prototype.getLastRemoteSnapshotVersion=function(e){return Be.resolve(this.lastRemoteSnapshotVersion)},e.prototype.getHighestSequenceNumber=function(e){return Be.resolve(this.highestSequenceNumber)},e.prototype.allocateTargetId=function(e){var t=this.targetIdGenerator.after(this.highestTargetId);return this.highestTargetId=t,Be.resolve(t)},e.prototype.setTargetsMetadata=function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.highestSequenceNumber&&(this.highestSequenceNumber=t),Be.resolve()},e.prototype.saveQueryData=function(e){this.queries.set(e.query,e);var t=e.targetId;t>this.highestTargetId&&(this.highestTargetId=t),e.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=e.sequenceNumber)},e.prototype.addQueryData=function(e,t){return g(!this.queries.has(t.query),"Adding a query that already exists"),this.saveQueryData(t),this.targetCount+=1,Be.resolve()},e.prototype.updateQueryData=function(e,t){return g(this.queries.has(t.query),"Updating a non-existent query"),this.saveQueryData(t),Be.resolve()},e.prototype.removeQueryData=function(e,t){return g(this.targetCount>0,"Removing a target from an empty cache"),g(this.queries.has(t.query),"Removing a non-existent target from the cache"),this.queries.delete(t.query),this.references.removeReferencesForId(t.targetId),this.targetCount-=1,Be.resolve()},e.prototype.removeTargets=function(e,t,n){var r=this,o=0,i=[];return this.queries.forEach((function(a,s){s.sequenceNumber<=t&&!n[s.targetId]&&(r.queries.delete(a),i.push(r.removeMatchingKeysForTargetId(e,s.targetId)),o++)})),Be.waitFor(i).next((function(){return o}))},e.prototype.getQueryCount=function(e){return Be.resolve(this.targetCount)},e.prototype.getQueryData=function(e,t){var n=this.queries.get(t)||null;return Be.resolve(n)},e.prototype.getQueryDataForTarget=function(e,t){return m("Not yet implemented.")},e.prototype.addMatchingKeys=function(e,t,n){this.references.addReferences(t,n);var r=this.persistence.referenceDelegate,o=[];return r&&t.forEach((function(t){o.push(r.addReference(e,t))})),Be.waitFor(o)},e.prototype.removeMatchingKeys=function(e,t,n){this.references.removeReferences(t,n);var r=this.persistence.referenceDelegate,o=[];return r&&t.forEach((function(t){o.push(r.removeReference(e,t))})),Be.waitFor(o)},e.prototype.removeMatchingKeysForTargetId=function(e,t){return this.references.removeReferencesForId(t),Be.resolve()},e.prototype.getMatchingKeysForTargetId=function(e,t){var n=this.references.referencesForId(t);return Be.resolve(n)},e.prototype.containsKey=function(e,t){return Be.resolve(this.references.containsKey(t))},e}(),zn=function(){function e(e,t){this.indexManager=e,this.sizer=t,this.docs=new _e(ce.comparator),this.newDocumentChanges=Me(),this.size=0}return e.prototype.addEntry=function(e,t){var n=t.key,r=this.docs.get(n),o=r?r.size:0,i=this.sizer(t);return this.docs=this.docs.insert(n,{maybeDocument:t,size:i}),this.newDocumentChanges=this.newDocumentChanges.add(n),this.size+=i-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())},e.prototype.removeEntry=function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)},e.prototype.getEntry=function(e,t){var n=this.docs.get(t);return Be.resolve(n?n.maybeDocument:null)},e.prototype.getEntries=function(e,t){var n=this,r=Ae();return t.forEach((function(e){var t=n.docs.get(e);r=r.insert(e,t?t.maybeDocument:null)})),Be.resolve(r)},e.prototype.getDocumentsMatchingQuery=function(e,t){g(!t.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");for(var n=Ne(),r=new ce(t.path.child("")),o=this.docs.getIteratorFrom(r);o.hasNext();){var i=o.getNext(),a=i.value.maybeDocument;if(!t.path.isPrefixOf(i.key.path))break;a instanceof Ft&&t.matches(a)&&(n=n.insert(a.key,a))}return Be.resolve(n)},e.prototype.forEachDocumentKey=function(e,t){return Be.forEach(this.docs,(function(e){return t(e)}))},e.prototype.getNewDocumentChanges=function(e){var t=this,n=Ie();return this.newDocumentChanges.forEach((function(e){var r=t.docs.get(e),o=r?r.maybeDocument:new Vt(e,be.forDeletedDoc());n=n.insert(e,o)})),this.newDocumentChanges=Me(),Be.resolve(n)},e.prototype.newChangeBuffer=function(){return new e.RemoteDocumentChangeBuffer(this)},e.prototype.getSize=function(e){return Be.resolve(this.size)},e.RemoteDocumentChangeBuffer=function(e){function t(t){var n=e.call(this)||this;return n.documentCache=t,n}return a.__extends(t,e),t.prototype.applyChanges=function(e){var t=this,n=[];return this.changes.forEach((function(r,o){o?n.push(t.documentCache.addEntry(e,o)):t.documentCache.removeEntry(r)})),Be.waitFor(n)},t.prototype.getFromCache=function(e,t){return this.documentCache.getEntry(e,t)},t.prototype.getAllFromCache=function(e,t){return this.documentCache.getEntries(e,t)},t}(jt),e}(),Wn=function(){function e(e,t){var n=this;this.clientId=e,this.mutationQueues={},this.listenSequence=new oe(0),this._started=!1,this._started=!0,this.referenceDelegate=t(this),this.queryCache=new Gn(this),this.indexManager=new Yt,this.remoteDocumentCache=new zn(this.indexManager,(function(e){return n.referenceDelegate.documentSize(e)}))}return e.createLruPersistence=function(t,n,r){return new e(t,(function(e){return new Kn(e,new wn(n),r)}))},e.createEagerPersistence=function(t){return new e(t,(function(e){return new Qn(e)}))},e.prototype.shutdown=function(){return this._started=!1,Promise.resolve()},Object.defineProperty(e.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),e.prototype.getActiveClients=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){return[2,[this.clientId]]}))}))},e.prototype.setPrimaryStateListener=function(e){return e(!0)},e.prototype.setDatabaseDeletedListener=function(){},e.prototype.setNetworkEnabled=function(e){},e.prototype.getIndexManager=function(){return this.indexManager},e.prototype.getMutationQueue=function(e){var t=this.mutationQueues[e.toKey()];return t||(t=new Un(this.indexManager,this.referenceDelegate),this.mutationQueues[e.toKey()]=t),t},e.prototype.getQueryCache=function(){return this.queryCache},e.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},e.prototype.runTransaction=function(e,t,n){var r=this;p("MemoryPersistence","Starting transaction:",e);var o=new Hn(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),n(o).next((function(e){return r.referenceDelegate.onTransactionCommitted(o).next((function(){return e}))})).toPromise()},e.prototype.mutationQueuesContainKey=function(e,t){return Be.or((n=this.mutationQueues,r=[],I(n,(function(e,t){return r.push(t)})),r).map((function(n){return function(){return n.containsKey(e,t)}})));var n,r},e}(),Hn=function(e){this.currentSequenceNumber=e},Qn=function(){function e(e){this.persistence=e,this.inMemoryPins=null,this._orphanedDocuments=null}return Object.defineProperty(e.prototype,"orphanedDocuments",{get:function(){if(this._orphanedDocuments)return this._orphanedDocuments;throw m("orphanedDocuments is only valid during a transaction.")},enumerable:!0,configurable:!0}),e.prototype.setInMemoryPins=function(e){this.inMemoryPins=e},e.prototype.addReference=function(e,t){return this.orphanedDocuments.delete(t),Be.resolve()},e.prototype.removeReference=function(e,t){return this.orphanedDocuments.add(t),Be.resolve()},e.prototype.removeMutationReference=function(e,t){return this.orphanedDocuments.add(t),Be.resolve()},e.prototype.removeTarget=function(e,t){var n=this,r=this.persistence.getQueryCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((function(e){e.forEach((function(e){return n.orphanedDocuments.add(e)}))})).next((function(){return r.removeQueryData(e,t)}))},e.prototype.onTransactionStarted=function(){this._orphanedDocuments=new Set},e.prototype.onTransactionCommitted=function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Be.forEach(this.orphanedDocuments,(function(r){return t.isReferenced(e,r).next((function(e){e||n.removeEntry(r)}))})).next((function(){return t._orphanedDocuments=null,n.apply(e)}))},e.prototype.updateLimboDocument=function(e,t){var n=this;return this.isReferenced(e,t).next((function(e){e?n.orphanedDocuments.delete(t):n.orphanedDocuments.add(t)}))},e.prototype.documentSize=function(e){return 0},e.prototype.isReferenced=function(e,t){var n=this;return Be.or([function(){return n.persistence.getQueryCache().containsKey(e,t)},function(){return n.persistence.mutationQueuesContainKey(e,t)},function(){return Be.resolve(n.inMemoryPins.containsKey(t))}])},e}(),Kn=function(){function e(e,t,n){this.persistence=e,this.serializer=t,this.inMemoryPins=null,this.orphanedSequenceNumbers=new qt((function(e){return pe(e.path)})),this.garbageCollector=new In(this,n)}return e.prototype.onTransactionStarted=function(){},e.prototype.onTransactionCommitted=function(e){return Be.resolve()},e.prototype.forEachTarget=function(e,t){return this.persistence.getQueryCache().forEachTarget(e,t)},e.prototype.getSequenceNumberCount=function(e){var t=this.orphanedDocumentCount(e);return this.persistence.getQueryCache().getTargetCount(e).next((function(e){return t.next((function(t){return e+t}))}))},e.prototype.orphanedDocumentCount=function(e){var t=0;return this.forEachOrphanedDocumentSequenceNumber(e,(function(e){t++})).next((function(){return t}))},e.prototype.forEachOrphanedDocumentSequenceNumber=function(e,t){var n=this;return Be.forEach(this.orphanedSequenceNumbers,(function(r,o){return n.isPinned(e,r,o).next((function(e){return e?Be.resolve():t(o)}))}))},e.prototype.setInMemoryPins=function(e){this.inMemoryPins=e},e.prototype.removeTargets=function(e,t,n){return this.persistence.getQueryCache().removeTargets(e,t,n)},e.prototype.removeOrphanedDocuments=function(e,t){var n=this,r=0,o=this.persistence.getRemoteDocumentCache(),i=o.newChangeBuffer();return o.forEachDocumentKey(e,(function(o){return n.isPinned(e,o,t).next((function(e){e||(r++,i.removeEntry(o))}))})).next((function(){return i.apply(e)})).next((function(){return r}))},e.prototype.removeMutationReference=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),Be.resolve()},e.prototype.removeTarget=function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getQueryCache().updateQueryData(e,n)},e.prototype.addReference=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),Be.resolve()},e.prototype.removeReference=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),Be.resolve()},e.prototype.updateLimboDocument=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),Be.resolve()},e.prototype.documentSize=function(e){var t,n=this.serializer.toDbRemoteDocument(e);if(n.document)t=n.document;else if(n.unknownDocument)t=n.unknownDocument;else{if(!n.noDocument)throw m("Unknown remote document type");t=n.noDocument}return JSON.stringify(t).length},e.prototype.isPinned=function(e,t,n){var r=this;return Be.or([function(){return r.persistence.mutationQueuesContainKey(e,t)},function(){return Be.resolve(r.inMemoryPins.containsKey(t))},function(){return r.persistence.getQueryCache().containsKey(e,t)},function(){var e=r.orphanedSequenceNumbers.get(t);return Be.resolve(void 0!==e&&e>n)}])},e.prototype.getCacheSize=function(e){return this.persistence.getRemoteDocumentCache().getSize(e)},e}(),Yn=Number,Jn=Yn.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),$n=Yn.MAX_SAFE_INTEGER||Math.pow(2,53)-1,Zn=Yn.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function Xn(e){return null==e}function er(e){return Zn(e)&&e<=$n&&e>=Jn}var tr=function(){function e(e,t,n,r,o){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===o&&(o=6e4),this.queue=e,this.timerId=t,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=o,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}return e.prototype.reset=function(){this.currentBaseMs=0},e.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},e.prototype.backoffAndRun=function(e){var t=this;this.cancel();var n=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),o=Math.max(0,n-r);this.currentBaseMs>0&&p("ExponentialBackoff","Backing off for "+o+" ms (base delay: "+this.currentBaseMs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,o,(function(){return t.lastAttemptTime=Date.now(),e()})),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},e.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},e.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},e}(),nr=function(e){return e[e.Initial=0]="Initial",e[e.Starting=1]="Starting",e[e.Open=2]="Open",e[e.Error=3]="Error",e[e.Backoff=4]="Backoff",e}({}),rr=function(){function e(e,t,n,r,o,i){this.queue=e,this.idleTimerId=n,this.connection=r,this.credentialsProvider=o,this.listener=i,this.state=nr.Initial,this.closeCount=0,this.idleTimer=null,this.stream=null,this.backoff=new tr(e,t)}return e.prototype.isStarted=function(){return this.state===nr.Starting||this.state===nr.Open||this.state===nr.Backoff},e.prototype.isOpen=function(){return this.state===nr.Open},e.prototype.start=function(){this.state!==nr.Error?(g(this.state===nr.Initial,"Already started"),this.auth()):this.performBackoff()},e.prototype.stop=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return this.isStarted()?[4,this.close(nr.Initial)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},e.prototype.inhibitBackoff=function(){g(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=nr.Initial,this.backoff.reset()},e.prototype.markIdle=function(){var e=this;this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,6e4,(function(){return e.handleIdleCloseTimer()})))},e.prototype.sendRequest=function(e){this.cancelIdleCheck(),this.stream.send(e)},e.prototype.handleIdleCloseTimer=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){return this.isOpen()?[2,this.close(nr.Initial)]:[2]}))}))},e.prototype.cancelIdleCheck=function(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},e.prototype.close=function(e,t){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(n){switch(n.label){case 0:return g(this.isStarted(),"Only started streams should be closed."),g(e===nr.Error||Xn(t),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),this.backoff.cancel(),this.closeCount++,e!==nr.Error?this.backoff.reset():t&&t.code===w.RESOURCE_EXHAUSTED?(y(t.toString()),y("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):t&&t.code===w.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.onClose(t)];case 1:return n.sent(),[2]}}))}))},e.prototype.tearDown=function(){},e.prototype.auth=function(){var e=this;g(this.state===nr.Initial,"Must be in initial state to auth"),this.state=nr.Starting;var t=this.getCloseGuardedDispatcher(this.closeCount),n=this.closeCount;this.credentialsProvider.getToken().then((function(t){e.closeCount===n&&e.startStream(t)}),(function(n){t((function(){var t=new C(w.UNKNOWN,"Fetching auth token failed: "+n.message);return e.handleStreamClose(t)}))}))},e.prototype.startStream=function(e){var t=this;g(this.state===nr.Starting,"Trying to start stream in a non-starting state");var n=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(e),this.stream.onOpen((function(){n((function(){return g(t.state===nr.Starting,"Expected stream to be in state Starting, but was "+t.state),t.state=nr.Open,t.listener.onOpen()}))})),this.stream.onClose((function(e){n((function(){return t.handleStreamClose(e)}))})),this.stream.onMessage((function(e){n((function(){return t.onMessage(e)}))}))},e.prototype.performBackoff=function(){var e=this;g(this.state===nr.Error,"Should only perform backoff when in Error state"),this.state=nr.Backoff,this.backoff.backoffAndRun((function(){return a.__awaiter(e,void 0,void 0,(function(){return a.__generator(this,(function(e){return g(this.state===nr.Backoff,"Backoff elapsed but state is now: "+this.state),this.state=nr.Initial,this.start(),g(this.isStarted(),"PersistentStream should have started"),[2]}))}))}))},e.prototype.handleStreamClose=function(e){return g(this.isStarted(),"Can't handle server close on non-started stream"),p("PersistentStream","close with error: "+e),this.stream=null,this.close(nr.Error,e)},e.prototype.getCloseGuardedDispatcher=function(e){var t=this;return function(n){t.queue.enqueueAndForget((function(){return t.closeCount===e?n():(p("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},e}(),or=function(e){function t(t,n,r,o,i){var a=e.call(this,t,he.ListenStreamConnectionBackoff,he.ListenStreamIdle,n,r,i)||this;return a.serializer=o,a}return a.__extends(t,e),t.prototype.startRpc=function(e){return this.connection.openStream("Listen",e)},t.prototype.onMessage=function(e){this.backoff.reset();var t=this.serializer.fromWatchChange(e),n=this.serializer.versionFromListenResponse(e);return this.listener.onWatchChange(t,n)},t.prototype.watch=function(e){var t={};t.database=this.serializer.encodedDatabaseId,t.addTarget=this.serializer.toTarget(e);var n=this.serializer.toListenRequestLabels(e);n&&(t.labels=n),this.sendRequest(t)},t.prototype.unwatch=function(e){var t={};t.database=this.serializer.encodedDatabaseId,t.removeTarget=e,this.sendRequest(t)},t}(rr),ir=function(e){function t(t,n,r,o,i){var a=e.call(this,t,he.WriteStreamConnectionBackoff,he.WriteStreamIdle,n,r,i)||this;return a.serializer=o,a.handshakeComplete_=!1,a.lastStreamToken=_(),a}return a.__extends(t,e),Object.defineProperty(t.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.handshakeComplete_=!1,e.prototype.start.call(this)},t.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},t.prototype.startRpc=function(e){return this.connection.openStream("Write",e)},t.prototype.onMessage=function(e){if(g(!!e.streamToken,"Got a write response without a stream token"),this.lastStreamToken=e.streamToken,this.handshakeComplete_){this.backoff.reset();var t=this.serializer.fromWriteResults(e.writeResults,e.commitTime),n=this.serializer.fromVersion(e.commitTime);return this.listener.onMutationResult(n,t)}return g(!e.writeResults||0===e.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},t.prototype.writeHandshake=function(){g(this.isOpen(),"Writing handshake requires an opened stream"),g(!this.handshakeComplete_,"Handshake already completed");var e={};e.database=this.serializer.encodedDatabaseId,this.sendRequest(e)},t.prototype.writeMutations=function(e){var t=this;g(this.isOpen(),"Writing mutations requires an opened stream"),g(this.handshakeComplete_,"Handshake must be complete before writing mutations"),g(this.lastStreamToken.length>0,"Trying to write mutation without a token");var n={streamToken:this.lastStreamToken,writes:e.map((function(e){return t.serializer.toMutation(e)}))};this.sendRequest(n)},t}(rr),ar=function(){function e(e,t,n,r){this.queue=e,this.connection=t,this.credentials=n,this.serializer=r}return e.prototype.newPersistentWriteStream=function(e){return new ir(this.queue,this.connection,this.credentials,this.serializer,e)},e.prototype.newPersistentWatchStream=function(e){return new or(this.queue,this.connection,this.credentials,this.serializer,e)},e.prototype.commit=function(e){var t=this,n={database:this.serializer.encodedDatabaseId,writes:e.map((function(e){return t.serializer.toMutation(e)}))};return this.invokeRPC("Commit",n).then((function(e){return t.serializer.fromWriteResults(e.writeResults,e.commitTime)}))},e.prototype.lookup=function(e){var t=this,n={database:this.serializer.encodedDatabaseId,documents:e.map((function(e){return t.serializer.toName(e)}))};return this.invokeStreamingRPC("BatchGetDocuments",n).then((function(n){var r=Ie();n.forEach((function(e){var n=t.serializer.fromMaybeDocument(e);r=r.insert(n.key,n)}));var o=[];return e.forEach((function(e){var t=r.get(e);g(!!t,"Missing entity in write response for "+e),o.push(t)})),o}))},e.prototype.invokeRPC=function(e,t){var n=this;return this.credentials.getToken().then((function(r){return n.connection.invokeRPC(e,t,r)})).catch((function(e){throw e.code===w.UNAUTHENTICATED&&n.credentials.invalidateToken(),e}))},e.prototype.invokeStreamingRPC=function(e,t){var n=this;return this.credentials.getToken().then((function(r){return n.connection.invokeStreamingRPC(e,t,r)})).catch((function(e){throw e.code===w.UNAUTHENTICATED&&n.credentials.invalidateToken(),e}))},e}(),sr=function(){function e(e){this.datastore=e,this.readVersions=xe(),this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return e.prototype.lookup=function(e){return a.__awaiter(this,void 0,void 0,(function(){var t,n=this;return a.__generator(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new C(w.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,this.datastore.lookup(e)];case 1:return(t=r.sent()).forEach((function(e){e instanceof Vt||e instanceof Ft?n.recordVersion(e):m("Document in a transaction was a "+e.constructor.name)})),[2,t]}}))}))},e.prototype.set=function(e,t){this.write(t.toMutations(e,this.precondition(e))),this.writtenDocs.add(e)},e.prototype.update=function(e,t){try{this.write(t.toMutations(e,this.preconditionForUpdate(e)))}catch(n){this.lastWriteError=n}this.writtenDocs.add(e)},e.prototype.delete=function(e){this.write([new mt(e,this.precondition(e))]),this.writtenDocs.add(e)},e.prototype.commit=function(){return a.__awaiter(this,void 0,void 0,(function(){var e;return a.__generator(this,(function(t){switch(t.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;if(e=this.readVersions,this.mutations.forEach((function(t){e=e.remove(t.key)})),!e.isEmpty())throw new C(w.INVALID_ARGUMENT,"Every document read in a transaction must also be written.");return[4,this.datastore.commit(this.mutations)];case 1:return t.sent(),this.committed=!0,[2]}}))}))},e.prototype.recordVersion=function(e){var t;if(e instanceof Ft)t=e.version;else{if(!(e instanceof Vt))throw m("Document in a transaction was a "+e.constructor.name);t=be.forDeletedDoc()}var n=this.readVersions.get(e.key);if(null!==n){if(!t.isEqual(n))throw new C(w.ABORTED,"Document version changed between two reads.")}else this.readVersions=this.readVersions.insert(e.key,t)},e.prototype.precondition=function(e){var t=this.readVersions.get(e);return!this.writtenDocs.has(e)&&t?ft.updateTime(t):ft.NONE},e.prototype.preconditionForUpdate=function(e){var t=this.readVersions.get(e);if(!this.writtenDocs.has(e)&&t){if(t.isEqual(be.forDeletedDoc()))throw new C(w.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ft.updateTime(t)}return ft.exists(!0)},e.prototype.write=function(e){this.ensureCommitNotCalled(),this.mutations=this.mutations.concat(e)},e.prototype.ensureCommitNotCalled=function(){g(!this.committed,"A transaction object cannot be used after its update callback has been invoked.")},e}(),ur=function(e){return e[e.Unknown=0]="Unknown",e[e.Online=1]="Online",e[e.Offline=2]="Offline",e}({}),cr=function(e){return e[e.RemoteStore=0]="RemoteStore",e[e.SharedClientState=1]="SharedClientState",e}({}),lr=function(){function e(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state=ur.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}return e.prototype.handleWatchStreamStart=function(){var e=this;0===this.watchStreamFailures&&(this.setAndBroadcast(ur.Unknown),g(null===this.onlineStateTimer,"onlineStateTimer shouldn't be started yet"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(he.OnlineStateTimeout,1e4,(function(){return e.onlineStateTimer=null,g(e.state===ur.Unknown,"Timer should be canceled if we transitioned to a different state."),e.logClientOfflineWarningIfNecessary("Backend didn't respond within 10 seconds."),e.setAndBroadcast(ur.Offline),Promise.resolve()})))},e.prototype.handleWatchStreamFailure=function(e){this.state===ur.Online?(this.setAndBroadcast(ur.Unknown),g(0===this.watchStreamFailures,"watchStreamFailures must be 0"),g(null===this.onlineStateTimer,"onlineStateTimer must be null")):(this.watchStreamFailures++,this.watchStreamFailures>=1&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary("Connection failed 1 times. Most recent error: "+e.toString()),this.setAndBroadcast(ur.Offline)))},e.prototype.set=function(e){this.clearOnlineStateTimer(),this.watchStreamFailures=0,e===ur.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(e)},e.prototype.setAndBroadcast=function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))},e.prototype.logClientOfflineWarningIfNecessary=function(e){var t="Could not reach Cloud Firestore backend. "+e+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.shouldWarnClientIsOffline?(y(t),this.shouldWarnClientIsOffline=!1):p("OnlineStateTracker",t)},e.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},e}(),hr=function(e){return e[e.OK=0]="OK",e[e.CANCELLED=1]="CANCELLED",e[e.UNKNOWN=2]="UNKNOWN",e[e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",e[e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",e[e.NOT_FOUND=5]="NOT_FOUND",e[e.ALREADY_EXISTS=6]="ALREADY_EXISTS",e[e.PERMISSION_DENIED=7]="PERMISSION_DENIED",e[e.UNAUTHENTICATED=16]="UNAUTHENTICATED",e[e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",e[e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",e[e.ABORTED=10]="ABORTED",e[e.OUT_OF_RANGE=11]="OUT_OF_RANGE",e[e.UNIMPLEMENTED=12]="UNIMPLEMENTED",e[e.INTERNAL=13]="INTERNAL",e[e.UNAVAILABLE=14]="UNAVAILABLE",e[e.DATA_LOSS=15]="DATA_LOSS",e}({});function fr(e){switch(e){case w.OK:return m("Treated status OK as error");case w.CANCELLED:case w.UNKNOWN:case w.DEADLINE_EXCEEDED:case w.RESOURCE_EXHAUSTED:case w.INTERNAL:case w.UNAVAILABLE:case w.UNAUTHENTICATED:return!1;case w.INVALID_ARGUMENT:case w.NOT_FOUND:case w.ALREADY_EXISTS:case w.PERMISSION_DENIED:case w.FAILED_PRECONDITION:case w.ABORTED:case w.OUT_OF_RANGE:case w.UNIMPLEMENTED:case w.DATA_LOSS:return!0;default:return m("Unknown status code: "+e)}}function dr(e){if(void 0===e)return y("GRPC error has no .code"),w.UNKNOWN;switch(e){case hr.OK:return w.OK;case hr.CANCELLED:return w.CANCELLED;case hr.UNKNOWN:return w.UNKNOWN;case hr.DEADLINE_EXCEEDED:return w.DEADLINE_EXCEEDED;case hr.RESOURCE_EXHAUSTED:return w.RESOURCE_EXHAUSTED;case hr.INTERNAL:return w.INTERNAL;case hr.UNAVAILABLE:return w.UNAVAILABLE;case hr.UNAUTHENTICATED:return w.UNAUTHENTICATED;case hr.INVALID_ARGUMENT:return w.INVALID_ARGUMENT;case hr.NOT_FOUND:return w.NOT_FOUND;case hr.ALREADY_EXISTS:return w.ALREADY_EXISTS;case hr.PERMISSION_DENIED:return w.PERMISSION_DENIED;case hr.FAILED_PRECONDITION:return w.FAILED_PRECONDITION;case hr.ABORTED:return w.ABORTED;case hr.OUT_OF_RANGE:return w.OUT_OF_RANGE;case hr.UNIMPLEMENTED:return w.UNIMPLEMENTED;case hr.DATA_LOSS:return w.DATA_LOSS;default:return m("Unknown status code: "+e)}}function pr(e){if(void 0===e)return hr.OK;switch(e){case w.OK:return hr.OK;case w.CANCELLED:return hr.CANCELLED;case w.UNKNOWN:return hr.UNKNOWN;case w.DEADLINE_EXCEEDED:return hr.DEADLINE_EXCEEDED;case w.RESOURCE_EXHAUSTED:return hr.RESOURCE_EXHAUSTED;case w.INTERNAL:return hr.INTERNAL;case w.UNAVAILABLE:return hr.UNAVAILABLE;case w.UNAUTHENTICATED:return hr.UNAUTHENTICATED;case w.INVALID_ARGUMENT:return hr.INVALID_ARGUMENT;case w.NOT_FOUND:return hr.NOT_FOUND;case w.ALREADY_EXISTS:return hr.ALREADY_EXISTS;case w.PERMISSION_DENIED:return hr.PERMISSION_DENIED;case w.FAILED_PRECONDITION:return hr.FAILED_PRECONDITION;case w.ABORTED:return hr.ABORTED;case w.OUT_OF_RANGE:return hr.OUT_OF_RANGE;case w.UNIMPLEMENTED:return hr.UNIMPLEMENTED;case w.DATA_LOSS:return hr.DATA_LOSS;default:return m("Unknown status code: "+e)}}var yr=function(){function e(e){this.comparator=e?function(t,n){return e(t,n)||ce.comparator(t.key,n.key)}:function(e,t){return ce.comparator(e.key,t.key)},this.keyedMap=Ne(),this.sortedSet=new _e(this.comparator)}return e.emptySet=function(t){return new e(t.comparator)},e.prototype.has=function(e){return null!=this.keyedMap.get(e)},e.prototype.get=function(e){return this.keyedMap.get(e)},e.prototype.first=function(){return this.sortedSet.minKey()},e.prototype.last=function(){return this.sortedSet.maxKey()},e.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},e.prototype.indexOf=function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1},Object.defineProperty(e.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),e.prototype.forEach=function(e){this.sortedSet.inorderTraversal((function(t,n){return e(t),!1}))},e.prototype.add=function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))},e.prototype.delete=function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this},e.prototype.isEqual=function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var o=n.getNext().key,i=r.getNext().key;if(!o.isEqual(i))return!1}return!0},e.prototype.toString=function(){var e=[];return this.forEach((function(t){e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},e.prototype.copy=function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r},e}(),vr=function(e){return e[e.Added=0]="Added",e[e.Removed=1]="Removed",e[e.Modified=2]="Modified",e[e.Metadata=3]="Metadata",e}({}),mr=function(e){return e[e.Local=0]="Local",e[e.Synced=1]="Synced",e}({}),gr=function(){function e(){this.changeMap=new _e(ce.comparator)}return e.prototype.track=function(e){var t=e.doc.key,n=this.changeMap.get(t);n?e.type!==vr.Added&&n.type===vr.Metadata?this.changeMap=this.changeMap.insert(t,e):e.type===vr.Metadata&&n.type!==vr.Removed?this.changeMap=this.changeMap.insert(t,{type:n.type,doc:e.doc}):e.type===vr.Modified&&n.type===vr.Modified?this.changeMap=this.changeMap.insert(t,{type:vr.Modified,doc:e.doc}):e.type===vr.Modified&&n.type===vr.Added?this.changeMap=this.changeMap.insert(t,{type:vr.Added,doc:e.doc}):e.type===vr.Removed&&n.type===vr.Added?this.changeMap=this.changeMap.remove(t):e.type===vr.Removed&&n.type===vr.Modified?this.changeMap=this.changeMap.insert(t,{type:vr.Removed,doc:n.doc}):e.type===vr.Added&&n.type===vr.Removed?this.changeMap=this.changeMap.insert(t,{type:vr.Modified,doc:e.doc}):m("unsupported combination of changes: "+JSON.stringify(e)+" after "+JSON.stringify(n)):this.changeMap=this.changeMap.insert(t,e)},e.prototype.getChanges=function(){var e=[];return this.changeMap.inorderTraversal((function(t,n){e.push(n)})),e},e}(),br=function(){function e(e,t,n,r,o,i,a,s){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=o,this.fromCache=i,this.syncStateChanged=a,this.excludesMetadataChanges=s}return e.fromInitialDocuments=function(t,n,r,o){var i=[];return n.forEach((function(e){i.push({type:vr.Added,doc:e})})),new e(t,n,yr.emptySet(n),i,r,o,!0,!1)},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&this.query.isEqual(e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0},e}(),_r=function(){function e(e,t,n,r,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=o}return e.createSynthesizedRemoteEventForCurrentChange=function(t,n){var r,o=((r={})[t]=wr.createSynthesizedTargetChangeForCurrentChange(t,n),r);return new e(be.MIN,o,Le(),Ie(),Me())},e}(),wr=function(){function e(e,t,n,r,o){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=o}return e.createSynthesizedTargetChangeForCurrentChange=function(t,n){return new e(_(),n,Me(),Me(),Me())},e}(),Cr=function(e,t,n,r){this.updatedTargetIds=e,this.removedTargetIds=t,this.key=n,this.newDoc=r},kr=function(e,t){this.targetId=e,this.existenceFilter=t},Sr=function(e){return e[e.NoChange=0]="NoChange",e[e.Added=1]="Added",e[e.Removed=2]="Removed",e[e.Current=3]="Current",e[e.Reset=4]="Reset",e}({}),Er=function(e,t,n,r){void 0===n&&(n=_()),void 0===r&&(r=null),this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r},Tr=function(){function e(){this.pendingResponses=0,this.documentChanges=Dr(),this._resumeToken=_(),this._current=!1,this._hasPendingChanges=!0}return Object.defineProperty(e.prototype,"current",{get:function(){return this._current},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resumeToken",{get:function(){return this._resumeToken},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPending",{get:function(){return 0!==this.pendingResponses},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasPendingChanges",{get:function(){return this._hasPendingChanges},enumerable:!0,configurable:!0}),e.prototype.updateResumeToken=function(e){e.length>0&&(this._hasPendingChanges=!0,this._resumeToken=e)},e.prototype.toTargetChange=function(){var e=Me(),t=Me(),n=Me();return this.documentChanges.forEach((function(r,o){switch(o){case vr.Added:e=e.add(r);break;case vr.Modified:t=t.add(r);break;case vr.Removed:n=n.add(r);break;default:m("Encountered invalid change type: "+o)}})),new wr(this._resumeToken,this._current,e,t,n)},e.prototype.clearPendingChanges=function(){this._hasPendingChanges=!1,this.documentChanges=Dr()},e.prototype.addDocumentChange=function(e,t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(e,t)},e.prototype.removeDocumentChange=function(e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(e)},e.prototype.recordPendingTargetRequest=function(){this.pendingResponses+=1},e.prototype.recordTargetResponse=function(){this.pendingResponses-=1},e.prototype.markCurrent=function(){this._hasPendingChanges=!0,this._current=!0},e}(),Ir=function(){function e(e){this.metadataProvider=e,this.targetStates={},this.pendingDocumentUpdates=Ie(),this.pendingDocumentTargetMapping=Ar(),this.pendingTargetResets=new Se(Y)}return e.prototype.handleDocumentChange=function(e){for(var t=0,n=e.updatedTargetIds;t<n.length;t++){var r=n[t];e.newDoc instanceof Ft?this.addDocumentToTarget(r,e.newDoc):e.newDoc instanceof Vt&&this.removeDocumentFromTarget(r,e.key,e.newDoc)}for(var o=0,i=e.removedTargetIds;o<i.length;o++)this.removeDocumentFromTarget(r=i[o],e.key,e.newDoc)},e.prototype.handleTargetChange=function(e){var t=this;this.forEachTarget(e,(function(n){var r=t.ensureTargetState(n);switch(e.state){case Sr.NoChange:t.isActiveTarget(n)&&r.updateResumeToken(e.resumeToken);break;case Sr.Added:r.recordTargetResponse(),r.isPending||r.clearPendingChanges(),r.updateResumeToken(e.resumeToken);break;case Sr.Removed:r.recordTargetResponse(),r.isPending||t.removeTarget(n),g(!e.cause,"WatchChangeAggregator does not handle errored targets");break;case Sr.Current:t.isActiveTarget(n)&&(r.markCurrent(),r.updateResumeToken(e.resumeToken));break;case Sr.Reset:t.isActiveTarget(n)&&(t.resetTarget(n),r.updateResumeToken(e.resumeToken));break;default:m("Unknown target watch change state: "+e.state)}}))},e.prototype.forEachTarget=function(e,t){e.targetIds.length>0?e.targetIds.forEach(t):T(this.targetStates,t)},e.prototype.handleExistenceFilter=function(e){var t=e.targetId,n=e.existenceFilter.count,r=this.queryDataForActiveTarget(t);if(r){var o=r.query;if(o.isDocumentQuery())if(0===n){var i=new ce(o.path);this.removeDocumentFromTarget(t,i,new Vt(i,be.forDeletedDoc()))}else g(1===n,"Single document existence filter with count: "+n);else this.getCurrentDocumentCountForTarget(t)!==n&&(this.resetTarget(t),this.pendingTargetResets=this.pendingTargetResets.add(t))}},e.prototype.createRemoteEvent=function(e){var t=this,n={};T(this.targetStates,(function(r,o){var i=t.queryDataForActiveTarget(r);if(i){if(o.current&&i.query.isDocumentQuery()){var a=new ce(i.query.path);null!==t.pendingDocumentUpdates.get(a)||t.targetContainsDocument(r,a)||t.removeDocumentFromTarget(r,a,new Vt(a,e))}o.hasPendingChanges&&(n[r]=o.toTargetChange(),o.clearPendingChanges())}}));var r=Me();this.pendingDocumentTargetMapping.forEach((function(e,n){var o=!0;n.forEachWhile((function(e){var n=t.queryDataForActiveTarget(e);return!n||n.purpose===bn.LimboResolution||(o=!1,!1)})),o&&(r=r.add(e))}));var o=new _r(e,n,this.pendingTargetResets,this.pendingDocumentUpdates,r);return this.pendingDocumentUpdates=Ie(),this.pendingDocumentTargetMapping=Ar(),this.pendingTargetResets=new Se(Y),o},e.prototype.addDocumentToTarget=function(e,t){if(this.isActiveTarget(e)){var n=this.targetContainsDocument(e,t.key)?vr.Modified:vr.Added;this.ensureTargetState(e).addDocumentChange(t.key,n),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t.key,t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t.key,this.ensureDocumentTargetMapping(t.key).add(e))}},e.prototype.removeDocumentFromTarget=function(e,t,n){if(this.isActiveTarget(e)){var r=this.ensureTargetState(e);this.targetContainsDocument(e,t)?r.addDocumentChange(t,vr.Removed):r.removeDocumentChange(t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,this.ensureDocumentTargetMapping(t).delete(e)),n&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t,n))}},e.prototype.removeTarget=function(e){delete this.targetStates[e]},e.prototype.getCurrentDocumentCountForTarget=function(e){var t=this.ensureTargetState(e).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size},e.prototype.recordPendingTargetRequest=function(e){this.ensureTargetState(e).recordPendingTargetRequest()},e.prototype.ensureTargetState=function(e){return this.targetStates[e]||(this.targetStates[e]=new Tr),this.targetStates[e]},e.prototype.ensureDocumentTargetMapping=function(e){var t=this.pendingDocumentTargetMapping.get(e);return t||(t=new Se(Y),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,t)),t},e.prototype.isActiveTarget=function(e){var t=null!==this.queryDataForActiveTarget(e);return t||p("WatchChangeAggregator","Detected inactive target",e),t},e.prototype.queryDataForActiveTarget=function(e){var t=this.targetStates[e];return t&&t.isPending?null:this.metadataProvider.getQueryDataForTarget(e)},e.prototype.resetTarget=function(e){var t=this;g(!this.targetStates[e].isPending,"Should only reset active targets"),this.targetStates[e]=new Tr,this.metadataProvider.getRemoteKeysForTarget(e).forEach((function(n){t.removeDocumentFromTarget(e,n,null)}))},e.prototype.targetContainsDocument=function(e,t){return this.metadataProvider.getRemoteKeysForTarget(e).has(t)},e}();function Ar(){return new _e(ce.comparator)}function Dr(){return new _e(ce.comparator)}var Nr=function(){function e(e,t,n,r,o){var i=this;this.localStore=e,this.datastore=t,this.writePipeline=[],this.listenTargets={},this.watchChangeAggregator=null,this.networkEnabled=!1,this.isPrimary=!1,this.connectivityMonitor=o,this.connectivityMonitor.addCallback((function(e){n.enqueueAndForget((function(){return a.__awaiter(i,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return this.canUseNetwork()?(p("RemoteStore","Restarting streams for network reachability change."),[4,this.restartNetwork()]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))})),this.onlineStateTracker=new lr(n,r),this.watchStream=this.datastore.newPersistentWatchStream({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.writeStream=this.datastore.newPersistentWriteStream({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})}return e.prototype.start=function(){return this.enableNetwork()},e.prototype.enableNetwork=function(){return a.__awaiter(this,void 0,void 0,(function(){var e;return a.__generator(this,(function(t){switch(t.label){case 0:return this.networkEnabled=!0,this.canUseNetwork()?(e=this.writeStream,[4,this.localStore.getLastStreamToken()]):[3,3];case 1:return e.lastStreamToken=t.sent(),this.shouldStartWatchStream()?this.startWatchStream():this.onlineStateTracker.set(ur.Unknown),[4,this.fillWritePipeline()];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},e.prototype.disableNetwork=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return e.sent(),this.onlineStateTracker.set(ur.Offline),[2]}}))}))},e.prototype.disableNetworkInternal=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return[4,this.writeStream.stop()];case 1:return e.sent(),[4,this.watchStream.stop()];case 2:return e.sent(),this.writePipeline.length>0&&(p("RemoteStore","Stopping write stream with "+this.writePipeline.length+" pending writes"),this.writePipeline=[]),this.cleanUpWatchStreamState(),[2]}}))}))},e.prototype.shutdown=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return p("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return e.sent(),this.connectivityMonitor.shutdown(),this.onlineStateTracker.set(ur.Unknown),[2]}}))}))},e.prototype.listen=function(e){g(!S(this.listenTargets,e.targetId),"listen called with duplicate targetId!"),this.listenTargets[e.targetId]=e,this.shouldStartWatchStream()?this.startWatchStream():this.watchStream.isOpen()&&this.sendWatchRequest(e)},e.prototype.unlisten=function(e){g(S(this.listenTargets,e),"unlisten called without assigned target ID!"),delete this.listenTargets[e],this.watchStream.isOpen()&&this.sendUnwatchRequest(e),A(this.listenTargets)&&(this.watchStream.isOpen()?this.watchStream.markIdle():this.canUseNetwork()&&this.onlineStateTracker.set(ur.Unknown))},e.prototype.getQueryDataForTarget=function(e){return this.listenTargets[e]||null},e.prototype.getRemoteKeysForTarget=function(e){return this.syncEngine.getRemoteKeysForTarget(e)},e.prototype.sendWatchRequest=function(e){this.watchChangeAggregator.recordPendingTargetRequest(e.targetId),this.watchStream.watch(e)},e.prototype.sendUnwatchRequest=function(e){this.watchChangeAggregator.recordPendingTargetRequest(e),this.watchStream.unwatch(e)},e.prototype.startWatchStream=function(){g(this.shouldStartWatchStream(),"startWatchStream() called when shouldStartWatchStream() is false."),this.watchChangeAggregator=new Ir(this),this.watchStream.start(),this.onlineStateTracker.handleWatchStreamStart()},e.prototype.shouldStartWatchStream=function(){return this.canUseNetwork()&&!this.watchStream.isStarted()&&!A(this.listenTargets)},e.prototype.canUseNetwork=function(){return this.isPrimary&&this.networkEnabled},e.prototype.cleanUpWatchStreamState=function(){this.watchChangeAggregator=null},e.prototype.onWatchStreamOpen=function(){return a.__awaiter(this,void 0,void 0,(function(){var e=this;return a.__generator(this,(function(t){return T(this.listenTargets,(function(t,n){e.sendWatchRequest(n)})),[2]}))}))},e.prototype.onWatchStreamClose=function(e){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){return void 0===e&&g(!this.shouldStartWatchStream(),"Watch stream was stopped gracefully while still needed."),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.onlineStateTracker.handleWatchStreamFailure(e),this.startWatchStream()):this.onlineStateTracker.set(ur.Unknown),[2]}))}))},e.prototype.onWatchStreamChange=function(e,t){return a.__awaiter(this,void 0,void 0,(function(){var n;return a.__generator(this,(function(r){switch(r.label){case 0:return this.onlineStateTracker.set(ur.Online),e instanceof Er&&e.state===Sr.Removed&&e.cause?[2,this.handleTargetError(e)]:(e instanceof Cr?this.watchChangeAggregator.handleDocumentChange(e):e instanceof kr?this.watchChangeAggregator.handleExistenceFilter(e):(g(e instanceof Er,"Expected watchChange to be an instance of WatchTargetChange"),this.watchChangeAggregator.handleTargetChange(e)),t.isEqual(be.MIN)?[3,3]:[4,this.localStore.getLastRemoteSnapshotVersion()]);case 1:return n=r.sent(),t.compareTo(n)>=0?[4,this.raiseWatchSnapshot(t)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},e.prototype.raiseWatchSnapshot=function(e){var t=this;g(!e.isEqual(be.MIN),"Can't raise event for unknown SnapshotVersion");var n=this.watchChangeAggregator.createRemoteEvent(e);return T(n.targetChanges,(function(n,r){if(r.resumeToken.length>0){var o=t.listenTargets[n];o&&(t.listenTargets[n]=o.withResumeToken(r.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.listenTargets[e];if(n){t.listenTargets[e]=n.withResumeToken(_(),n.snapshotVersion),t.sendUnwatchRequest(e);var r=new _n(n.query,e,bn.ExistenceFilterMismatch,n.sequenceNumber);t.sendWatchRequest(r)}})),this.syncEngine.applyRemoteEvent(n)},e.prototype.handleTargetError=function(e){var t=this;g(!!e.cause,"Handling target error without a cause");var n=e.cause,r=Promise.resolve();return e.targetIds.forEach((function(e){r=r.then((function(){return a.__awaiter(t,void 0,void 0,(function(){return a.__generator(this,(function(t){return S(this.listenTargets,e)?(delete this.listenTargets[e],this.watchChangeAggregator.removeTarget(e),[2,this.syncEngine.rejectListen(e,n)]):[2]}))}))}))})),r},e.prototype.fillWritePipeline=function(){return a.__awaiter(this,void 0,void 0,(function(){var e;return a.__generator(this,(function(t){switch(t.label){case 0:return this.canAddToWritePipeline()?[4,this.localStore.nextMutationBatch(this.writePipeline.length>0?this.writePipeline[this.writePipeline.length-1].batchId:-1)]:[3,4];case 1:return null!==(e=t.sent())?[3,2]:(0===this.writePipeline.length&&this.writeStream.markIdle(),[3,4]);case 2:return this.addToWritePipeline(e),[4,this.fillWritePipeline()];case 3:t.sent(),t.label=4;case 4:return this.shouldStartWriteStream()&&this.startWriteStream(),[2]}}))}))},e.prototype.canAddToWritePipeline=function(){return this.canUseNetwork()&&this.writePipeline.length<10},e.prototype.outstandingWrites=function(){return this.writePipeline.length},e.prototype.addToWritePipeline=function(e){g(this.canAddToWritePipeline(),"addToWritePipeline called when pipeline is full"),this.writePipeline.push(e),this.writeStream.isOpen()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(e.mutations)},e.prototype.shouldStartWriteStream=function(){return this.canUseNetwork()&&!this.writeStream.isStarted()&&this.writePipeline.length>0},e.prototype.startWriteStream=function(){g(this.shouldStartWriteStream(),"startWriteStream() called when shouldStartWriteStream() is false."),this.writeStream.start()},e.prototype.onWriteStreamOpen=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){return this.writeStream.writeHandshake(),[2]}))}))},e.prototype.onWriteHandshakeComplete=function(){var e=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then((function(){for(var t=0,n=e.writePipeline;t<n.length;t++)e.writeStream.writeMutations(n[t].mutations)})).catch(On)},e.prototype.onMutationResult=function(e,t){var n=this;g(this.writePipeline.length>0,"Got result for empty write pipeline");var r=this.writePipeline.shift(),o=Ve.from(r,e,t,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(o).then((function(){return n.fillWritePipeline()}))},e.prototype.onWriteStreamClose=function(e){return a.__awaiter(this,void 0,void 0,(function(){var t=this;return a.__generator(this,(function(n){return void 0===e&&g(!this.shouldStartWriteStream(),"Write stream was stopped gracefully while still needed."),e&&this.writePipeline.length>0?[2,(this.writeStream.handshakeComplete?this.handleWriteError(e):this.handleHandshakeError(e)).then((function(){t.shouldStartWriteStream()&&t.startWriteStream()}))]:[2]}))}))},e.prototype.handleHandshakeError=function(e){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){return fr(e.code)?(p("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=_(),[2,this.localStore.setLastStreamToken(_()).catch(On)]):[2]}))}))},e.prototype.handleWriteError=function(e){return a.__awaiter(this,void 0,void 0,(function(){var t,n=this;return a.__generator(this,(function(r){return fr(o=e.code)&&o!==w.ABORTED?(t=this.writePipeline.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(t.batchId,e).then((function(){return n.fillWritePipeline()}))]):[2];var o}))}))},e.prototype.createTransaction=function(){return new sr(this.datastore)},e.prototype.restartNetwork=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return e.sent(),this.onlineStateTracker.set(ur.Unknown),[4,this.enableNetwork()];case 2:return e.sent(),[2]}}))}))},e.prototype.handleCredentialChange=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return this.canUseNetwork()?(p("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.restartNetwork()]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},e.prototype.applyPrimaryState=function(e){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return this.isPrimary=e,e&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,4];case 2:return e?[3,4]:[4,this.disableNetworkInternal()];case 3:t.sent(),this.onlineStateTracker.set(ur.Unknown),t.label=4;case 4:return[2]}}))}))},e}(),Pr=function(){function e(e,t){if(N("GeoPoint",arguments,2),M("GeoPoint","number",1,e),M("GeoPoint","number",2,t),!isFinite(e)||e<-90||e>90)throw new C(w.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new C(w.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}return Object.defineProperty(e.prototype,"latitude",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"longitude",{get:function(){return this._long},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(e){return this._lat===e._lat&&this._long===e._long},e.prototype._compareTo=function(e){return Y(this._lat,e._lat)||Y(this._long,e._long)},e}(),xr=function(){function e(e,t,n,r,o,i,a){void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===o&&(o=null),void 0===i&&(i=null),void 0===a&&(a=null),this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=o,this.startAt=i,this.endAt=a,this.memoizedCanonicalId=null,this.memoizedOrderBy=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return e.atPath=function(t){return new e(t)},Object.defineProperty(e.prototype,"orderBy",{get:function(){if(null===this.memoizedOrderBy){var e=this.getInequalityFilterField(),t=this.getFirstOrderByField();if(null!==e&&null===t)this.memoizedOrderBy=e.isKeyField()?[zr]:[new Gr(e),zr];else{g(null===e||null!==t&&e.isEqual(t),"First orderBy should match inequality field."),this.memoizedOrderBy=[];for(var n=!1,r=0,o=this.explicitOrderBy;r<o.length;r++){var i=o[r];this.memoizedOrderBy.push(i),i.field.isKeyField()&&(n=!0)}n||this.memoizedOrderBy.push((this.explicitOrderBy.length>0?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:jr.ASCENDING)===jr.ASCENDING?zr:Wr)}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),e.prototype.addFilter=function(t){g(null==this.getInequalityFilterField()||!(t instanceof Rr)||!t.isInequality()||t.field.isEqual(this.getInequalityFilterField()),"Query must only have one inequality field."),g(!this.isDocumentQuery(),"No filtering allowed for document query");var n=this.filters.concat([t]);return new e(this.path,this.collectionGroup,this.explicitOrderBy.slice(),n,this.limit,this.startAt,this.endAt)},e.prototype.addOrderBy=function(t){g(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var n=this.explicitOrderBy.concat([t]);return new e(this.path,this.collectionGroup,n,this.filters.slice(),this.limit,this.startAt,this.endAt)},e.prototype.withLimit=function(t){return new e(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),t,this.startAt,this.endAt)},e.prototype.withStartAt=function(t){return new e(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,t,this.endAt)},e.prototype.withEndAt=function(t){return new e(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,t)},e.prototype.asCollectionQueryAtPath=function(t){return new e(t,null,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,this.endAt)},e.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var e=this.path.canonicalString();this.isCollectionGroupQuery()&&(e+="|cg:"+this.collectionGroup),e+="|f:";for(var t=0,n=this.filters;t<n.length;t++)e+=n[t].canonicalId(),e+=",";e+="|ob:";for(var r=0,o=this.orderBy;r<o.length;r++)e+=o[r].canonicalId(),e+=",";Xn(this.limit)||(e+="|l:",e+=this.limit),this.startAt&&(e+="|lb:",e+=this.startAt.canonicalId()),this.endAt&&(e+="|ub:",e+=this.endAt.canonicalId()),this.memoizedCanonicalId=e}return this.memoizedCanonicalId},e.prototype.toString=function(){var e="Query("+this.path.canonicalString();return this.isCollectionGroupQuery()&&(e+=" collectionGroup="+this.collectionGroup),this.filters.length>0&&(e+=", filters: ["+this.filters.join(", ")+"]"),Xn(this.limit)||(e+=", limit: "+this.limit),this.explicitOrderBy.length>0&&(e+=", orderBy: ["+this.explicitOrderBy.join(", ")+"]"),this.startAt&&(e+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(e+=", endAt: "+this.endAt.canonicalId()),e+")"},e.prototype.isEqual=function(e){if(this.limit!==e.limit)return!1;if(this.orderBy.length!==e.orderBy.length)return!1;for(var t=0;t<this.orderBy.length;t++)if(!this.orderBy[t].isEqual(e.orderBy[t]))return!1;if(this.filters.length!==e.filters.length)return!1;for(t=0;t<this.filters.length;t++)if(!this.filters[t].isEqual(e.filters[t]))return!1;return this.collectionGroup===e.collectionGroup&&!!this.path.isEqual(e.path)&&!(null!==this.startAt?!this.startAt.isEqual(e.startAt):null!==e.startAt)&&(null!==this.endAt?this.endAt.isEqual(e.endAt):null===e.endAt)},e.prototype.docComparator=function(e,t){for(var n=!1,r=0,o=this.orderBy;r<o.length;r++){var i=o[r],a=i.compare(e,t);if(0!==a)return a;n=n||i.field.isKeyField()}return g(n,"orderBy used that doesn't compare on key field"),0},e.prototype.matches=function(e){return this.matchesPathAndCollectionGroup(e)&&this.matchesOrderBy(e)&&this.matchesFilters(e)&&this.matchesBounds(e)},e.prototype.hasLimit=function(){return!Xn(this.limit)},e.prototype.getFirstOrderByField=function(){return this.explicitOrderBy.length>0?this.explicitOrderBy[0].field:null},e.prototype.getInequalityFilterField=function(){for(var e=0,t=this.filters;e<t.length;e++){var n=t[e];if(n instanceof Rr&&n.isInequality())return n.field}return null},e.prototype.findFilterOperator=function(e){for(var t=0,n=this.filters;t<n.length;t++){var r=n[t];if(r instanceof Rr&&e.indexOf(r.op)>=0)return r.op}return null},e.prototype.isDocumentQuery=function(){return ce.isDocumentKey(this.path)&&null===this.collectionGroup&&0===this.filters.length},e.prototype.isCollectionGroupQuery=function(){return null!==this.collectionGroup},e.prototype.matchesPathAndCollectionGroup=function(e){var t=e.key.path;return null!==this.collectionGroup?e.key.hasCollectionId(this.collectionGroup)&&this.path.isPrefixOf(t):ce.isDocumentKey(this.path)?this.path.isEqual(t):this.path.isImmediateParentOf(t)},e.prototype.matchesOrderBy=function(e){for(var t=0,n=this.explicitOrderBy;t<n.length;t++){var r=n[t];if(!r.field.isKeyField()&&null===e.field(r.field))return!1}return!0},e.prototype.matchesFilters=function(e){for(var t=0,n=this.filters;t<n.length;t++)if(!n[t].matches(e))return!1;return!0},e.prototype.matchesBounds=function(e){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,e)||this.endAt&&this.endAt.sortsBeforeDocument(this.orderBy,e))},e.prototype.assertValidBound=function(e){g(e.position.length<=this.orderBy.length,"Bound is longer than orderBy")},e}(),Or=function(){},Mr=function(){function e(e){this.name=e}return e.fromString=function(t){switch(t){case"<":return e.LESS_THAN;case"<=":return e.LESS_THAN_OR_EQUAL;case"==":return e.EQUAL;case">=":return e.GREATER_THAN_OR_EQUAL;case">":return e.GREATER_THAN;case"array-contains":return e.ARRAY_CONTAINS;case"in":return e.IN;case"array-contains-any":return e.ARRAY_CONTAINS_ANY;default:return m("Unknown FieldFilter operator: "+t)}},e.prototype.toString=function(){return this.name},e.prototype.isEqual=function(e){return this.name===e.name},e.LESS_THAN=new e("<"),e.LESS_THAN_OR_EQUAL=new e("<="),e.EQUAL=new e("=="),e.GREATER_THAN=new e(">"),e.GREATER_THAN_OR_EQUAL=new e(">="),e.ARRAY_CONTAINS=new e("array-contains"),e.IN=new e("in"),e.ARRAY_CONTAINS_ANY=new e("array-contains-any"),e}(),Rr=function(e){function t(t,n,r){var o=e.call(this)||this;return o.field=t,o.op=n,o.value=r,o}return a.__extends(t,e),t.create=function(e,n,r){if(e.isKeyField())return n===Mr.IN?(g(r instanceof Rt,"Comparing on key with IN, but filter value not an ArrayValue"),g(r.internalValue.every((function(e){return e instanceof xt})),"Comparing on key with IN, but an array value was not a RefValue"),new Fr(e,r)):(g(r instanceof xt,"Comparing on key, but filter value not a RefValue"),g(n!==Mr.ARRAY_CONTAINS&&n!==Mr.ARRAY_CONTAINS_ANY,"'"+n.toString()+"' queries don't make sense on document keys."),new Lr(e,n,r));if(r.isEqual(Ct.INSTANCE)){if(n!==Mr.EQUAL)throw new C(w.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new t(e,n,r)}if(r.isEqual(It.NAN)){if(n!==Mr.EQUAL)throw new C(w.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new t(e,n,r)}return n===Mr.ARRAY_CONTAINS?new Vr(e,r):n===Mr.IN?(g(r instanceof Rt,"IN filter has invalid value: "+r.toString()),new Br(e,r)):n===Mr.ARRAY_CONTAINS_ANY?(g(r instanceof Rt,"ARRAY_CONTAINS_ANY filter has invalid value: "+r.toString()),new qr(e,r)):new t(e,n,r)},t.prototype.matches=function(e){var t=e.field(this.field);return null!==t&&this.value.typeOrder===t.typeOrder&&this.matchesComparison(t.compareTo(this.value))},t.prototype.matchesComparison=function(e){switch(this.op){case Mr.LESS_THAN:return e<0;case Mr.LESS_THAN_OR_EQUAL:return e<=0;case Mr.EQUAL:return 0===e;case Mr.GREATER_THAN:return e>0;case Mr.GREATER_THAN_OR_EQUAL:return e>=0;default:return m("Unknown FieldFilter operator: "+this.op)}},t.prototype.isInequality=function(){return[Mr.LESS_THAN,Mr.LESS_THAN_OR_EQUAL,Mr.GREATER_THAN,Mr.GREATER_THAN_OR_EQUAL].indexOf(this.op)>=0},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},t.prototype.isEqual=function(e){return e instanceof t&&this.op.isEqual(e.op)&&this.field.isEqual(e.field)&&this.value.isEqual(e.value)},t.prototype.toString=function(){return this.field.canonicalString()+" "+this.op+" "+this.value.value()},t}(Or),Lr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.matches=function(e){var t=ce.comparator(e.key,this.value.key);return this.matchesComparison(t)},t}(Rr),Fr=function(e){function t(t,n){var r=e.call(this,t,Mr.IN,n)||this;return r.value=n,r}return a.__extends(t,e),t.prototype.matches=function(e){return this.value.internalValue.some((function(t){return e.key.isEqual(t.key)}))},t}(Rr),Vr=function(e){function t(t,n){return e.call(this,t,Mr.ARRAY_CONTAINS,n)||this}return a.__extends(t,e),t.prototype.matches=function(e){var t=e.field(this.field);return t instanceof Rt&&t.contains(this.value)},t}(Rr),Br=function(e){function t(t,n){var r=e.call(this,t,Mr.IN,n)||this;return r.value=n,r}return a.__extends(t,e),t.prototype.matches=function(e){var t=this.value,n=e.field(this.field);return null!==n&&t.contains(n)},t}(Rr),qr=function(e){function t(t,n){var r=e.call(this,t,Mr.ARRAY_CONTAINS_ANY,n)||this;return r.value=n,r}return a.__extends(t,e),t.prototype.matches=function(e){var t=this,n=e.field(this.field);return n instanceof Rt&&n.internalValue.some((function(e){return t.value.contains(e)}))},t}(Rr),jr=function(){function e(e){this.name=e}return e.prototype.toString=function(){return this.name},e.ASCENDING=new e("asc"),e.DESCENDING=new e("desc"),e}(),Ur=function(){function e(e,t){this.position=e,this.before=t}return e.prototype.canonicalId=function(){for(var e=this.before?"b:":"a:",t=0,n=this.position;t<n.length;t++)e+=n[t].toString();return e},e.prototype.sortsBeforeDocument=function(e,t){g(this.position.length<=e.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var o=e[r],i=this.position[r];if(o.field.isKeyField())g(i instanceof xt,"Bound has a non-key value where the key path is being used."),n=ce.comparator(i.key,t.key);else{var a=t.field(o.field);g(null!==a,"Field should exist since document matched the orderBy already."),n=i.compareTo(a)}if(o.dir===jr.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},e.prototype.isEqual=function(e){if(null===e)return!1;if(this.before!==e.before||this.position.length!==e.position.length)return!1;for(var t=0;t<this.position.length;t++)if(!this.position[t].isEqual(e.position[t]))return!1;return!0},e}(),Gr=function(){function e(e,t){this.field=e,void 0===t&&(t=jr.ASCENDING),this.dir=t,this.isKeyOrderBy=e.isKeyField()}return e.prototype.compare=function(e,t){var n=this.isKeyOrderBy?Ft.compareByKey(e,t):Ft.compareByField(this.field,e,t);switch(this.dir){case jr.ASCENDING:return n;case jr.DESCENDING:return-1*n;default:return m("Unknown direction: "+this.dir)}},e.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},e.prototype.toString=function(){return this.field.canonicalString()+" ("+this.dir+")"},e.prototype.isEqual=function(e){return this.dir===e.dir&&this.field.isEqual(e.field)},e}(),zr=new Gr(ue.keyField(),jr.ASCENDING),Wr=new Gr(ue.keyField(),jr.DESCENDING),Hr=function(){function e(){}return e.prototype.applyToLocalView=function(e,t){return new Nt(t,e)},e.prototype.applyToRemoteDocument=function(e,t){return t},e.prototype.computeBaseValue=function(e){return null},e.prototype.isEqual=function(t){return t instanceof e},e.instance=new e,e}(),Qr=function(){function e(e){this.elements=e}return e.prototype.applyToLocalView=function(e,t){return this.apply(e)},e.prototype.applyToRemoteDocument=function(e,t){return this.apply(e)},e.prototype.apply=function(e){for(var t=Jr(e),n=function(e){t.find((function(t){return t.isEqual(e)}))||t.push(e)},r=0,o=this.elements;r<o.length;r++)n(o[r]);return new Rt(t)},e.prototype.computeBaseValue=function(e){return null},e.prototype.isEqual=function(t){return t instanceof e&&J(t.elements,this.elements)},e}(),Kr=function(){function e(e){this.elements=e}return e.prototype.applyToLocalView=function(e,t){return this.apply(e)},e.prototype.applyToRemoteDocument=function(e,t){return this.apply(e)},e.prototype.apply=function(e){for(var t=Jr(e),n=function(e){t=t.filter((function(t){return!t.isEqual(e)}))},r=0,o=this.elements;r<o.length;r++)n(o[r]);return new Rt(t)},e.prototype.computeBaseValue=function(e){return null},e.prototype.isEqual=function(t){return t instanceof e&&J(t.elements,this.elements)},e}(),Yr=function(){function e(e){this.operand=e}return e.prototype.applyToLocalView=function(e,t){var n=this.computeBaseValue(e);return n instanceof Tt&&this.operand instanceof Tt?new Tt(n.internalValue+this.operand.internalValue):new It(n.internalValue+this.operand.internalValue)},e.prototype.applyToRemoteDocument=function(e,t){return g(null!==t,"Didn't receive transformResult for NUMERIC_ADD transform"),t},e.prototype.computeBaseValue=function(e){return e instanceof St?e:new Tt(0)},e.prototype.isEqual=function(t){return t instanceof e&&this.operand.isEqual(t.operand)},e}();function Jr(e){return e instanceof Rt?e.internalValue.slice():[]}var $r,Zr,Xr=function(){function e(e){this.count=e}return e.prototype.isEqual=function(e){return e&&e.count===this.count},e}(),eo=(($r={})[jr.ASCENDING.name]="ASCENDING",$r[jr.DESCENDING.name]="DESCENDING",$r),to=((Zr={})[Mr.LESS_THAN.name]="LESS_THAN",Zr[Mr.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",Zr[Mr.GREATER_THAN.name]="GREATER_THAN",Zr[Mr.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",Zr[Mr.EQUAL.name]="EQUAL",Zr[Mr.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",Zr[Mr.IN.name]="IN",Zr[Mr.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",Zr),no=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ro(e,t){g(!Xn(e),t+" is missing")}function oo(e){return"number"==typeof e?e:"string"==typeof e?Number(e):m("can't parse "+e)}var io=function(){function e(e,t){this.databaseId=e,this.options=t}return e.prototype.emptyByteString=function(){return this.options.useProto3Json?"":new Uint8Array(0)},e.prototype.unsafeCastProtoByteString=function(e){return e},e.prototype.fromRpcStatus=function(e){var t=void 0===e.code?w.UNKNOWN:dr(e.code);return new C(t,e.message||"")},e.prototype.toInt32Value=function(e){return Xn(e)?void 0:{value:e}},e.prototype.fromInt32Value=function(e){var t;return Xn(t="object"==typeof e?e.value:e)?null:t},e.prototype.toTimestamp=function(e){return{seconds:""+e.seconds,nanos:e.nanoseconds}},e.prototype.fromTimestamp=function(e){if("string"==typeof e)return this.fromIso8601String(e);g(!!e,"Cannot deserialize null or undefined timestamp.");var t=oo(e.seconds||"0");return new ge(t,e.nanos||0)},e.prototype.fromIso8601String=function(e){var t=0,n=no.exec(e);if(g(!!n,"invalid timestamp: "+e),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var o=new Date(e),i=Math.floor(o.getTime()/1e3);return new ge(i,t)},e.prototype.toBytes=function(e){return this.options.useProto3Json?e.toBase64():this.unsafeCastProtoByteString(e.toUint8Array())},e.prototype.fromBlob=function(e){return"string"==typeof e?(g(this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),ee.fromBase64String(e)):(g(!this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),ee.fromUint8Array(e))},e.prototype.toVersion=function(e){return this.toTimestamp(e.toTimestamp())},e.prototype.fromVersion=function(e){return g(!!e,"Trying to deserialize version that isn't set"),be.fromTimestamp(this.fromTimestamp(e))},e.prototype.toResourceName=function(e,t){return this.fullyQualifiedPrefixPath(e).child("documents").child(t).canonicalString()},e.prototype.fromResourceName=function(e){var t=ae.fromString(e);return g(this.isValidResourceName(t),"Tried to deserialize invalid key "+t.toString()),t},e.prototype.toName=function(e){return this.toResourceName(this.databaseId,e.path)},e.prototype.fromName=function(e){var t=this.fromResourceName(e);return g(t.get(1)===this.databaseId.projectId,"Tried to deserialize key from different project: "+t.get(1)+" vs "+this.databaseId.projectId),g(!t.get(3)&&!this.databaseId.database||t.get(3)===this.databaseId.database,"Tried to deserialize key from different database: "+t.get(3)+" vs "+this.databaseId.database),new ce(this.extractLocalPathFromResourceName(t))},e.prototype.toQueryPath=function(e){return this.toResourceName(this.databaseId,e)},e.prototype.fromQueryPath=function(e){var t=this.fromResourceName(e);return 4===t.length?ae.EMPTY_PATH:this.extractLocalPathFromResourceName(t)},Object.defineProperty(e.prototype,"encodedDatabaseId",{get:function(){return new ae(["projects",this.databaseId.projectId,"databases",this.databaseId.database]).canonicalString()},enumerable:!0,configurable:!0}),e.prototype.fullyQualifiedPrefixPath=function(e){return new ae(["projects",e.projectId,"databases",e.database])},e.prototype.extractLocalPathFromResourceName=function(e){return g(e.length>4&&"documents"===e.get(4),"tried to deserialize invalid key "+e.toString()),e.popFirst(5)},e.prototype.isValidResourceName=function(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)},e.prototype.toValue=function(e){if(e instanceof Ct)return{nullValue:"NULL_VALUE"};if(e instanceof kt)return{booleanValue:e.value()};if(e instanceof Tt)return{integerValue:""+e.value()};if(e instanceof It){var t=e.value();if(this.options.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:e.value()}}return e instanceof At?{stringValue:e.value()}:e instanceof Mt?{mapValue:this.toMapValue(e)}:e instanceof Rt?{arrayValue:this.toArrayValue(e)}:e instanceof Dt?{timestampValue:this.toTimestamp(e.internalValue)}:e instanceof Ot?{geoPointValue:{latitude:e.value().latitude,longitude:e.value().longitude}}:e instanceof Pt?{bytesValue:this.toBytes(e.value())}:e instanceof xt?{referenceValue:this.toResourceName(e.databaseId,e.key.path)}:m("Unknown FieldValue "+JSON.stringify(e))},e.prototype.fromValue=function(e){var t=this;if("nullValue"in e)return Ct.INSTANCE;if("booleanValue"in e)return kt.of(e.booleanValue);if("integerValue"in e)return new Tt(oo(e.integerValue));if("doubleValue"in e){if(this.options.useProto3Json){if("NaN"===e.doubleValue)return It.NAN;if("Infinity"===e.doubleValue)return It.POSITIVE_INFINITY;if("-Infinity"===e.doubleValue)return It.NEGATIVE_INFINITY}return new It(e.doubleValue)}if("stringValue"in e)return new At(e.stringValue);if("mapValue"in e)return this.fromFields(e.mapValue.fields||{});if("arrayValue"in e)return ro(e.arrayValue,"arrayValue"),new Rt((e.arrayValue.values||[]).map((function(e){return t.fromValue(e)})));if("timestampValue"in e)return ro(e.timestampValue,"timestampValue"),new Dt(this.fromTimestamp(e.timestampValue));if("geoPointValue"in e)return ro(e.geoPointValue,"geoPointValue"),new Ot(new Pr(e.geoPointValue.latitude||0,e.geoPointValue.longitude||0));if("bytesValue"in e){ro(e.bytesValue,"bytesValue");var n=this.fromBlob(e.bytesValue);return new Pt(n)}if("referenceValue"in e){ro(e.referenceValue,"referenceValue");var r=this.fromResourceName(e.referenceValue),o=new re(r.get(1),r.get(3)),i=new ce(this.extractLocalPathFromResourceName(r));return new xt(o,i)}return m("Unknown Value proto "+JSON.stringify(e))},e.prototype.toMutationDocument=function(e,t){return{name:this.toName(e),fields:this.toFields(t)}},e.prototype.toDocument=function(e){return g(!e.hasLocalMutations,"Can't serialize documents with mutations."),{name:this.toName(e.key),fields:this.toFields(e.data()),updateTime:this.toTimestamp(e.version.toTimestamp())}},e.prototype.fromDocument=function(e,t){var n=this,r=this.fromName(e.name),o=this.fromVersion(e.updateTime);return new Ft(r,o,{hasCommittedMutations:!!t},void 0,e,(function(e){return n.fromValue(e)}))},e.prototype.toFields=function(e){var t=this,n={};return e.forEach((function(e,r){n[e]=t.toValue(r)})),n},e.prototype.fromFields=function(e){var t=this,n=Mt.EMPTY;return I(e,(function(e,r){n=n.set(new ue([e]),t.fromValue(r))})),n},e.prototype.toMapValue=function(e){return{fields:this.toFields(e)}},e.prototype.toArrayValue=function(e){var t=this,n=[];return e.forEach((function(e){n.push(t.toValue(e))})),{values:n}},e.prototype.fromFound=function(e){var t=this;g(!!e.found,"Tried to deserialize a found document from a missing document."),ro(e.found.name,"doc.found.name"),ro(e.found.updateTime,"doc.found.updateTime");var n=this.fromName(e.found.name),r=this.fromVersion(e.found.updateTime);return new Ft(n,r,{},void 0,e.found,(function(e){return t.fromValue(e)}))},e.prototype.fromMissing=function(e){g(!!e.missing,"Tried to deserialize a missing document from a found document."),g(!!e.readTime,"Tried to deserialize a missing document without a read time.");var t=this.fromName(e.missing),n=this.fromVersion(e.readTime);return new Vt(t,n)},e.prototype.fromMaybeDocument=function(e){return"found"in e?this.fromFound(e):"missing"in e?this.fromMissing(e):m("invalid batch get response: "+JSON.stringify(e))},e.prototype.toWatchTargetChangeState=function(e){switch(e){case Sr.Added:return"ADD";case Sr.Current:return"CURRENT";case Sr.NoChange:return"NO_CHANGE";case Sr.Removed:return"REMOVE";case Sr.Reset:return"RESET";default:return m("Unknown WatchTargetChangeState: "+e)}},e.prototype.toTestWatchChange=function(e){if(e instanceof kr)return{filter:{count:e.existenceFilter.count,targetId:e.targetId}};if(e instanceof Cr){var t;if(e.newDoc instanceof Ft)return{documentChange:{document:{name:this.toName((t=e.newDoc).key),fields:this.toFields(t.data()),updateTime:this.toVersion(t.version)},targetIds:e.updatedTargetIds,removedTargetIds:e.removedTargetIds}};if(e.newDoc instanceof Vt)return{documentDelete:{document:this.toName((t=e.newDoc).key),readTime:this.toVersion(t.version),removedTargetIds:e.removedTargetIds}};if(null===e.newDoc)return{documentRemove:{document:this.toName(e.key),removedTargetIds:e.removedTargetIds}}}if(e instanceof Er){var n=void 0;return e.cause&&(n={code:pr(e.cause.code),message:e.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(e.state),targetIds:e.targetIds,resumeToken:this.unsafeCastProtoByteString(e.resumeToken),cause:n}}}return m("Unrecognized watch change: "+JSON.stringify(e))},e.prototype.fromWatchChange=function(e){var t,n=this;if("targetChange"in e){ro(e.targetChange,"targetChange");var r=this.fromWatchTargetChangeState(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],i=e.targetChange.resumeToken||this.emptyByteString(),a=e.targetChange.cause,s=a&&this.fromRpcStatus(a);t=new Er(r,o,i,s||null)}else if("documentChange"in e){ro(e.documentChange,"documentChange"),ro(e.documentChange.document,"documentChange.name"),ro(e.documentChange.document.name,"documentChange.document.name"),ro(e.documentChange.document.updateTime,"documentChange.document.updateTime");var u=e.documentChange,c=this.fromName(u.document.name),l=this.fromVersion(u.document.updateTime),h=new Ft(c,l,{},void 0,u.document,(function(e){return n.fromValue(e)}));t=new Cr(u.targetIds||[],u.removedTargetIds||[],h.key,h)}else if("documentDelete"in e){ro(e.documentDelete,"documentDelete"),ro(e.documentDelete.document,"documentDelete.document");var f=e.documentDelete;c=this.fromName(f.document),l=f.readTime?this.fromVersion(f.readTime):be.forDeletedDoc(),h=new Vt(c,l),t=new Cr([],f.removedTargetIds||[],h.key,h)}else if("documentRemove"in e){ro(e.documentRemove,"documentRemove"),ro(e.documentRemove.document,"documentRemove");var d=e.documentRemove;c=this.fromName(d.document),t=new Cr([],d.removedTargetIds||[],c,null)}else{if(!("filter"in e))return m("Unknown change type "+JSON.stringify(e));ro(e.filter,"filter"),ro(e.filter.targetId,"filter.targetId");var p=e.filter,y=new Xr(p.count||0);t=new kr(p.targetId,y)}return t},e.prototype.fromWatchTargetChangeState=function(e){return"NO_CHANGE"===e?Sr.NoChange:"ADD"===e?Sr.Added:"REMOVE"===e?Sr.Removed:"CURRENT"===e?Sr.Current:"RESET"===e?Sr.Reset:m("Got unexpected TargetChange.state: "+e)},e.prototype.versionFromListenResponse=function(e){if(!("targetChange"in e))return be.MIN;var t=e.targetChange;return t.targetIds&&t.targetIds.length?be.MIN:t.readTime?this.fromVersion(t.readTime):be.MIN},e.prototype.toMutation=function(e){var t,n=this;if(e instanceof pt)t={update:this.toMutationDocument(e.key,e.value)};else if(e instanceof mt)t={delete:this.toName(e.key)};else if(e instanceof yt)t={update:this.toMutationDocument(e.key,e.data),updateMask:this.toDocumentMask(e.fieldMask)};else{if(!(e instanceof vt))return m("Unknown mutation type "+e.type);t={transform:{document:this.toName(e.key),fieldTransforms:e.fieldTransforms.map((function(e){return n.toFieldTransform(e)}))}}}return e.precondition.isNone||(t.currentDocument=this.toPrecondition(e.precondition)),t},e.prototype.fromMutation=function(e){var t=this,n=e.currentDocument?this.fromPrecondition(e.currentDocument):ft.NONE;if(e.update){ro(e.update.name,"name");var r=this.fromName(e.update.name),o=this.fromFields(e.update.fields||{});if(e.updateMask){var i=this.fromDocumentMask(e.updateMask);return new yt(r,o,i,n)}return new pt(r,o,n)}if(e.delete)return r=this.fromName(e.delete),new mt(r,n);if(e.transform){r=this.fromName(e.transform.document);var a=e.transform.fieldTransforms.map((function(e){return t.fromFieldTransform(e)}));return g(!0===n.exists,'Transforms only support precondition "exists == true"'),new vt(r,a)}return m("unknown mutation proto: "+JSON.stringify(e))},e.prototype.toPrecondition=function(e){return g(!e.isNone,"Can't serialize an empty precondition"),void 0!==e.updateTime?{updateTime:this.toVersion(e.updateTime)}:void 0!==e.exists?{exists:e.exists}:m("Unknown precondition")},e.prototype.fromPrecondition=function(e){return void 0!==e.updateTime?ft.updateTime(this.fromVersion(e.updateTime)):void 0!==e.exists?ft.exists(e.exists):ft.NONE},e.prototype.fromWriteResult=function(e,t){var n=this,r=this.fromVersion(e.updateTime?e.updateTime:t),o=null;return e.transformResults&&e.transformResults.length>0&&(o=e.transformResults.map((function(e){return n.fromValue(e)}))),new lt(r,o)},e.prototype.fromWriteResults=function(e,t){var n=this;return e&&e.length>0?(g(void 0!==t,"Received a write result without a commit time"),e.map((function(e){return n.fromWriteResult(e,t)}))):[]},e.prototype.toFieldTransform=function(e){var t=this,n=e.transform;if(n instanceof Hr)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Qr)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements.map((function(e){return t.toValue(e)}))}};if(n instanceof Kr)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements.map((function(e){return t.toValue(e)}))}};if(n instanceof Yr)return{fieldPath:e.field.canonicalString(),increment:this.toValue(n.operand)};throw m("Unknown transform: "+e.transform)},e.prototype.fromFieldTransform=function(e){var t=this,n=null;if("setToServerValue"in e)g("REQUEST_TIME"===e.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(e)),n=Hr.instance;else if("appendMissingElements"in e)n=new Qr((e.appendMissingElements.values||[]).map((function(e){return t.fromValue(e)})));else if("removeAllFromArray"in e)n=new Kr((e.removeAllFromArray.values||[]).map((function(e){return t.fromValue(e)})));else if("increment"in e){var r=this.fromValue(e.increment);g(r instanceof St,"NUMERIC_ADD transform requires a NumberValue"),n=new Yr(r)}else m("Unknown transform proto: "+JSON.stringify(e));var o=ue.fromServerFormat(e.fieldPath);return new ct(o,n)},e.prototype.toDocumentsTarget=function(e){return{documents:[this.toQueryPath(e.path)]}},e.prototype.fromDocumentsTarget=function(e){var t=e.documents.length;return g(1===t,"DocumentsTarget contained other than 1 document: "+t),xr.atPath(this.fromQueryPath(e.documents[0]))},e.prototype.toQueryTarget=function(e){var t={structuredQuery:{}},n=e.path;null!==e.collectionGroup?(g(n.length%2==0,"Collection Group queries should be within a document path or root."),t.parent=this.toQueryPath(n),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(g(n.length%2!=0,"Document queries with filters are not supported."),t.parent=this.toQueryPath(n.popLast()),t.structuredQuery.from=[{collectionId:n.lastSegment()}]);var r=this.toFilter(e.filters);r&&(t.structuredQuery.where=r);var o=this.toOrder(e.orderBy);o&&(t.structuredQuery.orderBy=o);var i=this.toInt32Value(e.limit);return void 0!==i&&(t.structuredQuery.limit=i),e.startAt&&(t.structuredQuery.startAt=this.toCursor(e.startAt)),e.endAt&&(t.structuredQuery.endAt=this.toCursor(e.endAt)),t},e.prototype.fromQueryTarget=function(e){var t=this.fromQueryPath(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,o=null;if(r>0){g(1===r,"StructuredQuery.from with more than one collection is not supported.");var i=n.from[0];i.allDescendants?o=i.collectionId:t=t.child(i.collectionId)}var a=[];n.where&&(a=this.fromFilter(n.where));var s=[];n.orderBy&&(s=this.fromOrder(n.orderBy));var u=null;n.limit&&(u=this.fromInt32Value(n.limit));var c=null;n.startAt&&(c=this.fromCursor(n.startAt));var l=null;return n.endAt&&(l=this.fromCursor(n.endAt)),new xr(t,o,s,a,u,c,l)},e.prototype.toListenRequestLabels=function(e){var t=this.toLabel(e.purpose);return null==t?null:{"goog-listen-tags":t}},e.prototype.toLabel=function(e){switch(e){case bn.Listen:return null;case bn.ExistenceFilterMismatch:return"existence-filter-mismatch";case bn.LimboResolution:return"limbo-document";default:return m("Unrecognized query purpose: "+e)}},e.prototype.toTarget=function(e){var t,n=e.query;return(t=n.isDocumentQuery()?{documents:this.toDocumentsTarget(n)}:{query:this.toQueryTarget(n)}).targetId=e.targetId,e.resumeToken.length>0&&(t.resumeToken=this.unsafeCastProtoByteString(e.resumeToken)),t},e.prototype.toFilter=function(e){var t=this;if(0!==e.length){var n=e.map((function(e){return e instanceof Rr?t.toUnaryOrFieldFilter(e):m("Unrecognized filter: "+JSON.stringify(e))}));return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},e.prototype.fromFilter=function(e){var t=this;return e?void 0!==e.unaryFilter?[this.fromUnaryFilter(e)]:void 0!==e.fieldFilter?[this.fromFieldFilter(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return t.fromFilter(e)})).reduce((function(e,t){return e.concat(t)})):m("Unknown filter: "+JSON.stringify(e)):[]},e.prototype.toOrder=function(e){var t=this;if(0!==e.length)return e.map((function(e){return t.toPropertyOrder(e)}))},e.prototype.fromOrder=function(e){var t=this;return e.map((function(e){return t.fromPropertyOrder(e)}))},e.prototype.toCursor=function(e){var t=this;return{before:e.before,values:e.position.map((function(e){return t.toValue(e)}))}},e.prototype.fromCursor=function(e){var t=this,n=!!e.before,r=e.values.map((function(e){return t.fromValue(e)}));return new Ur(r,n)},e.prototype.toDirection=function(e){return eo[e.name]},e.prototype.fromDirection=function(e){switch(e){case"ASCENDING":return jr.ASCENDING;case"DESCENDING":return jr.DESCENDING;default:return}},e.prototype.toOperatorName=function(e){return to[e.name]},e.prototype.fromOperatorName=function(e){switch(e){case"EQUAL":return Mr.EQUAL;case"GREATER_THAN":return Mr.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return Mr.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return Mr.LESS_THAN;case"LESS_THAN_OR_EQUAL":return Mr.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return Mr.ARRAY_CONTAINS;case"IN":return Mr.IN;case"ARRAY_CONTAINS_ANY":return Mr.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":return m("Unspecified operator");default:return m("Unknown operator")}},e.prototype.toFieldPathReference=function(e){return{fieldPath:e.canonicalString()}},e.prototype.fromFieldPathReference=function(e){return ue.fromServerFormat(e.fieldPath)},e.prototype.toPropertyOrder=function(e){return{field:this.toFieldPathReference(e.field),direction:this.toDirection(e.dir)}},e.prototype.fromPropertyOrder=function(e){return new Gr(this.fromFieldPathReference(e.field),this.fromDirection(e.direction))},e.prototype.fromFieldFilter=function(e){return Rr.create(this.fromFieldPathReference(e.fieldFilter.field),this.fromOperatorName(e.fieldFilter.op),this.fromValue(e.fieldFilter.value))},e.prototype.toUnaryOrFieldFilter=function(e){if(e.op===Mr.EQUAL){if(e.value.isEqual(It.NAN))return{unaryFilter:{field:this.toFieldPathReference(e.field),op:"IS_NAN"}};if(e.value.isEqual(Ct.INSTANCE))return{unaryFilter:{field:this.toFieldPathReference(e.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.toFieldPathReference(e.field),op:this.toOperatorName(e.op),value:this.toValue(e.value)}}},e.prototype.fromUnaryFilter=function(e){switch(e.unaryFilter.op){case"IS_NAN":var t=this.fromFieldPathReference(e.unaryFilter.field);return Rr.create(t,Mr.EQUAL,It.NAN);case"IS_NULL":var n=this.fromFieldPathReference(e.unaryFilter.field);return Rr.create(n,Mr.EQUAL,Ct.INSTANCE);case"OPERATOR_UNSPECIFIED":return m("Unspecified filter");default:return m("Unknown filter")}},e.prototype.toDocumentMask=function(e){var t=[];return e.fields.forEach((function(e){return t.push(e.canonicalString())})),{fieldPaths:t}},e.prototype.fromDocumentMask=function(e){var t=(e.fieldPaths||[]).map((function(e){return ue.fromServerFormat(e)}));return ut.fromArray(t)},e}(),ao=function(){this.viewSnap=null,this.targetId=0,this.listeners=[]},so=function(){function e(e){this.syncEngine=e,this.queries=new qt((function(e){return e.canonicalId()})),this.onlineState=ur.Unknown,this.snapshotsInSyncListeners=new Set,this.syncEngine.subscribe(this)}return e.prototype.listen=function(e){var t=e.query,n=!1,r=this.queries.get(t);return r||(n=!0,r=new ao,this.queries.set(t,r)),r.listeners.push(e),g(!e.applyOnlineStateChange(this.onlineState),"applyOnlineStateChange() shouldn't raise an event for brand-new listeners."),r.viewSnap&&e.onViewSnapshot(r.viewSnap)&&this.raiseSnapshotsInSyncEvent(),n?this.syncEngine.listen(t).then((function(e){return r.targetId=e,e})):Promise.resolve(r.targetId)},e.prototype.unlisten=function(e){return a.__awaiter(this,void 0,void 0,(function(){var t,n,r,o;return a.__generator(this,(function(i){return n=!1,(r=this.queries.get(t=e.query))&&(o=r.listeners.indexOf(e))>=0&&(r.listeners.splice(o,1),n=0===r.listeners.length),n?(this.queries.delete(t),[2,this.syncEngine.unlisten(t)]):[2]}))}))},e.prototype.onWatchChange=function(e){for(var t=!1,n=0,r=e;n<r.length;n++){var o=r[n],i=this.queries.get(o.query);if(i){for(var a=0,s=i.listeners;a<s.length;a++)s[a].onViewSnapshot(o)&&(t=!0);i.viewSnap=o}}t&&this.raiseSnapshotsInSyncEvent()},e.prototype.onWatchError=function(e,t){var n=this.queries.get(e);if(n)for(var r=0,o=n.listeners;r<o.length;r++)o[r].onError(t);this.queries.delete(e)},e.prototype.onOnlineStateChange=function(e){this.onlineState=e;var t=!1;this.queries.forEach((function(n,r){for(var o=0,i=r.listeners;o<i.length;o++)i[o].applyOnlineStateChange(e)&&(t=!0)})),t&&this.raiseSnapshotsInSyncEvent()},e.prototype.addSnapshotsInSyncListener=function(e){this.snapshotsInSyncListeners.add(e),e.next()},e.prototype.removeSnapshotsInSyncListener=function(e){this.snapshotsInSyncListeners.delete(e)},e.prototype.raiseSnapshotsInSyncEvent=function(){this.snapshotsInSyncListeners.forEach((function(e){e.next()}))},e}(),uo=function(){function e(e,t,n){this.query=e,this.queryObserver=t,this.raisedInitialEvent=!1,this.snap=null,this.onlineState=ur.Unknown,this.options=n||{}}return e.prototype.onViewSnapshot=function(e){if(g(e.docChanges.length>0||e.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var t=[],n=0,r=e.docChanges;n<r.length;n++){var o=r[n];o.type!==vr.Metadata&&t.push(o)}e=new br(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var i=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(e)&&(this.queryObserver.next(e),i=!0):this.shouldRaiseInitialEvent(e,this.onlineState)&&(this.raiseInitialEvent(e),i=!0),this.snap=e,i},e.prototype.onError=function(e){this.queryObserver.error(e)},e.prototype.applyOnlineStateChange=function(e){this.onlineState=e;var t=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,e)&&(this.raiseInitialEvent(this.snap),t=!0),t},e.prototype.shouldRaiseInitialEvent=function(e,t){return g(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!e.fromCache||(this.options.waitForSyncWhenOnline&&t!==ur.Offline?(g(e.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!e.docs.isEmpty()||t===ur.Offline)},e.prototype.shouldRaiseEvent=function(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.snap&&this.snap.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges},e.prototype.raiseInitialEvent=function(e){g(!this.raisedInitialEvent,"Trying to raise initial events for second time"),e=br.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.raisedInitialEvent=!0,this.queryObserver.next(e)},e}(),co=function(){function e(e,t,n){this.targetId=e,this.addedKeys=t,this.removedKeys=n}return e.fromSnapshot=function(t,n){for(var r=Me(),o=Me(),i=0,a=n.docChanges;i<a.length;i++){var s=a[i];switch(s.type){case vr.Added:r=r.add(s.doc.key);break;case vr.Removed:o=o.add(s.doc.key)}}return new e(t,r,o)},e}(),lo=function(e){this.key=e},ho=function(e){this.key=e},fo=function(){function e(e,t){this.query=e,this._syncedDocuments=t,this.syncState=null,this.current=!1,this.limboDocuments=Me(),this.mutatedKeys=Me(),this.documentSet=new yr(e.docComparator.bind(e))}return Object.defineProperty(e.prototype,"syncedDocuments",{get:function(){return this._syncedDocuments},enumerable:!0,configurable:!0}),e.prototype.computeDocChanges=function(e,t){var n=this,r=t?t.changeSet:new gr,o=t?t.documentSet:this.documentSet,i=t?t.mutatedKeys:this.mutatedKeys,a=o,s=!1,u=this.query.hasLimit()&&o.size===this.query.limit?o.last():null;if(e.inorderTraversal((function(e,t){var c=o.get(e),l=t instanceof Ft?t:null;l&&(g(e.isEqual(l.key),"Mismatching keys found in document changes: "+e+" != "+l.key),l=n.query.matches(l)?l:null);var h=!!c&&n.mutatedKeys.has(c.key),f=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),d=!1;c&&l?c.data().isEqual(l.data())?h!==f&&(r.track({type:vr.Metadata,doc:l}),d=!0):n.shouldWaitForSyncedDocument(c,l)||(r.track({type:vr.Modified,doc:l}),d=!0,u&&n.query.docComparator(l,u)>0&&(s=!0)):!c&&l?(r.track({type:vr.Added,doc:l}),d=!0):c&&!l&&(r.track({type:vr.Removed,doc:c}),d=!0,u&&(s=!0)),d&&(l?(a=a.add(l),i=f?i.add(e):i.delete(e)):(a=a.delete(e),i=i.delete(e)))})),this.query.hasLimit())for(;a.size>this.query.limit;){var c=a.last();a=a.delete(c.key),i=i.delete(c.key),r.track({type:vr.Removed,doc:c})}return g(!s||!t,"View was refilled using docs that themselves needed refilling."),{documentSet:a,changeSet:r,needsRefill:s,mutatedKeys:i}},e.prototype.shouldWaitForSyncedDocument=function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations},e.prototype.applyChanges=function(e,t,n){var r=this;g(!e.needsRefill,"Cannot apply changes that need a refill");var o=this.documentSet;this.documentSet=e.documentSet,this.mutatedKeys=e.mutatedKeys;var i=e.changeSet.getChanges();i.sort((function(e,t){return function(e,t){var n=function(e){switch(e){case vr.Added:return 1;case vr.Modified:case vr.Metadata:return 2;case vr.Removed:return 0;default:return m("Unknown ChangeType: "+e)}};return n(e)-n(t)}(e.type,t.type)||r.query.docComparator(e.doc,t.doc)})),this.applyTargetChange(n);var a=t?this.updateLimboDocuments():[],s=0===this.limboDocuments.size&&this.current?mr.Synced:mr.Local,u=s!==this.syncState;return this.syncState=s,0!==i.length||u?{snapshot:new br(this.query,e.documentSet,o,i,e.mutatedKeys,s===mr.Local,u,!1),limboChanges:a}:{limboChanges:a}},e.prototype.applyOnlineStateChange=function(e){return this.current&&e===ur.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new gr,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}},e.prototype.shouldBeInLimbo=function(e){return!this._syncedDocuments.has(e)&&!!this.documentSet.has(e)&&!this.documentSet.get(e).hasLocalMutations},e.prototype.applyTargetChange=function(e){var t=this;e&&(e.addedDocuments.forEach((function(e){return t._syncedDocuments=t._syncedDocuments.add(e)})),e.modifiedDocuments.forEach((function(e){return g(t._syncedDocuments.has(e),"Modified document "+e+" not found in view.")})),e.removedDocuments.forEach((function(e){return t._syncedDocuments=t._syncedDocuments.delete(e)})),this.current=e.current)},e.prototype.updateLimboDocuments=function(){var e=this;if(!this.current)return[];var t=this.limboDocuments;this.limboDocuments=Me(),this.documentSet.forEach((function(t){e.shouldBeInLimbo(t.key)&&(e.limboDocuments=e.limboDocuments.add(t.key))}));var n=[];return t.forEach((function(t){e.limboDocuments.has(t)||n.push(new ho(t))})),this.limboDocuments.forEach((function(e){t.has(e)||n.push(new lo(e))})),n},e.prototype.synchronizeWithPersistedState=function(e,t){this._syncedDocuments=t,this.limboDocuments=Me();var n=this.computeDocChanges(e);return this.applyChanges(n,!0)},e.prototype.computeInitialSnapshot=function(){return br.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===mr.Local)},e}(),po=function(){function e(e,t,n,r){this.asyncQueue=e,this.remoteStore=t,this.updateFunction=n,this.deferred=r,this.retries=5,this.backoff=new tr(this.asyncQueue,he.RetryTransaction)}return e.prototype.run=function(){this.runWithBackOff()},e.prototype.runWithBackOff=function(){var e=this;this.backoff.backoffAndRun((function(){return a.__awaiter(e,void 0,void 0,(function(){var e,t,n=this;return a.__generator(this,(function(r){return e=this.remoteStore.createTransaction(),(t=this.tryRunUpdateFunction(e))&&t.then((function(t){n.asyncQueue.enqueueAndForget((function(){return e.commit().then((function(){n.deferred.resolve(t)})).catch((function(e){n.handleTransactionError(e)}))}))})).catch((function(e){n.handleTransactionError(e)})),[2]}))}))}))},e.prototype.tryRunUpdateFunction=function(e){try{var t=this.updateFunction(e);return!Xn(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(y){return this.deferred.reject(y),null}},e.prototype.handleTransactionError=function(e){var t=this;this.retries>0&&this.isRetryableTransactionError(e)?(this.retries-=1,this.asyncQueue.enqueueAndForget((function(){return t.runWithBackOff(),Promise.resolve()}))):this.deferred.reject(e)},e.prototype.isRetryableTransactionError=function(e){if("FirebaseError"===e.name){var t=e.code;return"aborted"===t||"failed-precondition"===t||!fr(t)}return!1},e}(),yo=function(e,t,n){this.query=e,this.targetId=t,this.view=n},vo=function(e){this.key=e,this.receivedDocument=!1},mo=function(){function e(e,t,n,r){this.localStore=e,this.remoteStore=t,this.sharedClientState=n,this.currentUser=r,this.syncEngineListener=null,this.queryViewsByQuery=new qt((function(e){return e.canonicalId()})),this.queryViewsByTarget={},this.limboTargetsByKey=new _e(ce.comparator),this.limboResolutionsByTarget={},this.limboDocumentRefs=new Bn,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=Ke.forSyncEngine(),this.isPrimary=void 0,this.onlineState=ur.Unknown}return Object.defineProperty(e.prototype,"isPrimaryClient",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),e.prototype.subscribe=function(e){g(null!==e,"SyncEngine listener cannot be null"),g(null===this.syncEngineListener,"SyncEngine already has a subscriber."),this.syncEngineListener=e},e.prototype.listen=function(e){return a.__awaiter(this,void 0,void 0,(function(){var t,n,r,o,i;return a.__generator(this,(function(a){switch(a.label){case 0:return this.assertSubscribed("listen()"),(r=this.queryViewsByQuery.get(e))?(this.sharedClientState.addLocalQueryTarget(t=r.targetId),n=r.view.computeInitialSnapshot(),[3,4]):[3,1];case 1:return[4,this.localStore.allocateQuery(e)];case 2:return o=a.sent(),i=this.sharedClientState.addLocalQueryTarget(o.targetId),t=o.targetId,[4,this.initializeViewAndComputeSnapshot(o,"current"===i)];case 3:n=a.sent(),this.isPrimary&&this.remoteStore.listen(o),a.label=4;case 4:return this.syncEngineListener.onWatchChange([n]),[2,t]}}))}))},e.prototype.initializeViewAndComputeSnapshot=function(e,t){return a.__awaiter(this,void 0,void 0,(function(){var n,r,o,i,s,u,c,l;return a.__generator(this,(function(a){switch(a.label){case 0:return[4,this.localStore.executeQuery(n=e.query)];case 1:return r=a.sent(),[4,this.localStore.remoteDocumentKeys(e.targetId)];case 2:return o=a.sent(),i=new fo(n,o),s=i.computeDocChanges(r),u=wr.createSynthesizedTargetChangeForCurrentChange(e.targetId,t&&this.onlineState!==ur.Offline),g(0===(c=i.applyChanges(s,!0===this.isPrimary,u)).limboChanges.length,"View returned limbo docs before target ack from the server."),g(!!c.snapshot,"applyChanges for new view should always return a snapshot"),l=new yo(n,e.targetId,i),this.queryViewsByQuery.set(n,l),this.queryViewsByTarget[e.targetId]=l,[2,c.snapshot]}}))}))},e.prototype.synchronizeViewAndComputeSnapshot=function(e){return a.__awaiter(this,void 0,void 0,(function(){var t,n,r;return a.__generator(this,(function(o){switch(o.label){case 0:return[4,this.localStore.executeQuery(e.query)];case 1:return t=o.sent(),[4,this.localStore.remoteDocumentKeys(e.targetId)];case 2:return n=o.sent(),r=e.view.synchronizeWithPersistedState(t,n),this.isPrimary&&this.updateTrackedLimbos(e.targetId,r.limboChanges),[2,r]}}))}))},e.prototype.unlisten=function(e){return a.__awaiter(this,void 0,void 0,(function(){var t,n=this;return a.__generator(this,(function(r){switch(r.label){case 0:return this.assertSubscribed("unlisten()"),g(!!(t=this.queryViewsByQuery.get(e)),"Trying to unlisten on query not found:"+e),this.isPrimary?(this.sharedClientState.removeLocalQueryTarget(t.targetId),this.sharedClientState.isActiveQueryTarget(t.targetId)?[3,2]:[4,this.localStore.releaseQuery(e,!1).then((function(){n.sharedClientState.clearQueryState(t.targetId),n.remoteStore.unlisten(t.targetId),n.removeAndCleanupQuery(t)})).catch(On)]):[3,3];case 1:r.sent(),r.label=2;case 2:return[3,5];case 3:return this.removeAndCleanupQuery(t),[4,this.localStore.releaseQuery(e,!0)];case 4:r.sent(),r.label=5;case 5:return[2]}}))}))},e.prototype.write=function(e,t){return a.__awaiter(this,void 0,void 0,(function(){var n;return a.__generator(this,(function(r){switch(r.label){case 0:return this.assertSubscribed("write()"),[4,this.localStore.localWrite(e)];case 1:return n=r.sent(),this.sharedClientState.addPendingMutation(n.batchId),this.addMutationCallback(n.batchId,t),[4,this.emitNewSnapsAndNotifyLocalStore(n.changes)];case 2:return r.sent(),[4,this.remoteStore.fillWritePipeline()];case 3:return r.sent(),[2]}}))}))},e.prototype.runTransaction=function(e,t,n){new po(e,this.remoteStore,t,n).run()},e.prototype.applyRemoteEvent=function(e){return a.__awaiter(this,void 0,void 0,(function(){var t,n=this;return a.__generator(this,(function(r){switch(r.label){case 0:this.assertSubscribed("applyRemoteEvent()"),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.applyRemoteEvent(e)];case 2:return t=r.sent(),I(e.targetChanges,(function(e,t){var r=n.limboResolutionsByTarget[Number(e)];r&&(g(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1,"Limbo resolution for single document contains multiple changes."),t.addedDocuments.size>0?r.receivedDocument=!0:t.modifiedDocuments.size>0?g(r.receivedDocument,"Received change for limbo target document without add."):t.removedDocuments.size>0&&(g(r.receivedDocument,"Received remove for limbo target document without add."),r.receivedDocument=!1))})),[4,this.emitNewSnapsAndNotifyLocalStore(t,e)];case 3:return r.sent(),[3,6];case 4:return[4,On(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},e.prototype.applyOnlineStateChange=function(e,t){if(this.isPrimary&&t===cr.RemoteStore||!this.isPrimary&&t===cr.SharedClientState){this.assertSubscribed("applyOnlineStateChange()");var n=[];this.queryViewsByQuery.forEach((function(t,r){var o=r.view.applyOnlineStateChange(e);g(0===o.limboChanges.length,"OnlineState should not affect limbo documents."),o.snapshot&&n.push(o.snapshot)})),this.syncEngineListener.onOnlineStateChange(e),this.syncEngineListener.onWatchChange(n),this.onlineState=e,this.isPrimary&&this.sharedClientState.setOnlineState(e)}},e.prototype.rejectListen=function(e,t){return a.__awaiter(this,void 0,void 0,(function(){var n,r,o,i,s,u,c=this;return a.__generator(this,(function(a){switch(a.label){case 0:return this.assertSubscribed("rejectListens()"),this.sharedClientState.updateQueryState(e,"rejected",t),(r=(n=this.limboResolutionsByTarget[e])&&n.key)?(this.limboTargetsByKey=this.limboTargetsByKey.remove(r),delete this.limboResolutionsByTarget[e],o=(o=new _e(ce.comparator)).insert(r,new Vt(r,be.forDeletedDoc())),i=Me().add(r),s=new _r(be.MIN,{},new Se(Y),o,i),[2,this.applyRemoteEvent(s)]):[3,1];case 1:return g(!!(u=this.queryViewsByTarget[e]),"Unknown targetId: "+e),[4,this.localStore.releaseQuery(u.query,!1).then((function(){return c.removeAndCleanupQuery(u)})).catch(On)];case 2:a.sent(),this.syncEngineListener.onWatchError(u.query,t),a.label=3;case 3:return[2]}}))}))},e.prototype.applyBatchState=function(e,t,n){return a.__awaiter(this,void 0,void 0,(function(){var r;return a.__generator(this,(function(o){switch(o.label){case 0:return this.assertSubscribed("applyBatchState()"),[4,this.localStore.lookupMutationDocuments(e)];case 1:return null===(r=o.sent())?(p("SyncEngine","Cannot apply mutation batch with id: "+e),[2]):"pending"!==t?[3,3]:[4,this.remoteStore.fillWritePipeline()];case 2:return o.sent(),[3,4];case 3:"acknowledged"===t||"rejected"===t?(this.processUserCallback(e,n||null),this.localStore.removeCachedMutationBatchMetadata(e)):m("Unknown batchState: "+t),o.label=4;case 4:return[4,this.emitNewSnapsAndNotifyLocalStore(r)];case 5:return o.sent(),[2]}}))}))},e.prototype.applySuccessfulWrite=function(e){return a.__awaiter(this,void 0,void 0,(function(){var t,n;return a.__generator(this,(function(r){switch(r.label){case 0:this.assertSubscribed("applySuccessfulWrite()"),this.processUserCallback(t=e.batch.batchId,null),this.triggerPendingWritesCallbacks(t),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.acknowledgeBatch(e)];case 2:return n=r.sent(),this.sharedClientState.updateMutationState(t,"acknowledged"),[4,this.emitNewSnapsAndNotifyLocalStore(n)];case 3:return r.sent(),[3,6];case 4:return[4,On(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},e.prototype.rejectFailedWrite=function(e,t){return a.__awaiter(this,void 0,void 0,(function(){var n;return a.__generator(this,(function(r){switch(r.label){case 0:this.assertSubscribed("rejectFailedWrite()"),this.processUserCallback(e,t),this.triggerPendingWritesCallbacks(e),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.rejectBatch(e)];case 2:return n=r.sent(),this.sharedClientState.updateMutationState(e,"rejected",t),[4,this.emitNewSnapsAndNotifyLocalStore(n)];case 3:return r.sent(),[3,6];case 4:return[4,On(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},e.prototype.registerPendingWritesCallback=function(e){return a.__awaiter(this,void 0,void 0,(function(){var t,n;return a.__generator(this,(function(r){switch(r.label){case 0:return this.remoteStore.canUseNetwork()||p("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.localStore.getHighestUnacknowledgedBatchId()];case 1:return-1===(t=r.sent())?(e.resolve(),[2]):((n=this.pendingWritesCallbacks.get(t)||[]).push(e),this.pendingWritesCallbacks.set(t,n),[2])}}))}))},e.prototype.triggerPendingWritesCallbacks=function(e){(this.pendingWritesCallbacks.get(e)||[]).forEach((function(e){e.resolve()})),this.pendingWritesCallbacks.delete(e)},e.prototype.rejectOutstandingPendingWritesCallbacks=function(e){this.pendingWritesCallbacks.forEach((function(t){t.forEach((function(t){t.reject(new C(w.CANCELLED,e))}))})),this.pendingWritesCallbacks.clear()},e.prototype.addMutationCallback=function(e,t){var n=this.mutationUserCallbacks[this.currentUser.toKey()];n||(n=new _e(Y)),n=n.insert(e,t),this.mutationUserCallbacks[this.currentUser.toKey()]=n},e.prototype.processUserCallback=function(e,t){var n=this.mutationUserCallbacks[this.currentUser.toKey()];if(n){var r=n.get(e);r&&(g(e===n.minKey(),"Mutation callbacks processed out-of-order?"),t?r.reject(t):r.resolve(),n=n.remove(e)),this.mutationUserCallbacks[this.currentUser.toKey()]=n}},e.prototype.removeAndCleanupQuery=function(e){var t=this;if(this.sharedClientState.removeLocalQueryTarget(e.targetId),this.queryViewsByQuery.delete(e.query),delete this.queryViewsByTarget[e.targetId],this.isPrimary){var n=this.limboDocumentRefs.referencesForId(e.targetId);this.limboDocumentRefs.removeReferencesForId(e.targetId),n.forEach((function(e){t.limboDocumentRefs.containsKey(e)||t.removeLimboTarget(e)}))}},e.prototype.removeLimboTarget=function(e){var t=this.limboTargetsByKey.get(e);null!==t&&(this.remoteStore.unlisten(t),this.limboTargetsByKey=this.limboTargetsByKey.remove(e),delete this.limboResolutionsByTarget[t])},e.prototype.updateTrackedLimbos=function(e,t){for(var n=0,r=t;n<r.length;n++){var o=r[n];o instanceof lo?(this.limboDocumentRefs.addReference(o.key,e),this.trackLimboChange(o)):o instanceof ho?(p("SyncEngine","Document no longer in limbo: "+o.key),this.limboDocumentRefs.removeReference(o.key,e),this.limboDocumentRefs.containsKey(o.key)||this.removeLimboTarget(o.key)):m("Unknown limbo change: "+JSON.stringify(o))}},e.prototype.trackLimboChange=function(e){var t=e.key;if(!this.limboTargetsByKey.get(t)){p("SyncEngine","New document in limbo: "+t);var n=this.limboTargetIdGenerator.next(),r=xr.atPath(t.path);this.limboResolutionsByTarget[n]=new vo(t),this.remoteStore.listen(new _n(r,n,bn.LimboResolution,oe.INVALID)),this.limboTargetsByKey=this.limboTargetsByKey.insert(t,n)}},e.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},e.prototype.emitNewSnapsAndNotifyLocalStore=function(e,t){return a.__awaiter(this,void 0,void 0,(function(){var n,r,o,i=this;return a.__generator(this,(function(a){switch(a.label){case 0:return n=[],r=[],o=[],this.queryViewsByQuery.forEach((function(a,s){o.push(Promise.resolve().then((function(){var t=s.view.computeDocChanges(e);return t.needsRefill?i.localStore.executeQuery(s.query).then((function(e){return s.view.computeDocChanges(e,t)})):t})).then((function(e){var o=s.view.applyChanges(e,!0===i.isPrimary,t&&t.targetChanges[s.targetId]);if(i.updateTrackedLimbos(s.targetId,o.limboChanges),o.snapshot){i.isPrimary&&i.sharedClientState.updateQueryState(s.targetId,o.snapshot.fromCache?"not-current":"current"),n.push(o.snapshot);var a=co.fromSnapshot(s.targetId,o.snapshot);r.push(a)}})))})),[4,Promise.all(o)];case 1:return a.sent(),this.syncEngineListener.onWatchChange(n),[4,this.localStore.notifyLocalViewChanges(r)];case 2:return a.sent(),[2]}}))}))},e.prototype.assertSubscribed=function(e){g(null!==this.syncEngineListener,"Trying to call "+e+" before calling subscribe().")},e.prototype.handleCredentialChange=function(e){return a.__awaiter(this,void 0,void 0,(function(){var t,n;return a.__generator(this,(function(r){switch(r.label){case 0:return t=!this.currentUser.isEqual(e),this.currentUser=e,t?(this.rejectOutstandingPendingWritesCallbacks("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.localStore.handleUserChange(e)]):[3,3];case 1:return n=r.sent(),this.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),[4,this.emitNewSnapsAndNotifyLocalStore(n.affectedDocuments)];case 2:r.sent(),r.label=3;case 3:return[4,this.remoteStore.handleCredentialChange()];case 4:return r.sent(),[2]}}))}))},e.prototype.applyPrimaryState=function(e){return a.__awaiter(this,void 0,void 0,(function(){var t,n,r,o,i,s,u=this;return a.__generator(this,(function(a){switch(a.label){case 0:return!0!==e||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.remoteStore.applyPrimaryState(!0)]);case 1:return a.sent(),t=this.sharedClientState.getAllActiveQueryTargets(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(t.toArray())];case 2:for(n=a.sent(),r=0,o=n;r<o.length;r++)this.remoteStore.listen(o[r]);return[3,7];case 3:return!1!==e||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,i=[],s=Promise.resolve(),T(this.queryViewsByTarget,(function(e,t){u.sharedClientState.isLocalQueryTarget(e)?i.push(e):s=s.then((function(){return u.unlisten(t.query)})),u.remoteStore.unlisten(t.targetId)})),[4,s]);case 4:return a.sent(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(i)];case 5:return a.sent(),this.resetLimboDocuments(),[4,this.remoteStore.applyPrimaryState(!1)];case 6:a.sent(),a.label=7;case 7:return[2]}}))}))},e.prototype.resetLimboDocuments=function(){var e=this;T(this.limboResolutionsByTarget,(function(t){e.remoteStore.unlisten(t)})),this.limboDocumentRefs.removeAllReferences(),this.limboResolutionsByTarget=[],this.limboTargetsByKey=new _e(ce.comparator)},e.prototype.synchronizeQueryViewsAndRaiseSnapshots=function(e){return a.__awaiter(this,void 0,void 0,(function(){var t,n,r,o,i,s,u,c,l;return a.__generator(this,(function(a){switch(a.label){case 0:t=[],n=[],r=0,o=e,a.label=1;case 1:return r<o.length?(s=void 0,(u=this.queryViewsByTarget[i=o[r]])?[4,this.localStore.releaseQuery(u.query,!0)]:[3,5]):[3,11];case 2:return a.sent(),[4,this.localStore.allocateQuery(u.query)];case 3:return s=a.sent(),[4,this.synchronizeViewAndComputeSnapshot(u)];case 4:return(c=a.sent()).snapshot&&n.push(c.snapshot),[3,9];case 5:return g(!0===this.isPrimary,"A secondary tab should never have an active query without an active view."),[4,this.localStore.getQueryForTarget(i)];case 6:return g(!!(l=a.sent()),"Query data for target "+i+" not found"),[4,this.localStore.allocateQuery(l)];case 7:return s=a.sent(),[4,this.initializeViewAndComputeSnapshot(s,!1)];case 8:a.sent(),a.label=9;case 9:t.push(s),a.label=10;case 10:return r++,[3,1];case 11:return this.syncEngineListener.onWatchChange(n),[2,t]}}))}))},e.prototype.getActiveClients=function(){return this.localStore.getActiveClients()},e.prototype.applyTargetState=function(e,t,n){return a.__awaiter(this,void 0,void 0,(function(){var r,o,i,s,u;return a.__generator(this,(function(a){switch(a.label){case 0:if(this.isPrimary)return p("SyncEngine","Ignoring unexpected query state notification."),[2];if(!this.queryViewsByTarget[e])return[3,11];switch(t){case"current":case"not-current":return[3,1];case"rejected":return[3,8]}return[3,10];case 1:return a.trys.push([1,4,,8]),[4,this.localStore.getNewDocumentChanges()];case 2:return r=a.sent(),o=_r.createSynthesizedRemoteEventForCurrentChange(e,"current"===t),[4,this.emitNewSnapsAndNotifyLocalStore(r,o)];case 3:return a.sent(),[3,11];case 4:return(c=i=a.sent()).code!==w.DATA_LOSS||c.message!==Ut?[3,6]:(s=[],T(this.queryViewsByTarget,(function(e){return s.push(e)})),[4,this.synchronizeQueryViewsAndRaiseSnapshots(s)]);case 5:return a.sent(),[3,7];case 6:throw i;case 7:return[3,8];case 8:return this.removeAndCleanupQuery(u=this.queryViewsByTarget[e]),[4,this.localStore.releaseQuery(u.query,!0)];case 9:return a.sent(),this.syncEngineListener.onWatchError(u.query,n),[3,11];case 10:m("Unexpected target state: "+t),a.label=11;case 11:return[2]}var c}))}))},e.prototype.applyActiveTargetsChange=function(e,t){return a.__awaiter(this,void 0,void 0,(function(){var n,r,o,i,s,u,c,l,h,f=this;return a.__generator(this,(function(d){switch(d.label){case 0:if(!this.isPrimary)return[2];n=0,r=e,d.label=1;case 1:return n<r.length?(g(!this.queryViewsByTarget[h=r[n]],"Trying to add an already active target"),[4,this.localStore.getQueryForTarget(h)]):[3,6];case 2:return g(!!(o=d.sent()),"Query data for active target "+h+" not found"),[4,this.localStore.allocateQuery(o)];case 3:return i=d.sent(),[4,this.initializeViewAndComputeSnapshot(i,!1)];case 4:d.sent(),this.remoteStore.listen(i),d.label=5;case 5:return n++,[3,1];case 6:s=function(e){var t;return a.__generator(this,(function(n){switch(n.label){case 0:return(t=u.queryViewsByTarget[e])?[4,u.localStore.releaseQuery(t.query,!1).then((function(){f.remoteStore.unlisten(e),f.removeAndCleanupQuery(t)})).catch(On)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))},u=this,c=0,l=t,d.label=7;case 7:return c<l.length?[5,s(h=l[c])]:[3,10];case 8:d.sent(),d.label=9;case 9:return c++,[3,7];case 10:return[2]}}))}))},e.prototype.enableNetwork=function(){return this.localStore.setNetworkEnabled(!0),this.remoteStore.enableNetwork()},e.prototype.disableNetwork=function(){return this.localStore.setNetworkEnabled(!1),this.remoteStore.disableNetwork()},e.prototype.getRemoteKeysForTarget=function(e){var t=this.limboResolutionsByTarget[e];return t&&t.receivedDocument?Me().add(t.key):this.queryViewsByTarget[e]?this.queryViewsByTarget[e].view.syncedDocuments:Me()},e}(),go=function(){function e(e){this.uid=e}return e.prototype.isAuthenticated=function(){return null!=this.uid},e.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},e.prototype.isEqual=function(e){return e.uid===this.uid},e.UNAUTHENTICATED=new e(null),e.GOOGLE_CREDENTIALS=new e("google-credentials-uid"),e.FIRST_PARTY=new e("first-party-uid"),e}(),bo="SharedClientState",_o=function(){function e(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r,g(void 0!==r==("rejected"===n),"MutationMetadata must contain an error iff state is 'rejected'")}return e.fromWebStorageEntry=function(t,n,r){var o=JSON.parse(r),i="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error),a=void 0;return i&&o.error&&(i="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(a=new C(o.error.code,o.error.message)),i?new e(t,n,o.state,a):(y(bo,"Failed to parse mutation state for ID '"+n+"': "+r),null)},e.prototype.toWebStorageJSON=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},e}(),wo=function(){function e(e,t,n){this.targetId=e,this.state=t,this.error=n,g(void 0!==n==("rejected"===t),"QueryTargetMetadata must contain an error iff state is 'rejected'")}return e.fromWebStorageEntry=function(t,n){var r=JSON.parse(n),o="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),i=void 0;return o&&r.error&&(o="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(i=new C(r.error.code,r.error.message)),o?new e(t,r.state,i):(y(bo,"Failed to parse target state for ID '"+t+"': "+n),null)},e.prototype.toWebStorageJSON=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},e}(),Co=function(){function e(e,t){this.clientId=e,this.activeTargetIds=t}return e.fromWebStorageEntry=function(t,n){for(var r=JSON.parse(n),o="object"==typeof r&&r.activeTargetIds instanceof Array,i=Le(),a=0;o&&a<r.activeTargetIds.length;++a)o=er(r.activeTargetIds[a]),i=i.add(r.activeTargetIds[a]);return o?new e(t,i):(y(bo,"Failed to parse client data for instance '"+t+"': "+n),null)},e}(),ko=function(){function e(e,t){this.clientId=e,this.onlineState=t}return e.fromWebStorageEntry=function(t){var n=JSON.parse(t);return"object"==typeof n&&n.onlineState in ur&&"string"==typeof n.clientId?new e(n.clientId,ur[n.onlineState]):(y(bo,"Failed to parse online state: "+t),null)},e}(),So=function(){function e(){this.activeTargetIds=Le()}return e.prototype.addQueryTarget=function(e){g(!this.activeTargetIds.has(e),"Target with ID '"+e+"' already active."),this.activeTargetIds=this.activeTargetIds.add(e)},e.prototype.removeQueryTarget=function(e){this.activeTargetIds=this.activeTargetIds.delete(e)},e.prototype.toWebStorageJSON=function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)},e}(),Eo=function(){function e(t,n,r,o,i){if(this.queue=t,this.platform=n,this.persistenceKey=r,this.localClientId=o,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.activeClients={},this.storageListener=this.handleWebStorageEvent.bind(this),this.started=!1,this.earlyEvents=[],!e.isAvailable(this.platform))throw new C(w.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=i,this.localClientStorageKey=this.toWebStorageClientStateKey(this.localClientId),this.sequenceNumberKey="firestore_sequence_number_"+r,this.activeClients[this.localClientId]=new So,this.clientStateKeyRe=new RegExp("^firestore_clients_"+a+"_([^_]*)$"),this.mutationBatchKeyRe=new RegExp("^firestore_mutations_"+a+"_(\\d+)(?:_(.*))?$"),this.queryTargetKeyRe=new RegExp("^firestore_targets_"+a+"_(\\d+)$"),this.onlineStateKey="firestore_online_state_"+r,this.platform.window.addEventListener("storage",this.storageListener)}return e.isAvailable=function(e){return!(!e.window||null==e.window.localStorage)},e.prototype.start=function(){return a.__awaiter(this,void 0,void 0,(function(){var e,t,n,r,o,i,s,u,c,l,h=this;return a.__generator(this,(function(a){switch(a.label){case 0:return g(!this.started,"WebStorageSharedClientState already started"),g(null!==this.syncEngine,"syncEngine property must be set before calling start()"),g(null!==this.onlineStateHandler,"onlineStateHandler property must be set before calling start()"),[4,this.syncEngine.getActiveClients()];case 1:for(e=a.sent(),t=0,n=e;t<n.length;t++)(r=n[t])!==this.localClientId&&(o=this.getItem(this.toWebStorageClientStateKey(r)))&&(i=Co.fromWebStorageEntry(r,o))&&(this.activeClients[i.clientId]=i);for(this.persistClientState(),(s=this.storage.getItem(this.onlineStateKey))&&(u=this.fromWebStorageOnlineState(s))&&this.handleOnlineStateEvent(u),c=0,l=this.earlyEvents;c<l.length;c++)this.handleWebStorageEvent(l[c]);return this.earlyEvents=[],this.platform.window.addEventListener("unload",(function(){return h.shutdown()})),this.started=!0,[2]}}))}))},e.prototype.writeSequenceNumber=function(e){this.setItem(this.sequenceNumberKey,JSON.stringify(e))},e.prototype.getAllActiveQueryTargets=function(){var e=Le();return I(this.activeClients,(function(t,n){e=e.unionWith(n.activeTargetIds)})),e},e.prototype.isActiveQueryTarget=function(e){for(var t in this.activeClients)if(this.activeClients.hasOwnProperty(t)&&this.activeClients[t].activeTargetIds.has(e))return!0;return!1},e.prototype.addPendingMutation=function(e){this.persistMutationState(e,"pending")},e.prototype.updateMutationState=function(e,t,n){this.persistMutationState(e,t,n),this.removeMutationState(e)},e.prototype.addLocalQueryTarget=function(e){var t="not-current";if(this.isActiveQueryTarget(e)){var n=this.storage.getItem(this.toWebStorageQueryTargetMetadataKey(e));if(n){var r=wo.fromWebStorageEntry(e,n);r&&(t=r.state)}}return this.localClientState.addQueryTarget(e),this.persistClientState(),t},e.prototype.removeLocalQueryTarget=function(e){this.localClientState.removeQueryTarget(e),this.persistClientState()},e.prototype.isLocalQueryTarget=function(e){return this.localClientState.activeTargetIds.has(e)},e.prototype.clearQueryState=function(e){this.removeItem(this.toWebStorageQueryTargetMetadataKey(e))},e.prototype.updateQueryState=function(e,t,n){this.persistQueryTargetState(e,t,n)},e.prototype.handleUserChange=function(e,t,n){var r=this;t.forEach((function(e){r.removeMutationState(e)})),this.currentUser=e,n.forEach((function(e){r.addPendingMutation(e)}))},e.prototype.setOnlineState=function(e){this.persistOnlineState(e)},e.prototype.shutdown=function(){this.started&&(this.platform.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)},e.prototype.getItem=function(e){var t=this.storage.getItem(e);return p(bo,"READ",e,t),t},e.prototype.setItem=function(e,t){p(bo,"SET",e,t),this.storage.setItem(e,t)},e.prototype.removeItem=function(e){p(bo,"REMOVE",e),this.storage.removeItem(e)},e.prototype.handleWebStorageEvent=function(e){var t=this;if(e.storageArea===this.storage){if(p(bo,"EVENT",e.key,e.newValue),e.key===this.localClientStorageKey)return void y("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.queue.enqueueAndForget((function(){return a.__awaiter(t,void 0,void 0,(function(){var t,n,r,o,i,s;return a.__generator(this,(function(a){if(!this.started)return this.earlyEvents.push(e),[2];if(null===e.key)return[2];if(this.clientStateKeyRe.test(e.key)){if(null==e.newValue)return n=this.fromWebStorageClientStateKey(e.key),[2,this.handleClientStateEvent(n,null)];if(t=this.fromWebStorageClientState(e.key,e.newValue))return[2,this.handleClientStateEvent(t.clientId,t)]}else if(this.mutationBatchKeyRe.test(e.key)){if(null!==e.newValue&&(r=this.fromWebStorageMutationMetadata(e.key,e.newValue)))return[2,this.handleMutationBatchEvent(r)]}else if(this.queryTargetKeyRe.test(e.key)){if(null!==e.newValue&&(o=this.fromWebStorageQueryTargetMetadata(e.key,e.newValue)))return[2,this.handleQueryTargetEvent(o)]}else if(e.key===this.onlineStateKey){if(null!==e.newValue&&(i=this.fromWebStorageOnlineState(e.newValue)))return[2,this.handleOnlineStateEvent(i)]}else e.key===this.sequenceNumberKey&&(g(!!this.sequenceNumberHandler,"Missing sequenceNumberHandler"),(s=function(e){var t=oe.INVALID;if(null!=e)try{var n=JSON.parse(e);g("number"==typeof n,"Found non-numeric sequence number"),t=n}catch(r){y(bo,"Failed to read sequence number from WebStorage",r)}return t}(e.newValue))!==oe.INVALID&&this.sequenceNumberHandler(s));return[2]}))}))}))}},Object.defineProperty(e.prototype,"localClientState",{get:function(){return this.activeClients[this.localClientId]},enumerable:!0,configurable:!0}),e.prototype.persistClientState=function(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())},e.prototype.persistMutationState=function(e,t,n){var r=new _o(this.currentUser,e,t,n),o=this.toWebStorageMutationBatchKey(e);this.setItem(o,r.toWebStorageJSON())},e.prototype.removeMutationState=function(e){var t=this.toWebStorageMutationBatchKey(e);this.removeItem(t)},e.prototype.persistOnlineState=function(e){this.storage.setItem(this.onlineStateKey,JSON.stringify({clientId:this.localClientId,onlineState:ur[e]}))},e.prototype.persistQueryTargetState=function(e,t,n){var r=this.toWebStorageQueryTargetMetadataKey(e),o=new wo(e,t,n);this.setItem(r,o.toWebStorageJSON())},e.prototype.toWebStorageClientStateKey=function(e){return g(-1===e.indexOf("_"),"Client key cannot contain '_', but was '"+e+"'"),"firestore_clients_"+this.persistenceKey+"_"+e},e.prototype.toWebStorageQueryTargetMetadataKey=function(e){return"firestore_targets_"+this.persistenceKey+"_"+e},e.prototype.toWebStorageMutationBatchKey=function(e){var t="firestore_mutations_"+this.persistenceKey+"_"+e;return this.currentUser.isAuthenticated()&&(t+="_"+this.currentUser.uid),t},e.prototype.fromWebStorageClientStateKey=function(e){var t=this.clientStateKeyRe.exec(e);return t?t[1]:null},e.prototype.fromWebStorageClientState=function(e,t){var n=this.fromWebStorageClientStateKey(e);return g(null!==n,"Cannot parse client state key '"+e+"'"),Co.fromWebStorageEntry(n,t)},e.prototype.fromWebStorageMutationMetadata=function(e,t){var n=this.mutationBatchKeyRe.exec(e);g(null!==n,"Cannot parse mutation batch key '"+e+"'");var r=Number(n[1]);return _o.fromWebStorageEntry(new go(void 0!==n[2]?n[2]:null),r,t)},e.prototype.fromWebStorageQueryTargetMetadata=function(e,t){var n=this.queryTargetKeyRe.exec(e);g(null!==n,"Cannot parse query target key '"+e+"'");var r=Number(n[1]);return wo.fromWebStorageEntry(r,t)},e.prototype.fromWebStorageOnlineState=function(e){return ko.fromWebStorageEntry(e)},e.prototype.handleMutationBatchEvent=function(e){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){return e.user.uid!==this.currentUser.uid?(p(bo,"Ignoring mutation for non-active user "+e.user.uid),[2]):[2,this.syncEngine.applyBatchState(e.batchId,e.state,e.error)]}))}))},e.prototype.handleQueryTargetEvent=function(e){return this.syncEngine.applyTargetState(e.targetId,e.state,e.error)},e.prototype.handleClientStateEvent=function(e,t){var n=this,r=this.getAllActiveQueryTargets();t?this.activeClients[e]=t:delete this.activeClients[e];var o=this.getAllActiveQueryTargets(),i=[],s=[];return o.forEach((function(e){return a.__awaiter(n,void 0,void 0,(function(){return a.__generator(this,(function(t){return r.has(e)||i.push(e),[2]}))}))})),r.forEach((function(e){return a.__awaiter(n,void 0,void 0,(function(){return a.__generator(this,(function(t){return o.has(e)||s.push(e),[2]}))}))})),this.syncEngine.applyActiveTargetsChange(i,s)},e.prototype.handleOnlineStateEvent=function(e){this.activeClients[e.clientId]&&this.onlineStateHandler(e.onlineState)},e}(),To=function(){function e(){this.localState=new So,this.queryState={},this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null}return e.prototype.addPendingMutation=function(e){},e.prototype.updateMutationState=function(e,t,n){},e.prototype.addLocalQueryTarget=function(e){return this.localState.addQueryTarget(e),this.queryState[e]||"not-current"},e.prototype.updateQueryState=function(e,t,n){this.queryState[e]=t},e.prototype.removeLocalQueryTarget=function(e){this.localState.removeQueryTarget(e)},e.prototype.isLocalQueryTarget=function(e){return this.localState.activeTargetIds.has(e)},e.prototype.clearQueryState=function(e){delete this.queryState[e]},e.prototype.getAllActiveQueryTargets=function(){return this.localState.activeTargetIds},e.prototype.isActiveQueryTarget=function(e){return this.localState.activeTargetIds.has(e)},e.prototype.start=function(){return this.localState=new So,Promise.resolve()},e.prototype.handleUserChange=function(e,t,n){},e.prototype.setOnlineState=function(e){},e.prototype.shutdown=function(){},e.prototype.writeSequenceNumber=function(e){},e}(),Io=function(){function e(e,t){this.cacheSizeBytes=e,this.synchronizeTabs=t}return e.prototype.lruParams=function(){return En.withCacheSize(this.cacheSizeBytes)},e}(),Ao=function(){},Do=function(){function e(e,t,n,r){this.platform=e,this.databaseInfo=t,this.credentials=n,this.asyncQueue=r,this.clientId=K.newId()}return e.prototype.start=function(e){var t=this;this.verifyNotTerminated();var n=new le,r=new le,o=!1;return this.credentials.setChangeListener((function(i){o?t.asyncQueue.enqueueAndForget((function(){return t.handleCredentialChange(i)})):(o=!0,t.initializePersistence(e,r,i).then((function(e){return t.initializeRest(i,e)})).then(n.resolve,n.reject))})),this.asyncQueue.enqueueAndForget((function(){return n.promise})),r.promise},e.prototype.enableNetwork=function(){var e=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return e.syncEngine.enableNetwork()}))},e.prototype.initializePersistence=function(e,t,n){var r=this;return e instanceof Io?this.startIndexedDbPersistence(n,e).then((function(e){return t.resolve(),e})).catch((function(e){if(t.reject(e),!r.canFallback(e))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),r.startMemoryPersistence()})):(t.resolve(),this.startMemoryPersistence())},e.prototype.canFallback=function(e){return e instanceof C?e.code===w.FAILED_PRECONDITION||e.code===w.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code},e.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new C(w.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.startIndexedDbPersistence=function(e,t){var n=this,r=xn.buildStoragePrefix(this.databaseInfo),o=new io(this.databaseInfo.databaseId,{useProto3Json:!0});return Promise.resolve().then((function(){return a.__awaiter(n,void 0,void 0,(function(){var n,i;return a.__generator(this,(function(a){switch(a.label){case 0:if(t.synchronizeTabs&&!Eo.isAvailable(this.platform))throw new C(w.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");return n=t.lruParams(),this.sharedClientState=t.synchronizeTabs?new Eo(this.asyncQueue,this.platform,r,this.clientId,e):new To,[4,xn.createIndexedDbPersistence({allowTabSynchronization:t.synchronizeTabs,persistenceKey:r,clientId:this.clientId,platform:this.platform,queue:this.asyncQueue,serializer:o,lruParams:n,sequenceNumberSyncer:this.sharedClientState})];case 1:return i=a.sent(),this.persistence=i,[2,i.referenceDelegate.garbageCollector]}}))}))}))},e.prototype.startMemoryPersistence=function(){return this.persistence=Wn.createEagerPersistence(this.clientId),this.sharedClientState=new To,Promise.resolve(null)},e.prototype.initializeRest=function(e,t){var n=this;return p("FirestoreClient","Initializing. user=",e.uid),this.platform.loadConnection(this.databaseInfo).then((function(r){return a.__awaiter(n,void 0,void 0,(function(){var n,o,i,s,u=this;return a.__generator(this,(function(c){switch(c.label){case 0:return this.localStore=new jn(this.persistence,e),t&&(this.lruScheduler=new Tn(t,this.asyncQueue,this.localStore)),n=this.platform.newConnectivityMonitor(),o=this.platform.newSerializer(this.databaseInfo.databaseId),i=new ar(this.asyncQueue,r,this.credentials,o),s=function(e){return u.syncEngine.applyOnlineStateChange(e,cr.SharedClientState)},this.remoteStore=new Nr(this.localStore,i,this.asyncQueue,(function(e){return u.syncEngine.applyOnlineStateChange(e,cr.RemoteStore)}),n),this.syncEngine=new mo(this.localStore,this.remoteStore,this.sharedClientState,e),this.sharedClientState.onlineStateHandler=s,this.remoteStore.syncEngine=this.syncEngine,this.sharedClientState.syncEngine=this.syncEngine,this.eventMgr=new so(this.syncEngine),[4,this.sharedClientState.start()];case 1:return c.sent(),[4,this.remoteStore.start()];case 2:return c.sent(),[4,this.persistence.setPrimaryStateListener((function(e){return a.__awaiter(u,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return[4,this.syncEngine.applyPrimaryState(e)];case 1:return t.sent(),this.lruScheduler&&(e&&!this.lruScheduler.started?this.lruScheduler.start():e||this.lruScheduler.stop()),[2]}}))}))}))];case 3:return c.sent(),[4,this.persistence.setDatabaseDeletedListener((function(){return a.__awaiter(u,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return[4,this.terminate()];case 1:return e.sent(),[2]}}))}))}))];case 4:return c.sent(),[2]}}))}))}))},e.prototype.handleCredentialChange=function(e){return this.asyncQueue.verifyOperationInProgress(),p("FirestoreClient","Credential Changed. Current user: "+e.uid),this.syncEngine.handleCredentialChange(e)},e.prototype.disableNetwork=function(){var e=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return e.syncEngine.disableNetwork()}))},e.prototype.terminate=function(){var e=this;return this.asyncQueue.enqueueAndInitiateShutdown((function(){return a.__awaiter(e,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return this.lruScheduler&&this.lruScheduler.stop(),[4,this.remoteStore.shutdown()];case 1:return e.sent(),[4,this.sharedClientState.shutdown()];case 2:return e.sent(),[4,this.persistence.shutdown()];case 3:return e.sent(),this.credentials.removeChangeListener(),[2]}}))}))}))},e.prototype.waitForPendingWrites=function(){var e=this;this.verifyNotTerminated();var t=new le;return this.asyncQueue.enqueueAndForget((function(){return e.syncEngine.registerPendingWritesCallback(t)})),t.promise},e.prototype.listen=function(e,t,n){var r=this;this.verifyNotTerminated();var o=new uo(e,t,n);return this.asyncQueue.enqueueAndForget((function(){return r.eventMgr.listen(o)})),o},e.prototype.unlisten=function(e){var t=this;this.clientTerminated||this.asyncQueue.enqueueAndForget((function(){return t.eventMgr.unlisten(e)}))},e.prototype.getDocumentFromLocalCache=function(e){var t=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return t.localStore.readDocument(e)})).then((function(e){if(e instanceof Ft)return e;if(e instanceof Vt)return null;throw new C(w.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")}))},e.prototype.getDocumentsFromLocalCache=function(e){var t=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return t.localStore.executeQuery(e)})).then((function(t){var n=Me(),r=new fo(e,n),o=r.computeDocChanges(t);return r.applyChanges(o,!1).snapshot}))},e.prototype.write=function(e){var t=this;this.verifyNotTerminated();var n=new le;return this.asyncQueue.enqueueAndForget((function(){return t.syncEngine.write(e,n)})),n.promise},e.prototype.databaseId=function(){return this.databaseInfo.databaseId},e.prototype.addSnapshotsInSyncListener=function(e){var t=this;this.verifyNotTerminated(),this.asyncQueue.enqueueAndForget((function(){return t.eventMgr.addSnapshotsInSyncListener(e),Promise.resolve()}))},e.prototype.removeSnapshotsInSyncListener=function(e){this.clientTerminated||this.eventMgr.removeSnapshotsInSyncListener(e)},Object.defineProperty(e.prototype,"clientTerminated",{get:function(){return this.asyncQueue.isShuttingDown},enumerable:!0,configurable:!0}),e.prototype.transaction=function(e){var t=this;this.verifyNotTerminated();var n=new le;return this.asyncQueue.enqueueAndForget((function(){return t.syncEngine.runTransaction(t.asyncQueue,e,n),Promise.resolve()})),n.promise},e}(),No=function(){function e(e){this.observer=e,this.muted=!1}return e.prototype.next=function(e){this.scheduleEvent(this.observer.next,e)},e.prototype.error=function(e){this.scheduleEvent(this.observer.error,e)},e.prototype.mute=function(){this.muted=!0},e.prototype.scheduleEvent=function(e,t){var n=this;this.muted||setTimeout((function(){n.muted||e(t)}),0)},e}(),Po=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];O("FieldPath",e,"fieldNames",1);for(var n=0;n<e.length;++n)if(M("FieldPath","string",n,e[n]),0===e[n].length)throw new C(w.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ue(e)}return e.documentId=function(){return e._DOCUMENT_ID},e.prototype.isEqual=function(t){if(!(t instanceof e))throw W("isEqual","FieldPath",1,t);return this._internalPath.isEqual(t._internalPath)},e._DOCUMENT_ID=new e(ue.keyField().canonicalString()),e}(),xo=new RegExp("[~\\*/\\[\\]]"),Oo=function(e,t){this.user=t,this.type="OAuth",this.authHeaders={Authorization:"Bearer "+e}},Mo=function(){function e(){this.changeListener=null}return e.prototype.getToken=function(){return Promise.resolve(null)},e.prototype.invalidateToken=function(){},e.prototype.setChangeListener=function(e){g(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=e,e(go.UNAUTHENTICATED)},e.prototype.removeChangeListener=function(){g(null!==this.changeListener,"removeChangeListener() when no listener registered"),this.changeListener=null},e}(),Ro=function(){function e(e){var t=this;this.app=e,this.tokenListener=null,this.currentUser=go.UNAUTHENTICATED,this.tokenCounter=0,this.changeListener=null,this.forceRefresh=!1,this.tokenListener=function(){t.tokenCounter++,t.currentUser=t.getUser(),t.changeListener&&t.changeListener(t.currentUser)},this.currentUser=this.getUser(),this.tokenCounter=0,this.app.INTERNAL.addAuthTokenListener(this.tokenListener)}return e.prototype.getToken=function(){var e=this;g(null!=this.tokenListener,"getToken cannot be called after listener removed.");var t=this.tokenCounter,n=this.forceRefresh;return this.forceRefresh=!1,this.app.INTERNAL.getToken(n).then((function(n){if(e.tokenCounter!==t)throw new C(w.ABORTED,"getToken aborted due to token change.");return n?(g("string"==typeof n.accessToken,"Invalid tokenData returned from getToken():"+n),new Oo(n.accessToken,e.currentUser)):null}))},e.prototype.invalidateToken=function(){this.forceRefresh=!0},e.prototype.setChangeListener=function(e){g(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=e,e(this.currentUser)},e.prototype.removeChangeListener=function(){g(null!=this.tokenListener,"removeChangeListener() called twice"),g(null!==this.changeListener,"removeChangeListener() called when no listener registered"),this.app.INTERNAL.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.changeListener=null},e.prototype.getUser=function(){var e=this.app.INTERNAL.getUid();return g(null===e||"string"==typeof e,"Received invalid UID: "+e),new go(e)},e}(),Lo=function(){function e(e,t){this.gapi=e,this.sessionIndex=t,this.type="FirstParty",this.user=go.FIRST_PARTY}return Object.defineProperty(e.prototype,"authHeaders",{get:function(){var e={"X-Goog-AuthUser":this.sessionIndex},t=this.gapi.auth.getAuthHeaderValueForFirstParty([]);return t&&(e.Authorization=t),e},enumerable:!0,configurable:!0}),e}(),Fo=function(){function e(e,t){this.gapi=e,this.sessionIndex=t}return e.prototype.getToken=function(){return Promise.resolve(new Lo(this.gapi,this.sessionIndex))},e.prototype.setChangeListener=function(e){e(go.FIRST_PARTY)},e.prototype.removeChangeListener=function(){},e.prototype.invalidateToken=function(){},e}();function Vo(e){if(!e)return new Mo;switch(e.type){case"gapi":var t=e.client;return g(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new Fo(t,e.sessionIndex||"0");case"provider":return e.client;default:throw new C(w.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}function Bo(e){return function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=e,r=0,o=["next","error","complete"];r<o.length;r++){var i=o[r];if(i in n&&"function"==typeof n[i])return!0}return!1}(e)}var qo=function(){function e(e){this._methodName=e}return e.delete=function(){return D("FieldValue.delete",arguments),jo.instance},e.serverTimestamp=function(){return D("FieldValue.serverTimestamp",arguments),Uo.instance},e.arrayUnion=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return P("FieldValue.arrayUnion",arguments,1),new Go(e)},e.arrayRemove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return P("FieldValue.arrayRemove",arguments,1),new zo(e)},e.increment=function(e){return M("FieldValue.increment","number",1,e),N("FieldValue.increment",arguments,1),new Wo(e)},e.prototype.isEqual=function(e){return this===e},e}(),jo=function(e){function t(){return e.call(this,"FieldValue.delete")||this}return a.__extends(t,e),t.instance=new t,t}(qo),Uo=function(e){function t(){return e.call(this,"FieldValue.serverTimestamp")||this}return a.__extends(t,e),t.instance=new t,t}(qo),Go=function(e){function t(t){var n=e.call(this,"FieldValue.arrayUnion")||this;return n._elements=t,n}return a.__extends(t,e),t}(qo),zo=function(e){function t(t){var n=e.call(this,"FieldValue.arrayRemove")||this;return n._elements=t,n}return a.__extends(t,e),t}(qo),Wo=function(e){function t(t){var n=e.call(this,"FieldValue.increment")||this;return n._operand=t,n}return a.__extends(t,e),t}(qo),Ho=k(qo,"Use FieldValue.<field>() instead."),Qo=/^__.*__$/,Ko=function(){function e(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}return e.prototype.toMutations=function(e,t){var n=[];return n.push(null!==this.fieldMask?new yt(e,this.data,this.fieldMask,t):new pt(e,this.data,t)),this.fieldTransforms.length>0&&n.push(new vt(e,this.fieldTransforms)),n},e}(),Yo=function(){function e(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}return e.prototype.toMutations=function(e,t){var n=[new yt(e,this.data,this.fieldMask,t)];return this.fieldTransforms.length>0&&n.push(new vt(e,this.fieldTransforms)),n},e}(),Jo=function(e){return e[e.Set=0]="Set",e[e.Update=1]="Update",e[e.MergeSet=2]="MergeSet",e[e.Argument=3]="Argument",e}({});function $o(e){switch(e){case Jo.Set:case Jo.MergeSet:case Jo.Update:return!0;case Jo.Argument:return!1;default:throw m("Unexpected case for UserDataSource: "+e)}}var Zo=function(){function e(e,t,n,r,o,i){this.dataSource=e,this.methodName=t,this.path=n,this.arrayElement=r,void 0===o&&this.validatePath(),this.arrayElement=void 0!==r&&r,this.fieldTransforms=o||[],this.fieldMask=i||[]}return e.prototype.childContextForField=function(t){var n=null==this.path?null:this.path.child(t),r=new e(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePathSegment(t),r},e.prototype.childContextForFieldPath=function(t){var n=null==this.path?null:this.path.child(t),r=new e(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePath(),r},e.prototype.childContextForArray=function(t){return new e(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},e.prototype.createError=function(e){var t=null===this.path||this.path.isEmpty()?"":" (found in field "+this.path.toString()+")";return new C(w.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+e+t)},e.prototype.contains=function(e){return void 0!==this.fieldMask.find((function(t){return e.isPrefixOf(t)}))||void 0!==this.fieldTransforms.find((function(t){return e.isPrefixOf(t.field)}))},e.prototype.validatePath=function(){if(null!==this.path)for(var e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))},e.prototype.validatePathSegment=function(e){if($o(this.dataSource)&&Qo.test(e))throw this.createError("Document fields cannot begin and end with __")},e}(),Xo=function(e,t){this.databaseId=e,this.key=t},ei=function(){function e(e){this.preConverter=e}return e.prototype.parseSetData=function(e,t){var n=new Zo(Jo.Set,e,ue.EMPTY_PATH);ni("Data must be an object, but it was:",n,t);var r=this.parseData(t,n);return new Ko(r,null,n.fieldTransforms)},e.prototype.parseMergeData=function(e,t,n){var r=new Zo(Jo.MergeSet,e,ue.EMPTY_PATH);ni("Data must be an object, but it was:",r,t);var o,i,a=this.parseData(t,r);if(n){for(var s=new Se(ue.comparator),u=0,c=n;u<c.length;u++){var l=c[u],h=void 0;if(l instanceof Po)h=l._internalPath;else{if("string"!=typeof l)throw m("Expected stringOrFieldPath to be a string or a FieldPath");h=oi(e,l)}if(!r.contains(h))throw new C(w.INVALID_ARGUMENT,"Field '"+h+"' is specified in your field mask but missing from your input data.");s=s.add(h)}o=ut.fromSet(s),i=r.fieldTransforms.filter((function(e){return o.covers(e.field)}))}else o=ut.fromArray(r.fieldMask),i=r.fieldTransforms;return new Ko(a,o,i)},e.prototype.parseUpdateData=function(e,t){var n=this,r=new Zo(Jo.Update,e,ue.EMPTY_PATH);ni("Data must be an object, but it was:",r,t);var o=new Se(ue.comparator),i=Mt.EMPTY;I(t,(function(t,a){var s=oi(e,t),u=r.childContextForFieldPath(s);if((a=n.runPreConverter(a,u))instanceof jo)o=o.add(s);else{var c=n.parseData(a,u);null!=c&&(o=o.add(s),i=i.set(s,c))}}));var a=ut.fromSet(o);return new Yo(i,a,r.fieldTransforms)},e.prototype.parseUpdateVarargs=function(e,t,n,r){var o=new Zo(Jo.Update,e,ue.EMPTY_PATH),i=[ri(e,t)],a=[n];if(r.length%2!=0)throw new C(w.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var s=0;s<r.length;s+=2)i.push(ri(e,r[s])),a.push(r[s+1]);var u=new Se(ue.comparator),c=Mt.EMPTY;for(s=0;s<i.length;++s){var l=i[s],h=o.childContextForFieldPath(l),f=this.runPreConverter(a[s],h);if(f instanceof jo)u=u.add(l);else{var d=this.parseData(f,h);null!=d&&(u=u.add(l),c=c.set(l,d))}}var p=ut.fromSet(u);return new Yo(c,p,o.fieldTransforms)},e.prototype.parseQueryValue=function(e,t){var n=new Zo(Jo.Argument,e,ue.EMPTY_PATH),r=this.parseData(t,n);return g(null!=r,"Parsed data should not be null."),g(0===n.fieldTransforms.length,"Field transforms should have been disallowed."),r},e.prototype.runPreConverter=function(e,t){try{return this.preConverter(e)}catch(r){var n=ii(r);throw t.createError(n)}},e.prototype.parseData=function(e,t){if(ti(e=this.runPreConverter(e,t)))return ni("Unsupported field value:",t,e),this.parseObject(e,t);if(e instanceof qo)return this.parseSentinelFieldValue(e,t),null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.arrayElement)throw t.createError("Nested arrays are not supported");return this.parseArray(e,t)}return this.parseScalarValue(e,t)},e.prototype.parseObject=function(e,t){var n=this,r=new _e(Y);return A(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):I(e,(function(e,o){var i=n.parseData(o,t.childContextForField(e));null!=i&&(r=r.insert(e,i))})),new Mt(r)},e.prototype.parseArray=function(e,t){for(var n=[],r=0,o=0,i=e;o<i.length;o++){var a=this.parseData(i[o],t.childContextForArray(r));null==a&&(a=Ct.INSTANCE),n.push(a),r++}return new Rt(n)},e.prototype.parseSentinelFieldValue=function(e,t){if(!$o(t.dataSource))throw t.createError(e._methodName+"() can only be used with update() and set()");if(null===t.path)throw t.createError(e._methodName+"() is not currently supported inside arrays");if(e instanceof jo){if(t.dataSource!==Jo.MergeSet)throw t.dataSource===Jo.Update?(g(t.path.length>0,"FieldValue.delete() at the top level should have already been handled."),t.createError("FieldValue.delete() can only appear at the top level of your update data")):t.createError("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");t.fieldMask.push(t.path)}else if(e instanceof Uo)t.fieldTransforms.push(new ct(t.path,Hr.instance));else if(e instanceof Go){var n=this.parseArrayTransformElements(e._methodName,e._elements),r=new Qr(n);t.fieldTransforms.push(new ct(t.path,r))}else if(e instanceof zo){n=this.parseArrayTransformElements(e._methodName,e._elements);var o=new Kr(n);t.fieldTransforms.push(new ct(t.path,o))}else if(e instanceof Wo){var i=this.parseQueryValue("FieldValue.increment",e._operand),a=new Yr(i);t.fieldTransforms.push(new ct(t.path,a))}else m("Unknown FieldValue type: "+e)},e.prototype.parseScalarValue=function(e,t){if(null===e)return Ct.INSTANCE;if("number"==typeof e)return er(e)?new Tt(e):new It(e);if("boolean"==typeof e)return kt.of(e);if("string"==typeof e)return new At(e);if(e instanceof Date)return new Dt(ge.fromDate(e));if(e instanceof ge)return new Dt(new ge(e.seconds,1e3*Math.floor(e.nanoseconds/1e3)));if(e instanceof Pr)return new Ot(e);if(e instanceof ee)return new Pt(e);if(e instanceof Xo)return new xt(e.databaseId,e.key);throw t.createError("Unsupported field value: "+U(e))},e.prototype.parseArrayTransformElements=function(e,t){var n=this;return t.map((function(t,r){var o=new Zo(Jo.Argument,e,ue.EMPTY_PATH);return n.parseData(t,o.childContextForArray(r))}))},e}();function ti(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof ge||e instanceof Pr||e instanceof ee||e instanceof Xo||e instanceof qo)}function ni(e,t,n){if(!ti(n)||!j(n)){var r=U(n);throw t.createError("an object"===r?e+" a custom object":e+" "+r)}}function ri(e,t){if(t instanceof Po)return t._internalPath;if("string"==typeof t)return oi(e,t);throw new C(w.INVALID_ARGUMENT,"Function "+e+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function oi(e,t){try{return function(e){if(e.search(xo)>=0)throw new C(w.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Po.bind.apply(Po,[void 0].concat(e.split("."))))}catch(t){throw new C(w.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(t)._internalPath}catch(r){var n=ii(r);throw new C(w.INVALID_ARGUMENT,"Function "+e+"() called with invalid data. "+n)}}function ii(e){return e instanceof Error?e.message:e.toString()}var ai=En.COLLECTION_DISABLED,si=function(){function e(e){if(void 0===e.host){if(void 0!==e.ssl)throw new C(w.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else L("settings","non-empty string","host",e.host),this.host=e.host,F("settings","boolean","ssl",e.ssl),this.ssl=E(e.ssl,!0);if(z("settings",e,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),F("settings","object","credentials",e.credentials),this.credentials=e.credentials,F("settings","boolean","timestampsInSnapshots",e.timestampsInSnapshots),!0===e.timestampsInSnapshots?y("\n  The timestampsInSnapshots setting now defaults to true and you no\n  longer need to explicitly set it. In a future release, the setting\n  will be removed entirely and so it is recommended that you remove it\n  from your firestore.settings() call now."):!1===e.timestampsInSnapshots&&y("\n  The timestampsInSnapshots setting will soon be removed. YOU MUST UPDATE\n  YOUR CODE.\n\n  To hide this warning, stop using the timestampsInSnapshots setting in your\n  firestore.settings({ ... }) call.\n\n  Once you remove the setting, Timestamps stored in Cloud Firestore will be\n  read back as Firebase Timestamp objects instead of as system Date objects.\n  So you will also need to update code expecting a Date to instead expect a\n  Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at'); const date =\n  timestamp.toDate();\n\n  Please audit all existing usages of Date when you enable the new\n  behavior."),this.timestampsInSnapshots=E(e.timestampsInSnapshots,!0),F("settings","number","cacheSizeBytes",e.cacheSizeBytes),void 0===e.cacheSizeBytes)this.cacheSizeBytes=En.DEFAULT_CACHE_SIZE_BYTES;else{if(e.cacheSizeBytes!==ai&&e.cacheSizeBytes<En.MINIMUM_CACHE_SIZE_BYTES)throw new C(w.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+En.MINIMUM_CACHE_SIZE_BYTES);this.cacheSizeBytes=e.cacheSizeBytes}F("settings","boolean","experimentalForceLongPolling",e.experimentalForceLongPolling),this.forceLongPolling=void 0!==e.experimentalForceLongPolling&&e.experimentalForceLongPolling}return e.prototype.isEqual=function(e){return this.host===e.host&&this.ssl===e.ssl&&this.timestampsInSnapshots===e.timestampsInSnapshots&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.forceLongPolling===e.forceLongPolling},e}(),ui=function(){function e(t){var n=this;if(this._firebaseApp=null,this._queue=new de,this.INTERNAL={delete:function(){return a.__awaiter(n,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return this.ensureClientConfigured(),[4,this._firestoreClient.terminate()];case 1:return e.sent(),[2]}}))}))}},"object"==typeof t.options){var r=t;this._firebaseApp=r,this._databaseId=e.databaseIdFromApp(r),this._persistenceKey=r.name,this._credentials=new Ro(r)}else{var o=t;if(!o.projectId)throw new C(w.INVALID_ARGUMENT,"Must provide projectId");this._databaseId=new re(o.projectId,o.database),this._persistenceKey="[DEFAULT]",this._credentials=new Mo}this._settings=new si({}),this._dataConverter=this.createDataConverter(this._databaseId)}return e.prototype.settings=function(e){if(N("Firestore.settings",arguments,1),M("Firestore.settings","object",1,e),S(e,"persistence"))throw new C(w.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var t=new si(e);if(this._firestoreClient&&!this._settings.isEqual(t))throw new C(w.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this._settings=t,void 0!==t.credentials&&(this._credentials=Vo(t.credentials))},e.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},e.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},e.prototype.enablePersistence=function(e){if(this._firestoreClient)throw new C(w.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var t=!1;return e&&(void 0!==e.experimentalTabSynchronization&&y("The 'experimentalTabSynchronization' setting has been renamed to 'synchronizeTabs'. In a future release, the setting will be removed and it is recommended that you update your firestore.enablePersistence() call to use 'synchronizeTabs'."),t=E(void 0!==e.synchronizeTabs?e.synchronizeTabs:e.experimentalTabSynchronization,!1)),this.configureClient(new Io(this._settings.cacheSizeBytes,t))},e.prototype.clearPersistence=function(){var e=this,t=xn.buildStoragePrefix(this.makeDatabaseInfo()),n=new le;return this._queue.enqueueAndForgetEvenAfterShutdown((function(){return a.__awaiter(e,void 0,void 0,(function(){var e;return a.__generator(this,(function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),void 0!==this._firestoreClient&&!this._firestoreClient.clientTerminated)throw new C(w.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return[4,xn.clearPersistence(t)];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(e.prototype,"_isTerminated",{get:function(){return this.ensureClientConfigured(),this._firestoreClient.clientTerminated},enumerable:!0,configurable:!0}),e.prototype.waitForPendingWrites=function(){return this.ensureClientConfigured(),this._firestoreClient.waitForPendingWrites()},e.prototype._onSnapshotsInSync=function(e){return this.ensureClientConfigured(),Bo(e)?this.onSnapshotsInSyncInternal(e):(M("Firestore.onSnapshotsInSync","function",1,e),this.onSnapshotsInSyncInternal({next:e}))},e.prototype.onSnapshotsInSyncInternal=function(e){var t=this,n=new No({next:function(){e.next&&e.next()},error:function(e){throw m("Uncaught Error in onSnapshotsInSync")}});return this._firestoreClient.addSnapshotsInSyncListener(n),function(){n.mute(),t._firestoreClient.removeSnapshotsInSyncListener(n)}},e.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(new Ao),this._firestoreClient},e.prototype.makeDatabaseInfo=function(){return new ne(this._databaseId,this._persistenceKey,this._settings.host,this._settings.ssl,this._settings.forceLongPolling)},e.prototype.configureClient=function(e){g(!!this._settings.host,"FirestoreSettings.host is not set"),g(!this._firestoreClient,"configureClient() called multiple times");var t=this.makeDatabaseInfo();return this._firestoreClient=new Do(b.getPlatform(),t,this._credentials,this._queue),this._firestoreClient.start(e)},e.prototype.createDataConverter=function(e){return new ei((function(t){if(t instanceof hi){var n=e,r=t.firestore._databaseId;if(!r.isEqual(n))throw new C(w.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new Xo(e,t._key)}return t}))},e.databaseIdFromApp=function(e){var t=e.options;if(!S(t,"projectId"))throw new C(w.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var n=t.projectId;if(!n||"string"!=typeof n)throw new C(w.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new re(n)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this._firebaseApp)throw new C(w.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._firebaseApp},enumerable:!0,configurable:!0}),e.prototype.collection=function(e){return N("Firestore.collection",arguments,1),M("Firestore.collection","non-empty string",1,e),this.ensureClientConfigured(),new mi(ae.fromString(e),this)},e.prototype.doc=function(e){return N("Firestore.doc",arguments,1),M("Firestore.doc","non-empty string",1,e),this.ensureClientConfigured(),hi.forPath(ae.fromString(e),this)},e.prototype.collectionGroup=function(e){if(N("Firestore.collectionGroup",arguments,1),M("Firestore.collectionGroup","non-empty string",1,e),e.indexOf("/")>=0)throw new C(w.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.ensureClientConfigured(),new yi(new xr(ae.EMPTY_PATH,e),this)},e.prototype.runTransaction=function(e){var t=this;return N("Firestore.runTransaction",arguments,1),M("Firestore.runTransaction","function",1,e),this.ensureClientConfigured().transaction((function(n){return e(new ci(t,n))}))},e.prototype.batch=function(){return this.ensureClientConfigured(),new li(this)},Object.defineProperty(e,"logLevel",{get:function(){switch(f()){case h.DEBUG:return"debug";case h.ERROR:return"error";case h.SILENT:return"silent";default:return m("Unknown log level: "+f())}},enumerable:!0,configurable:!0}),e.setLogLevel=function(e){switch(N("Firestore.setLogLevel",arguments,1),M("Firestore.setLogLevel","non-empty string",1,e),e){case"debug":d(h.DEBUG);break;case"error":d(h.ERROR);break;case"silent":d(h.SILENT);break;default:throw new C(w.INVALID_ARGUMENT,"Invalid log level: "+e)}},e.prototype._areTimestampsInSnapshotsEnabled=function(){return this._settings.timestampsInSnapshots},e}(),ci=function(){function e(e,t){this._firestore=e,this._transaction=t}return e.prototype.get=function(e){var t=this;N("Transaction.get",arguments,1);var n=wi("Transaction.get",e,this._firestore);return this._transaction.lookup([n._key]).then((function(e){if(!e||1!==e.length)return m("Mismatch in docs returned from document lookup.");var r=e[0];if(r instanceof Vt)return new di(t._firestore,n._key,null,!1,!1);if(r instanceof Ft)return new di(t._firestore,n._key,r,!1,!1);throw m("BatchGetDocumentsRequest returned unexpected document type: "+r.constructor.name)}))},e.prototype.set=function(e,t,n){x("Transaction.set",arguments,2,3);var r=wi("Transaction.set",e,this._firestore),o=(n=gi("Transaction.set",n)).merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("Transaction.set",t,n.mergeFields):this._firestore._dataConverter.parseSetData("Transaction.set",t);return this._transaction.set(r._key,o),this},e.prototype.update=function(e,t,n){for(var r,o,i=[],a=3;a<arguments.length;a++)i[a-3]=arguments[a];return"string"==typeof t||t instanceof Po?(P("Transaction.update",arguments,3),r=wi("Transaction.update",e,this._firestore),o=this._firestore._dataConverter.parseUpdateVarargs("Transaction.update",t,n,i)):(N("Transaction.update",arguments,2),r=wi("Transaction.update",e,this._firestore),o=this._firestore._dataConverter.parseUpdateData("Transaction.update",t)),this._transaction.update(r._key,o),this},e.prototype.delete=function(e){N("Transaction.delete",arguments,1);var t=wi("Transaction.delete",e,this._firestore);return this._transaction.delete(t._key),this},e}(),li=function(){function e(e){this._firestore=e,this._mutations=[],this._committed=!1}return e.prototype.set=function(e,t,n){x("WriteBatch.set",arguments,2,3),this.verifyNotCommitted();var r=wi("WriteBatch.set",e,this._firestore),o=(n=gi("WriteBatch.set",n)).merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("WriteBatch.set",t,n.mergeFields):this._firestore._dataConverter.parseSetData("WriteBatch.set",t);return this._mutations=this._mutations.concat(o.toMutations(r._key,ft.NONE)),this},e.prototype.update=function(e,t,n){for(var r,o,i=[],a=3;a<arguments.length;a++)i[a-3]=arguments[a];return this.verifyNotCommitted(),"string"==typeof t||t instanceof Po?(P("WriteBatch.update",arguments,3),r=wi("WriteBatch.update",e,this._firestore),o=this._firestore._dataConverter.parseUpdateVarargs("WriteBatch.update",t,n,i)):(N("WriteBatch.update",arguments,2),r=wi("WriteBatch.update",e,this._firestore),o=this._firestore._dataConverter.parseUpdateData("WriteBatch.update",t)),this._mutations=this._mutations.concat(o.toMutations(r._key,ft.exists(!0))),this},e.prototype.delete=function(e){N("WriteBatch.delete",arguments,1),this.verifyNotCommitted();var t=wi("WriteBatch.delete",e,this._firestore);return this._mutations=this._mutations.concat(new mt(t._key,ft.NONE)),this},e.prototype.commit=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){return this.verifyNotCommitted(),this._committed=!0,this._mutations.length>0?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]}))}))},e.prototype.verifyNotCommitted=function(){if(this._committed)throw new C(w.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},e}(),hi=function(){function e(e,t){this._key=e,this.firestore=t,this._firestoreClient=this.firestore.ensureClientConfigured()}return e.forPath=function(t,n){if(t.length%2!=0)throw new C(w.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.canonicalString()+" has "+t.length);return new e(new ce(t),n)},Object.defineProperty(e.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new mi(this._key.path.popLast(),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),e.prototype.collection=function(e){if(N("DocumentReference.collection",arguments,1),M("DocumentReference.collection","non-empty string",1,e),!e)throw new C(w.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var t=ae.fromString(e);return new mi(this._key.path.child(t),this.firestore)},e.prototype.isEqual=function(t){if(!(t instanceof e))throw W("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this._key.isEqual(t._key)},e.prototype.set=function(e,t){x("DocumentReference.set",arguments,1,2);var n=(t=gi("DocumentReference.set",t)).merge||t.mergeFields?this.firestore._dataConverter.parseMergeData("DocumentReference.set",e,t.mergeFields):this.firestore._dataConverter.parseSetData("DocumentReference.set",e);return this._firestoreClient.write(n.toMutations(this._key,ft.NONE))},e.prototype.update=function(e,t){for(var n,r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];return"string"==typeof e||e instanceof Po?(P("DocumentReference.update",arguments,2),n=this.firestore._dataConverter.parseUpdateVarargs("DocumentReference.update",e,t,r)):(N("DocumentReference.update",arguments,1),n=this.firestore._dataConverter.parseUpdateData("DocumentReference.update",e)),this._firestoreClient.write(n.toMutations(this._key,ft.exists(!0)))},e.prototype.delete=function(){return N("DocumentReference.delete",arguments,0),this._firestoreClient.write([new mt(this._key,ft.NONE)])},e.prototype.onSnapshot=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];x("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||Bo(e[o])||(z("DocumentReference.onSnapshot",r=e[o],["includeMetadataChanges"]),F("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),o++);var i={includeMetadataChanges:r.includeMetadataChanges};return Bo(e[o])?n=e[o]:(M("DocumentReference.onSnapshot","function",o,e[o]),R("DocumentReference.onSnapshot","function",o+1,e[o+1]),R("DocumentReference.onSnapshot","function",o+2,e[o+2]),n={next:e[o],error:e[o+1],complete:e[o+2]}),this.onSnapshotInternal(i,n)},e.prototype.onSnapshotInternal=function(e,t){var n=this,r=function(e){console.error("Uncaught Error in onSnapshot:",e)};t.error&&(r=t.error.bind(t));var o=new No({next:function(e){if(t.next){g(e.docs.size<=1,"Too many documents returned on a document query");var r=e.docs.get(n._key);t.next(new di(n.firestore,n._key,r,e.fromCache,e.hasPendingWrites))}},error:r}),i=this._firestoreClient.listen(xr.atPath(this._key.path),o,e);return function(){o.mute(),n._firestoreClient.unlisten(i)}},e.prototype.get=function(e){var t=this;return x("DocumentReference.get",arguments,0,1),_i("DocumentReference.get",e),new Promise((function(n,r){e&&"cache"===e.source?t.firestore.ensureClientConfigured().getDocumentFromLocalCache(t._key).then((function(e){n(new di(t.firestore,t._key,e,!0,e instanceof Ft&&e.hasLocalMutations))}),r):t.getViaSnapshotListener(n,r,e)}))},e.prototype.getViaSnapshotListener=function(e,t,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(o){r(),!o.exists&&o.metadata.fromCache?t(new C(w.UNAVAILABLE,"Failed to get document because the client is offline.")):o.exists&&o.metadata.fromCache&&n&&"server"===n.source?t(new C(w.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(o)},error:t})},e}(),fi=function(){function e(e,t){this.hasPendingWrites=e,this.fromCache=t}return e.prototype.isEqual=function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache},e}(),di=function(){function e(e,t,n,r,o){this._firestore=e,this._key=t,this._document=n,this._fromCache=r,this._hasPendingWrites=o}return e.prototype.data=function(e){return x("DocumentSnapshot.data",arguments,0,1),e=bi("DocumentSnapshot.data",e),this._document?this.convertObject(this._document.data(),_t.fromSnapshotOptions(e,this._firestore._areTimestampsInSnapshotsEnabled())):void 0},e.prototype.get=function(e,t){if(x("DocumentSnapshot.get",arguments,1,2),t=bi("DocumentSnapshot.get",t),this._document){var n=this._document.data().field(ri("DocumentSnapshot.get",e));if(null!==n)return this.convertValue(n,_t.fromSnapshotOptions(t,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(e.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ref",{get:function(){return new hi(this._key,this._firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return new fi(this._hasPendingWrites,this._fromCache)},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){if(!(t instanceof e))throw W("isEqual","DocumentSnapshot",1,t);return this._firestore===t._firestore&&this._fromCache===t._fromCache&&this._key.isEqual(t._key)&&(null===this._document?null===t._document:this._document.isEqual(t._document))},e.prototype.convertObject=function(e,t){var n=this,r={};return e.forEach((function(e,o){r[e]=n.convertValue(o,t)})),r},e.prototype.convertValue=function(e,t){if(e instanceof Mt)return this.convertObject(e,t);if(e instanceof Rt)return this.convertArray(e,t);if(e instanceof xt){var n=e.value(t),r=this._firestore.ensureClientConfigured().databaseId();return e.databaseId.isEqual(r)||y("Document "+this._key.path+" contains a document reference within a different database ("+e.databaseId.projectId+"/"+e.databaseId.database+") which is not supported. It will be treated as a reference in the current database ("+r.projectId+"/"+r.database+") instead."),new hi(n,this._firestore)}return e.value(t)},e.prototype.convertArray=function(e,t){var n=this;return e.internalValue.map((function(e){return n.convertValue(e,t)}))},e}(),pi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.data=function(t){var n=e.prototype.data.call(this,t);return g("object"==typeof n,"Document in a QueryDocumentSnapshot should exist"),n},t}(di),yi=function(){function e(e,t){this._query=e,this.firestore=t}return e.prototype.where=function(t,n,r){if(N("Query.where",arguments,3),G("Query.where",3,r),"in"!==n&&"array-contains-any"!==n){var o=["<","<=","==",">=",">","array-contains"];B("Query.where",o,2,n)}var i,a=ri("Query.where",t),s=Mr.fromString(n);if(a.isKeyField()){if(s===Mr.ARRAY_CONTAINS||s===Mr.ARRAY_CONTAINS_ANY)throw new C(w.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+s.toString()+"' queries on FieldPath.documentId().");if(s===Mr.IN){this.validateDisjunctiveFilterElements(r,s);for(var u=[],c=0,l=r;c<l.length;c++){var h=l[c];u.push(this.parseDocumentIdValue(h))}i=new Rt(u)}else i=this.parseDocumentIdValue(r)}else s!==Mr.IN&&s!==Mr.ARRAY_CONTAINS_ANY||this.validateDisjunctiveFilterElements(r,s),i=this.firestore._dataConverter.parseQueryValue("Query.where",r);var f=Rr.create(a,s,i);return this.validateNewFilter(f),new e(this._query.addFilter(f),this.firestore)},e.prototype.orderBy=function(t,n){var r;if(x("Query.orderBy",arguments,1,2),R("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r=jr.ASCENDING;else{if("desc"!==n)throw new C(w.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r=jr.DESCENDING}if(null!==this._query.startAt)throw new C(w.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this._query.endAt)throw new C(w.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var o=ri("Query.orderBy",t),i=new Gr(o,r);return this.validateNewOrderBy(i),new e(this._query.addOrderBy(i),this.firestore)},e.prototype.limit=function(t){if(N("Query.limit",arguments,1),M("Query.limit","number",1,t),t<=0)throw new C(w.INVALID_ARGUMENT,"Invalid Query. Query limit ("+t+") is invalid. Limit must be positive.");return new e(this._query.withLimit(t),this.firestore)},e.prototype.startAt=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];P("Query.startAt",arguments,1);var o=this.boundFromDocOrFields("Query.startAt",t,n,!0);return new e(this._query.withStartAt(o),this.firestore)},e.prototype.startAfter=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];P("Query.startAfter",arguments,1);var o=this.boundFromDocOrFields("Query.startAfter",t,n,!1);return new e(this._query.withStartAt(o),this.firestore)},e.prototype.endBefore=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];P("Query.endBefore",arguments,1);var o=this.boundFromDocOrFields("Query.endBefore",t,n,!0);return new e(this._query.withEndAt(o),this.firestore)},e.prototype.endAt=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];P("Query.endAt",arguments,1);var o=this.boundFromDocOrFields("Query.endAt",t,n,!1);return new e(this._query.withEndAt(o),this.firestore)},e.prototype.isEqual=function(t){if(!(t instanceof e))throw W("isEqual","Query",1,t);return this.firestore===t.firestore&&this._query.isEqual(t._query)},e.prototype.boundFromDocOrFields=function(e,t,n,r){if(G(e,1,t),t instanceof di){if(n.length>0)throw new C(w.INVALID_ARGUMENT,"Too many arguments provided to "+e+"().");var o=t;if(!o.exists)throw new C(w.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+e+"().");return this.boundFromDocument(e,o._document,r)}var i=[t].concat(n);return this.boundFromFields(e,i,r)},e.prototype.boundFromDocument=function(e,t,n){for(var r=[],o=0,i=this._query.orderBy;o<i.length;o++){var a=i[o];if(a.field.isKeyField())r.push(new xt(this.firestore._databaseId,t.key));else{var s=t.field(a.field);if(s instanceof Nt)throw new C(w.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=a.field.canonicalString();throw new C(w.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}r.push(s)}}return new Ur(r,n)},e.prototype.boundFromFields=function(e,t,n){var r=this._query.explicitOrderBy;if(t.length>r.length)throw new C(w.INVALID_ARGUMENT,"Too many arguments provided to "+e+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var o=[],i=0;i<t.length;i++){var a=t[i];if(r[i].field.isKeyField()){if("string"!=typeof a)throw new C(w.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+e+"(), but got a "+typeof a);if(!this._query.isCollectionGroupQuery()&&-1!==a.indexOf("/"))throw new C(w.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+e+"() must be a plain document ID, but '"+a+"' contains a slash.");var s=this._query.path.child(ae.fromString(a));if(!ce.isDocumentKey(s))throw new C(w.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+e+"() must result in a valid document path, but '"+s+"' is not because it contains an odd number of segments.");var u=new ce(s);o.push(new xt(this.firestore._databaseId,u))}else{var c=this.firestore._dataConverter.parseQueryValue(e,a);o.push(c)}}return new Ur(o,n)},e.prototype.onSnapshot=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];x("Query.onSnapshot",arguments,1,4);var n,r={},o=0;return"object"!=typeof e[o]||Bo(e[o])||(z("Query.onSnapshot",r=e[o],["includeMetadataChanges"]),F("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),o++),Bo(e[o])?n=e[o]:(M("Query.onSnapshot","function",o,e[o]),R("Query.onSnapshot","function",o+1,e[o+1]),R("Query.onSnapshot","function",o+2,e[o+2]),n={next:e[o],error:e[o+1],complete:e[o+2]}),this.onSnapshotInternal(r,n)},e.prototype.onSnapshotInternal=function(e,t){var n=this,r=function(e){console.error("Uncaught Error in onSnapshot:",e)};t.error&&(r=t.error.bind(t));var o=new No({next:function(e){t.next&&t.next(new vi(n.firestore,n._query,e))},error:r}),i=this.firestore.ensureClientConfigured(),a=i.listen(this._query,o,e);return function(){o.mute(),i.unlisten(a)}},e.prototype.get=function(e){var t=this;return x("Query.get",arguments,0,1),_i("Query.get",e),new Promise((function(n,r){e&&"cache"===e.source?t.firestore.ensureClientConfigured().getDocumentsFromLocalCache(t._query).then((function(e){n(new vi(t.firestore,t._query,e))}),r):t.getViaSnapshotListener(n,r,e)}))},e.prototype.getViaSnapshotListener=function(e,t,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(o){r(),o.metadata.fromCache&&n&&"server"===n.source?t(new C(w.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(o)},error:t})},e.prototype.parseDocumentIdValue=function(e){if("string"==typeof e){if(""===e)throw new C(w.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this._query.isCollectionGroupQuery()&&-1!==e.indexOf("/"))throw new C(w.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+e+"' contains a '/' character.");var t=this._query.path.child(ae.fromString(e));if(!ce.isDocumentKey(t))throw new C(w.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+t+"' is not because it has an odd number of segments ("+t.length+").");return new xt(this.firestore._databaseId,new ce(t))}if(e instanceof hi)return new xt(this.firestore._databaseId,e._key);throw new C(w.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+U(e)+".")},e.prototype.validateDisjunctiveFilterElements=function(e,t){if(!Array.isArray(e)||0===e.length)throw new C(w.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+t.toString()+"' filters.");if(e.length>10)throw new C(w.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters support a maximum of 10 elements in the value array.");if(e.indexOf(null)>=0)throw new C(w.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters cannot contain 'null' in the value array.");if(e.filter((function(e){return Number.isNaN(e)})).length>0)throw new C(w.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters cannot contain 'NaN' in the value array.")},e.prototype.validateNewFilter=function(e){if(e instanceof Rr){var t=[Mr.ARRAY_CONTAINS,Mr.ARRAY_CONTAINS_ANY],n=[Mr.IN,Mr.ARRAY_CONTAINS_ANY],r=t.indexOf(e.op)>=0,o=n.indexOf(e.op)>=0;if(e.isInequality()){var i=this._query.getInequalityFilterField();if(null!==i&&!i.isEqual(e.field))throw new C(w.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+i.toString()+"' and '"+e.field.toString()+"'");var a=this._query.getFirstOrderByField();null!==a&&this.validateOrderByAndInequalityMatch(e.field,a)}else if(o||r){var s=null;if(o&&(s=this._query.findFilterOperator(n)),null===s&&r&&(s=this._query.findFilterOperator(t)),null!=s)throw new C(w.INVALID_ARGUMENT,s===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+s.toString()+"' filters.")}}},e.prototype.validateNewOrderBy=function(e){if(null===this._query.getFirstOrderByField()){var t=this._query.getInequalityFilterField();null!==t&&this.validateOrderByAndInequalityMatch(t,e.field)}},e.prototype.validateOrderByAndInequalityMatch=function(e,t){if(!t.isEqual(e))throw new C(w.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+t.toString()+"' instead.")},e}(),vi=function(){function e(e,t,n){this._firestore=e,this._originalQuery=t,this._snapshot=n,this._cachedChanges=null,this._cachedChangesIncludeMetadataChanges=null,this.metadata=new fi(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(e.prototype,"docs",{get:function(){var e=[];return this.forEach((function(t){return e.push(t)})),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),e.prototype.forEach=function(e,t){var n=this;x("QuerySnapshot.forEach",arguments,1,2),M("QuerySnapshot.forEach","function",1,e),this._snapshot.docs.forEach((function(r){e.call(t,n.convertToDocumentImpl(r))}))},Object.defineProperty(e.prototype,"query",{get:function(){return new yi(this._originalQuery,this._firestore)},enumerable:!0,configurable:!0}),e.prototype.docChanges=function(e){e&&(z("QuerySnapshot.docChanges",e,["includeMetadataChanges"]),F("QuerySnapshot.docChanges","boolean","includeMetadataChanges",e.includeMetadataChanges));var t=!(!e||!e.includeMetadataChanges);if(t&&this._snapshot.excludesMetadataChanges)throw new C(w.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t,n){if(n.oldDocs.isEmpty()){var r,o=0;return n.docChanges.map((function(t){var i=new pi(e,t.doc.key,t.doc,n.fromCache,n.mutatedKeys.has(t.doc.key));return g(t.type===vr.Added,"Invalid event type for first snapshot"),g(!r||n.query.docComparator(r,t.doc)<0,"Got added events in wrong order"),r=t.doc,{type:"added",doc:i,oldIndex:-1,newIndex:o++}}))}var i=n.oldDocs;return n.docChanges.filter((function(e){return t||e.type!==vr.Metadata})).map((function(t){var r=new pi(e,t.doc.key,t.doc,n.fromCache,n.mutatedKeys.has(t.doc.key)),o=-1,a=-1;return t.type!==vr.Added&&(g((o=i.indexOf(t.doc.key))>=0,"Index for document not found"),i=i.delete(t.doc.key)),t.type!==vr.Removed&&(a=(i=i.add(t.doc)).indexOf(t.doc.key)),{type:Ci(t.type),doc:r,oldIndex:o,newIndex:a}}))}(this._firestore,t,this._snapshot),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges},e.prototype.isEqual=function(t){if(!(t instanceof e))throw W("isEqual","QuerySnapshot",1,t);return this._firestore===t._firestore&&this._originalQuery.isEqual(t._originalQuery)&&this._snapshot.isEqual(t._snapshot)},e.prototype.convertToDocumentImpl=function(e){return new pi(this._firestore,e.key,e,this.metadata.fromCache,this._snapshot.mutatedKeys.has(e.key))},e}();["length","forEach","map"].concat("undefined"!=typeof Symbol?[Symbol.iterator]:[]).forEach((function(e){try{Object.defineProperty(vi.prototype.docChanges,e,{get:function(){return function(){throw new C(w.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')}()}})}catch(t){}}));var mi=function(e){function t(t,n){var r=e.call(this,xr.atPath(t),n)||this;if(t.length%2!=1)throw new C(w.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.canonicalString()+" has "+t.length);return r}return a.__extends(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._query.path.popLast();return e.isEmpty()?null:new hi(new ce(e),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),t.prototype.doc=function(e){if(x("CollectionReference.doc",arguments,0,1),0===arguments.length&&(e=K.newId()),M("CollectionReference.doc","non-empty string",1,e),""===e)throw new C(w.INVALID_ARGUMENT,"Document path must be a non-empty string");var t=ae.fromString(e);return hi.forPath(this._query.path.child(t),this.firestore)},t.prototype.add=function(e){N("CollectionReference.add",arguments,1),M("CollectionReference.add","object",1,e);var t=this.doc();return t.set(e).then((function(){return t}))},t}(yi);function gi(e,t){if(void 0===t)return{merge:!1};if(z(e,t,["merge","mergeFields"]),F(e,"boolean","merge",t.merge),void 0!==(n=t.mergeFields)&&function(e,t,n,r,o){if(!(r instanceof Array))throw new C(w.INVALID_ARGUMENT,"Function "+e+"() requires its mergeFields option to be an array, but it was: "+U(r));for(var i=0;i<r.length;++i)if(!("string"==typeof(a=r[i])||a instanceof Po))throw new C(w.INVALID_ARGUMENT,"Function "+e+"() requires all mergeFields elements to be a string or a FieldPath, but the value at index "+i+" was: "+U(r[i]));var a}(e,0,0,n),void 0!==t.mergeFields&&void 0!==t.merge)throw new C(w.INVALID_ARGUMENT,"Invalid options passed to function "+e+'(): You cannot specify both "merge" and "mergeFields".');var n;return t}function bi(e,t){return void 0===t?{}:(z(e,t,["serverTimestamps"]),V(e,0,"serverTimestamps",t.serverTimestamps,["estimate","previous","none"]),t)}function _i(e,t){R(e,"object",1,t),t&&(z(e,t,["source"]),V(e,0,"source",t.source,["default","server","cache"]))}function wi(e,t,n){if(t instanceof hi){if(t.firestore!==n)throw new C(w.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}throw W(e,"DocumentReference",1,t)}function Ci(e){switch(e){case vr.Added:return"added";case vr.Modified:case vr.Metadata:return"modified";case vr.Removed:return"removed";default:return m("Unknown change type: "+e)}}var ki=k(ui,"Use firebase.firestore() instead."),Si=k(ci,"Use firebase.firestore().runTransaction() instead."),Ei=k(li,"Use firebase.firestore().batch() instead."),Ti=k(hi,"Use firebase.firestore().doc() instead."),Ii=k(di),Ai=k(pi),Di=k(yi),Ni=k(vi),Pi=k(mi,"Use firebase.firestore().collection() instead."),xi={Firestore:ki,GeoPoint:Pr,Timestamp:ge,Blob:te,Transaction:Si,WriteBatch:Ei,DocumentReference:Ti,DocumentSnapshot:Ii,Query:Di,QueryDocumentSnapshot:Ai,QuerySnapshot:Ni,CollectionReference:Pi,FieldPath:Po,FieldValue:Ho,setLogLevel:ui.setLogLevel,CACHE_SIZE_UNLIMITED:ai},Oi=function(){function e(){}return e.prototype.addCallback=function(e){},e.prototype.shutdown=function(){},e}(),Mi=function(){function e(){var e=this;this.networkAvailableListener=function(){return e.onNetworkAvailable()},this.networkUnavailableListener=function(){return e.onNetworkUnavailable()},this.callbacks=[],this.configureNetworkMonitoring()}return e.prototype.addCallback=function(e){this.callbacks.push(e)},e.prototype.shutdown=function(){window.removeEventListener("online",this.networkAvailableListener),window.removeEventListener("offline",this.networkUnavailableListener)},e.prototype.configureNetworkMonitoring=function(){window.addEventListener("online",this.networkAvailableListener),window.addEventListener("offline",this.networkUnavailableListener)},e.prototype.onNetworkAvailable=function(){p("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var e=0,t=this.callbacks;e<t.length;e++)(0,t[e])(0)},e.prototype.onNetworkUnavailable=function(){p("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var e=0,t=this.callbacks;e<t.length;e++)(0,t[e])(1)},e.isAvailable=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},e}(),Ri=function(){function e(e){this.sendFn=e.sendFn,this.closeFn=e.closeFn}return e.prototype.onOpen=function(e){g(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=e},e.prototype.onClose=function(e){g(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=e},e.prototype.onMessage=function(e){g(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=e},e.prototype.close=function(){this.closeFn()},e.prototype.send=function(e){this.sendFn(e)},e.prototype.callOnOpen=function(){g(void 0!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},e.prototype.callOnClose=function(e){g(void 0!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(e)},e.prototype.callOnMessage=function(e){g(void 0!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(e)},e}(),Li="Connection",Fi={BatchGetDocuments:"batchGet",Commit:"commit"},Vi="gl-js/ fire/"+c,Bi=function(){function e(e){this.databaseId=e.databaseId,this.baseUrl=(e.ssl?"https":"http")+"://"+e.host,this.forceLongPolling=e.forceLongPolling}return e.prototype.modifyHeadersForRequest=function(e,t){if(t)for(var n in t.authHeaders)t.authHeaders.hasOwnProperty(n)&&(e[n]=t.authHeaders[n]);e["X-Goog-Api-Client"]=Vi},e.prototype.invokeRPC=function(e,t,n){var r=this,o=this.makeUrl(e);return new Promise((function(i,a){var s=new u.XhrIo;s.listenOnce(u.EventType.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case u.ErrorCode.NO_ERROR:var t=s.getResponseJson();p(Li,"XHR received:",JSON.stringify(t)),i(t);break;case u.ErrorCode.TIMEOUT:p(Li,'RPC "'+e+'" timed out'),a(new C(w.DEADLINE_EXCEEDED,"Request time out"));break;case u.ErrorCode.HTTP_ERROR:var n=s.getStatus();if(p(Li,'RPC "'+e+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var o=(c=r.status.toLowerCase().replace("_","-"),Object.values(w).indexOf(c)>=0?c:w.UNKNOWN);a(new C(o,r.message))}else a(new C(w.UNKNOWN,"Server responded with status "+s.getStatus()))}else p(Li,'RPC "'+e+'" failed'),a(new C(w.UNAVAILABLE,"Connection failed."));break;default:m('RPC "'+e+'" failed with unanticipated webchannel error '+s.getLastErrorCode()+": "+s.getLastError()+", giving up.")}}finally{p(Li,'RPC "'+e+'" completed.')}var c}));var c=JSON.stringify(t);p(Li,"XHR sending: ",o+" "+c);var l={"Content-Type":"text/plain"};r.modifyHeadersForRequest(l,n),s.send(o,"POST",c,l,15)}))},e.prototype.invokeStreamingRPC=function(e,t,n){return this.invokeRPC(e,t,n)},e.prototype.openStream=function(e,t){var n=[this.baseUrl,"/","google.firestore.v1.Firestore","/",e,"/channel"],r=u.createWebChannelTransport(),o={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.modifyHeadersForRequest(o.initMessageHeaders,t),s.isReactNative()||(o.httpHeadersOverwriteParam="$httpHeaders");var i=n.join("");p(Li,"Creating WebChannel: "+i+" "+o);var a=r.createWebChannel(i,o),c=!1,l=!1,h=new Ri({sendFn:function(e){l?p(Li,"Not sending because WebChannel is closed:",e):(c||(p(Li,"Opening WebChannel transport."),a.open(),c=!0),p(Li,"WebChannel sending:",e),a.send(e))},closeFn:function(){return a.close()}}),f=function(e,t){a.listen(e,(function(e){try{t(e)}catch(n){setTimeout((function(){throw n}),0)}}))};return f(u.WebChannel.EventType.OPEN,(function(){l||p(Li,"WebChannel transport opened.")})),f(u.WebChannel.EventType.CLOSE,(function(){l||(l=!0,p(Li,"WebChannel transport closed"),h.callOnClose())})),f(u.WebChannel.EventType.ERROR,(function(e){l||(l=!0,p(Li,"WebChannel transport errored:",e),h.callOnClose(new C(w.UNAVAILABLE,"The operation could not be completed")))})),f(u.WebChannel.EventType.MESSAGE,(function(e){if(!l){var t=e.data[0];g(!!t,"Got a webchannel message without data.");var n=t.error||t[0]&&t[0].error;if(n){p(Li,"WebChannel received error:",n);var r=n.status,o=function(e){var t=hr[e];if(void 0!==t)return dr(t)}(r),i=n.message;void 0===o&&(o=w.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),l=!0,h.callOnClose(new C(o,i)),a.close()}else p(Li,"WebChannel received:",t),h.callOnMessage(t)}})),setTimeout((function(){h.callOnOpen()}),0),h},e.prototype.makeUrl=function(e){var t=Fi[e];g(void 0!==t,"Unknown REST mapping for: "+e);var n=[this.baseUrl,"/","v1"];return n.push("/projects/"),n.push(this.databaseId.projectId),n.push("/databases/"),n.push(this.databaseId.database),n.push("/documents"),n.push(":"),n.push(t),n.join("")},e}();function qi(e){!function(e){e.INTERNAL.registerService("firestore",(function(e){return new ui(e)}),function(e){g(e&&"object"==typeof e,"shallowCopy() expects object parameter.");var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}(xi))}(e)}b.setPlatform(new(function(){function e(){this.emptyByteString="",this.base64Available="undefined"!=typeof atob}return Object.defineProperty(e.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),e.prototype.loadConnection=function(e){return Promise.resolve(new Bi(e))},e.prototype.newConnectivityMonitor=function(){return Mi.isAvailable()?new Mi:new Oi},e.prototype.newSerializer=function(e){return new io(e,{useProto3Json:!0})},e.prototype.formatJSON=function(e){return JSON.stringify(e)},e.prototype.atob=function(e){return atob(e)},e.prototype.btoa=function(e){return btoa(e)},e}())),qi(o),t.registerFirestore=qi},"93Jm":function(e,t,n){e.exports=function(e,t,n){var r=!1;if(void 0===window.XMLHttpRequest)return t(Error("Browser not supported"));if(void 0===n){var o=e.match(/^\s*https?:\/\/[^\/]*/);n=o&&o[0]!==location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")}var i=new window.XMLHttpRequest;if(n&&!("withCredentials"in i)){i=new window.XDomainRequest;var a=t;t=function(){if(r)a.apply(this,arguments);else{var e=this,t=arguments;setTimeout((function(){a.apply(e,t)}),0)}}}function s(){var e;void 0===i.status||(e=i.status)>=200&&e<300||304===e?t.call(i,null,i):t.call(i,i,null)}return"onload"in i?i.onload=s:i.onreadystatechange=function(){4===i.readyState&&s()},i.onerror=function(e){t.call(this,e||!0,null),t=function(){}},i.onprogress=function(){},i.ontimeout=function(e){t.call(this,e,null),t=function(){}},i.onabort=function(e){t.call(this,e,null),t=function(){}},i.open("GET",e,!0),i.send(null),r=!0,i}},Mkpm:function(e,t){e.exports=o,e.exports.parse=o,e.exports.stringify=function e(t){function n(e){return e.join(" ")}function r(e){return e.map(n).join(", ")}function o(e){return e.map(r).map(i).join(", ")}function i(e){return"("+e+")"}switch("Feature"===t.type&&(t=t.geometry),t.type){case"Point":return"POINT ("+n(t.coordinates)+")";case"LineString":return"LINESTRING ("+r(t.coordinates)+")";case"Polygon":return"POLYGON ("+o(t.coordinates)+")";case"MultiPoint":return"MULTIPOINT ("+r(t.coordinates)+")";case"MultiPolygon":return"MULTIPOLYGON ("+t.coordinates.map(o).map(i).join(", ")+")";case"MultiLineString":return"MULTILINESTRING ("+o(t.coordinates)+")";case"GeometryCollection":return"GEOMETRYCOLLECTION ("+t.geometries.map(e).join(", ")+")";default:throw new Error("stringify requires a valid GeoJSON Feature or geometry object as input")}};var n=/[-+]?([0-9]*\.[0-9]+|[0-9]+)([eE][-+]?[0-9]+)?/,r=new RegExp("^"+n.source+"(\\s"+n.source+"){1,}");function o(e){var t,n=e.split(";"),o=n.pop(),i=(n.shift()||"").split("=").pop(),a=0;function s(e){var t=o.substring(a).match(e);return t?(a+=t[0].length,t[0]):null}function u(){s(/^\s*/)}function c(){u();for(var e,t=0,n=[],o=[n],i=n;e=s(/^(\()/)||s(/^(\))/)||s(/^(\,)/)||s(r);){if("("===e)o.push(i),o[o.length-1].push(i=[]),t++;else if(")"===e){if(0===i.length)return null;if(!(i=o.pop()))return null;if(0==--t)break}else if(","===e)o[o.length-1].push(i=[]);else{if(e.split(/\s/g).some(isNaN))return null;Array.prototype.push.apply(i,e.split(/\s/g).map(parseFloat))}u()}return 0!==t?null:n}function l(){for(var e,t,n=[];t=s(r)||s(/^(\,)/);)","===t?(n.push(e),e=[]):t.split(/\s/g).some(isNaN)||(e||(e=[]),Array.prototype.push.apply(e,t.split(/\s/g).map(parseFloat))),u();return e?(n.push(e),n.length?n:null):null}return(t=function e(){return function(){if(!s(/^(point)/i))return null;if(u(),!s(/^(\()/))return null;var e=l();return e?(u(),s(/^(\))/)?{type:"Point",coordinates:e[0]}:null):null}()||function(){if(!s(/^(linestring)/i))return null;if(u(),!s(/^(\()/))return null;var e=l();return e&&s(/^(\))/)?{type:"LineString",coordinates:e}:null}()||function(){if(!s(/^(polygon)/i))return null;u();var e=c();return e?{type:"Polygon",coordinates:e}:null}()||function(){if(!s(/^(multipoint)/i))return null;u();var e=o.substring(o.indexOf("(")+1,o.length-1).replace(/\(/g,"").replace(/\)/g,"");o="MULTIPOINT ("+e+")";var t=c();return t?(u(),{type:"MultiPoint",coordinates:t}):null}()||function(){if(!s(/^(multilinestring)/i))return null;u();var e=c();return e?(u(),{type:"MultiLineString",coordinates:e}):null}()||function(){if(!s(/^(multipolygon)/i))return null;u();var e=c();return e?{type:"MultiPolygon",coordinates:e}:null}()||function(){var t,n=[];if(!s(/^(geometrycollection)/i))return null;if(u(),!s(/^(\()/))return null;for(;t=e();)n.push(t),u(),s(/^(\,)/),u();return s(/^(\))/)?{type:"GeometryCollection",geometries:n}:null}()}())&&i.match(/\d+/)&&(t.crs={type:"name",properties:{name:"urn:ogc:def:crs:EPSG::"+i}}),t}},Nuzq:function(e,t,n){"use strict";var r=n("/7f5"),o=n("S0GR"),i=/(Lat)(itude)?/gi,a=/(L)(on|ng)(gitude)?/i;function s(e,t){var n,r,o;for(var i in e)(r=i.match(t))&&(!n||r[0].length/i.length>o)&&(o=r[0].length/i.length,n=i);return n}function u(e){return s(e,i)}function c(e){return s(e,a)}function l(e){return"object"==typeof e?Object.keys(e).length:0}function h(e){var t=[];return[",",";","\t","|"].forEach((function(n){var o=r.dsvFormat(n).parse(e);if(o.length>=1){for(var i=l(o[0]),a=0;a<o.length;a++)if(l(o[a])!==i)return;t.push({delimiter:n,arity:Object.keys(o[0]).length})}})),t.length?t.sort((function(e,t){return t.arity-e.arity}))[0].delimiter:null}e.exports={isLon:function(e){return!!e.match(a)},isLat:function(e){return!!e.match(i)},guessLatHeader:u,guessLonHeader:c,csv:r.csvParse,tsv:r.tsvParse,dsv:r,auto:function(e){var t=h(e);return t?function(e){return delete e.columns,e}(r.dsvFormat(t).parse(e)):null},csv2geojson:function(e,t,n){n||(n=t,t={}),t.delimiter=t.delimiter||",";var i=t.latfield||"",a=t.lonfield||"",s=t.crs||"",l=[],f={type:"FeatureCollection",features:l};if(""!==s&&(f.crs={type:"name",properties:{name:s}}),"auto"!==t.delimiter||"string"!=typeof e||(t.delimiter=h(e),t.delimiter)){var d="string"==typeof e?r.dsvFormat(t.delimiter).parse(e):e;if(d.length){var p,y=[];if(i||(i=u(d[0])),a||(a=c(d[0])),i&&a){for(p=0;p<d.length;p++)if(void 0!==d[p][a]&&void 0!==d[p][i]){var v,m,g,b=d[p][a],_=d[p][i];(g=o(b,"EW"))&&(b=g),(g=o(_,"NS"))&&(_=g),v=parseFloat(b),m=parseFloat(_),isNaN(v)||isNaN(m)?y.push({message:"A row contained an invalid value for latitude or longitude",row:d[p],index:p}):(t.includeLatLon||(delete d[p][a],delete d[p][i]),l.push({type:"Feature",properties:d[p],geometry:{type:"Point",coordinates:[parseFloat(v),parseFloat(m)]}}))}n(y.length?y:null,f)}else{for(p=0;p<d.length;p++)l.push({type:"Feature",properties:d[p],geometry:null});n(y.length?y:null,f)}}else n(null,f)}else n({type:"Error",message:"Could not autodetect delimiter"})},toLine:function(e){for(var t=e.features,n={type:"Feature",geometry:{type:"LineString",coordinates:[]}},r=0;r<t.length;r++)n.geometry.coordinates.push(t[r].geometry.coordinates);return n.properties=t.reduce((function(e,t){for(var n in t.properties)e[n]||(e[n]=[]),e[n].push(t.properties[n]);return e}),{}),{type:"FeatureCollection",features:[n]}},toPolygon:function(e){for(var t=e.features,n={type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}},r=0;r<t.length;r++)n.geometry.coordinates[0].push(t[r].geometry.coordinates);return n.properties=t.reduce((function(e,t){for(var n in t.properties)e[n]||(e[n]=[]),e[n].push(t.properties[n]);return e}),{}),{type:"FeatureCollection",features:[n]}}}},S0GR:function(e,t){function n(e,t){var n=r(e,t);return n.whole+"\xb0 "+(n.minutes?n.minutes+"' ":"")+(n.seconds?n.seconds+'" ':"")+n.dir}function r(e,t){var n=({lat:["N","S"],lon:["E","W"]}[t]||"")[e>=0?0:1],r=Math.abs(e),o=Math.floor(r),i=60*(r-o),a=Math.floor(i);return{whole:o,minutes:a,seconds:Math.floor(60*(i-a)),dir:n}}function o(e,t,n){if(t||(t="NSEW"),"string"!=typeof e)return{val:null,regex:n};var r=(n=n||/[\s\,]*([\-|\\u2014|\\u2015]?[0-9.]+)\xb0? *(?:([0-9.]+)['\u2019\u2032\u2018] *)?(?:([0-9.]+)(?:''|"|\u201d|\u2033) *)?([NSEW])?/gi).exec(e);return r?r[4]&&-1===t.indexOf(r[4])?{val:null,regex:n}:{val:((r[1]?parseFloat(r[1]):0)+(r[2]?parseFloat(r[2])/60:0)+(r[3]?parseFloat(r[3])/3600:0))*(r[4]&&"S"===r[4]||"W"===r[4]?-1:1),regex:n,raw:r[0],dim:r[4]}:{val:null,regex:n}}e.exports=function(e,t){return o(e,t).val},e.exports.pair=function(e,t){var n=o(e=e.trim(),t);if(null===n.val)return null;var r,i,a,s=o(e,t,n.regex);return null===s.val?null:n.raw+s.raw!==e?null:n.dim?(r=n.val,i=s.val,"N"===(a=n.dim)||"S"===a?[r,i]:"W"===a||"E"===a?[i,r]:void 0):[n.val,s.val]},e.exports.format=n,e.exports.formatPair=function(e){return n(e.lat,"lat")+" "+n(e.lon,"lon")},e.exports.coordToDMS=r},Wcq6:function(e,t,n){"use strict";var r,o=(r=n("wj3C"))&&"object"==typeof r&&"default"in r?r.default:r;e.exports=o},cSZD:function(e,t,n){"use strict";var r={};function o(e,t){e=Math.round(e*t),(e<<=1)<0&&(e=~e);for(var n="";e>=32;)n+=String.fromCharCode(63+(32|31&e)),e>>=5;return n+String.fromCharCode(e+63)}function i(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].slice().reverse());return t}r.decode=function(e,t){for(var n,r=0,o=0,i=0,a=[],s=0,u=0,c=null,l=Math.pow(10,t||5);r<e.length;){c=null,s=0,u=0;do{u|=(31&(c=e.charCodeAt(r++)-63))<<s,s+=5}while(c>=32);n=1&u?~(u>>1):u>>1,s=u=0;do{u|=(31&(c=e.charCodeAt(r++)-63))<<s,s+=5}while(c>=32);a.push([(o+=n)/l,(i+=1&u?~(u>>1):u>>1)/l])}return a},r.encode=function(e,t){if(!e.length)return"";for(var n=Math.pow(10,t||5),r=o(e[0][0],n)+o(e[0][1],n),i=1;i<e.length;i++){var a=e[i],s=e[i-1];r+=o(a[0]-s[0],n),r+=o(a[1]-s[1],n)}return r},r.fromGeoJSON=function(e,t){if(e&&"Feature"===e.type&&(e=e.geometry),!e||"LineString"!==e.type)throw new Error("Input must be a GeoJSON LineString");return r.encode(i(e.coordinates),t)},r.toGeoJSON=function(e,t){return{type:"LineString",coordinates:i(r.decode(e,t))}},e.exports&&(e.exports=r)},crnd:function(e,t){function n(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="crnd"},iML4:function(e,t,n){!function(e){"use strict";function t(){}function n(e){if(!e)return t;var n,r,o=e.scale[0],i=e.scale[1],a=e.translate[0],s=e.translate[1];return function(e,t){t||(n=r=0),e[0]=(n+=e[0])*o+a,e[1]=(r+=e[1])*i+s}}function r(e,t){for(var n=0,r=e.length;n<r;){var o=n+r>>>1;e[o]<t?n=o+1:r=o}return n}function o(e,t){var n={type:"Feature",id:t.id,properties:t.properties||{},geometry:i(e,t)};return null==t.id&&delete n.id,n}function i(e,t){var r=n(e.transform),o=e.arcs;function i(e,t){t.length&&t.pop();for(var n,i=o[e<0?~e:e],a=0,s=i.length;a<s;++a)t.push(n=i[a].slice()),r(n,a);e<0&&function(e,t){for(var n,r=e.length,o=r-t;o<--r;)n=e[o],e[o++]=e[r],e[r]=n}(t,s)}function a(e){return e=e.slice(),r(e,0),e}function s(e){for(var t=[],n=0,r=e.length;n<r;++n)i(e[n],t);return t.length<2&&t.push(t[0].slice()),t}function u(e){for(var t=s(e);t.length<4;)t.push(t[0].slice());return t}function c(e){return e.map(u)}var l={Point:function(e){return a(e.coordinates)},MultiPoint:function(e){return e.coordinates.map(a)},LineString:function(e){return s(e.arcs)},MultiLineString:function(e){return e.arcs.map(s)},Polygon:function(e){return c(e.arcs)},MultiPolygon:function(e){return e.arcs.map(c)}};return function e(t){var n=t.type;return"GeometryCollection"===n?{type:n,geometries:t.geometries.map(e)}:n in l?{type:n,coordinates:l[n](t)}:null}(t)}function a(e,t){var n={},r={},o={},i=[],a=-1;function s(e,t){for(var r in e){var o=e[r];delete t[o.start],delete o.start,delete o.end,o.forEach((function(e){n[e<0?~e:e]=1})),i.push(o)}}return t.forEach((function(n,r){var o,i=e.arcs[n<0?~n:n];i.length<3&&!i[1][0]&&!i[1][1]&&(o=t[++a],t[a]=n,t[r]=o)})),t.forEach((function(t){var n,i,a=function(t){var n,r=e.arcs[t<0?~t:t],o=r[0];return e.transform?(n=[0,0],r.forEach((function(e){n[0]+=e[0],n[1]+=e[1]}))):n=r[r.length-1],t<0?[n,o]:[o,n]}(t),s=a[0],u=a[1];if(n=o[s])if(delete o[n.end],n.push(t),n.end=u,i=r[u]){delete r[i.start];var c=i===n?n:n.concat(i);r[c.start=n.start]=o[c.end=i.end]=c}else r[n.start]=o[n.end]=n;else if(n=r[u])if(delete r[n.start],n.unshift(t),n.start=s,i=o[s]){delete o[i.end];var l=i===n?n:i.concat(n);r[l.start=i.start]=o[l.end=n.end]=l}else r[n.start]=o[n.end]=n;else r[(n=[t]).start=s]=o[n.end=u]=n})),s(o,r),s(r,o),t.forEach((function(e){n[e<0?~e:e]||i.push([e])})),i}function s(e,t,n){var r=[];function o(e){var t=e<0?~e:e;(l[t]||(l[t]=[])).push({i:e,g:c})}function i(e){e.forEach(o)}function s(e){e.forEach(i)}function u(e){"GeometryCollection"===e.type?e.geometries.forEach(u):e.type in h&&(c=e,h[e.type](e.arcs))}if(arguments.length>1){var c,l=[],h={LineString:i,MultiLineString:s,Polygon:s,MultiPolygon:function(e){e.forEach(s)}};u(t),l.forEach(arguments.length<3?function(e){r.push(e[0].i)}:function(e){n(e[0].g,e[e.length-1].g)&&r.push(e[0].i)})}else for(var f=0,d=e.arcs.length;f<d;++f)r.push(f);return{type:"MultiLineString",arcs:a(e,r)}}function u(e){var t=e[0],n=e[1],r=e[2];return Math.abs((t[0]-r[0])*(n[1]-t[1])-(t[0]-n[0])*(r[1]-t[1]))}function c(e,t){var n={},r=[],o=[];function s(e){e.forEach((function(t){t.forEach((function(t){(n[t=t<0?~t:t]||(n[t]=[])).push(e)}))})),r.push(e)}function u(t){return Math.abs(function(e){for(var t,n=-1,r=e.length,o=e[r-1],i=0;++n<r;)i+=(t=o)[0]*(o=e[n])[1]-t[1]*o[0];return i/2}(i(e,{type:"Polygon",arcs:[t]}).coordinates[0]))}return t.forEach((function(e){"Polygon"===e.type?s(e.arcs):"MultiPolygon"===e.type&&e.arcs.forEach(s)})),r.forEach((function(e){if(!e._){var t=[],r=[e];for(e._=1,o.push(t);e=r.pop();)t.push(e),e.forEach((function(e){e.forEach((function(e){n[e<0?~e:e].forEach((function(e){e._||(e._=1,r.push(e))}))}))}))}})),r.forEach((function(e){delete e._})),{type:"MultiPolygon",arcs:o.map((function(t){var r,o=[];if(t.forEach((function(e){e.forEach((function(e){e.forEach((function(e){n[e<0?~e:e].length<2&&o.push(e)}))}))})),(r=(o=a(e,o)).length)>1)for(var i,s,c=1,l=u(o[0]);c<r;++c)(i=u(o[c]))>l&&(s=o[0],o[0]=o[c],o[c]=s,l=i);return o}))}}function l(e,t){return e[1][2]-t[1][2]}e.version="1.6.26",e.mesh=function(e){return i(e,s.apply(this,arguments))},e.meshArcs=s,e.merge=function(e){return i(e,c.apply(this,arguments))},e.mergeArcs=c,e.feature=function(e,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map((function(t){return o(e,t)}))}:o(e,t)},e.neighbors=function(e){var t={},n=e.map((function(){return[]}));function o(e,n){e.forEach((function(e){e<0&&(e=~e);var r=t[e];r?r.push(n):t[e]=[n]}))}function i(e,t){e.forEach((function(e){o(e,t)}))}var a={LineString:o,MultiLineString:i,Polygon:i,MultiPolygon:function(e,t){e.forEach((function(e){i(e,t)}))}};for(var s in e.forEach((function e(t,n){"GeometryCollection"===t.type?t.geometries.forEach((function(t){e(t,n)})):t.type in a&&a[t.type](t.arcs,n)})),t)for(var u=t[s],c=u.length,l=0;l<c;++l)for(var h=l+1;h<c;++h){var f,d=u[l],p=u[h];(f=n[d])[s=r(f,p)]!==p&&f.splice(s,0,p),(f=n[p])[s=r(f,d)]!==d&&f.splice(s,0,d)}return n},e.presimplify=function(e,r){var o=n(e.transform),i=function(e){if(!e)return t;var n,r,o=e.scale[0],i=e.scale[1],a=e.translate[0],s=e.translate[1];return function(e,t){t||(n=r=0);var u=Math.round((e[0]-a)/o),c=Math.round((e[1]-s)/i);e[0]=u-n,e[1]=c-r,n=u,r=c}}(e.transform),a=function(){var e={},t=[],n=0;function r(e,n){for(;n>0;){var r=(n+1>>1)-1,o=t[r];if(l(e,o)>=0)break;t[o._=n]=o,t[e._=n=r]=e}}function o(e,r){for(;;){var o=r+1<<1,i=o-1,a=r,s=t[a];if(i<n&&l(t[i],s)<0&&(s=t[a=i]),o<n&&l(t[o],s)<0&&(s=t[a=o]),a===r)break;t[s._=r]=s,t[e._=r=a]=e}}return e.push=function(e){return r(t[e._=n]=e,n++),n},e.pop=function(){if(!(n<=0)){var e,r=t[0];return--n>0&&o(t[(e=t[n])._=0]=e,0),r}},e.remove=function(e){var i,a=e._;if(t[a]===e)return a!==--n&&(l(i=t[n],e)<0?r:o)(t[i._=a]=i,a),a},e}();function s(e){a.remove(e),e[1][2]=r(e),a.push(e)}return r||(r=u),e.arcs.forEach((function(e){var t,n,u,c,l=[],h=0;for(n=0,u=e.length;n<u;++n)o(e[n]=[(c=e[n])[0],c[1],1/0],n);for(n=1,u=e.length-1;n<u;++n)(t=e.slice(n-1,n+2))[1][2]=r(t),l.push(t),a.push(t);for(n=0,u=l.length;n<u;++n)(t=l[n]).previous=l[n-1],t.next=l[n+1];for(;t=a.pop();){var f=t.previous,d=t.next;t[1][2]<h?t[1][2]=h:h=t[1][2],f&&(f.next=d,f[2]=t[2],s(f)),d&&(d.previous=f,d[0]=t[0],s(d))}e.forEach(i)})),e}}(t)},os0x:function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",(function(){return o})),n.d(t,"__assign",(function(){return i})),n.d(t,"__rest",(function(){return a})),n.d(t,"__decorate",(function(){return s})),n.d(t,"__param",(function(){return u})),n.d(t,"__metadata",(function(){return c})),n.d(t,"__awaiter",(function(){return l})),n.d(t,"__generator",(function(){return h})),n.d(t,"__exportStar",(function(){return f})),n.d(t,"__values",(function(){return d})),n.d(t,"__read",(function(){return p})),n.d(t,"__spread",(function(){return y})),n.d(t,"__spreadArrays",(function(){return v})),n.d(t,"__await",(function(){return m})),n.d(t,"__asyncGenerator",(function(){return g})),n.d(t,"__asyncDelegator",(function(){return b})),n.d(t,"__asyncValues",(function(){return _})),n.d(t,"__makeTemplateObject",(function(){return w})),n.d(t,"__importStar",(function(){return C})),n.d(t,"__importDefault",(function(){return k}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function s(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function u(e,t){return function(n,r){t(n,r,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function h(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function f(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function d(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function p(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(s){o={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}function v(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}function m(e){return this instanceof m?(this.v=e,this):new m(e)}function g(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),i=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){i.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=o[e](t)).value instanceof m?Promise.resolve(n.value.v).then(u,c):l(i[0][2],n)}catch(r){l(i[0][3],r)}var n}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function b(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,o){t[r]=e[r]?function(t){return(n=!n)?{value:m(e[r](t)),done:"return"===r}:o?o(t):t}:o}}function _(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=d(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,o,(t=e[n](t)).done,t.value)}))}}}function w(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function k(e){return e&&e.__esModule?e:{default:e}}},"q/0M":function(e,t,n){"use strict";n.r(t),n.d(t,"LogLevel",(function(){return o})),n.d(t,"Logger",(function(){return s})),n.d(t,"setLogLevel",(function(){return u}));var r=[],o=function(e){return e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",e}({}),i=o.INFO,a=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var i=(new Date).toISOString();switch(t){case o.DEBUG:case o.VERBOSE:console.log.apply(console,["["+i+"]  "+e.name+":"].concat(n));break;case o.INFO:console.info.apply(console,["["+i+"]  "+e.name+":"].concat(n));break;case o.WARN:console.warn.apply(console,["["+i+"]  "+e.name+":"].concat(n));break;case o.ERROR:console.error.apply(console,["["+i+"]  "+e.name+":"].concat(n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+t+")")}}},s=function(){function e(e){this.name=e,this._logLevel=i,this._logHandler=a,r.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in o))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!0,configurable:!0}),e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,o.DEBUG].concat(e))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,o.VERBOSE].concat(e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,o.INFO].concat(e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,o.WARN].concat(e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,o.ERROR].concat(e))},e}();function u(e){r.forEach((function(t){t.logLevel=e}))}},qwng:function(e,t,n){var r=function(){"use strict";var e,t=/\s*/g,r=/^\s*|\s*$/g,o=/\s+/;function i(e){if(!e||!e.length)return 0;for(var t=0,n=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t)|0;return n}function a(e,t){return e.getElementsByTagName(t)}function s(e,t){return e.getAttribute(t)}function u(e,t){return parseFloat(s(e,t))}function c(e,t){var n=a(e,t);return n.length?n[0]:null}function l(e){for(var t=0,n=[];t<e.length;t++)n[t]=parseFloat(e[t]);return n}function h(e){var t;return e&&(t=e).normalize&&t.normalize(),e&&e.textContent||""}function f(e){return l(e.replace(t,"").split(","))}function d(e){for(var t=e.replace(r,"").split(o),n=[],i=0;i<t.length;i++)n.push(f(t[i]));return n}function p(e){var t,n=[u(e,"lon"),u(e,"lat")],r=c(e,"ele"),o=c(e,"gpxtpx:hr")||c(e,"hr"),i=c(e,"time");return r&&(t=parseFloat(h(r)),isNaN(t)||n.push(t)),{coordinates:n,time:i?h(i):null,heartRate:o?parseFloat(h(o)):null}}function y(t){return void 0!==t.xml?t.xml:e.serializeToString(t)}return"undefined"!=typeof XMLSerializer?e=new XMLSerializer:"object"!=typeof process||process.browser||(e=new(n(1).XMLSerializer)),{kml:function(e){for(var t={type:"FeatureCollection",features:[]},n={},r=["Polygon","LineString","Point","Track","gx:Track"],o=a(e,"Placemark"),u=a(e,"Style"),p=a(e,"StyleMap"),v=0;v<u.length;v++)n["#"+s(u[v],"id")]=i(y(u[v])).toString(16);for(var m=0;m<p.length;m++)n["#"+s(p[m],"id")]=i(y(p[m])).toString(16);for(var g=0;g<o.length;g++)t.features=t.features.concat(w(o[g]));function b(e){var t,n;return"#"===(e=e||"").substr(0,1)&&(e=e.substr(1)),6!==e.length&&3!==e.length||(t=e),8===e.length&&(n=parseInt(e.substr(0,2),16)/255,t="#"+e.substr(2)),[t,isNaN(n)?void 0:n]}function _(e){var t=a(e,"coord"),n=[],r=[];0===t.length&&(t=a(e,"gx:coord"));for(var o=0;o<t.length;o++)n.push(l(h(t[o]).split(" ")));for(var i=a(e,"when"),s=0;s<i.length;s++)r.push(h(i[s]));return{coords:n,times:r}}function w(e){var t,o=function e(t){var n,o,i,s,u,l=[],p=[];if(c(t,"MultiGeometry"))return e(c(t,"MultiGeometry"));if(c(t,"MultiTrack"))return e(c(t,"MultiTrack"));if(c(t,"gx:MultiTrack"))return e(c(t,"gx:MultiTrack"));for(i=0;i<r.length;i++)if(o=a(t,r[i]))for(s=0;s<o.length;s++)if(n=o[s],"Point"===r[i])l.push({type:"Point",coordinates:f(h(c(n,"coordinates")))});else if("LineString"===r[i])l.push({type:"LineString",coordinates:d(h(c(n,"coordinates")))});else if("Polygon"===r[i]){var y=a(n,"LinearRing"),v=[];for(u=0;u<y.length;u++)v.push(d(h(c(y[u],"coordinates"))));l.push({type:"Polygon",coordinates:v})}else if("Track"===r[i]||"gx:Track"===r[i]){var m=_(n);l.push({type:"LineString",coordinates:m.coords}),m.times.length&&p.push(m.times)}return{geoms:l,coordTimes:p}}(e),i={},u=h(c(e,"name")),l=h(c(e,"styleUrl")),p=h(c(e,"description")),y=c(e,"TimeSpan"),v=c(e,"ExtendedData"),m=c(e,"LineStyle"),g=c(e,"PolyStyle");if(!o.geoms.length)return[];if(u&&(i.name=u),"#"!==l[0]&&(l="#"+l),l&&n[l]&&(i.styleUrl=l,i.styleHash=n[l]),p&&(i.description=p),y){var w=h(c(y,"begin")),C=h(c(y,"end"));i.timespan={begin:w,end:C}}if(m){var k=b(h(c(m,"color"))),S=k[0],E=k[1],T=parseFloat(h(c(m,"width")));S&&(i.stroke=S),isNaN(E)||(i["stroke-opacity"]=E),isNaN(T)||(i["stroke-width"]=T)}if(g){var I=b(h(c(g,"color"))),A=I[0],D=I[1],N=h(c(g,"fill")),P=h(c(g,"outline"));A&&(i.fill=A),isNaN(D)||(i["fill-opacity"]=D),N&&(i["fill-opacity"]="1"===N?1:0),P&&(i["stroke-opacity"]="1"===P?1:0)}if(v){var x=a(v,"Data"),O=a(v,"SimpleData");for(t=0;t<x.length;t++)i[x[t].getAttribute("name")]=h(c(x[t],"value"));for(t=0;t<O.length;t++)i[O[t].getAttribute("name")]=h(O[t])}o.coordTimes.length&&(i.coordTimes=1===o.coordTimes.length?o.coordTimes[0]:o.coordTimes);var M={type:"Feature",geometry:1===o.geoms.length?o.geoms[0]:{type:"GeometryCollection",geometries:o.geoms},properties:i};return s(e,"id")&&(M.id=s(e,"id")),[M]}return t},gpx:function(e){var t,n,r,o,i=a(e,"trk"),s=a(e,"rte"),u=a(e,"wpt"),l={type:"FeatureCollection",features:[]};for(t=0;t<i.length;t++)(n=d(i[t]))&&l.features.push(n);for(t=0;t<s.length;t++)(n=y(s[t]))&&l.features.push(n);for(t=0;t<u.length;t++)l.features.push((o=void 0,(o=v(r=u[t])).sym=h(c(r,"sym")),{type:"Feature",properties:o,geometry:{type:"Point",coordinates:p(r).coordinates}}));function f(e,t){var n=a(e,t),r=[],o=[],i=[],s=n.length;if(s<2)return{};for(var u=0;u<s;u++){var c=p(n[u]);r.push(c.coordinates),c.time&&o.push(c.time),c.heartRate&&i.push(c.heartRate)}return{line:r,times:o,heartRates:i}}function d(e){for(var t,n=a(e,"trkseg"),r=[],o=[],i=[],s=0;s<n.length;s++)(t=f(n[s],"trkpt")).line&&r.push(t.line),t.times&&t.times.length&&o.push(t.times),t.heartRates&&t.heartRates.length&&i.push(t.heartRates);if(0!==r.length){var u=v(e);return o.length&&(u.coordTimes=1===r.length?o[0]:o),i.length&&(u.heartRates=1===r.length?i[0]:i),{type:"Feature",properties:u,geometry:{type:1===r.length?"LineString":"MultiLineString",coordinates:1===r.length?r[0]:r}}}}function y(e){var t=f(e,"rtept");if(t.line)return{type:"Feature",properties:v(e),geometry:{type:"LineString",coordinates:t.line}}}function v(e){var t,n=["name","desc","author","copyright","link","time","keywords"],r={};for(t=0;t<n.length;t++)r[n[t]]=h(c(e,n[t]));return function(e){var t={};for(var n in e)e[n]&&(t[n]=e[n]);return t}(r)}return l}}}();e.exports=r},vyr2:function(e,t,n){var r=n("93Jm"),o=n("Nuzq"),i=n("Mkpm"),a=n("cSZD"),s=n("iML4"),u=n("qwng");function c(e,t){"setGeoJSON"in e?e.setGeoJSON(t):"addData"in e&&e.addData(t)}function l(e,t,n){var r="string"==typeof e?JSON.parse(e):e;for(var o in n=n||L.geoJson(),r.objects){var i=s.feature(r,r.objects[o]);c(n,i.features?i.features:i)}return n}function h(e,t,n){return n=n||L.geoJson(),o.csv2geojson(e,t=t||{},(function(e,t){if(e)return n.fire("error",{error:e});c(n,t)})),n}function f(e,t,n){var r=v(e);return r?(c(n=n||L.geoJson(),u.gpx(r)),n):n.fire("error",{error:"Could not parse GPX"})}function d(e,t,n){var r=v(e);return r?(c(n=n||L.geoJson(),u.kml(r)),n):n.fire("error",{error:"Could not parse KML"})}function p(e,t,n){n=n||L.geoJson();for(var r=a.decode(e,(t=t||{}).precision),o={type:"LineString",coordinates:[]},i=0;i<r.length;i++)o.coordinates[i]=[r[i][1],r[i][0]];return c(n,o),n}function y(e,t,n){return c(n=n||L.geoJson(),i(e)),n}function v(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/xml"):e}e.exports.polyline=function(e,t,n){var o=n||L.geoJson();return r(e,(function(e,n){if(e)return o.fire("error",{error:e});p(n.responseText,t,o),o.fire("ready")})),o},e.exports.polyline.parse=p,e.exports.geojson=function(e,t,n){var o=n||L.geoJson();return r(e,(function(e,t){if(e)return o.fire("error",{error:e});c(o,JSON.parse(t.responseText)),o.fire("ready")})),o},e.exports.topojson=function(e,t,n){var o=n||L.geoJson();return r(e,(function(e,t){if(e)return o.fire("error",{error:e});l(t.responseText,0,o),o.fire("ready")})),o},e.exports.topojson.parse=l,e.exports.csv=function(e,t,n){var o=n||L.geoJson();return r(e,(function(e,n){var r;if(e)return o.fire("error",{error:e});function i(){r=!0}o.on("error",i),h(n.responseText,t,o),o.off("error",i),r||o.fire("ready")})),o},e.exports.csv.parse=h,e.exports.gpx=function(e,t,n){var o=n||L.geoJson();return r(e,(function(e,t){var n;if(e)return o.fire("error",{error:e});function r(){n=!0}o.on("error",r),f(t.responseXML||t.responseText,0,o),o.off("error",r),n||o.fire("ready")})),o},e.exports.gpx.parse=f,e.exports.kml=function(e,t,n){var o=n||L.geoJson();return r(e,(function(e,t){var n;if(e)return o.fire("error",{error:e});function r(){n=!0}o.on("error",r),d(t.responseXML||t.responseText,0,o),o.off("error",r),n||o.fire("ready")})),o},e.exports.kml.parse=d,e.exports.wkt=function(e,t,n){var o=n||L.geoJson();return r(e,(function(e,t){if(e)return o.fire("error",{error:e});y(t.responseText,0,o),o.fire("ready")})),o},e.exports.wkt.parse=y},wj3C:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n("30Go"),i=n("zVF4"),a=n("q/0M"),s=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r),u=new i.ErrorFactory("app","Firebase",s),c=[],l=function(){function e(e,t,n){this.firebase_=n,this.isDeleted_=!1,this.services_={},this.name_=t.name,this.automaticDataCollectionEnabled_=t.automaticDataCollectionEnabled||!1,this.options_=i.deepCopy(e),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(e){c.push(e),setTimeout((function(){return e(null)}),0)},removeAuthTokenListener:function(e){c=c.filter((function(t){return t!==e}))}}}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise((function(t){e.checkDestroyed_(),t()})).then((function(){e.firebase_.INTERNAL.removeApp(e.name_);for(var t=[],n=0,r=Object.keys(e.services_);n<r.length;n++)for(var o=r[n],i=0,a=Object.keys(e.services_[o]);i<a.length;i++)t.push(e.services_[o][a[i]]);return Promise.all(t.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()})))})).then((function(){e.isDeleted_=!0,e.services_={}}))},e.prototype._getService=function(e,t){if(void 0===t&&(t="[DEFAULT]"),this.checkDestroyed_(),this.services_[e]||(this.services_[e]={}),!this.services_[e][t]){var n="[DEFAULT]"!==t?t:void 0,r=this.firebase_.INTERNAL.factories[e](this,this.extendApp.bind(this),n);this.services_[e][t]=r}return this.services_[e][t]},e.prototype._removeServiceInstance=function(e,t){void 0===t&&(t="[DEFAULT]"),this.services_[e]&&this.services_[e][t]&&delete this.services_[e][t]},e.prototype.extendApp=function(e){var t=this;i.deepExtend(this,e),e.INTERNAL&&e.INTERNAL.addAuthTokenListener&&(c.forEach((function(e){t.INTERNAL.addAuthTokenListener(e)})),c=[])},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw u.create("app-deleted",{appName:this.name_})},e}();l.prototype.name&&l.prototype.options||l.prototype.delete||console.log("dc");var h=new a.Logger("@firebase/app");if(i.isBrowser()&&void 0!==self.firebase){h.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var f=self.firebase.SDK_VERSION;f&&f.indexOf("LITE")>=0&&h.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var d=function e(){var t=function(e){var t={},n={},r={},o={__esModule:!0,initializeApp:function(n,r){void 0===r&&(r={}),"object"==typeof r&&null!==r||(r={name:r});var a=r;void 0===a.name&&(a.name="[DEFAULT]");var s=a.name;if("string"!=typeof s||!s)throw u.create("bad-app-name",{appName:String(s)});if(i.contains(t,s))throw u.create("duplicate-app",{appName:s});var l=new e(n,a,o);return t[s]=l,c(l,"create"),l},app:a,apps:null,SDK_VERSION:"6.6.2",INTERNAL:{registerService:function(t,c,l,f,d){if(void 0===d&&(d=!1),n[t])return h.debug("There were multiple attempts to register service "+t+"."),o[t];function p(e){if(void 0===e&&(e=a()),"function"!=typeof e[t])throw u.create("invalid-app-argument",{appName:t});return e[t]()}return n[t]=c,f&&(r[t]=f,s().forEach((function(e){f("create",e)}))),void 0!==l&&i.deepExtend(p,l),o[t]=p,e.prototype[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=this._getService.bind(this,t);return r.apply(this,d?e:[])},p},removeApp:function(e){c(t[e],"delete"),delete t[e]},factories:n,useAsService:l}};function a(e){if(!i.contains(t,e=e||"[DEFAULT]"))throw u.create("no-app",{appName:e});return t[e]}function s(){return Object.keys(t).map((function(e){return t[e]}))}function c(e,t){for(var o=0,i=Object.keys(n);o<i.length;o++){var a=l(0,i[o]);if(null===a)return;r[a]&&r[a](t,e)}}function l(e,t){return"serverAuth"===t?null:t}return o.default=o,Object.defineProperty(o,"apps",{get:s}),a.App=e,o}(l);return t.INTERNAL=o.__assign({},t.INTERNAL,{createFirebaseNamespace:e,extendNamespace:function(e){i.deepExtend(t,e)},createSubscribe:i.createSubscribe,ErrorFactory:i.ErrorFactory,deepExtend:i.deepExtend}),t}(),p=d.initializeApp;d.initializeApp=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i.isNode()&&h.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),p.apply(void 0,e)};var y=d;t.default=y,t.firebase=y},x7I3:function(e,t,n){"use strict";n.r(t),n.d(t,"ErrorCode",(function(){return sr})),n.d(t,"EventType",(function(){return ur})),n.d(t,"WebChannel",(function(){return cr})),n.d(t,"XhrIo",(function(){return lr})),n.d(t,"createWebChannelTransport",(function(){return ar}));var r,o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},i=i||{},a=o;function s(e){return"string"==typeof e}function u(e){return"number"==typeof e}function c(e,t){e=e.split("."),t=t||a;for(var n=0;n<e.length;n++)if(null==(t=t[e[n]]))return null;return t}function l(){}function h(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var n=Object.prototype.toString.call(e);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof e.length&&void 0!==e.splice&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==e.call&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&void 0===e.call)return"object";return t}function f(e){return"array"==h(e)}function d(e){var t=h(e);return"array"==t||"object"==t&&"number"==typeof e.length}function p(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var y="closure_uid_"+(1e9*Math.random()>>>0),v=0;function m(e,t,n){return e.call.apply(e.bind,arguments)}function g(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function b(e,t,n){return(b=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?m:g).apply(null,arguments)}function _(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var w=Date.now||function(){return+new Date};function C(e,t){function n(){}n.prototype=t.prototype,e.N=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.yb=function(e,n,r){for(var o=Array(arguments.length-2),i=2;i<arguments.length;i++)o[i-2]=arguments[i];return t.prototype[n].apply(e,o)}}function k(){this.j=this.j,this.i=this.i}k.prototype.j=!1,k.prototype.la=function(){!this.j&&(this.j=!0,this.G(),0)&&(this[y]||(this[y]=++v))},k.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var S=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if(s(e))return s(t)&&1==t.length?e.indexOf(t,0):-1;for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},E=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,o=s(e)?e.split(""):e,i=0;i<r;i++)i in o&&t.call(n,o[i],i,e)};function T(e){return Array.prototype.concat.apply([],arguments)}function I(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function A(e){return/^[\s\xa0]*$/.test(e)}var D,N=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function P(e,t){return-1!=e.indexOf(t)}function x(e,t){return e<t?-1:e>t?1:0}e:{var O=a.navigator;if(O){var M=O.userAgent;if(M){D=M;break e}}D=""}function R(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function L(e){var t,n={};for(t in e)n[t]=e[t];return n}var F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function V(e,t){for(var n,r,o=1;o<arguments.length;o++){for(n in r=arguments[o])e[n]=r[n];for(var i=0;i<F.length;i++)n=F[i],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function B(e){return B[" "](e),e}B[" "]=l;var q,j,U=P(D,"Opera"),G=P(D,"Trident")||P(D,"MSIE"),z=P(D,"Edge"),W=z||G,H=P(D,"Gecko")&&!(P(D.toLowerCase(),"webkit")&&!P(D,"Edge"))&&!(P(D,"Trident")||P(D,"MSIE"))&&!P(D,"Edge"),Q=P(D.toLowerCase(),"webkit")&&!P(D,"Edge");function K(){var e=a.document;return e?e.documentMode:void 0}e:{var Y="",J=(j=D,H?/rv:([^\);]+)(\)|;)/.exec(j):z?/Edge\/([\d\.]+)/.exec(j):G?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(j):Q?/WebKit\/(\S+)/.exec(j):U?/(?:Version)[ \/]?(\S+)/.exec(j):void 0);if(J&&(Y=J?J[1]:""),G){var $=K();if(null!=$&&$>parseFloat(Y)){q=String($);break e}}q=Y}var Z,X={};function ee(e){return function(e,t){var n=X;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t()}(e,(function(){for(var t=0,n=N(String(q)).split("."),r=N(String(e)).split("."),o=Math.max(n.length,r.length),i=0;0==t&&i<o;i++){var a=n[i]||"",s=r[i]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;t=x(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||x(0==a[2].length,0==s[2].length)||x(a[2],s[2]),a=a[3],s=s[3]}while(0==t)}return 0<=t}))}var te=a.document;Z=te&&G?K()||("CSS1Compat"==te.compatMode?parseInt(q,10):5):void 0;var ne=!G||9<=Number(Z),re=G&&!ee("9"),oe=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{a.addEventListener("test",l,t),a.removeEventListener("test",l,t)}catch(n){}return e}();function ie(e,t){this.type=e,this.a=this.target=t,this.Ja=!0}function ae(e,t){if(ie.call(this,e?e.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.a=t,t=e.relatedTarget){if(H){e:{try{B(t.nodeName);var o=!0;break e}catch(i){}o=!1}o||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=s(e.pointerType)?e.pointerType:se[e.pointerType]||"",this.c=e,e.defaultPrevented&&this.b()}}ie.prototype.b=function(){this.Ja=!1},C(ae,ie);var se={2:"touch",3:"pen",4:"mouse"};ae.prototype.b=function(){ae.N.b.call(this);var e=this.c;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,re)try{(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)&&(e.keyCode=-1)}catch(t){}};var ue="closure_listenable_"+(1e6*Math.random()|0),ce=0;function le(e,t,n,r,o){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.da=o,this.key=++ce,this.X=this.Z=!1}function he(e){e.X=!0,e.listener=null,e.proxy=null,e.src=null,e.da=null}function fe(e){this.src=e,this.a={},this.b=0}function de(e,t){var n=t.type;if(n in e.a){var r,o=e.a[n],i=S(o,t);(r=0<=i)&&Array.prototype.splice.call(o,i,1),r&&(he(t),0==e.a[n].length&&(delete e.a[n],e.b--))}}function pe(e,t,n,r){for(var o=0;o<e.length;++o){var i=e[o];if(!i.X&&i.listener==t&&i.capture==!!n&&i.da==r)return o}return-1}fe.prototype.add=function(e,t,n,r,o){var i=e.toString();(e=this.a[i])||(e=this.a[i]=[],this.b++);var a=pe(e,t,r,o);return-1<a?(t=e[a],n||(t.Z=!1)):((t=new le(t,this.src,i,!!r,o)).Z=n,e.push(t)),t};var ye="closure_lm_"+(1e6*Math.random()|0),ve={};function me(e,t,n,r,o){if(r&&r.once)return function e(t,n,r,o,i){if(f(n)){for(var a=0;a<n.length;a++)e(t,n[a],r,o,i);return null}return r=Se(r),t&&t[ue]?t.Ba(n,r,p(o)?!!o.capture:!!o,i):ge(t,n,r,!0,o,i)}(e,t,n,r,o);if(f(t)){for(var i=0;i<t.length;i++)me(e,t[i],n,r,o);return null}return n=Se(n),e&&e[ue]?e.Aa(t,n,p(r)?!!r.capture:!!r,o):ge(e,t,n,!1,r,o)}function ge(e,t,n,r,o,i){if(!t)throw Error("Invalid event type");var a=p(o)?!!o.capture:!!o;if(a&&!ne)return null;var s=Ce(e);if(s||(e[ye]=s=new fe(e)),(n=s.add(t,n,r,a,i)).proxy)return n;if(r=function(){var e=we,t=ne?function(n){return e.call(t.src,t.listener,n)}:function(n){if(!(n=e.call(t.src,t.listener,n)))return n};return t}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)oe||(o=a),void 0===o&&(o=!1),e.addEventListener(t.toString(),r,o);else if(e.attachEvent)e.attachEvent(_e(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function be(e){if(!u(e)&&e&&!e.X){var t=e.src;if(t&&t[ue])de(t.c,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(_e(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Ce(t))?(de(n,e),0==n.b&&(n.src=null,t[ye]=null)):he(e)}}}function _e(e){return e in ve?ve[e]:ve[e]="on"+e}function we(e,t){return!!e.X||function(e,t){var n=e.listener,r=e.da||e.src;return e.Z&&be(e),n.call(r,t)}(e,ne?new ae(t,this):t=new ae(t||c("window.event"),this))}function Ce(e){return(e=e[ye])instanceof fe?e:null}var ke="__closure_events_fn_"+(1e9*Math.random()>>>0);function Se(e){return"function"==h(e)?e:(e[ke]||(e[ke]=function(t){return e.handleEvent(t)}),e[ke])}function Ee(){k.call(this),this.c=new fe(this),this.J=this,this.B=null}function Te(e,t,n,r){if(!(t=e.c.a[String(t)]))return!0;t=t.concat();for(var o=!0,i=0;i<t.length;++i){var a=t[i];if(a&&!a.X&&a.capture==n){var s=a.listener,u=a.da||a.src;a.Z&&de(e.c,a),o=!1!==s.call(u,r)&&o}}return o&&0!=r.Ja}C(Ee,k),Ee.prototype[ue]=!0,(r=Ee.prototype).addEventListener=function(e,t,n,r){me(this,e,t,n,r)},r.removeEventListener=function(e,t,n,r){!function e(t,n,r,o,i){if(f(n))for(var a=0;a<n.length;a++)e(t,n[a],r,o,i);else o=p(o)?!!o.capture:!!o,r=Se(r),t&&t[ue]?(t=t.c,(n=String(n).toString())in t.a&&-1<(r=pe(a=t.a[n],r,o,i))&&(he(a[r]),Array.prototype.splice.call(a,r,1),0==a.length&&(delete t.a[n],t.b--))):t&&(t=Ce(t))&&(n=t.a[n.toString()],t=-1,n&&(t=pe(n,r,o,i)),(r=-1<t?n[t]:null)&&be(r))}(this,e,t,n,r)},r.dispatchEvent=function(e){var t,n=this.B;if(n)for(t=[];n;n=n.B)t.push(n);n=this.J;var r=e.type||e;if(s(e))e=new ie(e,n);else if(e instanceof ie)e.target=e.target||n;else{var o=e;V(e=new ie(r,n),o)}if(o=!0,t)for(var i=t.length-1;0<=i;i--){var a=e.a=t[i];o=Te(a,r,!0,e)&&o}if(o=Te(a=e.a=n,r,!0,e)&&o,o=Te(a,r,!1,e)&&o,t)for(i=0;i<t.length;i++)o=Te(a=e.a=t[i],r,!1,e)&&o;return o},r.G=function(){if(Ee.N.G.call(this),this.c){var e,t=this.c;for(e in t.a){for(var n=t.a[e],r=0;r<n.length;r++)he(n[r]);delete t.a[e],t.b--}}this.B=null},r.Aa=function(e,t,n,r){return this.c.add(String(e),t,!1,n,r)},r.Ba=function(e,t,n,r){return this.c.add(String(e),t,!0,n,r)};var Ie=a.JSON.stringify;function Ae(e,t){this.c=e,this.f=t,this.b=0,this.a=null}function De(){this.b=this.a=null}Ae.prototype.get=function(){if(0<this.b){this.b--;var e=this.a;this.a=e.next,e.next=null}else e=this.c();return e};var Ne,Pe=new Ae((function(){return new Oe}),(function(e){e.reset()}));function xe(){var e=Fe,t=null;return e.a&&(t=e.a,e.a=e.a.next,e.a||(e.b=null),t.next=null),t}function Oe(){this.next=this.b=this.a=null}function Me(e){a.setTimeout((function(){throw e}),0)}function Re(e,t){Ne||function(){var e=a.Promise.resolve(void 0);Ne=function(){e.then(Ve)}}(),Le||(Ne(),Le=!0),Fe.add(e,t)}De.prototype.add=function(e,t){var n=Pe.get();n.set(e,t),this.b?this.b.next=n:this.a=n,this.b=n},Oe.prototype.set=function(e,t){this.a=e,this.b=t,this.next=null},Oe.prototype.reset=function(){this.next=this.b=this.a=null};var Le=!1,Fe=new De;function Ve(){for(var e;e=xe();){try{e.a.call(e.b)}catch(n){Me(n)}var t=Pe;t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}Le=!1}function Be(e,t){Ee.call(this),this.b=e||1,this.a=t||a,this.f=b(this.gb,this),this.g=w()}function qe(e){e.ba=!1,e.L&&(e.a.clearTimeout(e.L),e.L=null)}function je(e,t,n){if("function"==h(e))n&&(e=b(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=b(e.handleEvent,e)}return 2147483647<Number(t)?-1:a.setTimeout(e,t||0)}function Ue(e,t,n){k.call(this),this.f=null!=n?b(e,n):e,this.c=t,this.b=b(this.ab,this),this.a=[]}function Ge(e){e.U=je(e.b,e.c),e.f.apply(null,e.a)}function ze(e){k.call(this),this.b=e,this.a={}}C(Be,Ee),(r=Be.prototype).ba=!1,r.L=null,r.gb=function(){if(this.ba){var e=w()-this.g;0<e&&e<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-e):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(qe(this),this.start()))}},r.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=w())},r.G=function(){Be.N.G.call(this),qe(this),delete this.a},C(Ue,k),(r=Ue.prototype).ea=!1,r.U=null,r.Ua=function(e){this.a=arguments,this.U?this.ea=!0:Ge(this)},r.G=function(){Ue.N.G.call(this),this.U&&(a.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},r.ab=function(){this.U=null,this.ea&&(this.ea=!1,Ge(this))},C(ze,k);var We=[];function He(e,t,n,r){f(n)||(n&&(We[0]=n.toString()),n=We);for(var o=0;o<n.length;o++){var i=me(t,n[o],r||e.handleEvent,!1,e.b||e);if(!i)break;e.a[i.key]=i}}function Qe(e){R(e.a,(function(e,t){this.a.hasOwnProperty(t)&&be(e)}),e),e.a={}}function Ke(){}ze.prototype.G=function(){ze.N.G.call(this),Qe(this)},ze.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ye=new Ee;function Je(e){ie.call(this,"serverreachability",e)}function $e(e){Ye.dispatchEvent(new Je(Ye,e))}function Ze(e){ie.call(this,"statevent",e)}function Xe(e){Ye.dispatchEvent(new Ze(Ye,e))}function et(e){ie.call(this,"timingevent",e)}function tt(e,t){if("function"!=h(e))throw Error("Fn must not be null and must be a function");return a.setTimeout((function(){e()}),t)}C(Je,ie),C(Ze,ie),C(et,ie);var nt={NO_ERROR:0,hb:1,ob:2,nb:3,kb:4,mb:5,pb:6,Ma:7,TIMEOUT:8,sb:9},rt={jb:"complete",wb:"success",Na:"error",Ma:"abort",ub:"ready",vb:"readystatechange",TIMEOUT:"timeout",qb:"incrementaldata",tb:"progress",lb:"downloadprogress",xb:"uploadprogress"};function ot(){}function it(){}ot.prototype.a=null;var at,st={OPEN:"a",ib:"b",Na:"c",rb:"d"};function ut(){ie.call(this,"d")}function ct(){ie.call(this,"c")}function lt(){}function ht(e,t,n){this.g=e,this.W=t,this.V=n||1,this.I=new ze(this),this.O=ft,this.P=new Be(e=W?125:void 0),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}C(ut,ie),C(ct,ie),C(lt,ot),at=new lt;var ft=45e3,dt={},pt={};function yt(e,t,n){e.F=1,e.f=qt(Ot(t)),e.l=n,e.H=!0,mt(e,null)}function vt(e,t,n,r){e.F=1,e.f=qt(Ot(t)),e.l=null,e.H=n,mt(e,r)}function mt(e,t){e.v=w(),_t(e),e.D=Ot(e.f),Bt(e.D,"t",e.V),e.A=0,e.a=e.g.$(e.g.Y()?t:null),0<e.J&&(e.B=new Ue(b(e.Ka,e,e.a),e.J)),He(e.I,e.a,"readystatechange",e.eb),t=e.h?L(e.h):{},e.l?(e.w||(e.w="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.a.ca(e.D,e.w,e.l,t)):(e.w="GET",e.a.ca(e.D,e.w,null,t)),$e(1)}function gt(e,t,n){for(var r=!0;!e.m&&e.A<n.length;){var o=bt(e,n);if(o==pt){4==t&&(e.c=4,Xe(14),r=!1);break}if(o==dt){e.c=4,Xe(15),r=!1;break}Et(e,o)}4==t&&0==n.length&&(e.c=1,Xe(16),r=!1),e.b=e.b&&r,r||(St(e),kt(e))}function bt(e,t){var n=e.A,r=t.indexOf("\n",n);return-1==r?pt:(n=Number(t.substring(n,r)),isNaN(n)?dt:(r+=1)+n>t.length?pt:(t=t.substr(r,n),e.A=r+n,t))}function _t(e){e.R=w()+e.O,wt(e,e.O)}function wt(e,t){if(null!=e.i)throw Error("WatchDog timer not null");e.i=tt(b(e.bb,e),t)}function Ct(e){e.i&&(a.clearTimeout(e.i),e.i=null)}function kt(e){e.g.Da()||e.m||e.g.na(e)}function St(e){Ct(e);var t=e.B;t&&"function"==typeof t.la&&t.la(),e.B=null,qe(e.P),Qe(e.I),e.a&&(t=e.a,e.a=null,t.abort(),t.la())}function Et(e,t){try{e.g.Ga(e,t),$e(4)}catch(n){}}function Tt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(d(e)||s(e))E(e,t,void 0);else{if(e.K&&"function"==typeof e.K)var n=e.K();else if(e.C&&"function"==typeof e.C)n=void 0;else if(d(e)||s(e)){n=[];for(var r=e.length,o=0;o<r;o++)n.push(o)}else for(o in n=[],r=0,e)n[r++]=o;o=(r=function(e){if(e.C&&"function"==typeof e.C)return e.C();if(s(e))return e.split("");if(d(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e)).length;for(var i=0;i<o;i++)t.call(void 0,r[i],n&&n[i],e)}}function It(e,t){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof It)for(n=e.K(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function At(e,t){Nt(e.b,t)&&(delete e.b[t],e.c--,e.a.length>2*e.c&&Dt(e))}function Dt(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];Nt(e.b,r)&&(e.a[n++]=r),t++}e.a.length=n}if(e.c!=e.a.length){var o={};for(n=t=0;t<e.a.length;)Nt(o,r=e.a[t])||(e.a[n++]=r,o[r]=1),t++;e.a.length=n}}function Nt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(r=ht.prototype).setTimeout=function(e){this.O=e},r.eb=function(e){e=e.target;var t=this.B;t&&3==On(e)?t.Ua():this.Ka(e)},r.Ka=function(e){try{if(e==this.a)e:{var t=On(this.a),n=this.a.ya(),r=this.a.T();if(!(3>t||3==t&&!W&&!this.a.aa())){this.m||4!=t||7==n||$e(8==n||0>=r?3:2),Ct(this);var o=this.a.T();this.o=o;var i=this.a.aa();if(this.b=200==o){if(this.S&&!this.s){t:{if(this.a){var a=Mn(this.a,"X-HTTP-Initial-Response");if(a&&!A(a)){var s=a;break t}}s=null}if(!s){this.b=!1,this.c=3,Xe(12),St(this),kt(this);break e}this.s=!0,Et(this,s)}this.H?(gt(this,t,i),W&&this.b&&3==t&&(He(this.I,this.P,"tick",this.cb),this.P.start())):Et(this,i),4==t&&St(this),this.b&&!this.m&&(4==t?this.g.na(this):(this.b=!1,_t(this)))}else 400==o&&0<i.indexOf("Unknown SID")?(this.c=3,Xe(12)):(this.c=0,Xe(13)),St(this),kt(this)}}}catch(u){}},r.cb=function(){if(this.a){var e=On(this.a),t=this.a.aa();this.A<t.length&&(Ct(this),gt(this,e,t),this.b&&4!=e&&_t(this))}},r.cancel=function(){this.m=!0,St(this)},r.bb=function(){this.i=null;var e=w();0<=e-this.R?(2!=this.F&&($e(3),Xe(17)),St(this),this.c=2,kt(this)):wt(this,this.R-e)},(r=It.prototype).C=function(){Dt(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e},r.K=function(){return Dt(this),this.a.concat()},r.get=function(e,t){return Nt(this.b,e)?this.b[e]:t},r.set=function(e,t){Nt(this.b,e)||(this.c++,this.a.push(e)),this.b[e]=t},r.forEach=function(e,t){for(var n=this.K(),r=0;r<n.length;r++){var o=n[r],i=this.get(o);e.call(t,i,o,this)}};var Pt=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function xt(e,t){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,e instanceof xt?(this.h=void 0!==t?t:e.h,Mt(this,e.f),this.j=e.j,Rt(this,e.b),Lt(this,e.i),this.a=e.a,Ft(this,en(e.c)),this.g=e.g):e&&(n=String(e).match(Pt))?(this.h=!!t,Mt(this,n[1]||"",!0),this.j=jt(n[2]||""),Rt(this,n[3]||"",!0),Lt(this,n[4]),this.a=jt(n[5]||"",!0),Ft(this,n[6]||"",!0),this.g=jt(n[7]||"")):(this.h=!!t,this.c=new Yt(null,this.h))}function Ot(e){return new xt(e)}function Mt(e,t,n){e.f=n?jt(t,!0):t,e.f&&(e.f=e.f.replace(/:$/,""))}function Rt(e,t,n){e.b=n?jt(t,!0):t}function Lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.i=t}else e.i=null}function Ft(e,t,n){t instanceof Yt?(e.c=t,function(e,t){t&&!e.f&&(Jt(e),e.c=null,e.a.forEach((function(e,t){var n=t.toLowerCase();t!=n&&($t(this,t),Xt(this,n,e))}),e)),e.f=t}(e.c,e.h)):(n||(t=Ut(t,Qt)),e.c=new Yt(t,e.h))}function Vt(e,t,n){e.c.set(t,n)}function Bt(e,t,n){f(n)||(n=[String(n)]),Xt(e.c,t,n)}function qt(e){return Vt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^w()).toString(36)),e}function jt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Ut(e,t,n){return s(e)?(e=encodeURI(e).replace(t,Gt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Gt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}xt.prototype.toString=function(){var e=[],t=this.f;t&&e.push(Ut(t,zt,!0),":");var n=this.b;return(n||"file"==t)&&(e.push("//"),(t=this.j)&&e.push(Ut(t,zt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&e.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&e.push("/"),e.push(Ut(n,"/"==n.charAt(0)?Ht:Wt,!0))),(n=this.c.toString())&&e.push("?",n),(n=this.g)&&e.push("#",Ut(n,Kt)),e.join("")},xt.prototype.resolve=function(e){var t=Ot(this),n=!!e.f;n?Mt(t,e.f):n=!!e.j,n?t.j=e.j:n=!!e.b,n?Rt(t,e.b):n=null!=e.i;var r=e.a;if(n)Lt(t,e.i);else if(n=!!e.a){if("/"!=r.charAt(0))if(this.b&&!this.a)r="/"+r;else{var o=t.a.lastIndexOf("/");-1!=o&&(r=t.a.substr(0,o+1)+r)}if(".."==(o=r)||"."==o)r="";else if(P(o,"./")||P(o,"/.")){r=0==o.lastIndexOf("/",0),o=o.split("/");for(var i=[],a=0;a<o.length;){var s=o[a++];"."==s?r&&a==o.length&&i.push(""):".."==s?((1<i.length||1==i.length&&""!=i[0])&&i.pop(),r&&a==o.length&&i.push("")):(i.push(s),r=!0)}r=i.join("/")}else r=o}return n?t.a=r:n=""!==e.c.toString(),n?Ft(t,en(e.c)):n=!!e.g,n&&(t.g=e.g),t};var zt=/[#\/\?@]/g,Wt=/[#\?:]/g,Ht=/[#\?]/g,Qt=/[#\?@]/g,Kt=/#/g;function Yt(e,t){this.b=this.a=null,this.c=e||null,this.f=!!t}function Jt(e){e.a||(e.a=new It,e.b=0,e.c&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),o=null;if(0<=r){var i=e[n].substring(0,r);o=e[n].substring(r+1)}else i=e[n];t(i,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(e.c,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function $t(e,t){Jt(e),t=tn(e,t),Nt(e.a.b,t)&&(e.c=null,e.b-=e.a.get(t).length,At(e.a,t))}function Zt(e,t){return Jt(e),t=tn(e,t),Nt(e.a.b,t)}function Xt(e,t,n){$t(e,t),0<n.length&&(e.c=null,e.a.set(tn(e,t),I(n)),e.b+=n.length)}function en(e){var t=new Yt;return t.c=e.c,e.a&&(t.a=new It(e.a),t.b=e.b),t}function tn(e,t){return t=String(t),e.f&&(t=t.toLowerCase()),t}function nn(e){this.a=e,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function rn(e){var t=e.a.F.a;if(null!=t)Xe(4),t?(Xe(10),Hn(e.a,e,!1)):(Xe(11),Hn(e.a,e,!0));else{e.b=new ht(e,void 0,void 0),e.b.h=e.h,t=$n(t=e.a,t.Y()?e.f:null,e.i),Xe(4),Bt(t,"TYPE","xmlhttp");var n=e.a.j,r=e.a.I;n&&r&&Vt(t,n,r),vt(e.b,t,!1,e.f)}}function on(){this.a=this.b=null}function an(){this.a=new It}function sn(e){var t=typeof e;return"object"==t&&e||"function"==t?"o"+(e[y]||(e[y]=++v)):t.charAt(0)+e}function un(e,t){this.b=e,this.a=t}function cn(e){this.g=e||ln,e=a.PerformanceNavigationTiming?0<(e=a.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(a.ka&&a.ka.Ea&&a.ka.Ea()&&a.ka.Ea().zb),this.f=e?this.g:1,this.a=null,1<this.f&&(this.a=new an),this.b=null,this.c=[]}(r=Yt.prototype).add=function(e,t){Jt(this),this.c=null,e=tn(this,e);var n=this.a.get(e);return n||this.a.set(e,n=[]),n.push(t),this.b+=1,this},r.forEach=function(e,t){Jt(this),this.a.forEach((function(n,r){E(n,(function(n){e.call(t,n,r,this)}),this)}),this)},r.K=function(){Jt(this);for(var e=this.a.C(),t=this.a.K(),n=[],r=0;r<t.length;r++)for(var o=e[r],i=0;i<o.length;i++)n.push(t[r]);return n},r.C=function(e){Jt(this);var t=[];if(s(e))Zt(this,e)&&(t=T(t,this.a.get(tn(this,e))));else{e=this.a.C();for(var n=0;n<e.length;n++)t=T(t,e[n])}return t},r.set=function(e,t){return Jt(this),this.c=null,Zt(this,e=tn(this,e))&&(this.b-=this.a.get(e).length),this.a.set(e,[t]),this.b+=1,this},r.get=function(e,t){return e&&0<(e=this.C(e)).length?String(e[0]):t},r.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var e=[],t=this.a.K(),n=0;n<t.length;n++){var r=t[n],o=encodeURIComponent(String(r));r=this.C(r);for(var i=0;i<r.length;i++){var a=o;""!==r[i]&&(a+="="+encodeURIComponent(String(r[i]))),e.push(a)}}return this.c=e.join("&")},C((function(){}),(function(){})),(r=nn.prototype).M=null,r.$=function(e){return this.a.$(e)},r.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},r.Da=function(){return!1},r.Ga=function(e,t){if(this.c=e.o,0==this.M){if(!this.a.o&&(e=e.a)){var n=Mn(e,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(e=Mn(e,"X-HTTP-Session-Id"))&&(this.a.I=e)}if(t){try{var r=this.a.ja.a.parse(t)}catch(o){return(t=this.a).m=this.c,void Yn(t,2)}this.f=r[0]}else(t=this.a).m=this.c,Yn(t,2)}else 1==this.M&&(this.g?Xe(6):"11111"==t?(Xe(5),this.g=!0,(!G||10<=Number(Z))&&(this.c=200,this.b.cancel(),Xe(11),Hn(this.a,this,!0))):(Xe(7),this.g=!1))},r.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,rn(this)):1==this.M&&(this.g?(Xe(11),Hn(this.a,this,!0)):(Xe(10),Hn(this.a,this,!1)));else{0==this.M?Xe(8):1==this.M&&Xe(9);var e=this.a;e.m=this.c,Yn(e,2)}},r.Y=function(){return this.a.Y()},r.ma=function(){return this.a.ma()},an.prototype.add=function(e){this.a.set(sn(e),e)},an.prototype.C=function(){return this.a.C()};var ln=10;function hn(e,t){!e.a&&(P(t,"spdy")||P(t,"quic")||P(t,"h2"))&&(e.f=e.g,e.a=new an,e.b&&(yn(e,e.b),e.b=null))}function fn(e){return!!e.b||!!e.a&&e.a.a.c>=e.f}function dn(e){return e.b?1:e.a?e.a.a.c:0}function pn(e,t){return e.b?e=e.b==t:e.a?(t=sn(t),e=Nt(e.a.a.b,t)):e=!1,e}function yn(e,t){e.a?e.a.add(t):e.b=t}function vn(e,t){var n;e.b&&e.b==t?e.b=null:((n=e.a)&&(n=sn(t),n=Nt(e.a.a.b,n)),n&&At(e.a.a,sn(t)))}function mn(e){if(null!=e.b)return e.c.concat(e.b.j);if(null!=e.a&&0!=e.a.a.c){var t=e.c;return E(e.a.C(),(function(e){t=t.concat(e.j)})),t}return I(e.c)}function gn(){}function bn(){this.a=new gn}function _n(e,t,n){var r=n||"";try{Tt(e,(function(e,n){var o=e;p(e)&&(o=Ie(e)),t.push(r+n+"="+encodeURIComponent(o))}))}catch(o){throw t.push(r+"type="+encodeURIComponent("_badmap")),o}}function wn(e,t,n,r,o){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,o(r)}catch(i){}}cn.prototype.cancel=function(){this.c=mn(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(E(this.a.C(),(function(e){e.cancel()})),function(e){e.b={},e.a.length=0,e.c=0}(this.a.a))},gn.prototype.stringify=function(e){return a.JSON.stringify(e,void 0)},gn.prototype.parse=function(e){return a.JSON.parse(e,void 0)};var Cn=a.JSON.parse;function kn(e){Ee.call(this),this.headers=new It,this.H=e||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=Sn,this.D=this.F=!1}C(kn,Ee);var Sn="",En=/^https?$/i,Tn=["POST","PUT"];function In(e){return"content-type"==e.toLowerCase()}function An(e,t){e.b=!1,e.a&&(e.g=!0,e.a.abort(),e.g=!1),e.f=t,e.h=5,Dn(e),Pn(e)}function Dn(e){e.v||(e.v=!0,e.dispatchEvent("complete"),e.dispatchEvent("error"))}function Nn(e){if(e.b&&void 0!==i&&(!e.s[1]||4!=On(e)||2!=e.T()))if(e.l&&4==On(e))je(e.Fa,0,e);else if(e.dispatchEvent("readystatechange"),4==On(e)){e.b=!1;try{var t,n=e.T();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var o;if(o=0===n){var s=String(e.A).match(Pt)[1]||null;if(!s&&a.self&&a.self.location){var u=a.self.location.protocol;s=u.substr(0,u.length-1)}o=!En.test(s?s.toLowerCase():"")}t=o}t?(e.dispatchEvent("complete"),e.dispatchEvent("success")):(e.h=6,e.f=e.za()+" ["+e.T()+"]",Dn(e))}finally{Pn(e)}}}function Pn(e,t){if(e.a){xn(e);var n=e.a,r=e.s[0]?l:null;e.a=null,e.s=null,t||e.dispatchEvent("ready");try{n.onreadystatechange=r}catch(o){}}}function xn(e){e.a&&e.D&&(e.a.ontimeout=null),e.m&&(a.clearTimeout(e.m),e.m=null)}function On(e){return e.a?e.a.readyState:0}function Mn(e,t){return e.a?e.a.getResponseHeader(t):null}function Rn(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}if(r)return e;if(n=function(e){var t="";return R(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}(n),s(e)){if(t=encodeURIComponent(String(t)),t+=n=null!=n?"="+encodeURIComponent(String(n)):""){if(0>(n=e.indexOf("#"))&&(n=e.length),0>(r=e.indexOf("?"))||r>n){r=n;var o=""}else o=e.substring(r+1,n);n=(e=[e.substr(0,r),o,e.substr(n)])[1],e[1]=t?n?n+"&"+t:t:n,e=e[0]+(e[1]?"?"+e[1]:"")+e[2]}return e}return Vt(e,t,n),e}function Ln(e){this.f=[],this.F=new on,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Ra=this.P=0,this.Pa=!!c("internalChannelParams.failFast",e),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Oa=c("internalChannelParams.baseRetryDelayMs",e)||5e3,this.Sa=c("internalChannelParams.retryDelaySeedMs",e)||1e4,this.Qa=c("internalChannelParams.forwardChannelMaxRetries",e)||2,this.qa=c("internalChannelParams.forwardChannelRequestTimeoutMs",e)||2e4,this.La=e&&e.Ab||void 0,this.D=void 0,this.R=e&&e.supportsCrossDomainXhr||!1,this.H="",this.b=new cn(e&&e.concurrentRequestLimit),this.ja=new bn,this.o=!e||void 0===e.backgroundChannelTest||e.backgroundChannelTest,(this.W=e&&e.fastHandshake||!1)&&!this.o&&(this.o=!0),e&&e.forceLongPolling&&(this.oa=!1),this.fa=void 0}function Fn(e){if(Vn(e),3==e.u){var t=e.P++,n=Ot(e.B);Vt(n,"SID",e.H),Vt(n,"RID",t),Vt(n,"TYPE","terminate"),Un(e,n),(t=new ht(e,t,void 0)).F=2,t.f=qt(Ot(n)),n=!1,a.navigator&&a.navigator.sendBeacon&&(n=a.navigator.sendBeacon(t.f.toString(),"")),!n&&a.Image&&((new Image).src=t.f,n=!0),n||(t.a=t.g.$(null),t.a.ca(t.f)),t.v=w(),_t(t)}Jn(e)}function Vn(e){e.w&&(e.w.abort(),e.w=null),e.a&&(e.a.cancel(),e.a=null),e.l&&(a.clearTimeout(e.l),e.l=null),Qn(e),e.b.cancel(),e.h&&(u(e.h)&&a.clearTimeout(e.h),e.h=null)}function Bn(e,t){e.f.push(new un(e.Ra++,t)),3==e.u&&qn(e)}function qn(e){fn(e.b)||e.h||(e.h=!0,Re(e.Ia,e),e.A=0)}function jn(e,t){var n;n=t?t.W:e.P++;var r=Ot(e.B);Vt(r,"SID",e.H),Vt(r,"RID",n),Vt(r,"AID",e.O),Un(e,r),e.g&&e.i&&Rn(r,e.g,e.i),n=new ht(e,n,e.A+1),null===e.g&&(n.h=e.i),t&&(e.f=t.j.concat(e.f)),t=Gn(e,n,1e3),n.setTimeout(Math.round(.5*e.qa)+Math.round(.5*e.qa*Math.random())),yn(e.b,n),yt(n,r,t)}function Un(e,t){e.c&&Tt({},(function(e,n){Vt(t,n,e)}))}function Gn(e,t,n){n=Math.min(e.f.length,n);var r=e.c?b(e.c.Ta,e.c,e):null;e:for(var o=e.f,i=-1;;){var a=["count="+n];-1==i?0<n?a.push("ofs="+(i=o[0].b)):i=0:a.push("ofs="+i);for(var s=!0,u=0;u<n;u++){var c=o[u].b,l=o[u].a;if(0>(c-=i))i=Math.max(0,o[u].b-100),s=!1;else try{_n(l,a,"req"+c+"_")}catch(h){r&&r(l)}}if(s){r=a.join("&");break e}}return e=e.f.splice(0,n),t.j=e,r}function zn(e){e.a||e.l||(e.S=1,Re(e.Ha,e),e.v=0)}function Wn(e){return!(e.a||e.l||3<=e.v||(e.S++,e.l=tt(b(e.Ha,e),Kn(e,e.v)),e.v++,0))}function Hn(e,t,n){var r=t.l;r&&hn(e.b,r),e.ia=e.oa&&n,e.m=t.c,e.B=$n(e,null,e.ha),qn(e)}function Qn(e){null!=e.s&&(a.clearTimeout(e.s),e.s=null)}function Kn(e,t){var n=e.Oa+Math.floor(Math.random()*e.Sa);return e.ma()||(n*=2),n*t}function Yn(e,t){if(2==t){var n=null;e.c&&(n=null);var r=b(e.fb,e);n||(n=new xt("//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||Mt(n,"https"),qt(n)),function(e,t){var n=new Ke;if(a.Image){var r=new Image;r.onload=_(wn,n,r,"TestLoadImage: loaded",!0,t),r.onerror=_(wn,n,r,"TestLoadImage: error",!1,t),r.onabort=_(wn,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=_(wn,n,r,"TestLoadImage: timeout",!1,t),a.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else Xe(2);e.u=0,e.c&&e.c.ta(t),Jn(e),Vn(e)}function Jn(e){e.u=0,e.m=-1,e.c&&(0==mn(e.b).length&&0==e.f.length||(e.b.c.length=0,I(e.f),e.f.length=0),e.c.sa())}function $n(e,t,n){var r=function(e){return e instanceof xt?Ot(e):new xt(e,void 0)}(n);if(""!=r.b)t&&Rt(r,t+"."+r.b),Lt(r,r.i);else{var o=a.location;r=function(e,t,n,r){var o=new xt(null,void 0);return e&&Mt(o,e),t&&Rt(o,t),n&&Lt(o,n),r&&(o.a=r),o}(o.protocol,t?t+"."+o.hostname:o.hostname,+o.port,n)}return e.V&&R(e.V,(function(e,t){Vt(r,t,e)})),n=e.I,(t=e.j)&&n&&Vt(r,t,n),Vt(r,"VER",e.wa),Un(e,r),r}function Zn(){}function Xn(){if(G&&!(10<=Number(Z)))throw Error("Environmental error: no available transport.")}function er(e,t){Ee.call(this),this.a=new Ln(t),this.g=e,this.m=t&&t.testUrl?t.testUrl:function(e){for(var t=arguments[0],n=1;n<arguments.length;n++){var r,o=arguments[n];0==o.lastIndexOf("/",0)?t=o:((r=""==t)||(r=0<=(r=t.length-1)&&t.indexOf("/",r)==r),t+=r?o:"/"+o)}return t}(this.g,"test"),this.b=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.a.i=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.xa&&(e?e["X-WebChannel-Client-Profile"]=t.xa:e={"X-WebChannel-Client-Profile":t.xa}),this.a.J=e,(e=t&&t.httpHeadersOverwriteParam)&&!A(e)&&(this.a.g=e),this.l=t&&t.supportsCrossDomainXhr||!1,this.h=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!A(t)&&(this.a.j=t,null!==(e=this.b)&&t in e&&t in(e=this.b)&&delete e[t]),this.f=new rr(this)}function tr(e){ut.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.c=e)?(e=this.c,this.data=null!==t&&e in t?t[e]:void 0):this.data=t}else this.data=e}function nr(){ct.call(this),this.status=1}function rr(e){this.a=e}(r=kn.prototype).ca=function(e,t,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+e);t=t?t.toUpperCase():"GET",this.A=e,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(e){var t;return(t=e.a)||(t=e.a={}),t}(this.H?this.H:at),this.a.onreadystatechange=b(this.Fa,this);try{this.w=!0,this.a.open(t,String(e),!0),this.w=!1}catch(i){return void An(this,i)}e=n||"";var o=new It(this.headers);r&&Tt(r,(function(e,t){o.set(t,e)})),r=function(e){e:{for(var t=In,n=e.length,r=s(e)?e.split(""):e,o=0;o<n;o++)if(o in r&&t.call(void 0,r[o],o,e)){t=o;break e}t=-1}return 0>t?null:s(e)?e.charAt(t):e[t]}(o.K()),n=a.FormData&&e instanceof a.FormData,!(0<=S(Tn,t))||r||n||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(e,t){this.a.setRequestHeader(t,e)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{xn(this),0<this.o&&((this.D=function(e){return G&&ee(9)&&u(e.timeout)&&void 0!==e.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=b(this.Ca,this)):this.m=je(this.Ca,this.o,this)),this.l=!0,this.a.send(e),this.l=!1}catch(i){An(this,i)}},r.Ca=function(){void 0!==i&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},r.abort=function(e){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=e||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Pn(this))},r.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Pn(this,!0)),kn.N.G.call(this)},r.Fa=function(){this.j||(this.w||this.l||this.g?Nn(this):this.$a())},r.$a=function(){Nn(this)},r.T=function(){try{return 2<On(this)?this.a.status:-1}catch(j){return-1}},r.za=function(){try{return 2<On(this)?this.a.statusText:""}catch(j){return""}},r.aa=function(){try{return this.a?this.a.responseText:""}catch(j){return""}},r.Va=function(e){if(this.a){var t=this.a.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Cn(t)}},r.ya=function(){return this.h},r.Ya=function(){return s(this.f)?this.f:String(this.f)},(r=Ln.prototype).wa=8,r.u=1,r.Da=function(){return 0==this.u},r.Ia=function(e){if(this.h)if(this.h=null,1==this.u){if(!e){this.P=Math.floor(1e5*Math.random());var t,n=new ht(this,e=this.P++,void 0),r=this.i;if(this.J&&(r?V(r=L(r),this.J):r=this.J),null===this.g&&(n.h=r),this.W)e:{for(var o=t=0;o<this.f.length;o++){var i=this.f[o];if(void 0===(i="__data__"in i.a&&s(i=i.a.__data__)?i.length:void 0))break;if(4096<(t+=i)){t=o;break e}if(4096===t||o===this.f.length-1){t=o+1;break e}}t=1e3}else t=1e3;t=Gn(this,n,t),Vt(o=Ot(this.B),"RID",e),Vt(o,"CVER",22),this.o&&this.j&&Vt(o,"X-HTTP-Session-Id",this.j),Un(this,o),this.g&&r&&Rn(o,this.g,r),yn(this.b,n),this.W?(Vt(o,"$req",t),Vt(o,"SID","null"),n.S=!0,yt(n,o,null)):yt(n,o,t),this.u=2}}else 3==this.u&&(e?jn(this,e):0==this.f.length||fn(this.b)||jn(this))},r.Ha=function(){this.l=null,this.a=new ht(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var e=Ot(this.pa);Vt(e,"RID","rpc"),Vt(e,"SID",this.H),Vt(e,"CI",this.ia?"0":"1"),Vt(e,"AID",this.O),Un(this,e),Vt(e,"TYPE","xmlhttp"),this.g&&this.i&&Rn(e,this.g,this.i),this.D&&this.a.setTimeout(this.D),vt(this.a,e,!0,this.ga)},r.Ga=function(e,t){if(0!=this.u&&(this.a==e||pn(this.b,e)))if(this.m=e.o,!e.s&&pn(this.b,e)&&3==this.u){try{var n=this.ja.a.parse(t)}catch(i){n=null}if(f(n)&&3==n.length){if(0==(t=n)[0]){e:if(!this.l){if(this.a){if(!(this.a.v+3e3<e.v))break e;Qn(this),this.a.cancel(),this.a=null}Wn(this),Xe(18)}}else this.ra=t[1],0<this.ra-this.O&&37500>t[2]&&this.ia&&0==this.v&&!this.s&&(this.s=tt(b(this.Za,this),6e3));if(1>=dn(this.b)&&this.fa){try{this.fa()}catch(i){}this.fa=void 0}}else Yn(this,11)}else if((e.s||this.a==e)&&Qn(this),!A(t))for(t=n=this.ja.a.parse(t),n=0;n<t.length;n++){var r=t[n];if(this.O=r[0],r=r[1],2==this.u)if("c"==r[0]){this.H=r[1],this.ga=r[2];var o=r[3];null!=o&&(this.wa=o),null!=(r=r[5])&&u(r)&&0<r&&(this.D=1.5*r),this.o&&(r=e.a)&&((o=Mn(r,"X-Client-Wire-Protocol"))&&hn(this.b,o),this.j&&(r=Mn(r,"X-HTTP-Session-Id")))&&(this.I=r,Vt(this.B,this.j,r)),this.u=3,this.c&&this.c.va(),r=e,this.pa=$n(this,this.Y()?this.ga:null,this.ha),r.s?(vn(this.b,r),(o=this.D)&&r.setTimeout(o),r.i&&(Ct(r),_t(r)),this.a=r):zn(this),0<this.f.length&&qn(this)}else"stop"!=r[0]&&"close"!=r[0]||Yn(this,7);else 3==this.u&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?Yn(this,7):Fn(this):"noop"!=r[0]&&this.c&&this.c.ua(r),this.v=0)}},r.Za=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,Wn(this),Xe(19))},r.na=function(e){var t=null;if(this.a==e){Qn(this),this.a=null;var n=2}else{if(!pn(this.b,e))return;t=e.j,vn(this.b,e),n=1}if(this.m=e.o,0!=this.u)if(e.b)1==n?(t=w()-e.v,Ye.dispatchEvent(new et(Ye,e.l?e.l.length:0,t,this.A)),qn(this)):zn(this);else{var r=e.c;if(3==r||0==r&&0<this.m||!(1==n&&function(e,t){return!(dn(e.b)>=e.b.f-(e.h?1:0)||(e.h?(e.f=t.j.concat(e.f),0):1==e.u||2==e.u||e.A>=(e.Pa?0:e.Qa)||(e.h=tt(b(e.Ia,e,t),Kn(e,e.A)),e.A++,0)))}(this,e)||2==n&&Wn(this)))switch(t&&0<t.length&&(e=this.b,e.c=e.c.concat(t)),r){case 1:Yn(this,5);break;case 4:Yn(this,10);break;case 3:Yn(this,6);break;default:Yn(this,2)}}},r.fb=function(e){Xe(e?2:1)},r.$=function(e){if(e&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new kn(this.La)).F=this.R,e},r.ma=function(){return!!this.c&&!0},r.Y=function(){return this.R},(r=Zn.prototype).va=function(){},r.ua=function(){},r.ta=function(){},r.sa=function(){},r.Ta=function(){},Xn.prototype.a=function(e,t){return new er(e,t)},C(er,Ee),(r=er.prototype).addEventListener=function(e,t,n,r){er.N.addEventListener.call(this,e,t,n,r)},r.removeEventListener=function(e,t,n,r){er.N.removeEventListener.call(this,e,t,n,r)},r.Wa=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var e=this.a,t=this.m,n=this.g,r=this.b||void 0;Xe(0),e.ha=n,e.V=r||{},e.o&&(e.F.b=[],e.F.a=!1),e.w=new nn(e),null===e.g&&(e.w.h=e.i),n=t,e.g&&e.i&&(n=Rn(t,e.g,e.i)),(e=e.w).i=n,t=$n(e.a,null,e.i),Xe(3),null!=(n=e.a.F.b)?(e.f=n[0],e.M=1,rn(e)):(Bt(t,"MODE","init"),!e.a.o&&e.a.j&&Bt(t,"X-HTTP-Session-Id",e.a.j),e.b=new ht(e,void 0,void 0),e.b.h=e.h,vt(e.b,t,!1,null),e.M=0)},r.close=function(){Fn(this.a)},r.Xa=function(e){if(s(e)){var t={};t.__data__=e,Bn(this.a,t)}else this.h?((t={}).__data__=Ie(e),Bn(this.a,t)):Bn(this.a,e)},r.G=function(){this.a.c=null,delete this.f,Fn(this.a),delete this.a,er.N.G.call(this)},C(tr,ut),C(nr,ct),C(rr,Zn),rr.prototype.va=function(){this.a.dispatchEvent("a")},rr.prototype.ua=function(e){this.a.dispatchEvent(new tr(e))},rr.prototype.ta=function(e){this.a.dispatchEvent(new nr(e))},rr.prototype.sa=function(){this.a.dispatchEvent("b")};var or=_((function(e,t){function n(){}n.prototype=e.prototype;var r=new n;return e.apply(r,Array.prototype.slice.call(arguments,1)),r}),Xn);Xn.prototype.createWebChannel=Xn.prototype.a,er.prototype.send=er.prototype.Xa,er.prototype.open=er.prototype.Wa,er.prototype.close=er.prototype.close,nt.NO_ERROR=0,nt.TIMEOUT=8,nt.HTTP_ERROR=6,rt.COMPLETE="complete",it.EventType=st,st.OPEN="a",st.CLOSE="b",st.ERROR="c",st.MESSAGE="d",Ee.prototype.listen=Ee.prototype.Aa,kn.prototype.listenOnce=kn.prototype.Ba,kn.prototype.getLastError=kn.prototype.Ya,kn.prototype.getLastErrorCode=kn.prototype.ya,kn.prototype.getStatus=kn.prototype.T,kn.prototype.getStatusText=kn.prototype.za,kn.prototype.getResponseJson=kn.prototype.Va,kn.prototype.getResponseText=kn.prototype.aa,kn.prototype.send=kn.prototype.ca;var ir={createWebChannelTransport:or,ErrorCode:nt,EventType:rt,WebChannel:it,XhrIo:kn},ar=ir.createWebChannelTransport,sr=ir.ErrorCode,ur=ir.EventType,cr=ir.WebChannel,lr=ir.XhrIo;t.default=ir},zUnb:function(e,t,n){"use strict";function r(e){return"function"==typeof e}n.r(t);var o=!1,i={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){var t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else o&&console.log("RxJS: Back to a better error behavior. Thank you. <3");o=e},get useDeprecatedSynchronousErrorHandling(){return o}};function a(e){setTimeout((function(){throw e}),0)}var s={closed:!0,next:function(e){},error:function(e){if(i.useDeprecatedSynchronousErrorHandling)throw e;a(e)},complete:function(){}},u=Array.isArray||function(e){return e&&"number"==typeof e.length};function c(e){return null!==e&&"object"==typeof e}var l,h=function(){function e(e){return Error.call(this),this.message=e?"".concat(e.length," errors occurred during unsubscription:\n").concat(e.map((function(e,t){return"".concat(t+1,") ").concat(e.toString())})).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),f=((l=function(){function e(t){_classCallCheck(this,e),this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}return _createClass(e,[{key:"unsubscribe",value:function(){var t;if(!this.closed){var n=this._parentOrParents,o=this._unsubscribe,i=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof e)n.remove(this);else if(null!==n)for(var a=0;a<n.length;++a)n[a].remove(this);if(r(o))try{o.call(this)}catch(p){t=p instanceof h?d(p.errors):[p]}if(u(i))for(var s=-1,l=i.length;++s<l;){var f=i[s];if(c(f))try{f.unsubscribe()}catch(p){t=t||[],p instanceof h?t=t.concat(d(p.errors)):t.push(p)}}if(t)throw new h(t)}}},{key:"add",value:function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var r=n;(n=new e)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var o=n._parentOrParents;if(null===o)n._parentOrParents=this;else if(o instanceof e){if(o===this)return n;n._parentOrParents=[o,this]}else{if(-1!==o.indexOf(this))return n;o.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[n]:i.push(n),n}},{key:"remove",value:function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}}}]),e}()).EMPTY=function(e){return e.closed=!0,e}(new l),l);function d(e){return e.reduce((function(e,t){return e.concat(t instanceof h?t.errors:t)}),[])}var p="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),y=function(e){function t(e,n,r){var o;switch(_classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=s;break;case 1:if(!e){o.destination=s;break}if("object"==typeof e){e instanceof t?(o.syncErrorThrowable=e.syncErrorThrowable,o.destination=e,e.add(_assertThisInitialized(o))):(o.syncErrorThrowable=!0,o.destination=new v(_assertThisInitialized(o),e));break}default:o.syncErrorThrowable=!0,o.destination=new v(_assertThisInitialized(o),e,n,r)}return o}return _inherits(t,e),_createClass(t,[{key:p,value:function(){return this}},{key:"next",value:function(e){this.isStopped||this._next(e)}},{key:"error",value:function(e){this.isStopped||(this.isStopped=!0,this._error(e))}},{key:"complete",value:function(){this.isStopped||(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,_get(_getPrototypeOf(t.prototype),"unsubscribe",this).call(this))}},{key:"_next",value:function(e){this.destination.next(e)}},{key:"_error",value:function(e){this.destination.error(e),this.unsubscribe()}},{key:"_complete",value:function(){this.destination.complete(),this.unsubscribe()}},{key:"_unsubscribeAndRecycle",value:function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}],[{key:"create",value:function(e,n,r){var o=new t(e,n,r);return o.syncErrorThrowable=!1,o}}]),t}(f),v=function(e){function t(e,n,o,i){var a,u;_classCallCheck(this,t),(a=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._parentSubscriber=e;var c=_assertThisInitialized(a);return r(n)?u=n:n&&(u=n.next,o=n.error,i=n.complete,n!==s&&(r((c=Object.create(n)).unsubscribe)&&a.add(c.unsubscribe.bind(c)),c.unsubscribe=a.unsubscribe.bind(_assertThisInitialized(a)))),a._context=c,a._next=u,a._error=o,a._complete=i,a}return _inherits(t,e),_createClass(t,[{key:"next",value:function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;i.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}},{key:"error",value:function(e){if(!this.isStopped){var t=this._parentSubscriber,n=i.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):a(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;a(e)}}}},{key:"complete",value:function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};i.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}}},{key:"__tryOrUnsub",value:function(e,t){try{e.call(this._context,t)}catch(n){if(this.unsubscribe(),i.useDeprecatedSynchronousErrorHandling)throw n;a(n)}}},{key:"__tryOrSetError",value:function(e,t,n){if(!i.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(r){return i.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=r,e.syncErrorThrown=!0,!0):(a(r),!0)}return!1}},{key:"_unsubscribe",value:function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}]),t}(y),m="function"==typeof Symbol&&Symbol.observable||"@@observable";function g(){}var b,_=((b=function(){function e(t){_classCallCheck(this,e),this._isScalar=!1,t&&(this._subscribe=t)}return _createClass(e,[{key:"lift",value:function(t){var n=new e;return n.source=this,n.operator=t,n}},{key:"subscribe",value:function(e,t,n){var r=this.operator,o=function(e,t,n){if(e){if(e instanceof y)return e;if(e[p])return e[p]()}return e||t||n?new y(e,t,n):new y(s)}(e,t,n);if(o.add(r?r.call(o,this.source):this.source||i.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),i.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o}},{key:"_trySubscribe",value:function(e){try{return this._subscribe(e)}catch(t){i.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){var t=e,n=t.closed,r=t.destination,o=t.isStopped;if(n||o)return!1;e=r&&r instanceof y?r:null}return!0}(e)?e.error(t):console.warn(t)}}},{key:"forEach",value:function(e,t){var n=this;return new(t=w(t))((function(t,r){var o;o=n.subscribe((function(t){try{e(t)}catch(n){r(n),o&&o.unsubscribe()}}),r,t)}))}},{key:"_subscribe",value:function(e){var t=this.source;return t&&t.subscribe(e)}},{key:m,value:function(){return this}},{key:"pipe",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?this:((r=t)?1===r.length?r[0]:function(e){return r.reduce((function(e,t){return t(e)}),e)}:g)(this);var r}},{key:"toPromise",value:function(e){var t=this;return new(e=w(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))}}]),e}()).create=function(e){return new b(e)},b);function w(e){if(e||(e=i.Promise||Promise),!e)throw new Error("no Promise impl found");return e}var C,k=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),S=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).subject=e,r.subscriber=n,r.closed=!1,r}return _inherits(t,e),_createClass(t,[{key:"unsubscribe",value:function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}}}]),t}(f),E=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).destination=e,n}return _inherits(t,e),t}(y),T=((C=function(e){function t(){var e;return _classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return _inherits(t,e),_createClass(t,[{key:p,value:function(){return new E(this)}},{key:"lift",value:function(e){var t=new I(this,this);return t.operator=e,t}},{key:"next",value:function(e){if(this.closed)throw new k;if(!this.isStopped)for(var t=this.observers,n=t.length,r=t.slice(),o=0;o<n;o++)r[o].next(e)}},{key:"error",value:function(e){if(this.closed)throw new k;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,r=t.slice(),o=0;o<n;o++)r[o].error(e);this.observers.length=0}},{key:"complete",value:function(){if(this.closed)throw new k;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),r=0;r<t;r++)n[r].complete();this.observers.length=0}},{key:"unsubscribe",value:function(){this.isStopped=!0,this.closed=!0,this.observers=null}},{key:"_trySubscribe",value:function(e){if(this.closed)throw new k;return _get(_getPrototypeOf(t.prototype),"_trySubscribe",this).call(this,e)}},{key:"_subscribe",value:function(e){if(this.closed)throw new k;return this.hasError?(e.error(this.thrownError),f.EMPTY):this.isStopped?(e.complete(),f.EMPTY):(this.observers.push(e),new S(this,e))}},{key:"asObservable",value:function(){var e=new _;return e.source=this,e}}]),t}(_)).create=function(e,t){return new I(e,t)},C),I=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).destination=e,r.source=n,r}return _inherits(t,e),_createClass(t,[{key:"next",value:function(e){var t=this.destination;t&&t.next&&t.next(e)}},{key:"error",value:function(e){var t=this.destination;t&&t.error&&this.destination.error(e)}},{key:"complete",value:function(){var e=this.destination;e&&e.complete&&this.destination.complete()}},{key:"_subscribe",value:function(e){return this.source?this.source.subscribe(e):f.EMPTY}}]),t}(T);function A(e){return e&&"function"==typeof e.schedule}var D=function(e){function t(e,n,r){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).parent=e,o.outerValue=n,o.outerIndex=r,o.index=0,o}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}},{key:"_error",value:function(e){this.parent.notifyError(e,this),this.unsubscribe()}},{key:"_complete",value:function(){this.parent.notifyComplete(this),this.unsubscribe()}}]),t}(y),N=function(e){return function(t){for(var n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.complete()}};var P="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",x=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function O(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}var M=function(e){if(e&&"function"==typeof e[m])return r=e,function(e){var t=r[m]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if(x(e))return N(e);if(O(e))return n=e,function(e){return n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,a),e};if(e&&"function"==typeof e[P])return t=e,function(e){for(var n=t[P]();;){var r=n.next();if(r.done){e.complete();break}if(e.next(r.value),e.closed)break}return"function"==typeof n.return&&e.add((function(){n.return&&n.return()})),e};var t,n,r,o=c(e)?"an invalid object":"'".concat(e,"'");throw new TypeError("You provided ".concat(o," where a stream was expected.")+" You can provide an Observable, Promise, Array, or Iterable.")},R=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"notifyNext",value:function(e,t,n,r,o){this.destination.next(t)}},{key:"notifyError",value:function(e,t){this.destination.error(e)}},{key:"notifyComplete",value:function(e){this.destination.complete()}}]),t}(y);function F(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new V(e,t))}}var V=function(){function e(t,n){_classCallCheck(this,e),this.project=t,this.thisArg=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new B(e,this.project,this.thisArg))}}]),e}(),B=function(e){function t(e,n,r){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).project=n,o.count=0,o.thisArg=r||_assertThisInitialized(o),o}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}]),t}(y);function q(e,t){return new _((function(n){var r=new f,o=0;return r.add(t.schedule((function(){o!==e.length?(n.next(e[o++]),n.closed||r.add(this.schedule())):n.complete()}))),r}))}function j(e,t){return t?function(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[m]}(e))return function(e,t){return new _((function(n){var r=new f;return r.add(t.schedule((function(){var o=e[m]();r.add(o.subscribe({next:function(e){r.add(t.schedule((function(){return n.next(e)})))},error:function(e){r.add(t.schedule((function(){return n.error(e)})))},complete:function(){r.add(t.schedule((function(){return n.complete()})))}}))}))),r}))}(e,t);if(O(e))return function(e,t){return new _((function(n){var r=new f;return r.add(t.schedule((function(){return e.then((function(e){r.add(t.schedule((function(){n.next(e),r.add(t.schedule((function(){return n.complete()})))})))}),(function(e){r.add(t.schedule((function(){return n.error(e)})))}))}))),r}))}(e,t);if(x(e))return q(e,t);if(function(e){return e&&"function"==typeof e[P]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new _((function(n){var r,o=new f;return o.add((function(){r&&"function"==typeof r.return&&r.return()})),o.add(t.schedule((function(){r=e[P](),o.add(t.schedule((function(){if(!n.closed){var e,t;try{var o=r.next();e=o.value,t=o.done}catch(i){return void n.error(i)}t?n.complete():(n.next(e),this.schedule())}})))}))),o}))}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}(e,t):e instanceof _?e:new _(M(e))}function U(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return"function"==typeof t?function(r){return r.pipe(U((function(n,r){return j(e(n,r)).pipe(F((function(e,o){return t(n,e,r,o)})))}),n))}:("number"==typeof t&&(n=t),function(t){return t.lift(new G(e,n))})}var G=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.POSITIVE_INFINITY;_classCallCheck(this,e),this.project=t,this.concurrent=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new z(e,this.project,this.concurrent))}}]),e}(),z=function(e){function t(e,n){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).project=n,r.concurrent=o,r.hasCompleted=!1,r.buffer=[],r.active=0,r.index=0,r}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}},{key:"_tryNext",value:function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(t,e,n)}},{key:"_innerSub",value:function(e,t,n){var r=new D(this,void 0,void 0);this.destination.add(r),function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new D(e,n,r);o.closed||(t instanceof _?t.subscribe(o):M(t)(o))}(this,e,t,n,r)}},{key:"_complete",value:function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}},{key:"notifyNext",value:function(e,t,n,r,o){this.destination.next(t)}},{key:"notifyComplete",value:function(e){var t=this.buffer;this.remove(e),this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}]),t}(R);function W(e){return e}function H(e,t){return t?q(e,t):new _(N(e))}function Q(){return function(e){return e.lift(new Y(e))}}var K,Y=function(){function e(t){_classCallCheck(this,e),this.connectable=t}return _createClass(e,[{key:"call",value:function(e,t){var n=this.connectable;n._refCount++;var r=new J(e,n),o=t.subscribe(r);return r.closed||(r.connection=n.connect()),o}}]),e}(),J=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).connectable=n,r}return _inherits(t,e),_createClass(t,[{key:"_unsubscribe",value:function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var n=this.connection,r=e._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null}}]),t}(y),Z={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:(K=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).source=e,r.subjectFactory=n,r._refCount=0,r._isComplete=!1,r}return _inherits(t,e),_createClass(t,[{key:"_subscribe",value:function(e){return this.getSubject().subscribe(e)}},{key:"getSubject",value:function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject}},{key:"connect",value:function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new f).add(this.source.subscribe(new X(this.getSubject(),this))),e.closed&&(this._connection=null,e=f.EMPTY)),e}},{key:"refCount",value:function(){return Q()(this)}}]),t}(_).prototype)._subscribe},_isComplete:{value:K._isComplete,writable:!0},getSubject:{value:K.getSubject},connect:{value:K.connect},refCount:{value:K.refCount}},X=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).connectable=n,r}return _inherits(t,e),_createClass(t,[{key:"_error",value:function(e){this._unsubscribe(),_get(_getPrototypeOf(t.prototype),"_error",this).call(this,e)}},{key:"_complete",value:function(){this.connectable._isComplete=!0,this._unsubscribe(),_get(_getPrototypeOf(t.prototype),"_complete",this).call(this)}},{key:"_unsubscribe",value:function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}]),t}(E);function ee(){return new T}function te(){return function(e){return Q()((t=ee,function(e){var n;n="function"==typeof t?t:function(){return t};var r=Object.create(e,Z);return r.source=e,r.subjectFactory=n,r})(e));var t}}function ne(e,t,n){var r=function(e){return function(){if(e){var t=e.apply(void 0,arguments);for(var n in t)this[n]=t[n]}}}(t);function o(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this instanceof o)return r.apply(this,t),this;var i=_construct(o,t);return a.annotation=i,a;function a(e,t,n){for(var r=e.hasOwnProperty("__parameters__")?e.__parameters__:Object.defineProperty(e,"__parameters__",{value:[]}).__parameters__;r.length<=n;)r.push(null);return(r[n]=r[n]||[]).push(i),e}}return n&&(o.prototype=Object.create(n.prototype)),o.prototype.ngMetadataName=e,o.annotationCls=o,o}var re=ne("Inject",(function(e){return{token:e}})),oe=ne("Optional"),ie=ne("Self"),ae=ne("SkipSelf"),se=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}({});function ue(e){for(var t in e)if(e[t]===ue)return t;throw Error("Could not find renamed property on target object.")}function ce(e,t){for(var n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function le(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function he(e){return{factory:e.factory,providers:e.providers||[],imports:e.imports||[]}}function fe(e){return de(e,e[ye])||de(e,e[ge])}function de(e,t){return t&&t.token===e?t:null}function pe(e){return e&&(e.hasOwnProperty(ve)||e.hasOwnProperty(be))?e[ve]:null}var ye=ue({"\u0275prov":ue}),ve=ue({"\u0275inj":ue}),me=ue({"\u0275provFallback":ue}),ge=ue({ngInjectableDef:ue}),be=ue({ngInjectorDef:ue});function _e(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(_e).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return"".concat(e.overriddenName);if(e.name)return"".concat(e.name);var t=e.toString();if(null==t)return""+t;var n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function we(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}var Ce=ue({__forward_ref__:ue});function ke(e){return e.__forward_ref__=ke,e.toString=function(){return _e(this())},e}function Se(e){return Ee(e)?e():e}function Ee(e){return"function"==typeof e&&e.hasOwnProperty(Ce)&&e.__forward_ref__===ke}var Te,Ie="undefined"!=typeof globalThis&&globalThis,Ae="undefined"!=typeof window&&window,De="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Ne="undefined"!=typeof global&&global,Pe=Ie||Ne||Ae||De,xe=ue({"\u0275cmp":ue}),Oe=ue({"\u0275dir":ue}),Me=ue({"\u0275pipe":ue}),Re=ue({"\u0275mod":ue}),Le=ue({"\u0275loc":ue}),Fe=ue({"\u0275fac":ue}),Ve=ue({__NG_ELEMENT_ID__:ue}),Be=function(){function e(t,n){_classCallCheck(this,e),this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=le({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}return _createClass(e,[{key:"toString",value:function(){return"InjectionToken ".concat(this._desc)}}]),e}(),qe=new Be("INJECTOR",-1),je={},Ue=/\n/gm,Ge=ue({provide:String,useValue:ue}),ze=void 0;function We(e){var t=ze;return ze=e,t}function He(e){var t=Te;return Te=e,t}function Qe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:se.Default;if(void 0===ze)throw new Error("inject() must be called from an injection context");return null===ze?Ye(e,void 0,t):ze.get(e,t&se.Optional?null:void 0,t)}function Ke(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:se.Default;return(Te||Qe)(Se(e),t)}function Ye(e,t,n){var r=fe(e);if(r&&"root"==r.providedIn)return void 0===r.value?r.value=r.factory():r.value;if(n&se.Optional)return null;if(void 0!==t)return t;throw new Error("Injector: NOT_FOUND [".concat(_e(e),"]"))}function Je(e){for(var t=[],n=0;n<e.length;n++){var r=Se(e[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");for(var o=void 0,i=se.Default,a=0;a<r.length;a++){var s=r[a];s instanceof oe||"Optional"===s.ngMetadataName||s===oe?i|=se.Optional:s instanceof ae||"SkipSelf"===s.ngMetadataName||s===ae?i|=se.SkipSelf:s instanceof ie||"Self"===s.ngMetadataName||s===ie?i|=se.Self:o=s instanceof re||s===re?s.token:s}t.push(Ke(o,i))}else t.push(Ke(r))}return t}var $e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:je;if(t===je){var n=new Error("NullInjectorError: No provider for ".concat(_e(e),"!"));throw n.name="NullInjectorError",n}return t}}]),e}(),Ze=function e(){_classCallCheck(this,e)};function Xe(e,t){e.forEach((function(e){return Array.isArray(e)?Xe(e,t):t(e)}))}function et(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function tt(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function nt(e,t){var n=rt(e,t);if(n>=0)return e[1|n]}function rt(e,t){return function(e,t,n){for(var r=0,o=e.length>>1;o!==r;){var i=r+(o-r>>1),a=e[i<<1];if(t===a)return i<<1;a>t?o=i:r=i+1}return~(o<<1)}(e,t)}var ot=function(){var e={OnPush:0,Default:1};return e[e.OnPush]="OnPush",e[e.Default]="Default",e}(),it=function(){var e={Emulated:0,Native:1,None:2,ShadowDom:3};return e[e.Emulated]="Emulated",e[e.Native]="Native",e[e.None]="None",e[e.ShadowDom]="ShadowDom",e}();function at(e){return""+{toString:e}}var st={},ut=[],ct=0;function lt(e){var t=e.type,n=t.prototype,r={},o={type:t,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:r,inputs:null,outputs:null,exportAs:e.exportAs||null,onChanges:null,onInit:n.ngOnInit||null,doCheck:n.ngDoCheck||null,afterContentInit:n.ngAfterContentInit||null,afterContentChecked:n.ngAfterContentChecked||null,afterViewInit:n.ngAfterViewInit||null,afterViewChecked:n.ngAfterViewChecked||null,onDestroy:n.ngOnDestroy||null,onPush:e.changeDetection===ot.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||ut,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||it.Emulated,id:"c",styles:e.styles||ut,_:null,setInput:null,schemas:e.schemas||null,tView:null};return o._=at((function(){var t=e.directives,n=e.features,i=e.pipes;o.id+=ct++,o.inputs=yt(e.inputs,r),o.outputs=yt(e.outputs),n&&n.forEach((function(e){return e(o)})),o.directiveDefs=t?function(){return("function"==typeof t?t():t).map(ht)}:null,o.pipeDefs=i?function(){return("function"==typeof i?i():i).map(ft)}:null})),o}function ht(e){return mt(e)||function(e){return e[Oe]||null}(e)}function ft(e){return function(e){return e[Me]||null}(e)}var dt={};function pt(e){var t={type:e.type,bootstrap:e.bootstrap||ut,declarations:e.declarations||ut,imports:e.imports||ut,exports:e.exports||ut,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&at((function(){dt[e.id]=e.type})),t}function yt(e,t){if(null==e)return st;var n={};for(var r in e)if(e.hasOwnProperty(r)){var o=e[r],i=o;Array.isArray(o)&&(i=o[1],o=o[0]),n[o]=r,t&&(t[o]=i)}return n}var vt=lt;function mt(e){return e[xe]||null}function gt(e,t){return e.hasOwnProperty(Fe)?e[Fe]:null}function bt(e,t){var n=e[Re]||null;if(!n&&!0===t)throw new Error("Type ".concat(_e(e)," does not have '\u0275mod' property."));return n}function _t(e){return Array.isArray(e)&&"object"==typeof e[1]}function wt(e){return Array.isArray(e)&&!0===e[1]}function Ct(e){return 0!=(8&e.flags)}function kt(e){return 2==(2&e.flags)}function St(e){return 1==(1&e.flags)}function Et(e){return null!==e.template}function Tt(e){return 0!=(512&e[2])}var It={lFrame:Ht(null),bindingsEnabled:!0,checkNoChangesMode:!1};function At(){return It.bindingsEnabled}function Dt(){return It.lFrame.lView}function Nt(){return It.lFrame.tView}function Pt(e){It.lFrame.contextLView=e}function xt(){return It.lFrame.previousOrParentTNode}function Ot(e,t){It.lFrame.previousOrParentTNode=e,It.lFrame.isParent=t}function Mt(){return It.lFrame.isParent}function Rt(){return It.checkNoChangesMode}function Lt(e){It.checkNoChangesMode=e}function Ft(){return It.lFrame.bindingIndex}function Vt(){return It.lFrame.bindingIndex++}function Bt(e){var t=It.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function qt(e,t){var n=It.lFrame;n.bindingIndex=n.bindingRootIndex=e,n.currentDirectiveIndex=t}function jt(e){It.lFrame.currentQueryIndex=e}function Ut(e,t){var n=Wt();It.lFrame=n,n.previousOrParentTNode=t,n.lView=e}var Gt=Qt;function zt(e,t){var n=Wt(),r=e[1];It.lFrame=n,n.previousOrParentTNode=t,n.isParent=!0,n.lView=e,n.tView=r,n.selectedIndex=0,n.contextLView=e,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.currentSanitizer=null,n.bindingRootIndex=-1,n.bindingIndex=r.bindingStartIndex,n.currentQueryIndex=0}function Wt(){var e=It.lFrame,t=null===e?null:e.child;return null===t?Ht(e):t}function Ht(e){var t={previousOrParentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:0,contextLView:null,elementDepthCount:0,currentNamespace:null,currentSanitizer:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null};return null!==e&&(e.child=t),t}function Qt(){It.lFrame=It.lFrame.parent}function Kt(){return It.lFrame.selectedIndex}function Yt(e){It.lFrame.selectedIndex=e}function Jt(e,t){for(var n=t.directiveStart,r=t.directiveEnd;n<r;n++){var o=e.data[n];o.afterContentInit&&(e.contentHooks||(e.contentHooks=[])).push(-n,o.afterContentInit),o.afterContentChecked&&((e.contentHooks||(e.contentHooks=[])).push(n,o.afterContentChecked),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,o.afterContentChecked)),o.afterViewInit&&(e.viewHooks||(e.viewHooks=[])).push(-n,o.afterViewInit),o.afterViewChecked&&((e.viewHooks||(e.viewHooks=[])).push(n,o.afterViewChecked),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,o.afterViewChecked)),null!=o.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(n,o.onDestroy)}}function $t(e,t,n){en(e,t,3,n)}function Zt(e,t,n,r){(3&e[2])===n&&en(e,t,n,r)}function Xt(e,t){var n=e[2];(3&n)===t&&(n&=1023,n+=1,e[2]=n)}function en(e,t,n,r){for(var o=null!=r?r:-1,i=0,a=void 0!==r?65535&e[18]:0;a<t.length;a++)if("number"==typeof t[a+1]){if(i=t[a],null!=r&&i>=r)break}else t[a]<0&&(e[18]+=65536),(i<o||-1==o)&&(tn(e,n,t,a),e[18]=(4294901760&e[18])+a+2),a++}function tn(e,t,n,r){var o=n[r]<0,i=n[r+1],a=e[o?-n[r]:n[r]];o?e[2]>>10<e[18]>>16&&(3&e[2])===t&&(e[2]+=1024,i.call(a)):i.call(a)}var nn=function e(t,n,r){_classCallCheck(this,e),this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r},rn=void 0;function on(e){return!!e.listen}var an={createRenderer:function(e,t){return void 0!==rn?rn:"undefined"!=typeof document?document:void 0}};function sn(e,t,n){for(var r=on(e),o=0;o<n.length;){var i=n[o];if("number"==typeof i){if(0!==i)break;o++;var a=n[o++],s=n[o++],u=n[o++];r?e.setAttribute(t,s,u,a):t.setAttributeNS(a,s,u)}else{var c=i,l=n[++o];un(c)?r&&e.setProperty(t,c,l):r?e.setAttribute(t,c,l):t.setAttribute(c,l),o++}}return o}function un(e){return 64===e.charCodeAt(0)}function cn(e,t){if(null===t||0===t.length);else if(null===e||0===e.length)e=t.slice();else for(var n=-1,r=0;r<t.length;r++){var o=t[r];"number"==typeof o?n=o:0===n||ln(e,n,o,null,-1===n||2===n?t[++r]:null)}return e}function ln(e,t,n,r,o){var i=0,a=e.length;if(-1===t)a=-1;else for(;i<e.length;){var s=e[i++];if("number"==typeof s){if(s===t){a=-1;break}if(s>t){a=i-1;break}}}for(;i<e.length;){var u=e[i];if("number"==typeof u)break;if(u===n){if(null===r)return void(null!==o&&(e[i+1]=o));if(r===e[i+1])return void(e[i+2]=o)}i++,null!==r&&i++,null!==o&&i++}-1!==a&&(e.splice(a,0,t),i=a+1),e.splice(i++,0,n),null!==r&&e.splice(i++,0,r),null!==o&&e.splice(i++,0,o)}function hn(e){return-1!==e}function fn(e){return 32767&e}function dn(e){return e>>16}function pn(e,t){for(var n=dn(e),r=t;n>0;)r=r[15],n--;return r}function yn(e){return"string"==typeof e?e:null==e?"":""+e}function vn(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():yn(e)}var mn=("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Pe);function gn(e){return e instanceof Function?e():e}var bn=!0;function _n(e){var t=bn;return bn=e,t}var wn=0;function Cn(e,t){var n=Sn(e,t);if(-1!==n)return n;var r=t[1];r.firstCreatePass&&(e.injectorIndex=t.length,kn(r.data,e),kn(t,null),kn(r.blueprint,null));var o=En(e,t),i=e.injectorIndex;if(hn(o))for(var a=fn(o),s=pn(o,t),u=s[1].data,c=0;c<8;c++)t[i+c]=s[a+c]|u[a+c];return t[i+8]=o,i}function kn(e,t){e.push(0,0,0,0,0,0,0,0,t)}function Sn(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null==t[e.injectorIndex+8]?-1:e.injectorIndex}function En(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;for(var n=t[6],r=1;n&&-1===n.injectorIndex;)n=(t=t[15])?t[6]:null,r++;return n?n.injectorIndex|r<<16:-1}function Tn(e,t,n){!function(e,t,n){var r="string"!=typeof n?n[Ve]:n.charCodeAt(0)||0;null==r&&(r=n[Ve]=wn++);var o=255&r,i=1<<o,a=64&o,s=32&o,u=t.data;128&o?a?s?u[e+7]|=i:u[e+6]|=i:s?u[e+5]|=i:u[e+4]|=i:a?s?u[e+3]|=i:u[e+2]|=i:s?u[e+1]|=i:u[e]|=i}(e,t,n)}function In(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:se.Default,o=arguments.length>4?arguments[4]:void 0;if(null!==e){var i=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;var t=e[Ve];return"number"==typeof t&&t>0?255&t:t}(n);if("function"==typeof i){Ut(t,e);try{var a=i();if(null!=a||r&se.Optional)return a;throw new Error("No provider for ".concat(vn(n),"!"))}finally{Gt()}}else if("number"==typeof i){if(-1===i)return new On(e,t);var s=null,u=Sn(e,t),c=-1,l=r&se.Host?t[16][6]:null;for((-1===u||r&se.SkipSelf)&&(c=-1===u?En(e,t):t[u+8],xn(r,!1)?(s=t[1],u=fn(c),t=pn(c,t)):u=-1);-1!==u;){c=t[u+8];var h=t[1];if(Pn(i,u,h.data)){var f=Dn(u,t,n,s,r,l);if(f!==An)return f}xn(r,t[1].data[u+8]===l)&&Pn(i,u,t)?(s=h,u=fn(c),t=pn(c,t)):u=-1}}}if(r&se.Optional&&void 0===o&&(o=null),0==(r&(se.Self|se.Host))){var d=t[9],p=He(void 0);try{return d?d.get(n,o,r&se.Optional):Ye(n,o,r&se.Optional)}finally{He(p)}}if(r&se.Optional)return o;throw new Error("NodeInjector: NOT_FOUND [".concat(vn(n),"]"))}var An={};function Dn(e,t,n,r,o,i){var a=t[1],s=a.data[e+8],u=function(e,t,n,r,o){for(var i=e.providerIndexes,a=t.data,s=65535&i,u=e.directiveStart,c=i>>16,l=o?s+c:e.directiveEnd,h=r?s:s+c;h<l;h++){var f=a[h];if(h<u&&n===f||h>=u&&f.type===n)return h}if(o){var d=a[u];if(d&&Et(d)&&d.type===n)return u}return null}(s,a,n,null==r?kt(s)&&bn:r!=a&&3===s.type,o&se.Host&&i===s);return null!==u?Nn(t,a,u,s):An}function Nn(e,t,n,r){var o=e[n],i=t.data;if(o instanceof nn){var a=o;if(a.resolving)throw new Error("Circular dep for ".concat(vn(i[n])));var s,u=_n(a.canSeeViewProviders);a.resolving=!0,a.injectImpl&&(s=He(a.injectImpl)),Ut(e,r);try{o=e[n]=a.factory(void 0,i,e,r),t.firstCreatePass&&n>=r.directiveStart&&function(e,t,n){var r=t.onChanges,o=t.onInit,i=t.doCheck;r&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,r),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,r)),o&&(n.preOrderHooks||(n.preOrderHooks=[])).push(-e,o),i&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,i),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,i))}(n,i[n],t)}finally{a.injectImpl&&He(s),_n(u),a.resolving=!1,Gt()}}return o}function Pn(e,t,n){var r=64&e,o=32&e;return!!((128&e?r?o?n[t+7]:n[t+6]:o?n[t+5]:n[t+4]:r?o?n[t+3]:n[t+2]:o?n[t+1]:n[t])&1<<e)}function xn(e,t){return!(e&se.Self||e&se.Host&&t)}var On=function(){function e(t,n){_classCallCheck(this,e),this._tNode=t,this._lView=n}return _createClass(e,[{key:"get",value:function(e,t){return In(this._tNode,this._lView,e,void 0,t)}}]),e}();function Mn(e){var t=Object.getPrototypeOf(e.prototype).constructor,n=t[Fe]||function e(t){var n=t;if(Ee(t))return function(){var t=e(Se(n));return t?t():null};var r=gt(n);if(null===r){var o=pe(n);r=o&&o.factory}return r||null}(t);return null!==n?n:function(e){return new e}}function Rn(e){return e.ngDebugContext}function Ln(e){return e.ngOriginalError}function Fn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e.error.apply(e,n)}var Vn=function(){function e(){_classCallCheck(this,e),this._console=console}return _createClass(e,[{key:"handleError",value:function(e){var t=this._findOriginalError(e),n=this._findContext(e),r=function(e){return e.ngErrorLogger||Fn}(e);r(this._console,"ERROR",e),t&&r(this._console,"ORIGINAL ERROR",t),n&&r(this._console,"ERROR CONTEXT",n)}},{key:"_findContext",value:function(e){return e?Rn(e)?Rn(e):this._findContext(Ln(e)):null}},{key:"_findOriginalError",value:function(e){for(var t=Ln(e);t&&Ln(t);)t=Ln(t);return t}}]),e}(),Bn=!0,qn=!1;function jn(){return qn=!0,Bn}function Un(e){for(;Array.isArray(e);)e=e[0];return e}function Gn(e,t){return Un(t[e+19])}function zn(e,t){return Un(t[e.index])}function Wn(e,t){return e.data[t+19]}function Hn(e,t){return e[t+19]}function Qn(e,t){var n=t[e];return _t(n)?n:n[0]}function Kn(e){var t=function(e){return e.__ngContext__||null}(e);return t?Array.isArray(t)?t:t.lView:null}function Yn(e){return 128==(128&e[2])}function Jn(e,t){return null===e||null==t?null:e[t]}function $n(e){e[18]=0}function Zn(e,t){e.__ngContext__=t}function Xn(e){throw new Error("Multiple components match node with tagname ".concat(e.tagName))}function er(){throw new Error("Cannot mix multi providers and regular providers")}function tr(e,t,n){for(var r=e.length;;){var o=e.indexOf(t,n);if(-1===o)return o;if(0===o||e.charCodeAt(o-1)<=32){var i=t.length;if(o+i===r||e.charCodeAt(o+i)<=32)return o}n=o+1}}function nr(e,t,n){for(var r=0;r<e.length;){var o=e[r++];if(n&&"class"===o){if(-1!==tr((o=e[r]).toLowerCase(),t,0))return!0}else if(1===o){for(;r<e.length&&"string"==typeof(o=e[r++]);)if(o.toLowerCase()===t)return!0;return!1}}return!1}function rr(e,t,n){return t===(0!==e.type||n?e.tagName:"ng-template")}function or(e,t,n){for(var r=4,o=e.attrs||[],i=function(e){for(var t=0;t<e.length;t++)if(3===(n=e[t])||4===n||6===n)return t;var n;return e.length}(o),a=!1,s=0;s<t.length;s++){var u=t[s];if("number"!=typeof u){if(!a)if(4&r){if(r=2|1&r,""!==u&&!rr(e,u,n)||""===u&&1===t.length){if(ir(r))return!1;a=!0}}else{var c=8&r?u:t[++s];if(8&r&&null!==e.attrs){if(!nr(e.attrs,c,n)){if(ir(r))return!1;a=!0}continue}var l=ar(8&r?"class":u,o,0==e.type&&"ng-template"!==e.tagName,n);if(-1===l){if(ir(r))return!1;a=!0;continue}if(""!==c){var h;h=l>i?"":o[l+1].toLowerCase();var f=8&r?h:null;if(f&&-1!==tr(f,c,0)||2&r&&c!==h){if(ir(r))return!1;a=!0}}}}else{if(!a&&!ir(r)&&!ir(u))return!1;if(a&&ir(u))continue;a=!1,r=u|1&r}}return ir(r)||a}function ir(e){return 0==(1&e)}function ar(e,t,n,r){if(null===t)return-1;var o=0;if(r||!n){for(var i=!1;o<t.length;){var a=t[o];if(a===e)return o;if(3===a||6===a)i=!0;else{if(1===a||2===a){for(var s=t[++o];"string"==typeof s;)s=t[++o];continue}if(4===a)break;if(0===a){o+=4;continue}}o+=i?1:2}return-1}return function(e,t){var n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){if(e[n]===t)return n;n++}return-1}(t,e)}function sr(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=0;r<t.length;r++)if(or(e,t[r],n))return!0;return!1}function ur(e,t){return e?":not("+t.trim()+")":t}function cr(e){for(var t=e[0],n=1,r=2,o="",i=!1;n<e.length;){var a=e[n];if("string"==typeof a)if(2&r){var s=e[++n];o+="["+a+(s.length>0?'="'+s+'"':"")+"]"}else 8&r?o+="."+a:4&r&&(o+=" "+a);else""===o||ir(a)||(t+=ur(i,o),o=""),r=a,i=i||!ir(r);n++}return""!==o&&(t+=ur(i,o)),t}var lr={};function hr(e){var t=e[3];return wt(t)?t[3]:t}function fr(e){dr(Nt(),Dt(),Kt()+e,Rt())}function dr(e,t,n,r){if(!r)if(3==(3&t[2])){var o=e.preOrderCheckHooks;null!==o&&$t(t,o,n)}else{var i=e.preOrderHooks;null!==i&&Zt(t,i,0,n)}Yt(n)}function pr(e,t){return e<<17|t<<2}function yr(e){return e>>17&32767}function vr(e){return 2|e}function mr(e){return(131068&e)>>2}function gr(e,t){return-131069&e|t<<2}function br(e){return 1|e}function _r(e,t){var n=e.contentQueries;if(null!==n)for(var r=0;r<n.length;r+=2){var o=n[r],i=n[r+1];if(-1!==i){var a=e.data[i];jt(o),a.contentQueries(2,t[i],i)}}}function wr(e,t,n){return on(t)?t.createElement(e,n):null===n?t.createElement(e):t.createElementNS(n,e)}function Cr(e,t,n,r,o,i,a,s,u,c){var l=t.blueprint.slice();return l[0]=o,l[2]=140|r,$n(l),l[3]=l[15]=e,l[8]=n,l[10]=a||e&&e[10],l[11]=s||e&&e[11],l[12]=u||e&&e[12]||null,l[9]=c||e&&e[9]||null,l[6]=i,l[16]=2==t.type?e[16]:l,l}function kr(e,t,n,r,o,i){var a=n+19,s=e.data[a]||function(e,t,n,r,o,i){var a=xt(),s=Mt(),u=s?a:a&&a.parent,c=e.data[n]=xr(0,u&&u!==t?u:null,r,n,o,i);return null===e.firstChild&&(e.firstChild=c),a&&(!s||null!=a.child||null===c.parent&&2!==a.type?s||(a.next=c):a.child=c),c}(e,t,a,r,o,i);return Ot(s,!0),s}function Sr(e,t,n){zt(t,t[6]);try{var r=e.viewQuery;null!==r&&to(1,r,n);var o=e.template;null!==o&&Ir(e,t,o,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&_r(e,t),e.staticViewQueries&&to(2,e.viewQuery,n);var i=e.components;null!==i&&function(e,t){for(var n=0;n<t.length;n++)Jr(e,t[n])}(t,i)}finally{t[2]&=-5,Qt()}}function Er(e,t,n,r){var o=t[2];if(256!=(256&o)){zt(t,t[6]);var i=Rt();try{$n(t),It.lFrame.bindingIndex=e.bindingStartIndex,null!==n&&Ir(e,t,n,2,r);var a=3==(3&o);if(!i)if(a){var s=e.preOrderCheckHooks;null!==s&&$t(t,s,null)}else{var u=e.preOrderHooks;null!==u&&Zt(t,u,0,null),Xt(t,0)}if(function(e){for(var t=e[13];null!==t;){var n=void 0;if(wt(t)&&(n=t[2])>>1==-1){for(var r=9;r<t.length;r++){var o=t[r],i=o[1];Yn(o)&&Er(i,o,i.template,o[8])}0!=(1&n)&&Kr(t,e[16])}t=t[4]}}(t),null!==e.contentQueries&&_r(e,t),!i)if(a){var c=e.contentCheckHooks;null!==c&&$t(t,c)}else{var l=e.contentHooks;null!==l&&Zt(t,l,1),Xt(t,1)}!function(e,t){try{var n=e.expandoInstructions;if(null!==n)for(var r=e.expandoStartIndex,o=-1,i=0;i<n.length;i++){var a=n[i];"number"==typeof a?a<=0?(Yt(0-a),o=r+=9+n[++i]):r+=a:(null!==a&&(qt(r,o),a(2,t[o])),o++)}}finally{Yt(-1)}}(e,t);var h=e.components;null!==h&&function(e,t){for(var n=0;n<t.length;n++)Yr(e,t[n])}(t,h);var f=e.viewQuery;if(null!==f&&to(2,f,r),!i)if(a){var d=e.viewCheckHooks;null!==d&&$t(t,d)}else{var p=e.viewHooks;null!==p&&Zt(t,p,2),Xt(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),i||(t[2]&=-73)}finally{Qt()}}}function Tr(e,t,n,r){var o=t[10],i=!Rt(),a=4==(4&t[2]);try{i&&!a&&o.begin&&o.begin(),a&&Sr(e,t,r),Er(e,t,n,r)}finally{i&&!a&&o.end&&o.end()}}function Ir(e,t,n,r,o){var i=Kt();try{Yt(-1),2&r&&t.length>19&&dr(e,t,0,Rt()),n(r,o)}finally{Yt(i)}}function Ar(e,t,n){At()&&(function(e,t,n,r){var o=n.directiveStart,i=n.directiveEnd;e.firstCreatePass||Cn(n,t),Zn(r,t);for(var a=n.initialInputs,s=o;s<i;s++){var u=e.data[s],c=Et(u);c&&zr(t,n,u);var l=Nn(t,e,s,n);Zn(l,t),null!==a&&Wr(0,s-o,l,u,0,a),c&&(Qn(n.index,t)[8]=l)}}(e,t,n,zn(n,t)),128==(128&n.flags)&&function(e,t,n){var r=n.directiveStart,o=n.directiveEnd,i=e.expandoInstructions,a=e.firstCreatePass,s=n.index-19;try{Yt(s);for(var u=r;u<o;u++){var c=e.data[u],l=t[u];null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs?Vr(c,l):a&&i.push(null)}}finally{Yt(-1)}}(e,t,n))}function Dr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:zn,r=t.localNames;if(null!==r)for(var o=t.index+1,i=0;i<r.length;i+=2){var a=r[i+1],s=-1===a?n(t,e):e[a];e[o++]=s}}function Nr(e){return e.tView||(e.tView=Pr(1,-1,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts))}function Pr(e,t,n,r,o,i,a,s,u,c){var l=19+r,h=l+o,f=function(e,t){for(var n=[],r=0;r<t;r++)n.push(r<e?null:lr);return n}(l,h);return f[1]={type:e,id:t,blueprint:f,template:n,queries:null,viewQuery:s,node:null,data:f.slice().fill(null,l),bindingStartIndex:l,expandoStartIndex:h,expandoInstructions:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof i?i():i,pipeRegistry:"function"==typeof a?a():a,firstChild:null,schemas:u,consts:c}}function xr(e,t,n,r,o,i){return{type:n,index:r,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,tagName:o,attrs:i,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,residualStyles:void 0,classes:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function Or(e,t,n){for(var r in e)if(e.hasOwnProperty(r)){var o=e[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(t,o):n[r]=[t,o]}return n}function Mr(e,t,n,r,o,i,a,s){var u,c,l=Gn(n,t),h=Wn(e,n),f=h.inputs;if(!a&&null!=f&&(u=f[r]))io(e,t,u,r,o),kt(h)&&function(e,t){var n=Qn(t,e);16&n[2]||(n[2]|=64)}(t,n+19);else if(3===h.type){r="class"===(c=r)?"className":"for"===c?"htmlFor":"formaction"===c?"formAction":"innerHtml"===c?"innerHTML":"readonly"===c?"readOnly":"tabindex"===c?"tabIndex":c;var d=s?s(h,t):t[11];o=null!=i?i(o,h.tagName||"",r):o,on(d)?d.setProperty(l,r,o):un(r)||(l.setProperty?l.setProperty(r,o):l[r]=o)}}function Rr(e,t,n,r){var o=!1;if(At()){var i=function(e,t,n){var r=e.directiveRegistry,o=null;if(r)for(var i=0;i<r.length;i++){var a=r[i];sr(n,a.selectors,!1)&&(o||(o=[]),Tn(Cn(n,t),e,a.type),Et(a)?(2&n.flags&&Xn(n),qr(e,n),o.unshift(a)):o.push(a))}return o}(e,t,n),a=null===r?null:{"":-1};if(null!==i){var s=0;o=!0,Ur(n,e.data.length,i.length);for(var u=0;u<i.length;u++){var c=i[u];c.providersResolver&&c.providersResolver(c)}Br(e,n,i.length);for(var l=!1,h=!1,f=0;f<i.length;f++){var d=i[f];n.mergedAttrs=cn(n.mergedAttrs,d.hostAttrs),Gr(e,t,d),jr(e.data.length-1,d,a),null!==d.contentQueries&&(n.flags|=8),null===d.hostBindings&&null===d.hostAttrs&&0===d.hostVars||(n.flags|=128),!l&&(d.onChanges||d.onInit||d.doCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index-19),l=!0),h||!d.onChanges&&!d.doCheck||((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index-19),h=!0),Lr(e,d),s+=d.hostVars}!function(e,t){for(var n=t.directiveEnd,r=e.data,o=t.attrs,i=[],a=null,s=null,u=t.directiveStart;u<n;u++){var c=r[u],l=c.inputs;i.push(null!==o?Hr(l,o):null),a=Or(l,u,a),s=Or(c.outputs,u,s)}null!==a&&((a.hasOwnProperty("class")||a.hasOwnProperty("className"))&&(t.flags|=16),a.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=i,t.inputs=a,t.outputs=s}(e,n),Fr(e,t,s)}a&&function(e,t,n){if(t)for(var r=e.localNames=[],o=0;o<t.length;o+=2){var i=n[t[o+1]];if(null==i)throw new Error("Export of name '".concat(t[o+1],"' not found!"));r.push(t[o],i)}}(n,r,a)}return n.mergedAttrs=cn(n.mergedAttrs,n.attrs),o}function Lr(e,t){var n=e.expandoInstructions;n.push(t.hostBindings),0!==t.hostVars&&n.push(t.hostVars)}function Fr(e,t,n){for(var r=0;r<n;r++)t.push(lr),e.blueprint.push(lr),e.data.push(null)}function Vr(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function Br(e,t,n){var r=19-t.index,o=e.data.length-(65535&t.providerIndexes);(e.expandoInstructions||(e.expandoInstructions=[])).push(r,o,n)}function qr(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function jr(e,t,n){if(n){if(t.exportAs)for(var r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;Et(t)&&(n[""]=e)}}function Ur(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function Gr(e,t,n){e.data.push(n);var r=n.factory||(n.factory=gt(n.type)),o=new nn(r,Et(n),null);e.blueprint.push(o),t.push(o)}function zr(e,t,n){var r=zn(t,e),o=Nr(n),i=e[10],a=$r(e,Cr(e,o,null,n.onPush?64:16,r,t,i,i.createRenderer(r,n)));e[t.index]=a}function Wr(e,t,n,r,o,i){var a=i[t];if(null!==a)for(var s=r.setInput,u=0;u<a.length;){var c=a[u++],l=a[u++],h=a[u++];null!==s?r.setInput(n,h,c,l):n[l]=h}}function Hr(e,t){for(var n=null,r=0;r<t.length;){var o=t[r];if(0!==o)if(5!==o){if("number"==typeof o)break;e.hasOwnProperty(o)&&(null===n&&(n=[]),n.push(o,e[o],t[r+1])),r+=2}else r+=2;else r+=4}return n}function Qr(e,t,n,r){return new Array(e,!0,-2,t,null,null,r,n,null)}function Kr(e,t){for(var n=e[5],r=0;r<n.length;r++){var o=n[r],i=o[3][3][16];if(i!==t&&0==(16&i[2])){var a=o[1];Er(a,o,a.template,o[8])}}}function Yr(e,t){var n=Qn(t,e);if(Yn(n)&&80&n[2]){var r=n[1];Er(r,n,r.template,n[8])}}function Jr(e,t){var n=Qn(t,e),r=n[1];!function(e,t){for(var n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])}(r,n),Sr(r,n,n[8])}function $r(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function Zr(e){for(;e;){e[2]|=64;var t=hr(e);if(Tt(e)&&!t)return e;e=t}return null}function Xr(e,t,n){var r=t[10];r.begin&&r.begin();try{Er(e,t,e.template,n)}catch(o){throw oo(t,o),o}finally{r.end&&r.end()}}function eo(e){!function(e){for(var t=0;t<e.components.length;t++){var n=e.components[t],r=Kn(n),o=r[1];Tr(o,r,o.template,n)}}(e[8])}function to(e,t,n){jt(0),t(e,n)}var no=Promise.resolve(null);function ro(e){return e[7]||(e[7]=[])}function oo(e,t){var n=e[9],r=n?n.get(Vn,null):null;r&&r.handleError(t)}function io(e,t,n,r,o){for(var i=0;i<n.length;){var a=n[i++],s=n[i++],u=t[a],c=e.data[a];null!==c.setInput?c.setInput(u,o,r,s):u[s]=o}}function ao(e,t,n){var r=Gn(t,e),o=e[11];on(o)?o.setValue(r,n):r.textContent=n}function so(e,t){var n=t[3];return-1===e.index?wt(n)?n:null:n}function uo(e,t){var n=so(e,t);return n?_o(t[11],n[7]):null}function co(e,t,n,r,o){if(null!=r){var i,a=!1;wt(r)?i=r:_t(r)&&(a=!0,r=r[0]);var s=Un(r);0===e&&null!==n?null==o?go(t,n,s):mo(t,n,s,o||null):1===e&&null!==n?mo(t,n,s,o||null):2===e?function(e,t,n){var r=_o(e,t);r&&function(e,t,n,r){on(e)?e.removeChild(t,n,r):t.removeChild(n)}(e,r,t,n)}(t,s,a):3===e&&t.destroyNode(s),null!=i&&function(e,t,n,r,o){var i=n[7];i!==Un(n)&&co(t,e,r,i,o);for(var a=9;a<n.length;a++){var s=n[a];So(s[1],s,e,t,r,i)}}(t,e,i,n,o)}}function lo(e,t,n,r){var o=uo(e.node,t);o&&So(e,t,t[11],n?1:2,o,r)}function ho(e,t){var n=e[5],r=n.indexOf(t);n.splice(r,1)}function fo(e,t){if(!(e.length<=9)){var n=9+t,r=e[n];if(r){var o=r[17];null!==o&&o!==e&&ho(o,r),t>0&&(e[n-1][4]=r[4]);var i=tt(e,9+t);lo(r[1],r,!1,null);var a=i[5];null!==a&&a.detachView(i[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}}function po(e,t){if(!(256&t[2])){var n=t[11];on(n)&&n.destroyNode&&So(e,t,n,3,null,null),function(e){var t=e[13];if(!t)return vo(e[1],e);for(;t;){var n=null;if(_t(t))n=t[13];else{var r=t[9];r&&(n=r)}if(!n){for(;t&&!t[4]&&t!==e;)_t(t)&&vo(t[1],t),t=yo(t,e);null===t&&(t=e),_t(t)&&vo(t[1],t),n=t&&t[4]}t=n}}(t)}}function yo(e,t){var n;return _t(e)&&(n=e[6])&&2===n.type?so(n,e):e[3]===t?null:e[3]}function vo(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){var n;if(null!=e&&null!=(n=e.destroyHooks))for(var r=0;r<n.length;r+=2){var o=t[n[r]];o instanceof nn||n[r+1].call(o)}}(e,t),function(e,t){var n=e.cleanup;if(null!==n){for(var r=t[7],o=0;o<n.length-1;o+=2)if("string"==typeof n[o]){var i=n[o+1],a="function"==typeof i?i(t):Un(t[i]),s=r[n[o+2]],u=n[o+3];"boolean"==typeof u?a.removeEventListener(n[o],s,u):u>=0?r[u]():r[-u].unsubscribe(),o+=2}else n[o].call(r[n[o+1]]);t[7]=null}}(e,t);var n=t[6];n&&3===n.type&&on(t[11])&&t[11].destroy();var r=t[17];if(null!==r&&wt(t[3])){r!==t[3]&&ho(r,t);var o=t[5];null!==o&&o.detachView(e)}}}function mo(e,t,n,r){on(e)?e.insertBefore(t,n,r):t.insertBefore(n,r,!0)}function go(e,t,n){on(e)?e.appendChild(t,n):t.appendChild(n)}function bo(e,t,n,r){null!==r?mo(e,t,n,r):go(e,t,n)}function _o(e,t){return on(e)?e.parentNode(t):t.parentNode}function wo(e,t,n,r){var o=function(e,t,n){for(var r=t.parent;null!=r&&(4===r.type||5===r.type);)r=(t=r).parent;if(null==r){var o=n[6];return 2===o.type?uo(o,n):n[0]}if(t&&5===t.type&&4&t.flags)return zn(t,n).parentNode;if(2&r.flags){var i=e.data,a=i[i[r.index].directiveStart].encapsulation;if(a!==it.ShadowDom&&a!==it.Native)return null}return zn(r,n)}(e,r,t);if(null!=o){var i=t[11],a=function(e,t){if(2===e.type){var n=so(e,t);return null===n?null:Co(n.indexOf(t,9)-9,n)}return 4===e.type||5===e.type?zn(e,t):null}(r.parent||t[6],t);if(Array.isArray(n))for(var s=0;s<n.length;s++)bo(i,o,n[s],a);else bo(i,o,n,a)}}function Co(e,t){var n=9+e+1;if(n<t.length){var r=t[n],o=r[1].firstChild;if(null!==o)return function e(t,n){if(null!==n){var r=n.type;if(3===r)return zn(n,t);if(0===r)return Co(-1,t[n.index]);if(4===r||5===r){var o=n.child;if(null!==o)return e(t,o);var i=t[n.index];return wt(i)?Co(-1,i):Un(i)}var a=t[16],s=a[6],u=hr(a),c=s.projection[n.projection];return null!=c?e(u,c):e(t,n.next)}return null}(r,o)}return t[7]}function ko(e,t,n,r,o,i,a){for(;null!=n;){var s=r[n.index],u=n.type;a&&0===t&&(s&&Zn(Un(s),r),n.flags|=4),64!=(64&n.flags)&&(4===u||5===u?(ko(e,t,n.child,r,o,i,!1),co(t,e,o,s,i)):1===u?Eo(e,t,r,n,o,i):co(t,e,o,s,i)),n=a?n.projectionNext:n.next}}function So(e,t,n,r,o,i){ko(n,r,e.node.child,t,o,i,!1)}function Eo(e,t,n,r,o,i){var a=n[16],s=a[6].projection[r.projection];if(Array.isArray(s))for(var u=0;u<s.length;u++)co(t,e,o,s[u],i);else ko(e,t,s,a[3],o,i,!0)}function To(e,t,n){on(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function Io(e,t,n){on(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}var Ao,Do,No,Po=function(){function e(t,n){_classCallCheck(this,e),this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._viewContainerRef=null,this._tViewNode=null}return _createClass(e,[{key:"destroy",value:function(){if(this._appRef)this._appRef.detachView(this);else if(this._viewContainerRef){var e=this._viewContainerRef.indexOf(this);e>-1&&this._viewContainerRef.detach(e),this._viewContainerRef=null}po(this._lView[1],this._lView)}},{key:"onDestroy",value:function(e){var t,n,r;t=this._lView[1],r=e,ro(n=this._lView).push(r),t.firstCreatePass&&function(e){return e.cleanup||(e.cleanup=[])}(t).push(n[7].length-1,null)}},{key:"markForCheck",value:function(){Zr(this._cdRefInjectingView||this._lView)}},{key:"detach",value:function(){this._lView[2]&=-129}},{key:"reattach",value:function(){this._lView[2]|=128}},{key:"detectChanges",value:function(){Xr(this._lView[1],this._lView,this.context)}},{key:"checkNoChanges",value:function(){!function(e,t,n){Lt(!0);try{Xr(e,t,n)}finally{Lt(!1)}}(this._lView[1],this._lView,this.context)}},{key:"attachToViewContainerRef",value:function(e){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=e}},{key:"detachFromAppRef",value:function(){var e;this._appRef=null,So(this._lView[1],e=this._lView,e[11],2,null,null)}},{key:"attachToAppRef",value:function(e){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}},{key:"rootNodes",get:function(){var e=this._lView;return null==e[0]?function e(t,n,r,o){for(var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];null!==r;){var a=n[r.index];if(null!==a&&o.push(Un(a)),wt(a))for(var s=9;s<a.length;s++){var u=a[s],c=u[1].firstChild;null!==c&&e(u[1],u,c,o)}var l=r.type;if(4===l||5===l)e(t,n,r.child,o);else if(1===l){var h=n[16],f=h[6],d=hr(h),p=f.projection[r.projection];null!==p&&null!==d&&e(d[1],d,p,o,!0)}r=i?r.projectionNext:r.next}return o}(e[1],e,e[6].child,[]):[]}},{key:"context",get:function(){return this._lView[8]}},{key:"destroyed",get:function(){return 256==(256&this._lView[2])}}]),e}(),xo=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e)))._view=e,n}return _inherits(t,e),_createClass(t,[{key:"detectChanges",value:function(){eo(this._view)}},{key:"checkNoChanges",value:function(){!function(e){Lt(!0);try{eo(e)}finally{Lt(!1)}}(this._view)}},{key:"context",get:function(){return null}}]),t}(Po);function Oo(e,t,n){return Ao||(Ao=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),t}(e)),new Ao(zn(t,n))}var Mo=new Be("Set Injector scope."),Ro={},Lo={},Fo=[],Vo=void 0;function Bo(){return void 0===Vo&&(Vo=new $e),Vo}function qo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return t=t||Bo(),new jo(e,n,t,r)}var jo=function(){function e(t,n,r){var o=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;_classCallCheck(this,e),this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;var a=[];n&&Xe(n,(function(e){return o.processProvider(e,t,n)})),Xe([t],(function(e){return o.processInjectorType(e,[],a)})),this.records.set(qe,zo(void 0,this));var s=this.records.get(Mo);this.scope=null!=s?s.value:null,this.injectorDefTypes.forEach((function(e){return o.get(e)})),this.source=i||("object"==typeof t?null:_e(t))}return _createClass(e,[{key:"destroy",value:function(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach((function(e){return e.ngOnDestroy()}))}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:je,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:se.Default;this.assertNotDestroyed();var r,o=We(this);try{if(!(n&se.SkipSelf)){var i=this.records.get(e);if(void 0===i){var a=("function"==typeof(r=e)||"object"==typeof r&&r instanceof Be)&&fe(e);i=a&&this.injectableDefInScope(a)?zo(Uo(e),Ro):null,this.records.set(e,i)}if(null!=i)return this.hydrate(e,i)}return(n&se.Self?Bo():this.parent).get(e,t=n&se.Optional&&t===je?null:t)}catch(s){if("NullInjectorError"===s.name){if((s.ngTempTokenPath=s.ngTempTokenPath||[]).unshift(_e(e)),o)throw s;return function(e,t,n,r){var o=e.ngTempTokenPath;throw t.__source&&o.unshift(t.__source),e.message=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;var o=_e(t);if(Array.isArray(t))o=t.map(_e).join(" -> ");else if("object"==typeof t){var i=[];for(var a in t)if(t.hasOwnProperty(a)){var s=t[a];i.push(a+":"+("string"==typeof s?JSON.stringify(s):_e(s)))}o="{".concat(i.join(", "),"}")}return"".concat(n).concat(r?"("+r+")":"","[").concat(o,"]: ").concat(e.replace(Ue,"\n  "))}("\n"+e.message,o,"R3InjectorError",r),e.ngTokenPath=o,e.ngTempTokenPath=null,e}(s,e,0,this.source)}throw s}finally{We(o)}}},{key:"toString",value:function(){var e=[];return this.records.forEach((function(t,n){return e.push(_e(n))})),"R3Injector[".concat(e.join(", "),"]")}},{key:"assertNotDestroyed",value:function(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}},{key:"processInjectorType",value:function(e,t,n){var r=this;if(!(e=Se(e)))return!1;var o=pe(e),i=null==o&&e.ngModule||void 0,a=void 0===i?e:i,s=-1!==n.indexOf(a);if(void 0!==i&&(o=pe(i)),null==o)return!1;if(this.injectorDefTypes.add(a),this.records.set(a,zo(o.factory,Ro)),null!=o.imports&&!s){var u;n.push(a);try{Xe(o.imports,(function(e){r.processInjectorType(e,t,n)&&(void 0===u&&(u=[]),u.push(e))}))}finally{}if(void 0!==u)for(var c=function(e){var t=u[e],n=t.ngModule,o=t.providers;Xe(o,(function(e){return r.processProvider(e,n,o||Fo)}))},l=0;l<u.length;l++)c(l)}var h=o.providers;if(null!=h&&!s){var f=e;Xe(h,(function(e){return r.processProvider(e,f,h)}))}return void 0!==i&&void 0!==e.providers}},{key:"processProvider",value:function(e,t,n){var r=Ho(e=Se(e))?e:Se(e&&e.provide),o=function(e,t,n){return Wo(e)?zo(void 0,e.useValue):zo(Go(e,t,n),Ro)}(e,t,n);if(Ho(e)||!0!==e.multi){var i=this.records.get(r);i&&void 0!==i.multi&&er()}else{var a=this.records.get(r);a?void 0===a.multi&&er():((a=zo(void 0,Ro,!0)).factory=function(){return Je(a.multi)},this.records.set(r,a)),r=e,a.multi.push(e)}this.records.set(r,o)}},{key:"hydrate",value:function(e,t){var n;return t.value===Lo?function(e){throw new Error("Cannot instantiate cyclic dependency! ".concat(e))}(_e(e)):t.value===Ro&&(t.value=Lo,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(n=t.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(t.value),t.value}},{key:"injectableDefInScope",value:function(e){return!!e.providedIn&&("string"==typeof e.providedIn?"any"===e.providedIn||e.providedIn===this.scope:this.injectorDefTypes.has(e.providedIn))}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();function Uo(e){var t=fe(e),n=null!==t?t.factory:gt(e);if(null!==n)return n;var r=pe(e);if(null!==r)return r.factory;if(e instanceof Be)throw new Error("Token ".concat(_e(e)," is missing a \u0275prov definition."));if(e instanceof Function)return function(e){var t=e.length;if(t>0){var n=function(e,t){for(var n=[],r=0;r<e;r++)n.push("?");return n}(t);throw new Error("Can't resolve all parameters for ".concat(_e(e),": (").concat(n.join(", "),")."))}var r=function(e){var t=e&&(e[ye]||e[ge]||e[me]&&e[me]());if(t){var n=function(e){if(e.hasOwnProperty("name"))return e.name;var t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn('DEPRECATED: DI is instantiating a token "'.concat(n,'" that inherits its @Injectable decorator but does not provide one itself.\n')+'This will become an error in v10. Please add @Injectable() to the "'.concat(n,'" class.')),t}return null}(e);return null!==r?function(){return r.factory(e)}:function(){return new e}}(e);throw new Error("unreachable")}function Go(e,t,n){var r,o=void 0;if(Ho(e))return Uo(Se(e));if(Wo(e))o=function(){return Se(e.useValue)};else if((r=e)&&r.useFactory)o=function(){return e.useFactory.apply(e,_toConsumableArray(Je(e.deps||[])))};else if(function(e){return!(!e||!e.useExisting)}(e))o=function(){return Ke(Se(e.useExisting))};else{var i=Se(e&&(e.useClass||e.provide));if(i||function(e,t,n){var r="";throw e&&t&&(r=" - only instances of Provider and Type are allowed, got: [".concat(t.map((function(e){return e==n?"?"+n+"?":"..."})).join(", "),"]")),new Error("Invalid provider for the NgModule '".concat(_e(e),"'")+r)}(t,n,e),!function(e){return!!e.deps}(e))return Uo(i);o=function(){return _construct(i,_toConsumableArray(Je(e.deps)))}}return o}function zo(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{factory:e,value:t,multi:n?[]:void 0}}function Wo(e){return null!==e&&"object"==typeof e&&Ge in e}function Ho(e){return"function"==typeof e}var Qo=function(e,t,n){return qo({name:n},t,e,n)},Ko=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"create",value:function(e,t){return Array.isArray(e)?Qo(e,t,""):Qo(e.providers,e.parent,e.name||"")}}]),e}();return e.THROW_IF_NOT_FOUND=je,e.NULL=new $e,e.\u0275prov=le({token:e,providedIn:"any",factory:function(){return Ke(qe)}}),e.__NG_ELEMENT_ID__=-1,e}(),Yo=new Map,Jo=new Set;function $o(e){return"string"==typeof e?e:e.text()}function Zo(e,t){for(var n=e.styles,r=e.classes,o=0,i=0;i<t.length;i++){var a=t[i];"number"==typeof a?o=a:1==o?r=we(r,a):2==o&&(n=we(n,a+": "+t[++i]+";"))}null!==n&&(e.styles=n),null!==r&&(e.classes=r)}var Xo=null;function ei(){if(!Xo){var e=Pe.Symbol;if(e&&e.iterator)Xo=e.iterator;else for(var t=Object.getOwnPropertyNames(Map.prototype),n=0;n<t.length;++n){var r=t[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(Xo=r)}}return Xo}function ti(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}var ni=function(){function e(t){_classCallCheck(this,e),this.wrapped=t}return _createClass(e,null,[{key:"wrap",value:function(t){return new e(t)}},{key:"unwrap",value:function(t){return e.isWrapped(t)?t.wrapped:t}},{key:"isWrapped",value:function(t){return t instanceof e}}]),e}();function ri(e){return!!oi(e)&&(Array.isArray(e)||!(e instanceof Map)&&ei()in e)}function oi(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function ii(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function ai(e,t,n,r){var o=ii(e,t,n);return ii(e,t+1,r)||o}function si(e,t,n,r){return ii(e,Vt(),n)?t+yn(n)+r:lr}function ui(e,t,n,r,o,i,a,s){var u=Dt(),c=Nt(),l=e+19,h=c.firstCreatePass?function(e,t,n,r,o,i,a,s,u){var c=t.consts,l=kr(t,n[6],e,0,a||null,Jn(c,s));Rr(t,n,l,Jn(c,u)),Jt(t,l);var h=l.tViews=Pr(2,-1,r,o,i,t.directiveRegistry,t.pipeRegistry,null,t.schemas,c),f=xr(0,null,2,-1,null,null);return f.injectorIndex=l.injectorIndex,h.node=f,null!==t.queries&&(t.queries.template(t,l),h.queries=t.queries.embeddedTView(l)),l}(e,c,u,t,n,r,o,i,a):c.data[l];Ot(h,!1);var f=u[11].createComment("");wo(c,u,f,h),Zn(f,u),$r(u,u[l]=Qr(f,u,f,h)),St(h)&&Ar(c,u,h),null!=a&&Dr(u,h,s)}function ci(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:se.Default,n=Dt();return null==n?Ke(e,t):In(xt(),n,Se(e),t)}function li(e,t,n){var r=Dt();if(ii(r,Vt(),t)){var o=Kt();Mr(Nt(),r,o,e,t,n)}return li}function hi(e,t,n,r,o){var i=t.inputs,a=o?"class":"style";io(e,n,i[a]||o&&i.className,a,r)}function fi(e,t,n,r){var o=Dt(),i=Nt(),a=19+e,s=o[11],u=o[a]=wr(t,s,It.lFrame.currentNamespace),c=i.firstCreatePass?function(e,t,n,r,o,i,a){var s=t.consts,u=Jn(s,i),c=kr(t,n[6],e,3,o,u);return Rr(t,n,c,Jn(s,a)),null!==c.mergedAttrs&&Zo(c,c.mergedAttrs),null!==t.queries&&t.queries.elementStart(t,c),c}(e,i,o,0,t,n,r):i.data[a];Ot(c,!0);var l=c.mergedAttrs;null!==l&&sn(s,u,l);var h=c.classes;null!==h&&Io(s,u,h);var f=c.styles;null!==f&&To(s,u,f),wo(i,o,u,c),0===It.lFrame.elementDepthCount&&Zn(u,o),It.lFrame.elementDepthCount++,St(c)&&(Ar(i,o,c),function(e,t,n){if(Ct(t))for(var r=t.directiveEnd,o=t.directiveStart;o<r;o++){var i=e.data[o];i.contentQueries&&i.contentQueries(1,n[o],o)}}(i,c,o)),null!==r&&Dr(o,c)}function di(){var e=xt();Mt()?It.lFrame.isParent=!1:Ot(e=e.parent,!1);var t=e;It.lFrame.elementDepthCount--;var n=Nt();n.firstCreatePass&&(Jt(n,e),Ct(e)&&n.queries.elementEnd(e)),null!==t.classes&&function(e){return 0!=(16&e.flags)}(t)&&hi(n,t,Dt(),t.classes,!0),null!==t.styles&&function(e){return 0!=(32&e.flags)}(t)&&hi(n,t,Dt(),t.styles,!1)}function pi(e,t,n,r){fi(e,t,n,r),di()}function yi(){return Dt()}function vi(e){return!!e&&"function"==typeof e.then}function mi(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,o=Dt(),i=Nt(),a=xt();return function(e,t,n,r,o,i){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7?arguments[7]:void 0,u=St(r),c=e.firstCreatePass&&(e.cleanup||(e.cleanup=[])),l=ro(t),h=!0;if(3===r.type){var f=zn(r,t),d=s?s(f):st,p=d.target||f,y=l.length,v=s?function(e){return s(Un(e[r.index])).target}:r.index;if(on(n)){var m=null;if(!s&&u&&(m=function(e,t,n,r){var o=e.cleanup;if(null!=o)for(var i=0;i<o.length-1;i+=2){var a=o[i];if(a===n&&o[i+1]===r){var s=t[7],u=o[i+2];return s.length>u?s[u]:null}"string"==typeof a&&(i+=2)}return null}(e,t,o,r.index)),null!==m)(m.__ngLastListenerFn__||m).__ngNextListenerFn__=i,m.__ngLastListenerFn__=i,h=!1;else{i=bi(r,t,i,!1);var g=n.listen(d.name||p,o,i);l.push(i,g),c&&c.push(o,v,y,y+1)}}else i=bi(r,t,i,!0),p.addEventListener(o,i,a),l.push(i),c&&c.push(o,v,y,a)}var b,_=r.outputs;if(h&&null!==_&&(b=_[o])){var w=b.length;if(w)for(var C=0;C<w;C+=2){var k=t[b[C]][b[C+1]].subscribe(i),S=l.length;l.push(i,k),c&&c.push(o,r.index,S,-(S+1))}}}(i,o,o[11],a,e,t,n,r),mi}function gi(e,t,n){try{return!1!==t(n)}catch(r){return oo(e,r),!1}}function bi(e,t,n,r){return function o(i){if(i===Function)return n;var a=2&e.flags?Qn(e.index,t):t;0==(32&t[2])&&Zr(a);for(var s=gi(t,n,i),u=o.__ngNextListenerFn__;u;)s=gi(t,u,i)&&s,u=u.__ngNextListenerFn__;return r&&!1===s&&(i.preventDefault(),i.returnValue=!1),s}}function _i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(e){return(It.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,It.lFrame.contextLView))[8]}(e)}function wi(e,t,n){return Ci(e,"",t,"",n),wi}function Ci(e,t,n,r,o){var i=Dt(),a=si(i,t,n,r);if(a!==lr){var s=Kt();Mr(Nt(),i,s,e,a,o)}return Ci}var ki=[];function Si(e,t,n,r,o){for(var i=e[n+1],a=null===t,s=r?yr(i):mr(i),u=!1;0!==s&&(!1===u||a);){var c=e[s+1];Ei(e[s],t)&&(u=!0,e[s+1]=r?br(c):vr(c)),s=r?yr(c):mr(c)}u&&(e[n+1]=r?vr(i):br(i))}function Ei(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&rt(e,t)>=0}function Ti(e,t){return function(e,t,n,r){var o,i,a=Dt(),s=Nt(),u=Bt(2);(s.firstUpdatePass&&function(e,t,n,r){var o=e.data;if(null===o[n+1]){var i=o[Kt()+19],a=function(e,t){return t>=e.expandoStartIndex}(e,n);(function(e,t){return 0!=(16&e.flags)})(i)&&null===t&&!a&&(t=!1),t=function(e,t,n,r){var o=function(e){var t=It.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e),i=t.residualClasses;if(null===o)0===t.classBindings&&(n=Ai(n=Ii(null,e,t,n,!0),t.attrs,!0),i=null);else{var a=t.directiveStylingLast;if(-1===a||e[a]!==o)if(n=Ii(o,e,t,n,!0),null===i){var s=function(e,t,n){var r=t.classBindings;if(0!==mr(r))return e[yr(r)]}(e,t);void 0!==s&&Array.isArray(s)&&function(e,t,n,r){e[yr(t.classBindings)]=r}(e,t,0,s=Ai(s=Ii(null,e,t,s[1],!0),t.attrs,!0))}else i=function(e,t,n){for(var r=void 0,o=t.directiveEnd,i=1+t.directiveStylingLast;i<o;i++)r=Ai(r,e[i].hostAttrs,!0);return Ai(r,t.attrs,!0)}(e,t)}return void 0!==i&&(t.residualClasses=i),n}(o,i,t),function(e,t,n,r,o,i){var a=t.classBindings,s=yr(a),u=mr(a);e[r]=n;var c,l=!1;if(Array.isArray(n)){var h=n;(null===(c=h[1])||rt(h,c)>0)&&(l=!0)}else c=n;if(o)if(0!==u){var f=yr(e[s+1]);e[r+1]=pr(f,s),0!==f&&(e[f+1]=gr(e[f+1],r)),e[s+1]=131071&e[s+1]|r<<17}else e[r+1]=pr(s,0),0!==s&&(e[s+1]=gr(e[s+1],r)),s=r;else e[r+1]=pr(u,0),0===s?s=r:e[u+1]=gr(e[u+1],r),u=r;l&&(e[r+1]=vr(e[r+1])),Si(e,c,r,!0),Si(e,c,r,!1),function(e,t,n,r,o){var i=e.residualClasses;null!=i&&"string"==typeof t&&rt(i,t)>=0&&(n[r+1]=br(n[r+1]))}(t,c,e,r),a=pr(s,u),t.classBindings=a}(o,i,t,n,a)}}(s,e,u),t!==lr&&ii(a,u,t))&&(null==n&&(o=null===(i=It.lFrame)?null:i.currentSanitizer)&&(n=o),function(e,t,n,r,o,i,a,s){if(3===t.type){var u=e.data,c=u[s+1];Ni(1==(1&c)?Di(u,t,n,o,mr(c),!0):void 0)||(Ni(i)||2==(2&c)&&(i=Di(u,null,n,o,s,!0)),function(e,t,n,r,o){var i=on(e);o?i?e.addClass(n,r):n.classList.add(r):i?e.removeClass(n,r):n.classList.remove(r)}(r,0,Gn(Kt(),n),o,i))}}(s,s.data[Kt()+19],a,a[11],e,a[u+1]=function(e,t){return null==e||("function"==typeof t?e=t(e):"string"==typeof t?e+=t:"object"==typeof e&&(e=_e(function(e){return e instanceof function(){function e(t){_classCallCheck(this,e),this.changingThisBreaksApplicationSecurity=t}return _createClass(e,[{key:"toString",value:function(){return"SafeValue must use [property]=binding: ".concat(this.changingThisBreaksApplicationSecurity)+" (see http://g.co/ng/security#xss)"}}]),e}()?e.changingThisBreaksApplicationSecurity:e}(e)))),e}(t,n),0,u))}(e,t,null),Ti}function Ii(e,t,n,r,o){var i=null,a=n.directiveEnd,s=n.directiveStylingLast;for(-1===s?s=n.directiveStart:s++;s<a&&(r=Ai(r,(i=t[s]).hostAttrs,o),i!==e);)s++;return null!==e&&(n.directiveStylingLast=s),r}function Ai(e,t,n){var r,o,i,a,s=n?1:2,u=-1;if(null!==t)for(var c=0;c<t.length;c++){var l=t[c];"number"==typeof l?u=l:u===s&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),r=e,o=l,i=!!n||t[++c],a=void 0,(a=rt(r,o))>=0?r[1|a]=i:function(e,t,n,r){var o=e.length;if(o==t)e.push(n,r);else if(1===o)e.push(r,e[0]),e[0]=n;else{for(o--,e.push(e[o-1],e[o]);o>t;)e[o]=e[o-2],o--;e[t]=n,e[t+1]=r}}(r,a=~a,o,i))}return void 0===e?null:e}function Di(e,t,n,r,o,i){for(var a=null===t,s=void 0;o>0;){var u=e[o],c=Array.isArray(u),l=c?u[1]:u,h=null===l,f=n[o+1];f===lr&&(f=h?ki:void 0);var d=h?nt(f,r):l===r?f:void 0;if(c&&!Ni(d)&&(d=nt(u,r)),Ni(d)&&(s=d,a))return s;var p=e[o+1];o=a?yr(p):mr(p)}if(null!==t){var y=i?t.residualClasses:t.residualStyles;null!=y&&(s=nt(y,r))}return s}function Ni(e){return void 0!==e}function Pi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Dt(),r=Nt(),o=e+19,i=r.firstCreatePass?kr(r,n[6],e,3,null,null):r.data[o],a=n[o]=function(e,t){return on(t)?t.createText(e):t.createTextNode(e)}(t,n[11]);wo(r,n,a,i),Ot(i,!1)}function xi(e){return Oi("",e,""),xi}function Oi(e,t,n){var r=Dt(),o=si(r,e,t,n);return o!==lr&&ao(r,Kt(),o),Oi}function Mi(e,t,n,r,o){var i=Dt(),a=function(e,t,n,r,o,i){var a=ai(e,Ft(),n,o);return Bt(2),a?t+yn(n)+r+yn(o)+i:lr}(i,e,t,n,r,o);return a!==lr&&ao(i,Kt(),a),Mi}function Ri(e,t){var n=Kn(e)[1],r=n.data.length-1;Jt(n,{directiveStart:r,directiveEnd:r+1})}function Li(e){for(var t=Object.getPrototypeOf(e.type.prototype).constructor,n=!0,r=[e];t;){var o=void 0;if(Et(e))o=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");o=t.\u0275dir}if(o){if(n){r.push(o);var i=e;i.inputs=Fi(e.inputs),i.declaredInputs=Fi(e.declaredInputs),i.outputs=Fi(e.outputs);var a=o.hostBindings;a&&qi(e,a);var s=o.viewQuery,u=o.contentQueries;s&&Vi(e,s),u&&Bi(e,u),ce(e.inputs,o.inputs),ce(e.declaredInputs,o.declaredInputs),ce(e.outputs,o.outputs),i.afterContentChecked=i.afterContentChecked||o.afterContentChecked,i.afterContentInit=e.afterContentInit||o.afterContentInit,i.afterViewChecked=e.afterViewChecked||o.afterViewChecked,i.afterViewInit=e.afterViewInit||o.afterViewInit,i.doCheck=e.doCheck||o.doCheck,i.onDestroy=e.onDestroy||o.onDestroy,i.onInit=e.onInit||o.onInit}var c=o.features;if(c)for(var l=0;l<c.length;l++){var h=c[l];h&&h.ngInherit&&h(e),h===Li&&(n=!1)}}t=Object.getPrototypeOf(t)}!function(e){for(var t=0,n=null,r=e.length-1;r>=0;r--){var o=e[r];o.hostVars=t+=o.hostVars,o.hostAttrs=cn(o.hostAttrs,n=cn(n,o.hostAttrs))}}(r)}function Fi(e){return e===st?{}:e===ut?[]:e}function Vi(e,t){var n=e.viewQuery;e.viewQuery=n?function(e,r){t(e,r),n(e,r)}:t}function Bi(e,t){var n=e.contentQueries;e.contentQueries=n?function(e,r,o){t(e,r,o),n(e,r,o)}:t}function qi(e,t){var n=e.hostBindings;e.hostBindings=n?function(e,r){t(e,r),n(e,r)}:t}var ji=function(){function e(t,n,r){_classCallCheck(this,e),this.previousValue=t,this.currentValue=n,this.firstChange=r}return _createClass(e,[{key:"isFirstChange",value:function(){return this.firstChange}}]),e}();function Ui(e){e.type.prototype.ngOnChanges&&(e.setInput=Gi,e.onChanges=function(){var e=zi(this),t=e&&e.current;if(t){var n=e.previous;if(n===st)e.previous=t;else for(var r in t)n[r]=t[r];e.current=null,this.ngOnChanges(t)}})}function Gi(e,t,n,r){var o=zi(e)||function(e,t){return e.__ngSimpleChanges__=t}(e,{previous:st,current:null}),i=o.current||(o.current={}),a=o.previous,s=this.declaredInputs[n],u=a[s];i[s]=new ji(u&&u.currentValue,t,a===st),e[r]=t}function zi(e){return e.__ngSimpleChanges__||null}function Wi(e,t,n,r,o){if(e=Se(e),Array.isArray(e))for(var i=0;i<e.length;i++)Wi(e[i],t,n,r,o);else{var a=Nt(),s=Dt(),u=Ho(e)?e:Se(e.provide),c=Go(e),l=xt(),h=65535&l.providerIndexes,f=l.directiveStart,d=l.providerIndexes>>16;if(e.useClass||Ho(e)){var p=(e.useClass||e).prototype.ngOnDestroy;p&&(a.destroyHooks||(a.destroyHooks=[])).push(t.length,p)}if(Ho(e)||!e.multi){var y=new nn(c,o,ci),v=Qi(u,t,o?h:h+d,f);-1==v?(Tn(Cn(l,s),a,u),t.push(u),l.directiveStart++,l.directiveEnd++,o&&(l.providerIndexes+=65536),n.push(y),s.push(y)):(n[v]=y,s[v]=y)}else{var m=Qi(u,t,h+d,f),g=Qi(u,t,h,h+d),b=m>=0&&n[m],_=g>=0&&n[g];if(o&&!_||!o&&!b){Tn(Cn(l,s),a,u);var w=function(e,t,n,r,o){var i=new nn(e,n,ci);return i.multi=[],i.index=t,i.componentProviders=0,Hi(i,o,r&&!n),i}(o?Yi:Ki,n.length,o,r,c);!o&&_&&(n[g].providerFactory=w),t.push(u),l.directiveStart++,l.directiveEnd++,o&&(l.providerIndexes+=65536),n.push(w),s.push(w)}else Hi(n[o?g:m],c,!o&&r);!o&&r&&_&&n[g].componentProviders++}}}function Hi(e,t,n){e.multi.push(t),n&&e.componentProviders++}function Qi(e,t,n,r){for(var o=n;o<r;o++)if(t[o]===e)return o;return-1}function Ki(e,t,n,r){return Ji(this.multi,[])}function Yi(e,t,n,r){var o,i=this.multi;if(this.providerFactory){var a=this.providerFactory.componentProviders,s=Nn(n,n[1],this.providerFactory.index,r);Ji(i,o=s.slice(0,a));for(var u=a;u<s.length;u++)o.push(s[u])}else Ji(i,o=[]);return o}function Ji(e,t){for(var n=0;n<e.length;n++)t.push((0,e[n])());return t}function $i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(n){n.providersResolver=function(n,r){return function(e,t,n){var r=Nt();if(r.firstCreatePass){var o=Et(e);Wi(n,r.data,r.blueprint,o,!0),Wi(t,r.data,r.blueprint,o,!1)}}(n,r?r(e):e,t)}}}var Zi=function e(){_classCallCheck(this,e)},Xi=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"resolveComponentFactory",value:function(e){throw function(e){var t=Error("No component factory found for ".concat(_e(e),". Did you add it to @NgModule.entryComponents?"));return t.ngComponent=e,t}(e)}}]),e}(),ea=function(){var e=function e(){_classCallCheck(this,e)};return e.NULL=new Xi,e}(),ta=function(){var e=function e(t){_classCallCheck(this,e),this.nativeElement=t};return e.__NG_ELEMENT_ID__=function(){return na(e)},e}(),na=function(e){return Oo(e,xt(),Dt())},ra=function e(){_classCallCheck(this,e)},oa=function(){var e={Important:1,DashCase:2};return e[e.Important]="Important",e[e.DashCase]="DashCase",e}(),ia=function(){var e=function e(){_classCallCheck(this,e)};return e.__NG_ELEMENT_ID__=function(){return aa()},e}(),aa=function(){var e=Dt(),t=Qn(xt().index,e);return function(e){var t=e[11];if(on(t))return t;throw new Error("Cannot inject Renderer2 when the application uses Renderer3!")}(_t(t)?t:e)},sa=function(){var e=function e(){_classCallCheck(this,e)};return e.\u0275prov=le({token:e,providedIn:"root",factory:function(){return null}}),e}(),ua=new function e(t){_classCallCheck(this,e),this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}("9.0.0"),ca=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"supports",value:function(e){return ri(e)}},{key:"create",value:function(e){return new ha(e)}}]),e}(),la=function(e,t){return t},ha=function(){function e(t){_classCallCheck(this,e),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||la}return _createClass(e,[{key:"forEachItem",value:function(e){var t;for(t=this._itHead;null!==t;t=t._next)e(t)}},{key:"forEachOperation",value:function(e){for(var t=this._itHead,n=this._removalsHead,r=0,o=null;t||n;){var i=!n||t&&t.currentIndex<ya(n,r,o)?t:n,a=ya(i,r,o),s=i.currentIndex;if(i===n)r--,n=n._nextRemoved;else if(t=t._next,null==i.previousIndex)r++;else{o||(o=[]);var u=a-r,c=s-r;if(u!=c){for(var l=0;l<u;l++){var h=l<o.length?o[l]:o[l]=0,f=h+l;c<=f&&f<u&&(o[l]=h+1)}o[i.previousIndex]=c-u}}a!==s&&e(i,a,s)}}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachMovedItem",value:function(e){var t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"forEachIdentityChange",value:function(e){var t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}},{key:"diff",value:function(e){if(null==e&&(e=[]),!ri(e))throw new Error("Error trying to diff '".concat(_e(e),"'. Only arrays and iterables are allowed"));return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n,r,o,i=this._itHead,a=!1;if(Array.isArray(e)){this.length=e.length;for(var s=0;s<this.length;s++)r=e[s],o=this._trackByFn(s,r),null!==i&&ti(i.trackById,o)?(a&&(i=this._verifyReinsertion(i,r,o,s)),ti(i.item,r)||this._addIdentityChange(i,r)):(i=this._mismatch(i,r,o,s),a=!0),i=i._next}else n=0,function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(e[n]);else for(var r,o=e[ei()]();!(r=o.next()).done;)t(r.value)}(e,(function(e){o=t._trackByFn(n,e),null!==i&&ti(i.trackById,o)?(a&&(i=t._verifyReinsertion(i,e,o,n)),ti(i.item,e)||t._addIdentityChange(i,e)):(i=t._mismatch(i,e,o,n),a=!0),i=i._next,n++})),this.length=n;return this._truncate(i),this.collection=e,this.isDirty}},{key:"_reset",value:function(){if(this.isDirty){var e,t;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=t)e.previousIndex=e.currentIndex,t=e._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(e,t,n,r){var o;return null===e?o=this._itTail:(o=e._prev,this._remove(e)),null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(ti(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,r)):null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(ti(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,r)):e=this._addAfter(new fa(t,n),o,r),e}},{key:"_verifyReinsertion",value:function(e,t,n,r){var o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==o?e=this._reinsertAfter(o,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}},{key:"_truncate",value:function(e){for(;null!==e;){var t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);var r=e._prevRemoved,o=e._nextRemoved;return null===r?this._removalsHead=o:r._nextRemoved=o,null===o?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_moveAfter",value:function(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_addAfter",value:function(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}},{key:"_insertAfter",value:function(e,t,n){var r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new pa),this._linkedRecords.put(e),e.currentIndex=n,e}},{key:"_remove",value:function(e){return this._addToRemovals(this._unlink(e))}},{key:"_unlink",value:function(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);var t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}},{key:"_addToMoves",value:function(e,t){return e.previousIndex===t?e:(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e,e)}},{key:"_addToRemovals",value:function(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new pa),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}},{key:"_addIdentityChange",value:function(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}}]),e}(),fa=function e(t,n){_classCallCheck(this,e),this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null},da=function(){function e(){_classCallCheck(this,e),this._head=null,this._tail=null}return _createClass(e,[{key:"add",value:function(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}},{key:"get",value:function(e,t){var n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&ti(n.trackById,e))return n;return null}},{key:"remove",value:function(e){var t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}]),e}(),pa=function(){function e(){_classCallCheck(this,e),this.map=new Map}return _createClass(e,[{key:"put",value:function(e){var t=e.trackById,n=this.map.get(t);n||(n=new da,this.map.set(t,n)),n.add(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);return n?n.get(e,t):null}},{key:"remove",value:function(e){var t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}},{key:"clear",value:function(){this.map.clear()}},{key:"isEmpty",get:function(){return 0===this.map.size}}]),e}();function ya(e,t,n){var r=e.previousIndex;if(null===r)return r;var o=0;return n&&r<n.length&&(o=n[r]),r+t+o}var va=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"supports",value:function(e){return e instanceof Map||oi(e)}},{key:"create",value:function(){return new ma}}]),e}(),ma=function(){function e(){_classCallCheck(this,e),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return _createClass(e,[{key:"forEachItem",value:function(e){var t;for(t=this._mapHead;null!==t;t=t._next)e(t)}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachChangedItem",value:function(e){var t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"diff",value:function(e){if(e){if(!(e instanceof Map||oi(e)))throw new Error("Error trying to diff '".concat(_e(e),"'. Only maps and objects are allowed"))}else e=new Map;return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n=this._mapHead;if(this._appendAfter=null,this._forEach(e,(function(e,r){if(n&&n.key===r)t._maybeAddToChanges(n,e),t._appendAfter=n,n=n._next;else{var o=t._getOrCreateRecordForKey(r,e);n=t._insertBeforeOrAppend(n,o)}})),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(var r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(e,t){if(e){var n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}},{key:"_getOrCreateRecordForKey",value:function(e,t){if(this._records.has(e)){var n=this._records.get(e);this._maybeAddToChanges(n,t);var r=n._prev,o=n._next;return r&&(r._next=o),o&&(o._prev=r),n._next=null,n._prev=null,n}var i=new ga(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}},{key:"_reset",value:function(){if(this.isDirty){var e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(e,t){ti(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}},{key:"_addToAdditions",value:function(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}},{key:"_addToChanges",value:function(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}},{key:"_forEach",value:function(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach((function(n){return t(e[n],n)}))}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}}]),e}(),ga=function e(t){_classCallCheck(this,e),this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null},ba=function(){var e=function(){function e(t){_classCallCheck(this,e),this.factories=t}return _createClass(e,[{key:"find",value:function(e){var t,n=this.factories.find((function(t){return t.supports(e)}));if(null!=n)return n;throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat((t=e).name||typeof t,"'"))}}],[{key:"create",value:function(t,n){if(null!=n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){if(!n)throw new Error("Cannot extend IterableDiffers without a parent injector");return e.create(t,n)},deps:[[e,new ae,new oe]]}}}]),e}();return e.\u0275prov=le({token:e,providedIn:"root",factory:function(){return new e([new ca])}}),e}(),_a=function(){var e=function(){function e(t){_classCallCheck(this,e),this.factories=t}return _createClass(e,[{key:"find",value:function(e){var t=this.factories.find((function(t){return t.supports(e)}));if(t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"'"))}}],[{key:"create",value:function(t,n){if(n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){if(!n)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return e.create(t,n)},deps:[[e,new ae,new oe]]}}}]),e}();return e.\u0275prov=le({token:e,providedIn:"root",factory:function(){return new e([new va])}}),e}(),wa=[new va],Ca=new ba([new ca]),ka=new _a(wa),Sa=function(){var e=function e(){_classCallCheck(this,e)};return e.__NG_ELEMENT_ID__=function(){return Ea(e,ta)},e}(),Ea=function(e,t){return function(e,t,n,r){return Do||(Do=function(e){function t(e,n,r){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._declarationView=e,o._declarationTContainer=n,o.elementRef=r,o}return _inherits(t,e),_createClass(t,[{key:"createEmbeddedView",value:function(e){var t=this._declarationTContainer.tViews,n=Cr(this._declarationView,t,e,16,null,t.node);n[17]=this._declarationView[this._declarationTContainer.index];var r=this._declarationView[5];null!==r&&(n[5]=r.createEmbeddedView(t)),Sr(t,n,e);var o=new Po(n);return o._tViewNode=n[6],o}}]),t}(e)),0===n.type?new Do(r,n,Oo(t,n,r)):null}(e,t,xt(),Dt())},Ta=function(){var e=function e(){_classCallCheck(this,e)};return e.__NG_ELEMENT_ID__=function(){return Ia(e,ta)},e}(),Ia=function(e,t){return function(e,t,n,r){var o;No||(No=function(e){function n(e,t,r){var o;return _classCallCheck(this,n),(o=_possibleConstructorReturn(this,_getPrototypeOf(n).call(this)))._lContainer=e,o._hostTNode=t,o._hostView=r,o}return _inherits(n,e),_createClass(n,[{key:"clear",value:function(){for(;this.length>0;)this.remove(this.length-1)}},{key:"get",value:function(e){return null!==this._lContainer[8]&&this._lContainer[8][e]||null}},{key:"createEmbeddedView",value:function(e,t,n){var r=e.createEmbeddedView(t||{});return this.insert(r,n),r}},{key:"createComponent",value:function(e,t,n,r,o){var i=n||this.parentInjector;if(!o&&null==e.ngModule&&i){var a=i.get(Ze,null);a&&(o=a)}var s=e.create(i,r,void 0,o);return this.insert(s.hostView,t),s}},{key:"insert",value:function(e,t){var n=e._lView,r=n[1];if(e.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");if(this.allocateContainerIfNeeded(),wt(n[3])){var o=this.indexOf(e);if(-1!==o)this.detach(o);else{var i=n[3],a=new No(i,i[6],i[3]);a.detach(a.indexOf(e))}}var s=this._adjustIndex(t);return function(e,t,n,r){var o=9+r,i=n.length;r>0&&(n[o-1][4]=t),r<i-9?(t[4]=n[o],et(n,9+r,t)):(n.push(t),t[4]=null),t[3]=n;var a=t[17];null!==a&&n!==a&&function(e,t){var n=e[5],r=t[3][3][16];16!=(16&r[2])&&t[16]!==r&&(e[2]|=1),null===n?e[5]=[t]:n.push(t)}(a,t);var s=t[5];null!==s&&s.insertView(e),t[2]|=128}(r,n,this._lContainer,s),lo(r,n,!0,Co(s,this._lContainer)),e.attachToViewContainerRef(this),et(this._lContainer[8],s,e),e}},{key:"move",value:function(e,t){if(e.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");return this.insert(e,t)}},{key:"indexOf",value:function(e){var t=this._lContainer[8];return null!==t?t.indexOf(e):-1}},{key:"remove",value:function(e){this.allocateContainerIfNeeded();var t=this._adjustIndex(e,-1);(function(e,t){var n=fo(e,t);n&&po(n[1],n)})(this._lContainer,t),tt(this._lContainer[8],t)}},{key:"detach",value:function(e){this.allocateContainerIfNeeded();var t=this._adjustIndex(e,-1),n=fo(this._lContainer,t);return n&&null!=tt(this._lContainer[8],t)?new Po(n):null}},{key:"_adjustIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null==e?this.length+t:e}},{key:"allocateContainerIfNeeded",value:function(){null===this._lContainer[8]&&(this._lContainer[8]=[])}},{key:"element",get:function(){return Oo(t,this._hostTNode,this._hostView)}},{key:"injector",get:function(){return new On(this._hostTNode,this._hostView)}},{key:"parentInjector",get:function(){var e=En(this._hostTNode,this._hostView),t=pn(e,this._hostView),n=function(e,t,n){if(n.parent&&-1!==n.parent.injectorIndex){for(var r=n.parent.injectorIndex,o=n.parent;null!=o.parent&&r==o.parent.injectorIndex;)o=o.parent;return o}for(var i=dn(e),a=t,s=t[6];i>1;)s=(a=a[15])[6],i--;return s}(e,this._hostView,this._hostTNode);return hn(e)&&null!=n?new On(n,t):new On(null,this._hostView)}},{key:"length",get:function(){return this._lContainer.length-9}}]),n}(e));var i=r[n.index];if(wt(i))(function(e,t){e[2]=-2})(o=i);else{var a;if(4===n.type)a=Un(i);else if(a=r[11].createComment(""),Tt(r)){var s=r[11],u=zn(n,r);mo(s,_o(s,u),a,function(e,t){return on(e)?e.nextSibling(t):t.nextSibling}(s,u))}else wo(r[1],r,a,n);r[n.index]=o=Qr(i,r,a,n),$r(r,o)}return new No(o,n,r)}(e,t,xt(),Dt())},Aa={};function Da(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}var Na=new Be("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return mn}}),Pa=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).componentDef=e,r.ngModule=n,r.componentType=e.type,r.selector=e.selectors.map(cr).join(","),r.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],r.isBoundToModule=!!n,r}return _inherits(t,e),_createClass(t,[{key:"create",value:function(e,t,n,r){var o,i,a=(r=r||this.ngModule)?function(e,t){return{get:function(n,r,o){var i=e.get(n,Aa,o);return i!==Aa||r===Aa?i:t.get(n,r,o)}}}(e,r.injector):e,s=a.get(ra,an),u=a.get(sa,null),c=s.createRenderer(null,this.componentDef),l=n?function(e,t,n){if(on(e))return e.selectRootElement(t,n===it.ShadowDom);var r="string"==typeof t?e.querySelector(t):t;return r.textContent="",r}(c,n,this.componentDef.encapsulation):wr(this.componentDef.selectors[0][0]||"div",s.createRenderer(null,this.componentDef),null),h=this.componentDef.onPush?576:528,f="string"==typeof n&&/^#root-ng-internal-isolated-\d+/.test(n),d={components:[],scheduler:mn,clean:no,playerHandler:null,flags:0},p=Pr(0,-1,null,1,0,null,null,null,null,null),y=Cr(null,p,d,h,null,null,s,c,u,a),v=n&&l?ua.full:null;zt(y,null);try{var m=function(e,t,n,r,o,i,a){var s=n[1];n[19]=e;var u=kr(s,null,0,3,null,null),c=u.mergedAttrs=t.hostAttrs;null!==c&&(Zo(u,c),null!==e&&(sn(o,e,c),null!==u.classes&&Io(o,e,u.classes),null!==u.styles&&To(o,e,u.styles)));var l=r.createRenderer(e,t);null!==e&&i&&(on(o)?o.setAttribute(e,"ng-version",i):e.setAttribute("ng-version",i));var h=Cr(n,Nr(t),null,t.onPush?64:16,n[19],u,r,l,null);return s.firstCreatePass&&(Tn(Cn(u,n),s,t.type),qr(s,u),Ur(u,n.length,1)),$r(n,h),n[19]=h}(l,this.componentDef,y,s,c,v);i=Wn(y[1],0),t&&(i.projection=t.map((function(e){return Array.from(e)}))),o=function(e,t,n,r,o){var i=n[1],a=function(e,t,n){var r=xt();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),Br(e,r,1),Gr(e,t,n));var o=Nn(t,e,t.length-1,r);Zn(o,t);var i=zn(r,t);return i&&Zn(i,t),o}(i,n,t);r.components.push(a),e[8]=a,o&&o.forEach((function(e){return e(a,t)})),t.contentQueries&&t.contentQueries(1,a,n.length-1);var s=xt();if(i.firstCreatePass&&(null!==t.hostBindings||null!==t.hostAttrs)){Yt(s.index-19);var u=n[1];Lr(u,t),Fr(u,n,t.hostVars),Vr(t,a)}return a}(m,this.componentDef,y,d,[Ri]),Sr(p,y,null)}finally{Qt()}var g=new xa(this.componentType,o,Oo(ta,i,y),y,i);return n&&!f||(g.hostView._tViewNode.child=i),g}},{key:"inputs",get:function(){return Da(this.componentDef.inputs)}},{key:"outputs",get:function(){return Da(this.componentDef.outputs)}}]),t}(Zi),xa=function(e){function t(e,n,r,o,i){var a,s,u,c;return _classCallCheck(this,t),(a=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).location=r,a._rootLView=o,a._tNode=i,a.destroyCbs=[],a.instance=n,a.hostView=a.changeDetectorRef=new xo(o),a.hostView._tViewNode=(s=o[1],u=o,null==(c=s.node)&&(s.node=c=xr(0,null,2,-1,null,null)),u[6]=c),a.componentType=e,a}return _inherits(t,e),_createClass(t,[{key:"destroy",value:function(){this.destroyCbs&&(this.destroyCbs.forEach((function(e){return e()})),this.destroyCbs=null,!this.hostView.destroyed&&this.hostView.destroy())}},{key:"onDestroy",value:function(e){this.destroyCbs&&this.destroyCbs.push(e)}},{key:"injector",get:function(){return new On(this._tNode,this._rootLView)}}]),t}(function(){return function e(){_classCallCheck(this,e)}}()),Oa=void 0,Ma=["en",[["a","p"],["AM","PM"],Oa],[["AM","PM"],Oa,Oa],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Oa,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Oa,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Oa,"{1} 'at' {0}",Oa],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},function(e){var t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}],Ra={};function La(e){var t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e),n=Fa(t);if(n)return n;var r=t.split("-")[0];if(n=Fa(r))return n;if("en"===r)return Ma;throw new Error('Missing locale data for the locale "'.concat(e,'".'))}function Fa(e){return e in Ra||(Ra[e]=Pe.ng&&Pe.ng.common&&Pe.ng.common.locales&&Pe.ng.common.locales[e]),Ra[e]}var Va=function(){var e={LocaleId:0,DayPeriodsFormat:1,DayPeriodsStandalone:2,DaysFormat:3,DaysStandalone:4,MonthsFormat:5,MonthsStandalone:6,Eras:7,FirstDayOfWeek:8,WeekendRange:9,DateFormat:10,TimeFormat:11,DateTimeFormat:12,NumberSymbols:13,NumberFormats:14,CurrencyCode:15,CurrencySymbol:16,CurrencyName:17,Currencies:18,PluralCase:19,ExtraData:20};return e[e.LocaleId]="LocaleId",e[e.DayPeriodsFormat]="DayPeriodsFormat",e[e.DayPeriodsStandalone]="DayPeriodsStandalone",e[e.DaysFormat]="DaysFormat",e[e.DaysStandalone]="DaysStandalone",e[e.MonthsFormat]="MonthsFormat",e[e.MonthsStandalone]="MonthsStandalone",e[e.Eras]="Eras",e[e.FirstDayOfWeek]="FirstDayOfWeek",e[e.WeekendRange]="WeekendRange",e[e.DateFormat]="DateFormat",e[e.TimeFormat]="TimeFormat",e[e.DateTimeFormat]="DateTimeFormat",e[e.NumberSymbols]="NumberSymbols",e[e.NumberFormats]="NumberFormats",e[e.CurrencyCode]="CurrencyCode",e[e.CurrencySymbol]="CurrencySymbol",e[e.CurrencyName]="CurrencyName",e[e.Currencies]="Currencies",e[e.PluralCase]="PluralCase",e[e.ExtraData]="ExtraData",e}();function Ba(e){var t;null==(t=e)&&function(e,t,n,r){throw new Error("ASSERTION ERROR: ".concat("Expected localeId to be defined")+" [Expected=> null != ".concat(t," <=Actual]"))}(0,t),"string"==typeof e&&e.toLowerCase().replace(/_/g,"-")}var qa=new Map,ja={provide:ea,useClass:function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).ngModule=e,n}return _inherits(t,e),_createClass(t,[{key:"resolveComponentFactory",value:function(e){var t=mt(e);return new Pa(t,this.ngModule)}}]),t}(ea),deps:[Ze]},Ua=function(e){function t(e,n){var r;_classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._parent=n,r._bootstrapComponents=[],r.injector=_assertThisInitialized(r),r.destroyCbs=[];var o=bt(e),i=e[Le]||null;return i&&Ba(i),r._bootstrapComponents=gn(o.bootstrap),r._r3Injector=qo(e,n,[{provide:Ze,useValue:_assertThisInitialized(r)},ja],_e(e)),r.instance=r.get(e),r}return _inherits(t,e),_createClass(t,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ko.THROW_IF_NOT_FOUND,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:se.Default;return e===Ko||e===Ze||e===qe?this:this._r3Injector.get(e,t,n)}},{key:"destroy",value:function(){var e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach((function(e){return e()})),this.destroyCbs=null}},{key:"onDestroy",value:function(e){this.destroyCbs.push(e)}},{key:"componentFactoryResolver",get:function(){return this.get(ea)}}]),t}(Ze),Ga=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).moduleType=e,null!==bt(e)&&function e(t){if(null!==t.\u0275mod.id){var n=t.\u0275mod.id;(function(e,t,n){if(t&&t!==n)throw new Error("Duplicate module registered for ".concat(e," - ").concat(_e(t)," vs ").concat(_e(t.name)))})(n,qa.get(n),t),qa.set(n,t)}var r=t.\u0275mod.imports;r instanceof Function&&(r=r()),r&&r.forEach((function(t){return e(t)}))}(e),n}return _inherits(t,e),_createClass(t,[{key:"create",value:function(e){return new Ua(this.moduleType,e)}}]),t}(function(){return function e(){_classCallCheck(this,e)}}());function za(e,t){var n,r=Nt(),o=e+19;r.firstCreatePass?(n=function(e,t){if(t)for(var n=t.length-1;n>=0;n--){var r=t[n];if(e===r.name)return r}throw new Error("The pipe '".concat(e,"' could not be found!"))}(t,r.pipeRegistry),r.data[o]=n,n.onDestroy&&(r.destroyHooks||(r.destroyHooks=[])).push(o,n.onDestroy)):n=r.data[o];var i=(n.factory||(n.factory=gt(n.type)))();return function(e,t,n,r){var o=n+19;o>=e.data.length&&(e.data[o]=null,e.blueprint[o]=null),t[o]=r}(r,Dt(),e,i),i}function Wa(e,t,n,r){var o=Dt(),i=Hn(o,e);return function(e,t){return ni.isWrapped(t)&&(t=ni.unwrap(t),e[Ft()]=lr),t}(o,function(e,t){return e[1].data[t+19].pure}(o,e)?function(e,t,n,r,o,i,a){var s=t+n;return ai(e,s,o,i)?function(e,t,n){return e[t]=n}(e,s+2,a?r.call(a,o,i):r(o,i)):function(e,t){return e[t]}(e,s+2)}(o,function(){var e=It.lFrame,t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}(),t,i.transform,n,r,i):i.transform(n,r))}var Ha=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).__isAsync=n,e}return _inherits(t,e),_createClass(t,[{key:"emit",value:function(e){_get(_getPrototypeOf(t.prototype),"next",this).call(this,e)}},{key:"subscribe",value:function(e,n,r){var o,i=function(e){return null},a=function(){return null};e&&"object"==typeof e?(o=this.__isAsync?function(t){setTimeout((function(){return e.next(t)}))}:function(t){e.next(t)},e.error&&(i=this.__isAsync?function(t){setTimeout((function(){return e.error(t)}))}:function(t){e.error(t)}),e.complete&&(a=this.__isAsync?function(){setTimeout((function(){return e.complete()}))}:function(){e.complete()})):(o=this.__isAsync?function(t){setTimeout((function(){return e(t)}))}:function(t){e(t)},n&&(i=this.__isAsync?function(e){setTimeout((function(){return n(e)}))}:function(e){n(e)}),r&&(a=this.__isAsync?function(){setTimeout((function(){return r()}))}:function(){r()}));var s=_get(_getPrototypeOf(t.prototype),"subscribe",this).call(this,o,i,a);return e instanceof f&&e.add(s),s}}]),t}(T),Qa=new Be("Application Initializer"),Ka=function(){var e=function(){function e(t){var n=this;_classCallCheck(this,e),this.appInits=t,this.initialized=!1,this.done=!1,this.donePromise=new Promise((function(e,t){n.resolve=e,n.reject=t}))}return _createClass(e,[{key:"runInitializers",value:function(){var e=this;if(!this.initialized){var t=[],n=function(){e.done=!0,e.resolve()};if(this.appInits)for(var r=0;r<this.appInits.length;r++){var o=this.appInits[r]();vi(o)&&t.push(o)}Promise.all(t).then((function(){n()})).catch((function(t){e.reject(t)})),0===t.length&&n(),this.initialized=!0}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ke(Qa,8))},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e}(),Ya=new Be("AppId"),Ja={provide:Ya,useFactory:function(){return"".concat($a()).concat($a()).concat($a())},deps:[]};function $a(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var Za=new Be("Platform Initializer"),Xa=new Be("Platform ID"),es=new Be("appBootstrapListener"),ts=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"log",value:function(e){console.log(e)}},{key:"warn",value:function(e){console.warn(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e}(),ns=new Be("LocaleId"),rs=new Be("DefaultCurrencyCode"),os=function e(t,n){_classCallCheck(this,e),this.ngModuleFactory=t,this.componentFactories=n},is=function(e){return new Ga(e)},as=is,ss=function(e){return Promise.resolve(is(e))},us=function(e){var t=is(e),n=gn(bt(e).declarations).reduce((function(e,t){var n=mt(t);return n&&e.push(new Pa(n)),e}),[]);return new os(t,n)},cs=us,ls=function(e){return Promise.resolve(us(e))},hs=function(){var e=function(){function e(){_classCallCheck(this,e),this.compileModuleSync=as,this.compileModuleAsync=ss,this.compileModuleAndAllComponentsSync=cs,this.compileModuleAndAllComponentsAsync=ls}return _createClass(e,[{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(e){}},{key:"getModuleId",value:function(e){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e}(),fs=new Be("compilerOptions"),ds=Promise.resolve(0);function ps(e){"undefined"==typeof Zone?ds.then((function(){e&&e.apply(null,null)})):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}var ys=function(){function e(t){var n,r,o=t.enableLongStackTrace,i=void 0!==o&&o,a=t.shouldCoalesceEventChangeDetection,s=void 0!==a&&a;if(_classCallCheck(this,e),this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ha(!1),this.onMicrotaskEmpty=new Ha(!1),this.onStable=new Ha(!1),this.onError=new Ha(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),i&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),this.shouldCoalesceEventChangeDetection=s,this.lastRequestAnimationFrameId=-1,this.nativeRequestAnimationFrame=function(){var e=Pe.requestAnimationFrame,t=Pe.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){var n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);var r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,r=!!(n=this).shouldCoalesceEventChangeDetection&&n.nativeRequestAnimationFrame&&function(){!function(e){-1===e.lastRequestAnimationFrameId&&(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Pe,(function(){e.lastRequestAnimationFrameId=-1,bs(e),gs(e)})),bs(e))}(n)},n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0,maybeDelayChangeDetection:r},onInvokeTask:function(e,t,o,i,a,s){try{return _s(n),e.invokeTask(o,i,a,s)}finally{r&&"eventTask"===i.type&&r(),ws(n)}},onInvoke:function(e,t,r,o,i,a,s){try{return _s(n),e.invoke(r,o,i,a,s)}finally{ws(n)}},onHasTask:function(e,t,r,o){e.hasTask(r,o),t===r&&("microTask"==o.change?(n._hasPendingMicrotasks=o.microTask,bs(n),gs(n)):"macroTask"==o.change&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:function(e,t,r,o){return e.handleError(r,o),n.runOutsideAngular((function(){return n.onError.emit(o)})),!1}})}return _createClass(e,[{key:"run",value:function(e,t,n){return this._inner.run(e,t,n)}},{key:"runTask",value:function(e,t,n,r){var o=this._inner,i=o.scheduleEventTask("NgZoneEvent: "+r,e,ms,vs,vs);try{return o.runTask(i,t,n)}finally{o.cancelTask(i)}}},{key:"runGuarded",value:function(e,t,n){return this._inner.runGuarded(e,t,n)}},{key:"runOutsideAngular",value:function(e){return this._outer.run(e)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!e.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(e.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),e}();function vs(){}var ms={};function gs(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular((function(){return e.onStable.emit(null)}))}finally{e.isStable=!0}}}function bs(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||e.shouldCoalesceEventChangeDetection&&-1!==e.lastRequestAnimationFrameId)}function _s(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function ws(e){e._nesting--,gs(e)}var Cs,ks=function(){function e(){_classCallCheck(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ha,this.onMicrotaskEmpty=new Ha,this.onStable=new Ha,this.onError=new Ha}return _createClass(e,[{key:"run",value:function(e,t,n){return e.apply(t,n)}},{key:"runGuarded",value:function(e,t,n){return e.apply(t,n)}},{key:"runOutsideAngular",value:function(e){return e()}},{key:"runTask",value:function(e,t,n,r){return e.apply(t,n)}}]),e}(),Ss=function(){var e=function(){function e(t){var n=this;_classCallCheck(this,e),this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run((function(){n.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")}))}return _createClass(e,[{key:"_watchAngularEvents",value:function(){var e=this;this._ngZone.onUnstable.subscribe({next:function(){e._didWork=!0,e._isZoneStable=!1}}),this._ngZone.runOutsideAngular((function(){e._ngZone.onStable.subscribe({next:function(){ys.assertNotInAngularZone(),ps((function(){e._isZoneStable=!0,e._runCallbacksIfReady()}))}})}))}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var e=this;if(this.isStable())ps((function(){for(;0!==e._callbacks.length;){var t=e._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(e._didWork)}e._didWork=!1}));else{var t=this.getPendingTasks();this._callbacks=this._callbacks.filter((function(e){return!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)})),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map((function(e){return{source:e.source,creationLocation:e.creationLocation,data:e.data}})):[]}},{key:"addCallback",value:function(e,t,n){var r=this,o=-1;t&&t>0&&(o=setTimeout((function(){r._callbacks=r._callbacks.filter((function(e){return e.timeoutId!==o})),e(r._didWork,r.getPendingTasks())}),t)),this._callbacks.push({doneCb:e,timeoutId:o,updateCb:n})}},{key:"whenStable",value:function(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(e,t,n){return[]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ke(ys))},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e}(),Es=function(){var e=function(){function e(){_classCallCheck(this,e),this._applications=new Map,Ts.addToWindow(this)}return _createClass(e,[{key:"registerApplication",value:function(e,t){this._applications.set(e,t)}},{key:"unregisterApplication",value:function(e){this._applications.delete(e)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(e){return this._applications.get(e)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Ts.findTestabilityInTree(this,e,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e}(),Ts=new(function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"addToWindow",value:function(e){}},{key:"findTestabilityInTree",value:function(e,t,n){return null}}]),e}()),Is=function(e,t,n){var r=new Ga(n);if(0===Yo.size)return Promise.resolve(r);var o,i,a=(o=e.get(fs,[]).concat(t).map((function(e){return e.providers})),i=[],o.forEach((function(e){return e&&i.push.apply(i,_toConsumableArray(e))})),i);if(0===a.length)return Promise.resolve(r);var s=function(){var e=Pe.ng;if(!e||!e.\u0275compilerFacade)throw new Error("Angular JIT compilation failed: '@angular/compiler' not loaded!\n  - JIT compilation is discouraged for production use-cases! Consider AOT mode instead.\n  - Did you bootstrap using '@angular/platform-browser-dynamic' or '@angular/platform-server'?\n  - Alternatively provide the compiler with 'import \"@angular/compiler\";' before bootstrapping.");return e.\u0275compilerFacade}(),u=Ko.create({providers:a}).get(s.ResourceLoader);return function(e){var t=[],n=new Map;function r(e){var t=n.get(e);if(!t){var r=function(e){return Promise.resolve(u.get(e))}(e);n.set(e,t=r.then($o))}return t}return Yo.forEach((function(e,n){var o=[];e.templateUrl&&o.push(r(e.templateUrl).then((function(t){e.template=t})));var i=e.styleUrls,a=e.styles||(e.styles=[]),s=e.styles.length;i&&i.forEach((function(t,n){a.push(""),o.push(r(t).then((function(r){a[s+n]=r,i.splice(i.indexOf(t),1),0==i.length&&(e.styleUrls=void 0)})))}));var u=Promise.all(o).then((function(){return function(e){Jo.delete(e)}(n)}));t.push(u)})),Yo=new Map,Promise.all(t).then((function(){}))}().then((function(){return r}))},As=new Be("AllowMultipleToken");function Ds(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r="Platform: ".concat(t),o=new Be(r);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=Ns();if(!i||i.injector.get(As,!1))if(e)e(n.concat(t).concat({provide:o,useValue:!0}));else{var a=n.concat(t).concat({provide:o,useValue:!0},{provide:Mo,useValue:"platform"});!function(e){if(Cs&&!Cs.destroyed&&!Cs.injector.get(As,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Cs=e.get(Ps);var t=e.get(Za,null);t&&t.forEach((function(e){return e()}))}(Ko.create({providers:a,name:r}))}return function(e){var t=Ns();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(o)}}function Ns(){return Cs&&!Cs.destroyed?Cs:null}var Ps=function(){var e=function(){function e(t){_classCallCheck(this,e),this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return _createClass(e,[{key:"bootstrapModuleFactory",value:function(e,t){var n,r,o=this,i=(n=t?t.ngZone:void 0,r=t&&t.ngZoneEventCoalescing||!1,"noop"===n?new ks:("zone.js"===n?void 0:n)||new ys({enableLongStackTrace:jn(),shouldCoalesceEventChangeDetection:r})),a=[{provide:ys,useValue:i}];return i.run((function(){var t=Ko.create({providers:a,parent:o.injector,name:e.moduleType.name}),n=e.create(t),r=n.injector.get(Vn,null);if(!r)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return n.onDestroy((function(){return Rs(o._modules,n)})),i.runOutsideAngular((function(){return i.onError.subscribe({next:function(e){r.handleError(e)}})})),function(e,t,r){try{var i=((a=n.injector.get(Ka)).runInitializers(),a.donePromise.then((function(){return Ba(n.injector.get(ns,"en-US")||"en-US"),o._moduleDoBootstrap(n),n})));return vi(i)?i.catch((function(n){throw t.runOutsideAngular((function(){return e.handleError(n)})),n})):i}catch(s){throw t.runOutsideAngular((function(){return e.handleError(s)})),s}var a}(r,i)}))}},{key:"bootstrapModule",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=xs({},n);return Is(this.injector,r,e).then((function(e){return t.bootstrapModuleFactory(e,r)}))}},{key:"_moduleDoBootstrap",value:function(e){var t=e.injector.get(Ms);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach((function(e){return t.bootstrap(e)}));else{if(!e.instance.ngDoBootstrap)throw new Error("The module ".concat(_e(e.instance.constructor),' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. ')+"Please define one of these.");e.instance.ngDoBootstrap(t)}this._modules.push(e)}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach((function(e){return e.destroy()})),this._destroyListeners.forEach((function(e){return e()})),this._destroyed=!0}},{key:"injector",get:function(){return this._injector}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ke(Ko))},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e}();function xs(e,t){return Array.isArray(t)?t.reduce(xs,e):Object.assign(Object.assign({},e),t)}var Os,Ms=((Os=function(){function e(t,n,r,o,i,a){var s=this;_classCallCheck(this,e),this._zone=t,this._console=n,this._injector=r,this._exceptionHandler=o,this._componentFactoryResolver=i,this._initStatus=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=jn(),this._zone.onMicrotaskEmpty.subscribe({next:function(){s._zone.run((function(){s.tick()}))}});var u=new _((function(e){s._stable=s._zone.isStable&&!s._zone.hasPendingMacrotasks&&!s._zone.hasPendingMicrotasks,s._zone.runOutsideAngular((function(){e.next(s._stable),e.complete()}))})),c=new _((function(e){var t;s._zone.runOutsideAngular((function(){t=s._zone.onStable.subscribe((function(){ys.assertNotInAngularZone(),ps((function(){s._stable||s._zone.hasPendingMacrotasks||s._zone.hasPendingMicrotasks||(s._stable=!0,e.next(!0))}))}))}));var n=s._zone.onUnstable.subscribe((function(){ys.assertInAngularZone(),s._stable&&(s._stable=!1,s._zone.runOutsideAngular((function(){e.next(!1)})))}));return function(){t.unsubscribe(),n.unsubscribe()}}));this.isStable=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Number.POSITIVE_INFINITY,o=null,i=t[t.length-1];return A(i)?(o=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(r=t.pop())):"number"==typeof i&&(r=t.pop()),null===o&&1===t.length&&t[0]instanceof _?t[0]:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;return U(W,e)}(r)(H(t,o))}(u,c.pipe(te()))}return _createClass(e,[{key:"bootstrap",value:function(e,t){var n,r=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");n=e instanceof Zi?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);var o=n.isBoundToModule?void 0:this._injector.get(Ze),i=n.create(Ko.NULL,[],t||n.selector,o);i.onDestroy((function(){r._unloadComponent(i)}));var a=i.injector.get(Ss,null);return a&&i.injector.get(Es).registerApplication(i.location.nativeElement,a),this._loadComponent(i),jn()&&this._console.log("Angular is running in the development mode. Call enableProdMode() to enable the production mode."),i}},{key:"tick",value:function(){var e=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;var t=!0,n=!1,r=void 0;try{for(var o,i=this._views[Symbol.iterator]();!(t=(o=i.next()).done);t=!0)o.value.detectChanges()}catch(h){n=!0,r=h}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}if(this._enforceNoNewChanges){var a=!0,s=!1,u=void 0;try{for(var c,l=this._views[Symbol.iterator]();!(a=(c=l.next()).done);a=!0)c.value.checkNoChanges()}catch(h){s=!0,u=h}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}}}catch(f){this._zone.runOutsideAngular((function(){return e._exceptionHandler.handleError(f)}))}finally{this._runningTick=!1}}},{key:"attachView",value:function(e){var t=e;this._views.push(t),t.attachToAppRef(this)}},{key:"detachView",value:function(e){var t=e;Rs(this._views,t),t.detachFromAppRef()}},{key:"_loadComponent",value:function(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(es,[]).concat(this._bootstrapListeners).forEach((function(t){return t(e)}))}},{key:"_unloadComponent",value:function(e){this.detachView(e.hostView),Rs(this.components,e)}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach((function(e){return e.destroy()}))}},{key:"viewCount",get:function(){return this._views.length}}]),e}()).\u0275fac=function(e){return new(e||Os)(Ke(ys),Ke(ts),Ke(Ko),Ke(Vn),Ke(ea),Ke(Ka))},Os.\u0275prov=le({token:Os,factory:Os.\u0275fac}),Os);function Rs(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var Ls=Ds(null,"core",[{provide:Xa,useValue:"unknown"},{provide:Ps,deps:[Ko]},{provide:Es,deps:[]},{provide:ts,deps:[]}]),Fs=[{provide:Ms,useClass:Ms,deps:[ys,ts,Ko,Vn,ea,Ka]},{provide:Na,deps:[ys],useFactory:function(e){var t=[];return e.onStable.subscribe((function(){for(;t.length;)t.pop()()})),function(e){t.push(e)}}},{provide:Ka,useClass:Ka,deps:[[new oe,Qa]]},{provide:hs,useClass:hs,deps:[]},Ja,{provide:ba,useFactory:function(){return Ca},deps:[]},{provide:_a,useFactory:function(){return ka},deps:[]},{provide:ns,useFactory:function(e){return Ba(e=e||"undefined"!=typeof $localize&&$localize.locale||"en-US"),e},deps:[[new re(ns),new oe,new ae]]},{provide:rs,useValue:"USD"}],Vs=function(){var e=function e(t){_classCallCheck(this,e)};return e.\u0275mod=pt({type:e}),e.\u0275inj=he({factory:function(t){return new(t||e)(Ke(Ms))},providers:Fs}),e}(),Bs={apiKey:"AIzaSyBBLjXy4C9SWDNm2XmczSppIh3xL6ZSt9I",authDomain:"argengis-60763.firebaseapp.com",databaseURL:"https://argengis-60763.firebaseio.com",projectId:"argengis-60763",storageBucket:"argengis-60763.appspot.com",messagingSenderId:"944972773597",appId:"1:944972773597:web:edc500e7cc508693"},qs=null;function js(){return qs}var Us=new Be("DocumentToken"),Gs=function(){var e={Zero:0,One:1,Two:2,Few:3,Many:4,Other:5};return e[e.Zero]="Zero",e[e.One]="One",e[e.Two]="Two",e[e.Few]="Few",e[e.Many]="Many",e[e.Other]="Other",e}(),zs=function(){var e={Format:0,Standalone:1};return e[e.Format]="Format",e[e.Standalone]="Standalone",e}(),Ws=function(){var e={Narrow:0,Abbreviated:1,Wide:2,Short:3};return e[e.Narrow]="Narrow",e[e.Abbreviated]="Abbreviated",e[e.Wide]="Wide",e[e.Short]="Short",e}(),Hs=function(){var e={Short:0,Medium:1,Long:2,Full:3};return e[e.Short]="Short",e[e.Medium]="Medium",e[e.Long]="Long",e[e.Full]="Full",e}(),Qs=function(){var e={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};return e[e.Decimal]="Decimal",e[e.Group]="Group",e[e.List]="List",e[e.PercentSign]="PercentSign",e[e.PlusSign]="PlusSign",e[e.MinusSign]="MinusSign",e[e.Exponential]="Exponential",e[e.SuperscriptingExponent]="SuperscriptingExponent",e[e.PerMille]="PerMille",e[e.Infinity]="Infinity",e[e.NaN]="NaN",e[e.TimeSeparator]="TimeSeparator",e[e.CurrencyDecimal]="CurrencyDecimal",e[e.CurrencyGroup]="CurrencyGroup",e}();function Ks(e,t){return Xs(La(e)[Va.DateFormat],t)}function Ys(e,t){return Xs(La(e)[Va.TimeFormat],t)}function Js(e,t){return Xs(La(e)[Va.DateTimeFormat],t)}function $s(e,t){var n=La(e),r=n[Va.NumberSymbols][t];if(void 0===r){if(t===Qs.CurrencyDecimal)return n[Va.NumberSymbols][Qs.Decimal];if(t===Qs.CurrencyGroup)return n[Va.NumberSymbols][Qs.Group]}return r}function Zs(e){if(!e[Va.ExtraData])throw new Error('Missing extra locale data for the locale "'.concat(e[Va.LocaleId],'". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.'))}function Xs(e,t){for(var n=t;n>-1;n--)if(void 0!==e[n])return e[n];throw new Error("Locale data API: locale data undefined")}function eu(e){var t=_slicedToArray(e.split(":"),2);return{hours:+t[0],minutes:+t[1]}}var tu=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,nu={},ru=/((?:[^GyMLwWdEabBhHmsSzZO']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/,ou=function(){var e={Short:0,ShortGMT:1,Long:2,Extended:3};return e[e.Short]="Short",e[e.ShortGMT]="ShortGMT",e[e.Long]="Long",e[e.Extended]="Extended",e}(),iu=function(){var e={FullYear:0,Month:1,Date:2,Hours:3,Minutes:4,Seconds:5,FractionalSeconds:6,Day:7};return e[e.FullYear]="FullYear",e[e.Month]="Month",e[e.Date]="Date",e[e.Hours]="Hours",e[e.Minutes]="Minutes",e[e.Seconds]="Seconds",e[e.FractionalSeconds]="FractionalSeconds",e[e.Day]="Day",e}(),au=function(){var e={DayPeriods:0,Days:1,Months:2,Eras:3};return e[e.DayPeriods]="DayPeriods",e[e.Days]="Days",e[e.Months]="Months",e[e.Eras]="Eras",e}();function su(e,t){return t&&(e=e.replace(/\{([^}]+)}/g,(function(e,n){return null!=t&&n in t?t[n]:e}))),e}function uu(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-",r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,i="";(e<0||o&&e<=0)&&(o?e=1-e:(e=-e,i=n));for(var a=String(e);a.length<t;)a="0"+a;return r&&(a=a.substr(a.length-t)),i+a}function cu(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return function(i,a){var s,u=function(e,t){switch(e){case iu.FullYear:return t.getFullYear();case iu.Month:return t.getMonth();case iu.Date:return t.getDate();case iu.Hours:return t.getHours();case iu.Minutes:return t.getMinutes();case iu.Seconds:return t.getSeconds();case iu.FractionalSeconds:return t.getMilliseconds();case iu.Day:return t.getDay();default:throw new Error('Unknown DateType value "'.concat(e,'".'))}}(e,i);if((n>0||u>-n)&&(u+=n),e===iu.Hours)0===u&&-12===n&&(u=12);else if(e===iu.FractionalSeconds)return s=t,uu(u,3).substr(0,s);var c=$s(a,Qs.MinusSign);return uu(u,t,c,r,o)}}function lu(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:zs.Format,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(o,i){return function(e,t,n,r,o,i){switch(n){case au.Months:return function(e,t,n){var r=La(e),o=Xs([r[Va.MonthsFormat],r[Va.MonthsStandalone]],t);return Xs(o,n)}(t,o,r)[e.getMonth()];case au.Days:return function(e,t,n){var r=La(e),o=Xs([r[Va.DaysFormat],r[Va.DaysStandalone]],t);return Xs(o,n)}(t,o,r)[e.getDay()];case au.DayPeriods:var a=e.getHours(),s=e.getMinutes();if(i){var u,c=function(e){var t=La(e);return Zs(t),(t[Va.ExtraData][2]||[]).map((function(e){return"string"==typeof e?eu(e):[eu(e[0]),eu(e[1])]}))}(t),l=function(e,t,n){var r=La(e);Zs(r);var o=Xs([r[Va.ExtraData][0],r[Va.ExtraData][1]],t)||[];return Xs(o,n)||[]}(t,o,r);if(c.forEach((function(e,t){if(Array.isArray(e)){var n=e[0],r=n.hours,o=n.minutes,i=e[1],c=i.hours,h=i.minutes;a>=r&&s>=o&&(a<c||a===c&&s<h)&&(u=l[t])}else{var f=e.hours,d=e.minutes;f===a&&d===s&&(u=l[t])}})),u)return u}return function(e,t,n){var r=La(e),o=Xs([r[Va.DayPeriodsFormat],r[Va.DayPeriodsStandalone]],t);return Xs(o,n)}(t,o,r)[a<12?0:1];case au.Eras:return function(e,t){return Xs(La(e)[Va.Eras],t)}(t,r)[e.getFullYear()<=0?0:1];default:throw new Error("unexpected translation type ".concat(n))}}(o,i,e,t,n,r)}}function hu(e){return function(t,n,r){var o=-1*r,i=$s(n,Qs.MinusSign),a=o>0?Math.floor(o/60):Math.ceil(o/60);switch(e){case ou.Short:return(o>=0?"+":"")+uu(a,2,i)+uu(Math.abs(o%60),2,i);case ou.ShortGMT:return"GMT"+(o>=0?"+":"")+uu(a,1,i);case ou.Long:return"GMT"+(o>=0?"+":"")+uu(a,2,i)+":"+uu(Math.abs(o%60),2,i);case ou.Extended:return 0===r?"Z":(o>=0?"+":"")+uu(a,2,i)+":"+uu(Math.abs(o%60),2,i);default:throw new Error('Unknown zone width "'.concat(e,'"'))}}}function fu(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){var o,i,a,s;if(t){var u=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,c=n.getDate();o=1+Math.floor((c+u)/7)}else{var l=(i=n.getFullYear(),a=new Date(i,0,1).getDay(),new Date(i,0,1+(a<=4?4:11)-a)),h=(s=n,new Date(s.getFullYear(),s.getMonth(),s.getDate()+(4-s.getDay()))).getTime()-l.getTime();o=1+Math.round(h/6048e5)}return uu(o,e,$s(r,Qs.MinusSign))}}var du={};function pu(e,t){e=e.replace(/:/g,"");var n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function yu(e){return e instanceof Date&&!isNaN(e.valueOf())}var vu,mu=function e(){_classCallCheck(this,e)},gu=((vu=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).locale=e,n}return _inherits(t,e),_createClass(t,[{key:"getPluralCategory",value:function(e,t){switch(function(e){return La(e)[Va.PluralCase]}(t||this.locale)(e)){case Gs.Zero:return"zero";case Gs.One:return"one";case Gs.Two:return"two";case Gs.Few:return"few";case Gs.Many:return"many";default:return"other"}}}]),t}(mu)).\u0275fac=function(e){return new(e||vu)(Ke(ns))},vu.\u0275prov=le({token:vu,factory:vu.\u0275fac}),vu);function bu(e,t){t=encodeURIComponent(t);var n=!0,r=!1,o=void 0;try{for(var i,a=e.split(";")[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value,u=s.indexOf("="),c=_slicedToArray(-1==u?[s,""]:[s.slice(0,u),s.slice(u+1)],2),l=c[0],h=c[1];if(l.trim()===t)return decodeURIComponent(h)}}catch(f){r=!0,o=f}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return null}var _u,wu,Cu,ku,Su=function(){function e(t,n,r,o){_classCallCheck(this,e),this.$implicit=t,this.ngForOf=n,this.index=r,this.count=o}return _createClass(e,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),e}(),Eu=((_u=function(){function e(t,n,r){_classCallCheck(this,e),this._viewContainer=t,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}return _createClass(e,[{key:"ngDoCheck",value:function(){if(this._ngForOfDirty){this._ngForOfDirty=!1;var e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(r){throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat((t=e).name||typeof t,"'. NgFor only supports binding to Iterables such as Arrays."))}}var t;if(this._differ){var n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}},{key:"_applyChanges",value:function(e){var t=this,n=[];e.forEachOperation((function(e,r,o){if(null==e.previousIndex){var i=t._viewContainer.createEmbeddedView(t._template,new Su(null,t._ngForOf,-1,-1),null===o?void 0:o),a=new Tu(e,i);n.push(a)}else if(null==o)t._viewContainer.remove(null===r?void 0:r);else if(null!==r){var s=t._viewContainer.get(r);t._viewContainer.move(s,o);var u=new Tu(e,s);n.push(u)}}));for(var r=0;r<n.length;r++)this._perViewChange(n[r].view,n[r].record);for(var o=0,i=this._viewContainer.length;o<i;o++){var a=this._viewContainer.get(o);a.context.index=o,a.context.count=i,a.context.ngForOf=this._ngForOf}e.forEachIdentityChange((function(e){t._viewContainer.get(e.currentIndex).context.$implicit=e.item}))}},{key:"_perViewChange",value:function(e,t){e.context.$implicit=t.item}},{key:"ngForOf",set:function(e){this._ngForOf=e,this._ngForOfDirty=!0}},{key:"ngForTrackBy",set:function(e){jn()&&null!=e&&"function"!=typeof e&&console&&console.warn&&console.warn("trackBy must be a function, but received ".concat(JSON.stringify(e),". ")+"See https://angular.io/docs/ts/latest/api/common/index/NgFor-directive.html#!#change-propagation for more information."),this._trackByFn=e},get:function(){return this._trackByFn}},{key:"ngForTemplate",set:function(e){e&&(this._template=e)}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}()).\u0275fac=function(e){return new(e||_u)(ci(Ta),ci(Sa),ci(ba))},_u.\u0275dir=vt({type:_u,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),_u),Tu=function e(t,n){_classCallCheck(this,e),this.record=t,this.view=n},Iu=((ku=function(){function e(t){_classCallCheck(this,e),this.locale=t}return _createClass(e,[{key:"transform",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"mediumDate",r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;if(null==t||""===t||t!=t)return null;try{return function(e,t,n,r){var o=function(e){if(yu(e))return e;if("number"==typeof e&&!isNaN(e))return new Date(e);if("string"==typeof e){e=e.trim();var t,n=parseFloat(e);if(!isNaN(e-n))return new Date(n);if(/^(\d{4}-\d{1,2}-\d{1,2})$/.test(e)){var r=_slicedToArray(e.split("-").map((function(e){return+e})),3),o=r[0],i=r[1],a=r[2];return new Date(o,i-1,a)}if(t=e.match(tu))return function(e){var t=new Date(0),n=0,r=0,o=e[8]?t.setUTCFullYear:t.setFullYear,i=e[8]?t.setUTCHours:t.setHours;e[9]&&(n=Number(e[9]+e[10]),r=Number(e[9]+e[11])),o.call(t,Number(e[1]),Number(e[2])-1,Number(e[3]));var a=Number(e[4]||0)-n,s=Number(e[5]||0)-r,u=Number(e[6]||0),c=Math.round(1e3*parseFloat("0."+(e[7]||0)));return i.call(t,a,s,u,c),t}(t)}var s=new Date(e);if(!yu(s))throw new Error('Unable to convert "'.concat(e,'" into a date'));return s}(e);t=function e(t,n){var r=function(e){return La(e)[Va.LocaleId]}(t);if(nu[r]=nu[r]||{},nu[r][n])return nu[r][n];var o="";switch(n){case"shortDate":o=Ks(t,Hs.Short);break;case"mediumDate":o=Ks(t,Hs.Medium);break;case"longDate":o=Ks(t,Hs.Long);break;case"fullDate":o=Ks(t,Hs.Full);break;case"shortTime":o=Ys(t,Hs.Short);break;case"mediumTime":o=Ys(t,Hs.Medium);break;case"longTime":o=Ys(t,Hs.Long);break;case"fullTime":o=Ys(t,Hs.Full);break;case"short":var i=e(t,"shortTime"),a=e(t,"shortDate");o=su(Js(t,Hs.Short),[i,a]);break;case"medium":var s=e(t,"mediumTime"),u=e(t,"mediumDate");o=su(Js(t,Hs.Medium),[s,u]);break;case"long":var c=e(t,"longTime"),l=e(t,"longDate");o=su(Js(t,Hs.Long),[c,l]);break;case"full":var h=e(t,"fullTime"),f=e(t,"fullDate");o=su(Js(t,Hs.Full),[h,f])}return o&&(nu[r][n]=o),o}(n,t)||t;for(var i,a=[];t;){if(!(i=ru.exec(t))){a.push(t);break}var s=(a=a.concat(i.slice(1))).pop();if(!s)break;t=s}var u=o.getTimezoneOffset();r&&(u=pu(r,u),o=function(e,t,n){var r=e.getTimezoneOffset();return function(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}(e,-1*(pu(t,r)-r))}(o,r));var c="";return a.forEach((function(e){var t=function(e){if(du[e])return du[e];var t;switch(e){case"G":case"GG":case"GGG":t=lu(au.Eras,Ws.Abbreviated);break;case"GGGG":t=lu(au.Eras,Ws.Wide);break;case"GGGGG":t=lu(au.Eras,Ws.Narrow);break;case"y":t=cu(iu.FullYear,1,0,!1,!0);break;case"yy":t=cu(iu.FullYear,2,0,!0,!0);break;case"yyy":t=cu(iu.FullYear,3,0,!1,!0);break;case"yyyy":t=cu(iu.FullYear,4,0,!1,!0);break;case"M":case"L":t=cu(iu.Month,1,1);break;case"MM":case"LL":t=cu(iu.Month,2,1);break;case"MMM":t=lu(au.Months,Ws.Abbreviated);break;case"MMMM":t=lu(au.Months,Ws.Wide);break;case"MMMMM":t=lu(au.Months,Ws.Narrow);break;case"LLL":t=lu(au.Months,Ws.Abbreviated,zs.Standalone);break;case"LLLL":t=lu(au.Months,Ws.Wide,zs.Standalone);break;case"LLLLL":t=lu(au.Months,Ws.Narrow,zs.Standalone);break;case"w":t=fu(1);break;case"ww":t=fu(2);break;case"W":t=fu(1,!0);break;case"d":t=cu(iu.Date,1);break;case"dd":t=cu(iu.Date,2);break;case"E":case"EE":case"EEE":t=lu(au.Days,Ws.Abbreviated);break;case"EEEE":t=lu(au.Days,Ws.Wide);break;case"EEEEE":t=lu(au.Days,Ws.Narrow);break;case"EEEEEE":t=lu(au.Days,Ws.Short);break;case"a":case"aa":case"aaa":t=lu(au.DayPeriods,Ws.Abbreviated);break;case"aaaa":t=lu(au.DayPeriods,Ws.Wide);break;case"aaaaa":t=lu(au.DayPeriods,Ws.Narrow);break;case"b":case"bb":case"bbb":t=lu(au.DayPeriods,Ws.Abbreviated,zs.Standalone,!0);break;case"bbbb":t=lu(au.DayPeriods,Ws.Wide,zs.Standalone,!0);break;case"bbbbb":t=lu(au.DayPeriods,Ws.Narrow,zs.Standalone,!0);break;case"B":case"BB":case"BBB":t=lu(au.DayPeriods,Ws.Abbreviated,zs.Format,!0);break;case"BBBB":t=lu(au.DayPeriods,Ws.Wide,zs.Format,!0);break;case"BBBBB":t=lu(au.DayPeriods,Ws.Narrow,zs.Format,!0);break;case"h":t=cu(iu.Hours,1,-12);break;case"hh":t=cu(iu.Hours,2,-12);break;case"H":t=cu(iu.Hours,1);break;case"HH":t=cu(iu.Hours,2);break;case"m":t=cu(iu.Minutes,1);break;case"mm":t=cu(iu.Minutes,2);break;case"s":t=cu(iu.Seconds,1);break;case"ss":t=cu(iu.Seconds,2);break;case"S":t=cu(iu.FractionalSeconds,1);break;case"SS":t=cu(iu.FractionalSeconds,2);break;case"SSS":t=cu(iu.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=hu(ou.Short);break;case"ZZZZZ":t=hu(ou.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=hu(ou.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=hu(ou.Long);break;default:return null}return du[e]=t,t}(e);c+=t?t(o,n,u):"''"===e?"'":e.replace(/(^'|'$)/g,"").replace(/''/g,"'")})),c}(t,n,o||this.locale,r)}catch(i){throw function(e,t){return Error("InvalidPipeArgument: '".concat(t,"' for pipe '").concat(_e(e),"'"))}(e,i.message)}}}]),e}()).\u0275fac=function(e){return new(e||ku)(ci(ns))},ku.\u0275pipe={type:(Cu={name:"date",type:ku,pure:!0}).type,name:Cu.name,factory:null,pure:!1!==Cu.pure,onDestroy:Cu.type.prototype.ngOnDestroy||null},ku),Au=((wu=function e(){_classCallCheck(this,e)}).\u0275mod=pt({type:wu}),wu.\u0275inj=he({factory:function(e){return new(e||wu)},providers:[{provide:mu,useClass:gu}]}),wu);function Du(e){return"server"===e}var Nu,Pu,xu,Ou,Mu=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"getProperty",value:function(e,t){return e[t]}},{key:"log",value:function(e){window.console&&window.console.log&&window.console.log(e)}},{key:"logGroup",value:function(e){window.console&&window.console.group&&window.console.group(e)}},{key:"logGroupEnd",value:function(){window.console&&window.console.groupEnd&&window.console.groupEnd()}},{key:"onAndCancel",value:function(e,t,n){return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n,!1)}}},{key:"dispatchEvent",value:function(e,t){e.dispatchEvent(t)}},{key:"remove",value:function(e){return e.parentNode&&e.parentNode.removeChild(e),e}},{key:"getValue",value:function(e){return e.value}},{key:"createElement",value:function(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"isElementNode",value:function(e){return e.nodeType===Node.ELEMENT_NODE}},{key:"isShadowRoot",value:function(e){return e instanceof DocumentFragment}},{key:"getGlobalEventTarget",value:function(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}},{key:"getHistory",value:function(){return window.history}},{key:"getLocation",value:function(){return window.location}},{key:"getBaseHref",value:function(e){var t,n=Ru||(Ru=document.querySelector("base"))?Ru.getAttribute("href"):null;return null==n?null:(t=n,Nu||(Nu=document.createElement("a")),Nu.setAttribute("href",t),"/"===Nu.pathname.charAt(0)?Nu.pathname:"/"+Nu.pathname)}},{key:"resetBaseElement",value:function(){Ru=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"performanceNow",value:function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}},{key:"supportsCookies",value:function(){return!0}},{key:"getCookie",value:function(e){return bu(document.cookie,e)}}],[{key:"makeCurrent",value:function(){var e;e=new t,qs||(qs=e)}}]),t}(function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))}return _inherits(t,e),_createClass(t,[{key:"supportsDOMEvents",value:function(){return!0}}]),t}(function(){return function e(){_classCallCheck(this,e)}}())),Ru=null,Lu=new Be("TRANSITION_ID"),Fu=[{provide:Qa,useFactory:function(e,t,n){return function(){n.get(Ka).donePromise.then((function(){var n=js();Array.prototype.slice.apply(t.querySelectorAll("style[ng-transition]")).filter((function(t){return t.getAttribute("ng-transition")===e})).forEach((function(e){return n.remove(e)}))}))}},deps:[Lu,Us,Ko],multi:!0}],Vu=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"addToWindow",value:function(e){Pe.getAngularTestability=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.findTestabilityInTree(t,n);if(null==r)throw new Error("Could not find testability for element.");return r},Pe.getAllAngularTestabilities=function(){return e.getAllTestabilities()},Pe.getAllAngularRootElements=function(){return e.getAllRootElements()},Pe.frameworkStabilizers||(Pe.frameworkStabilizers=[]),Pe.frameworkStabilizers.push((function(e){var t=Pe.getAllAngularTestabilities(),n=t.length,r=!1,o=function(t){r=r||t,0==--n&&e(r)};t.forEach((function(e){e.whenStable(o)}))}))}},{key:"findTestabilityInTree",value:function(e,t,n){if(null==t)return null;var r=e.getTestability(t);return null!=r?r:n?js().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}],[{key:"init",value:function(){var t;t=new e,Ts=t}}]),e}(),Bu=new Be("EventManagerPlugins"),qu=((Pu=function(){function e(t,n){var r=this;_classCallCheck(this,e),this._zone=n,this._eventNameToPlugin=new Map,t.forEach((function(e){return e.manager=r})),this._plugins=t.slice().reverse()}return _createClass(e,[{key:"addEventListener",value:function(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}},{key:"addGlobalEventListener",value:function(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(e){var t=this._eventNameToPlugin.get(e);if(t)return t;for(var n=this._plugins,r=0;r<n.length;r++){var o=n[r];if(o.supports(e))return this._eventNameToPlugin.set(e,o),o}throw new Error("No event manager plugin found for event ".concat(e))}}]),e}()).\u0275fac=function(e){return new(e||Pu)(Ke(Bu),Ke(ys))},Pu.\u0275prov=le({token:Pu,factory:Pu.\u0275fac}),Pu),ju=function(){function e(t){_classCallCheck(this,e),this._doc=t}return _createClass(e,[{key:"addGlobalEventListener",value:function(e,t,n){var r=js().getGlobalEventTarget(this._doc,e);if(!r)throw new Error("Unsupported event target ".concat(r," for event ").concat(t));return this.addEventListener(r,t,n)}}]),e}(),Uu=((Ou=function(){function e(){_classCallCheck(this,e),this._stylesSet=new Set}return _createClass(e,[{key:"addStyles",value:function(e){var t=this,n=new Set;e.forEach((function(e){t._stylesSet.has(e)||(t._stylesSet.add(e),n.add(e))})),this.onStylesAdded(n)}},{key:"onStylesAdded",value:function(e){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),e}()).\u0275fac=function(e){return new(e||Ou)},Ou.\u0275prov=le({token:Ou,factory:Ou.\u0275fac}),Ou),Gu=((xu=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._doc=e,n._hostNodes=new Set,n._styleNodes=new Set,n._hostNodes.add(e.head),n}return _inherits(t,e),_createClass(t,[{key:"_addStylesToHost",value:function(e,t){var n=this;e.forEach((function(e){var r=n._doc.createElement("style");r.textContent=e,n._styleNodes.add(t.appendChild(r))}))}},{key:"addHost",value:function(e){this._addStylesToHost(this._stylesSet,e),this._hostNodes.add(e)}},{key:"removeHost",value:function(e){this._hostNodes.delete(e)}},{key:"onStylesAdded",value:function(e){var t=this;this._hostNodes.forEach((function(n){return t._addStylesToHost(e,n)}))}},{key:"ngOnDestroy",value:function(){this._styleNodes.forEach((function(e){return js().remove(e)}))}}]),t}(Uu)).\u0275fac=function(e){return new(e||xu)(Ke(Us))},xu.\u0275prov=le({token:xu,factory:xu.\u0275fac}),xu),zu={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Wu=/%COMP%/g;function Hu(e,t,n){for(var r=0;r<t.length;r++){var o=t[r];Array.isArray(o)?Hu(e,o,n):(o=o.replace(Wu,e),n.push(o))}return n}function Qu(e){return function(t){if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}var Ku,Yu,Ju,$u,Zu=((Ku=function(){function e(t,n,r){_classCallCheck(this,e),this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new Xu(t)}return _createClass(e,[{key:"createRenderer",value:function(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case it.Emulated:var n=this.rendererByCompId.get(t.id);return n||(n=new ec(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n;case it.Native:case it.ShadowDom:return new tc(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){var r=Hu(t.id,t.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Ku)(Ke(qu),Ke(Gu),Ke(Ya))},Ku.\u0275prov=le({token:Ku,factory:Ku.\u0275fac}),Ku),Xu=function(){function e(t){_classCallCheck(this,e),this.eventManager=t,this.data=Object.create(null)}return _createClass(e,[{key:"destroy",value:function(){}},{key:"createElement",value:function(e,t){return t?document.createElementNS(zu[t]||t,e):document.createElement(e)}},{key:"createComment",value:function(e){return document.createComment(e)}},{key:"createText",value:function(e){return document.createTextNode(e)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"insertBefore",value:function(e,t,n){e&&e.insertBefore(t,n)}},{key:"removeChild",value:function(e,t){e&&e.removeChild(t)}},{key:"selectRootElement",value:function(e,t){var n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error('The selector "'.concat(e,'" did not match any elements'));return t||(n.textContent=""),n}},{key:"parentNode",value:function(e){return e.parentNode}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"setAttribute",value:function(e,t,n,r){if(r){t=r+":"+t;var o=zu[r];o?e.setAttributeNS(o,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}},{key:"removeAttribute",value:function(e,t,n){if(n){var r=zu[n];r?e.removeAttributeNS(r,t):e.removeAttribute("".concat(n,":").concat(t))}else e.removeAttribute(t)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"setStyle",value:function(e,t,n,r){r&oa.DashCase?e.style.setProperty(t,n,r&oa.Important?"important":""):e.style[t]=n}},{key:"removeStyle",value:function(e,t,n){n&oa.DashCase?e.style.removeProperty(t):e.style[t]=""}},{key:"setProperty",value:function(e,t,n){e[t]=n}},{key:"setValue",value:function(e,t){e.nodeValue=t}},{key:"listen",value:function(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,Qu(n)):this.eventManager.addEventListener(e,t,Qu(n))}}]),e}(),ec=function(e){function t(e,n,r,o){var i;_classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).component=r;var a,s=Hu(o+"-"+r.id,r.styles,[]);return n.addStyles(s),i.contentAttr="_ngcontent-%COMP%".replace(Wu,o+"-"+r.id),i.hostAttr=(a=o+"-"+r.id,"_nghost-%COMP%".replace(Wu,a)),i}return _inherits(t,e),_createClass(t,[{key:"applyToHost",value:function(e){_get(_getPrototypeOf(t.prototype),"setAttribute",this).call(this,e,this.hostAttr,"")}},{key:"createElement",value:function(e,n){var r=_get(_getPrototypeOf(t.prototype),"createElement",this).call(this,e,n);return _get(_getPrototypeOf(t.prototype),"setAttribute",this).call(this,r,this.contentAttr,""),r}}]),t}(Xu),tc=function(e){function t(e,n,r,o){var i;_classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).sharedStylesHost=n,i.hostEl=r,i.component=o,i.shadowRoot=o.encapsulation===it.ShadowDom?r.attachShadow({mode:"open"}):r.createShadowRoot(),i.sharedStylesHost.addHost(i.shadowRoot);for(var a=Hu(o.id,o.styles,[]),s=0;s<a.length;s++){var u=document.createElement("style");u.textContent=a[s],i.shadowRoot.appendChild(u)}return i}return _inherits(t,e),_createClass(t,[{key:"nodeOrShadowRoot",value:function(e){return e===this.hostEl?this.shadowRoot:e}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(e,n){return _get(_getPrototypeOf(t.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(e),n)}},{key:"insertBefore",value:function(e,n,r){return _get(_getPrototypeOf(t.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(e),n,r)}},{key:"removeChild",value:function(e,n){return _get(_getPrototypeOf(t.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(e),n)}},{key:"parentNode",value:function(e){return this.nodeOrShadowRoot(_get(_getPrototypeOf(t.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(e)))}}]),t}(Xu),nc=((Yu=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))}return _inherits(t,e),_createClass(t,[{key:"supports",value:function(e){return!0}},{key:"addEventListener",value:function(e,t,n){var r=this;return e.addEventListener(t,n,!1),function(){return r.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){return e.removeEventListener(t,n)}}]),t}(ju)).\u0275fac=function(e){return new(e||Yu)(Ke(Us))},Yu.\u0275prov=le({token:Yu,factory:Yu.\u0275fac}),Yu),rc=["alt","control","meta","shift"],oc={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},ic={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},ac={alt:function(e){return e.altKey},control:function(e){return e.ctrlKey},meta:function(e){return e.metaKey},shift:function(e){return e.shiftKey}},sc=((Ju=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))}return _inherits(t,e),_createClass(t,[{key:"supports",value:function(e){return null!=t.parseEventName(e)}},{key:"addEventListener",value:function(e,n,r){var o=t.parseEventName(n),i=t.eventCallback(o.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular((function(){return js().onAndCancel(e,o.domEventName,i)}))}}],[{key:"parseEventName",value:function(e){var n=e.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;var o=t._normalizeKey(n.pop()),i="";if(rc.forEach((function(e){var t=n.indexOf(e);t>-1&&(n.splice(t,1),i+=e+".")})),i+=o,0!=n.length||0===o.length)return null;var a={};return a.domEventName=r,a.fullKey=i,a}},{key:"getEventFullKey",value:function(e){var t="",n=function(e){var t=e.key;if(null==t){if(null==(t=e.keyIdentifier))return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&ic.hasOwnProperty(t)&&(t=ic[t]))}return oc[t]||t}(e);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),rc.forEach((function(r){r!=n&&(0,ac[r])(e)&&(t+=r+".")})),t+=n}},{key:"eventCallback",value:function(e,n,r){return function(o){t.getEventFullKey(o)===e&&r.runGuarded((function(){return n(o)}))}}},{key:"_normalizeKey",value:function(e){switch(e){case"esc":return"escape";default:return e}}}]),t}(ju)).\u0275fac=function(e){return new(e||Ju)(Ke(Us))},Ju.\u0275prov=le({token:Ju,factory:Ju.\u0275fac}),Ju),uc=Ds(Ls,"browser",[{provide:Xa,useValue:"browser"},{provide:Za,useValue:function(){Mu.makeCurrent(),Vu.init()},multi:!0},{provide:Us,useFactory:function(){return function(e){rn=e}(document),document},deps:[]}]),cc=[[],{provide:Mo,useValue:"root"},{provide:Vn,useFactory:function(){return new Vn},deps:[]},{provide:Bu,useClass:nc,multi:!0,deps:[Us,ys,Xa]},{provide:Bu,useClass:sc,multi:!0,deps:[Us]},[],{provide:Zu,useClass:Zu,deps:[qu,Gu,Ya]},{provide:ra,useExisting:Zu},{provide:Uu,useExisting:Gu},{provide:Gu,useClass:Gu,deps:[Us]},{provide:Ss,useClass:Ss,deps:[ys]},{provide:qu,useClass:qu,deps:[Bu,ys]},[]],lc=(($u=function(){function e(t){if(_classCallCheck(this,e),t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return _createClass(e,null,[{key:"withServerTransition",value:function(t){return{ngModule:e,providers:[{provide:Ya,useValue:t.appId},{provide:Lu,useExisting:Ya},Fu]}}}]),e}()).\u0275mod=pt({type:$u}),$u.\u0275inj=he({factory:function(e){return new(e||$u)(Ke($u,12))},providers:cc,imports:[Au,Vs]}),$u);function hc(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[t.length-1];return A(r)?(t.pop(),q(t,r)):H(t)}function fc(e,t){return function(n){return n.lift(new dc(e,t))}}"undefined"!=typeof window&&window;var dc=function(){function e(t,n){_classCallCheck(this,e),this.predicate=t,this.thisArg=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new pc(e,this.predicate,this.thisArg))}}]),e}(),pc=function(e){function t(e,n,r){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).predicate=n,o.thisArg=r,o.count=0,o}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}t&&this.destination.next(e)}}]),t}(y),yc=function e(){_classCallCheck(this,e)},vc=function e(){_classCallCheck(this,e)},mc=function(){function e(t){var n=this;_classCallCheck(this,e),this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?function(){n.headers=new Map,t.split("\n").forEach((function(e){var t=e.indexOf(":");if(t>0){var r=e.slice(0,t),o=r.toLowerCase(),i=e.slice(t+1).trim();n.maybeSetNormalizedName(r,o),n.headers.has(o)?n.headers.get(o).push(i):n.headers.set(o,[i])}}))}:function(){n.headers=new Map,Object.keys(t).forEach((function(e){var r=t[e],o=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(n.headers.set(o,r),n.maybeSetNormalizedName(e,o))}))}:this.headers=new Map}return _createClass(e,[{key:"has",value:function(e){return this.init(),this.headers.has(e.toLowerCase())}},{key:"get",value:function(e){this.init();var t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}},{key:"keys",value:function(){return this.init(),Array.from(this.normalizedNames.values())}},{key:"getAll",value:function(e){return this.init(),this.headers.get(e.toLowerCase())||null}},{key:"append",value:function(e,t){return this.clone({name:e,value:t,op:"a"})}},{key:"set",value:function(e,t){return this.clone({name:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({name:e,value:t,op:"d"})}},{key:"maybeSetNormalizedName",value:function(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}},{key:"init",value:function(){var t=this;this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach((function(e){return t.applyUpdate(e)})),this.lazyUpdate=null))}},{key:"copyFrom",value:function(e){var t=this;e.init(),Array.from(e.headers.keys()).forEach((function(n){t.headers.set(n,e.headers.get(n)),t.normalizedNames.set(n,e.normalizedNames.get(n))}))}},{key:"clone",value:function(t){var n=new e;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n}},{key:"applyUpdate",value:function(e){var t=e.name.toLowerCase();switch(e.op){case"a":case"s":var n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);var r=("a"===e.op?this.headers.get(t):void 0)||[];r.push.apply(r,_toConsumableArray(n)),this.headers.set(t,r);break;case"d":var o=e.value;if(o){var i=this.headers.get(t);if(!i)return;0===(i=i.filter((function(e){return-1===o.indexOf(e)}))).length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,i)}else this.headers.delete(t),this.normalizedNames.delete(t)}}},{key:"forEach",value:function(e){var t=this;this.init(),Array.from(this.normalizedNames.keys()).forEach((function(n){return e(t.normalizedNames.get(n),t.headers.get(n))}))}}]),e}(),gc=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"encodeKey",value:function(e){return bc(e)}},{key:"encodeValue",value:function(e){return bc(e)}},{key:"decodeKey",value:function(e){return decodeURIComponent(e)}},{key:"decodeValue",value:function(e){return decodeURIComponent(e)}}]),e}();function bc(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}var _c=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(_classCallCheck(this,e),this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new gc,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,t){var n=new Map;return e.length>0&&e.split("&").forEach((function(e){var r=e.indexOf("="),o=_slicedToArray(-1==r?[t.decodeKey(e),""]:[t.decodeKey(e.slice(0,r)),t.decodeValue(e.slice(r+1))],2),i=o[0],a=o[1],s=n.get(i)||[];s.push(a),n.set(i,s)})),n}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach((function(e){var r=n.fromObject[e];t.map.set(e,Array.isArray(r)?r:[r])}))):this.map=null}return _createClass(e,[{key:"has",value:function(e){return this.init(),this.map.has(e)}},{key:"get",value:function(e){this.init();var t=this.map.get(e);return t?t[0]:null}},{key:"getAll",value:function(e){return this.init(),this.map.get(e)||null}},{key:"keys",value:function(){return this.init(),Array.from(this.map.keys())}},{key:"append",value:function(e,t){return this.clone({param:e,value:t,op:"a"})}},{key:"set",value:function(e,t){return this.clone({param:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({param:e,value:t,op:"d"})}},{key:"toString",value:function(){var e=this;return this.init(),this.keys().map((function(t){var n=e.encoder.encodeKey(t);return e.map.get(t).map((function(t){return n+"="+e.encoder.encodeValue(t)})).join("&")})).filter((function(e){return""!==e})).join("&")}},{key:"clone",value:function(t){var n=new e({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat([t]),n}},{key:"init",value:function(){var e=this;null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach((function(t){return e.map.set(t,e.cloneFrom.map.get(t))})),this.updates.forEach((function(t){switch(t.op){case"a":case"s":var n=("a"===t.op?e.map.get(t.param):void 0)||[];n.push(t.value),e.map.set(t.param,n);break;case"d":if(void 0===t.value){e.map.delete(t.param);break}var r=e.map.get(t.param)||[],o=r.indexOf(t.value);-1!==o&&r.splice(o,1),r.length>0?e.map.set(t.param,r):e.map.delete(t.param)}})),this.cloneFrom=this.updates=null)}}]),e}();function wc(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function Cc(e){return"undefined"!=typeof Blob&&e instanceof Blob}function kc(e){return"undefined"!=typeof FormData&&e instanceof FormData}var Sc=function(){function e(t,n,r,o){var i;if(_classCallCheck(this,e),this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||o?(this.body=void 0!==r?r:null,i=o):i=r,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.params&&(this.params=i.params)),this.headers||(this.headers=new mc),this.params){var a=this.params.toString();if(0===a.length)this.urlWithParams=n;else{var s=n.indexOf("?");this.urlWithParams=n+(-1===s?"?":s<n.length-1?"&":"")+a}}else this.params=new _c,this.urlWithParams=n}return _createClass(e,[{key:"serializeBody",value:function(){return null===this.body?null:wc(this.body)||Cc(this.body)||kc(this.body)||"string"==typeof this.body?this.body:this.body instanceof _c?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}},{key:"detectContentTypeHeader",value:function(){return null===this.body?null:kc(this.body)?null:Cc(this.body)?this.body.type||null:wc(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof _c?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null}},{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.method||this.method,r=t.url||this.url,o=t.responseType||this.responseType,i=void 0!==t.body?t.body:this.body,a=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,s=void 0!==t.reportProgress?t.reportProgress:this.reportProgress,u=t.headers||this.headers,c=t.params||this.params;return void 0!==t.setHeaders&&(u=Object.keys(t.setHeaders).reduce((function(e,n){return e.set(n,t.setHeaders[n])}),u)),t.setParams&&(c=Object.keys(t.setParams).reduce((function(e,n){return e.set(n,t.setParams[n])}),c)),new e(n,r,i,{params:c,headers:u,reportProgress:s,responseType:o,withCredentials:a})}}]),e}(),Ec=function(){var e={Sent:0,UploadProgress:1,ResponseHeader:2,DownloadProgress:3,Response:4,User:5};return e[e.Sent]="Sent",e[e.UploadProgress]="UploadProgress",e[e.ResponseHeader]="ResponseHeader",e[e.DownloadProgress]="DownloadProgress",e[e.Response]="Response",e[e.User]="User",e}(),Tc=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OK";_classCallCheck(this,e),this.headers=t.headers||new mc,this.status=void 0!==t.status?t.status:n,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300},Ic=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,n))).type=Ec.ResponseHeader,e}return _inherits(t,e),_createClass(t,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new t({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),t}(Tc),Ac=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,n))).type=Ec.Response,e.body=void 0!==n.body?n.body:null,e}return _inherits(t,e),_createClass(t,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new t({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),t}(Tc),Dc=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,0,"Unknown Error"))).name="HttpErrorResponse",n.ok=!1,n.message=n.status>=200&&n.status<300?"Http failure during parsing for ".concat(e.url||"(unknown url)"):"Http failure response for ".concat(e.url||"(unknown url)",": ").concat(e.status," ").concat(e.statusText),n.error=e.error||null,n}return _inherits(t,e),t}(Tc);function Nc(e,t){return{body:t,headers:e.headers,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}var Pc,xc,Oc,Mc,Rc,Lc,Fc,Vc,Bc,qc=((Pc=function(){function e(t){_classCallCheck(this,e),this.handler=t}return _createClass(e,[{key:"request",value:function(e,t){var n,r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e instanceof Sc)n=e;else{var i=void 0;i=o.headers instanceof mc?o.headers:new mc(o.headers);var a=void 0;o.params&&(a=o.params instanceof _c?o.params:new _c({fromObject:o.params})),n=new Sc(e,t,void 0!==o.body?o.body:null,{headers:i,params:a,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials})}var s=hc(n).pipe(U((function(e){return r.handler.handle(e)}),void 0,1));if(e instanceof Sc||"events"===o.observe)return s;var u=s.pipe(fc((function(e){return e instanceof Ac})));switch(o.observe||"body"){case"body":switch(n.responseType){case"arraybuffer":return u.pipe(F((function(e){if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body})));case"blob":return u.pipe(F((function(e){if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body})));case"text":return u.pipe(F((function(e){if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body})));case"json":default:return u.pipe(F((function(e){return e.body})))}case"response":return u;default:throw new Error("Unreachable: unhandled observe type ".concat(o.observe,"}"))}}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("DELETE",e,t)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("GET",e,t)}},{key:"head",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("HEAD",e,t)}},{key:"jsonp",value:function(e,t){return this.request("JSONP",e,{params:(new _c).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}},{key:"options",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("OPTIONS",e,t)}},{key:"patch",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PATCH",e,Nc(n,t))}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("POST",e,Nc(n,t))}},{key:"put",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PUT",e,Nc(n,t))}}]),e}()).\u0275fac=function(e){return new(e||Pc)(Ke(yc))},Pc.\u0275prov=le({token:Pc,factory:Pc.\u0275fac}),Pc),jc=function(){function e(t,n){_classCallCheck(this,e),this.next=t,this.interceptor=n}return _createClass(e,[{key:"handle",value:function(e){return this.interceptor.intercept(e,this.next)}}]),e}(),Uc=new Be("HTTP_INTERCEPTORS"),Gc=((xc=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"intercept",value:function(e,t){return t.handle(e)}}]),e}()).\u0275fac=function(e){return new(e||xc)},xc.\u0275prov=le({token:xc,factory:xc.\u0275fac}),xc),zc=/^\)\]\}',?\n/,Wc=function e(){_classCallCheck(this,e)},Hc=((Mc=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"build",value:function(){return new XMLHttpRequest}}]),e}()).\u0275fac=function(e){return new(e||Mc)},Mc.\u0275prov=le({token:Mc,factory:Mc.\u0275fac}),Mc),Qc=((Oc=function(){function e(t){_classCallCheck(this,e),this.xhrFactory=t}return _createClass(e,[{key:"handle",value:function(e){var t=this;if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without JsonpClientModule installed.");return new _((function(n){var r=t.xhrFactory.build();if(r.open(e.method,e.urlWithParams),e.withCredentials&&(r.withCredentials=!0),e.headers.forEach((function(e,t){return r.setRequestHeader(e,t.join(","))})),e.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){var o=e.detectContentTypeHeader();null!==o&&r.setRequestHeader("Content-Type",o)}if(e.responseType){var i=e.responseType.toLowerCase();r.responseType="json"!==i?i:"text"}var a=e.serializeBody(),s=null,u=function(){if(null!==s)return s;var t=1223===r.status?204:r.status,n=r.statusText||"OK",o=new mc(r.getAllResponseHeaders()),i=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(r)||e.url;return s=new Ic({headers:o,status:t,statusText:n,url:i})},c=function(){var t=u(),o=t.headers,i=t.status,a=t.statusText,s=t.url,c=null;204!==i&&(c=void 0===r.response?r.responseText:r.response),0===i&&(i=c?200:0);var l=i>=200&&i<300;if("json"===e.responseType&&"string"==typeof c){var h=c;c=c.replace(zc,"");try{c=""!==c?JSON.parse(c):null}catch(f){c=h,l&&(l=!1,c={error:f,text:c})}}l?(n.next(new Ac({body:c,headers:o,status:i,statusText:a,url:s||void 0})),n.complete()):n.error(new Dc({error:c,headers:o,status:i,statusText:a,url:s||void 0}))},l=function(e){var t=u().url,o=new Dc({error:e,status:r.status||0,statusText:r.statusText||"Unknown Error",url:t||void 0});n.error(o)},h=!1,f=function(t){h||(n.next(u()),h=!0);var o={type:Ec.DownloadProgress,loaded:t.loaded};t.lengthComputable&&(o.total=t.total),"text"===e.responseType&&r.responseText&&(o.partialText=r.responseText),n.next(o)},d=function(e){var t={type:Ec.UploadProgress,loaded:e.loaded};e.lengthComputable&&(t.total=e.total),n.next(t)};return r.addEventListener("load",c),r.addEventListener("error",l),e.reportProgress&&(r.addEventListener("progress",f),null!==a&&r.upload&&r.upload.addEventListener("progress",d)),r.send(a),n.next({type:Ec.Sent}),function(){r.removeEventListener("error",l),r.removeEventListener("load",c),e.reportProgress&&(r.removeEventListener("progress",f),null!==a&&r.upload&&r.upload.removeEventListener("progress",d)),r.abort()}}))}}]),e}()).\u0275fac=function(e){return new(e||Oc)(Ke(Wc))},Oc.\u0275prov=le({token:Oc,factory:Oc.\u0275fac}),Oc),Kc=new Be("XSRF_COOKIE_NAME"),Yc=new Be("XSRF_HEADER_NAME"),Jc=function e(){_classCallCheck(this,e)},$c=((Bc=function(){function e(t,n,r){_classCallCheck(this,e),this.doc=t,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}return _createClass(e,[{key:"getToken",value:function(){if("server"===this.platform)return null;var e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=bu(e,this.cookieName),this.lastCookieString=e),this.lastToken}}]),e}()).\u0275fac=function(e){return new(e||Bc)(Ke(Us),Ke(Xa),Ke(Kc))},Bc.\u0275prov=le({token:Bc,factory:Bc.\u0275fac}),Bc),Zc=((Vc=function(){function e(t,n){_classCallCheck(this,e),this.tokenService=t,this.headerName=n}return _createClass(e,[{key:"intercept",value:function(e,t){var n=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||n.startsWith("http://")||n.startsWith("https://"))return t.handle(e);var r=this.tokenService.getToken();return null===r||e.headers.has(this.headerName)||(e=e.clone({headers:e.headers.set(this.headerName,r)})),t.handle(e)}}]),e}()).\u0275fac=function(e){return new(e||Vc)(Ke(Jc),Ke(Yc))},Vc.\u0275prov=le({token:Vc,factory:Vc.\u0275fac}),Vc),Xc=((Fc=function(){function e(t,n){_classCallCheck(this,e),this.backend=t,this.injector=n,this.chain=null}return _createClass(e,[{key:"handle",value:function(e){if(null===this.chain){var t=this.injector.get(Uc,[]);this.chain=t.reduceRight((function(e,t){return new jc(e,t)}),this.backend)}return this.chain.handle(e)}}]),e}()).\u0275fac=function(e){return new(e||Fc)(Ke(vc),Ke(Ko))},Fc.\u0275prov=le({token:Fc,factory:Fc.\u0275fac}),Fc),el=((Lc=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"disable",value:function(){return{ngModule:e,providers:[{provide:Zc,useClass:Gc}]}}},{key:"withOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:e,providers:[t.cookieName?{provide:Kc,useValue:t.cookieName}:[],t.headerName?{provide:Yc,useValue:t.headerName}:[]]}}}]),e}()).\u0275mod=pt({type:Lc}),Lc.\u0275inj=he({factory:function(e){return new(e||Lc)},providers:[Zc,{provide:Uc,useExisting:Zc,multi:!0},{provide:Jc,useClass:$c},{provide:Kc,useValue:"XSRF-TOKEN"},{provide:Yc,useValue:"X-XSRF-TOKEN"}]}),Lc),tl=((Rc=function e(){_classCallCheck(this,e)}).\u0275mod=pt({type:Rc}),Rc.\u0275inj=he({factory:function(e){return new(e||Rc)},providers:[qc,{provide:yc,useClass:Xc},Qc,{provide:vc,useExisting:Qc},Hc,{provide:Wc,useExisting:Hc}],imports:[[el.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),Rc);function nl(e,t){return new _((function(n){var r=e.length;if(0!==r)for(var o=new Array(r),i=0,a=0,s=function(s){var u=j(e[s]),c=!1;n.add(u.subscribe({next:function(e){c||(c=!0,a++),o[s]=e},error:function(e){return n.error(e)},complete:function(){++i!==r&&c||(a===r&&n.next(t?t.reduce((function(e,t,n){return e[t]=o[n],e}),{}):o),n.complete())}}))},u=0;u<r;u++)s(u);else n.complete()}))}var rl,ol,il,al,sl=new Be("NgValueAccessor"),ul={provide:sl,useExisting:ke((function(){return cl})),multi:!0},cl=((rl=function(){function e(t,n){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this.onChange=function(e){},this.onTouched=function(){}}return _createClass(e,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"checked",e)}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}]),e}()).\u0275fac=function(e){return new(e||rl)(ci(ia),ci(ta))},rl.\u0275dir=vt({type:rl,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,t){1&e&&mi("change",(function(e){return t.onChange(e.target.checked)}))("blur",(function(e){return t.onTouched()}))},features:[$i([ul])]}),rl),ll={provide:sl,useExisting:ke((function(){return fl})),multi:!0},hl=new Be("CompositionEventMode"),fl=((al=function(){function e(t,n,r){var o;_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this._compositionMode=r,this.onChange=function(e){},this.onTouched=function(){},this._composing=!1,null==this._compositionMode&&(this._compositionMode=(o=js()?js().getUserAgent():"",!/android (\d+)/.test(o.toLowerCase())))}return _createClass(e,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==e?"":e)}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_handleInput",value:function(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}},{key:"_compositionStart",value:function(){this._composing=!0}},{key:"_compositionEnd",value:function(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}]),e}()).\u0275fac=function(e){return new(e||al)(ci(ia),ci(ta),ci(hl,8))},al.\u0275dir=vt({type:al,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,t){1&e&&mi("input",(function(e){return t._handleInput(e.target.value)}))("blur",(function(e){return t.onTouched()}))("compositionstart",(function(e){return t._compositionStart()}))("compositionend",(function(e){return t._compositionEnd(e.target.value)}))},features:[$i([ll])]}),al),dl=((il=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"reset",value:function(e){this.control&&this.control.reset(e)}},{key:"hasError",value:function(e,t){return!!this.control&&this.control.hasError(e,t)}},{key:"getError",value:function(e,t){return this.control?this.control.getError(e,t):null}},{key:"value",get:function(){return this.control?this.control.value:null}},{key:"valid",get:function(){return this.control?this.control.valid:null}},{key:"invalid",get:function(){return this.control?this.control.invalid:null}},{key:"pending",get:function(){return this.control?this.control.pending:null}},{key:"disabled",get:function(){return this.control?this.control.disabled:null}},{key:"enabled",get:function(){return this.control?this.control.enabled:null}},{key:"errors",get:function(){return this.control?this.control.errors:null}},{key:"pristine",get:function(){return this.control?this.control.pristine:null}},{key:"dirty",get:function(){return this.control?this.control.dirty:null}},{key:"touched",get:function(){return this.control?this.control.touched:null}},{key:"status",get:function(){return this.control?this.control.status:null}},{key:"untouched",get:function(){return this.control?this.control.untouched:null}},{key:"statusChanges",get:function(){return this.control?this.control.statusChanges:null}},{key:"valueChanges",get:function(){return this.control?this.control.valueChanges:null}},{key:"path",get:function(){return null}}]),e}()).\u0275fac=function(e){return new(e||il)},il.\u0275dir=vt({type:il}),il),pl=((ol=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"formDirective",get:function(){return null}},{key:"path",get:function(){return null}}]),t}(dl)).\u0275fac=function(e){return yl(e||ol)},ol.\u0275dir=vt({type:ol,features:[Li]}),ol),yl=Mn(pl);function vl(){throw new Error("unimplemented")}var ml,gl,bl=function(e){function t(){var e;return _classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments)))._parent=null,e.name=null,e.valueAccessor=null,e._rawValidators=[],e._rawAsyncValidators=[],e}return _inherits(t,e),_createClass(t,[{key:"validator",get:function(){return vl()}},{key:"asyncValidator",get:function(){return vl()}}]),t}(dl),_l=function(){function e(t){_classCallCheck(this,e),this._cd=t}return _createClass(e,[{key:"ngClassUntouched",get:function(){return!!this._cd.control&&this._cd.control.untouched}},{key:"ngClassTouched",get:function(){return!!this._cd.control&&this._cd.control.touched}},{key:"ngClassPristine",get:function(){return!!this._cd.control&&this._cd.control.pristine}},{key:"ngClassDirty",get:function(){return!!this._cd.control&&this._cd.control.dirty}},{key:"ngClassValid",get:function(){return!!this._cd.control&&this._cd.control.valid}},{key:"ngClassInvalid",get:function(){return!!this._cd.control&&this._cd.control.invalid}},{key:"ngClassPending",get:function(){return!!this._cd.control&&this._cd.control.pending}}]),e}(),wl=((gl=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))}return _inherits(t,e),t}(_l)).\u0275fac=function(e){return new(e||gl)(ci(bl,2))},gl.\u0275dir=vt({type:gl,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,t){2&e&&Ti("ng-untouched",t.ngClassUntouched)("ng-touched",t.ngClassTouched)("ng-pristine",t.ngClassPristine)("ng-dirty",t.ngClassDirty)("ng-valid",t.ngClassValid)("ng-invalid",t.ngClassInvalid)("ng-pending",t.ngClassPending)},features:[Li]}),gl),Cl=((ml=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))}return _inherits(t,e),t}(_l)).\u0275fac=function(e){return new(e||ml)(ci(pl,2))},ml.\u0275dir=vt({type:ml,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:14,hostBindings:function(e,t){2&e&&Ti("ng-untouched",t.ngClassUntouched)("ng-touched",t.ngClassTouched)("ng-pristine",t.ngClassPristine)("ng-dirty",t.ngClassDirty)("ng-valid",t.ngClassValid)("ng-invalid",t.ngClassInvalid)("ng-pending",t.ngClassPending)},features:[Li]}),ml);function kl(e){return null==e||0===e.length}var Sl=new Be("NgValidators"),El=new Be("NgAsyncValidators"),Tl=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Il=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"min",value:function(e){return function(t){if(kl(t.value)||kl(e))return null;var n=parseFloat(t.value);return!isNaN(n)&&n<e?{min:{min:e,actual:t.value}}:null}}},{key:"max",value:function(e){return function(t){if(kl(t.value)||kl(e))return null;var n=parseFloat(t.value);return!isNaN(n)&&n>e?{max:{max:e,actual:t.value}}:null}}},{key:"required",value:function(e){return kl(e.value)?{required:!0}:null}},{key:"requiredTrue",value:function(e){return!0===e.value?null:{required:!0}}},{key:"email",value:function(e){return kl(e.value)?null:Tl.test(e.value)?null:{email:!0}}},{key:"minLength",value:function(e){return function(t){if(kl(t.value))return null;var n=t.value?t.value.length:0;return n<e?{minlength:{requiredLength:e,actualLength:n}}:null}}},{key:"maxLength",value:function(e){return function(t){var n=t.value?t.value.length:0;return n>e?{maxlength:{requiredLength:e,actualLength:n}}:null}}},{key:"pattern",value:function(t){return t?("string"==typeof t?(r="","^"!==t.charAt(0)&&(r+="^"),r+=t,"$"!==t.charAt(t.length-1)&&(r+="$"),n=new RegExp(r)):(r=t.toString(),n=t),function(e){if(kl(e.value))return null;var t=e.value;return n.test(t)?null:{pattern:{requiredPattern:r,actualValue:t}}}):e.nullValidator;var n,r}},{key:"nullValidator",value:function(e){return null}},{key:"compose",value:function(e){if(!e)return null;var t=e.filter(Al);return 0==t.length?null:function(e){return Nl(function(e,t){return t.map((function(t){return t(e)}))}(e,t))}}},{key:"composeAsync",value:function(e){if(!e)return null;var t=e.filter(Al);return 0==t.length?null:function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(1===t.length){var r=t[0];if(u(r))return nl(r,null);if(c(r)&&Object.getPrototypeOf(r)===Object.prototype){var o=Object.keys(r);return nl(o.map((function(e){return r[e]})),o)}}if("function"==typeof t[t.length-1]){var i=t.pop();return nl(t=1===t.length&&u(t[0])?t[0]:t,null).pipe(F((function(e){return i.apply(void 0,_toConsumableArray(e))})))}return nl(t,null)}(function(e,t){return t.map((function(t){return t(e)}))}(e,t).map(Dl)).pipe(F(Nl))}}}]),e}();function Al(e){return null!=e}function Dl(e){var t,n=vi(e)?j(e):e;if(!(t=n)||"function"!=typeof t.subscribe)throw new Error("Expected validator to return Promise or Observable.");return n}function Nl(e){var t=e.reduce((function(e,t){return null!=t?Object.assign(Object.assign({},e),t):e}),{});return 0===Object.keys(t).length?null:t}function Pl(e){return e.validate?function(t){return e.validate(t)}:e}function xl(e){return e.validate?function(t){return e.validate(t)}:e}var Ol,Ml,Rl,Ll,Fl={provide:sl,useExisting:ke((function(){return Vl})),multi:!0},Vl=((Ol=function(){function e(t,n){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this.onChange=function(e){},this.onTouched=function(){}}return _createClass(e,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==e?"":e)}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}]),e}()).\u0275fac=function(e){return new(e||Ol)(ci(ia),ci(ta))},Ol.\u0275dir=vt({type:Ol,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,t){1&e&&mi("change",(function(e){return t.onChange(e.target.value)}))("input",(function(e){return t.onChange(e.target.value)}))("blur",(function(e){return t.onTouched()}))},features:[$i([Fl])]}),Ol),Bl={provide:sl,useExisting:ke((function(){return jl})),multi:!0},ql=((Rl=function(){function e(){_classCallCheck(this,e),this._accessors=[]}return _createClass(e,[{key:"add",value:function(e,t){this._accessors.push([e,t])}},{key:"remove",value:function(e){for(var t=this._accessors.length-1;t>=0;--t)if(this._accessors[t][1]===e)return void this._accessors.splice(t,1)}},{key:"select",value:function(e){var t=this;this._accessors.forEach((function(n){t._isSameGroup(n,e)&&n[1]!==e&&n[1].fireUncheck(e.value)}))}},{key:"_isSameGroup",value:function(e,t){return!!e[0].control&&e[0]._parent===t._control._parent&&e[1].name===t.name}}]),e}()).\u0275fac=function(e){return new(e||Rl)},Rl.\u0275prov=le({token:Rl,factory:Rl.\u0275fac}),Rl),jl=((Ml=function(){function e(t,n,r,o){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this._registry=r,this._injector=o,this.onChange=function(){},this.onTouched=function(){}}return _createClass(e,[{key:"ngOnInit",value:function(){this._control=this._injector.get(bl),this._checkName(),this._registry.add(this._control,this)}},{key:"ngOnDestroy",value:function(){this._registry.remove(this)}},{key:"writeValue",value:function(e){this._state=e===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)}},{key:"registerOnChange",value:function(e){var t=this;this._fn=e,this.onChange=function(){e(t.value),t._registry.select(t)}}},{key:"fireUncheck",value:function(e){this.writeValue(e)}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_checkName",value:function(){this.name&&this.formControlName&&this.name!==this.formControlName&&this._throwNameError(),!this.name&&this.formControlName&&(this.name=this.formControlName)}},{key:"_throwNameError",value:function(){throw new Error('\n      If you define both a name and a formControlName attribute on your radio button, their values\n      must match. Ex: <input type="radio" formControlName="food" name="food">\n    ')}}]),e}()).\u0275fac=function(e){return new(e||Ml)(ci(ia),ci(ta),ci(ql),ci(Ko))},Ml.\u0275dir=vt({type:Ml,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(e,t){1&e&&mi("change",(function(e){return t.onChange()}))("blur",(function(e){return t.onTouched()}))},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[$i([Bl])]}),Ml),Ul={provide:sl,useExisting:ke((function(){return Gl})),multi:!0},Gl=((Ll=function(){function e(t,n){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this.onChange=function(e){},this.onTouched=function(){}}return _createClass(e,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(e))}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}]),e}()).\u0275fac=function(e){return new(e||Ll)(ci(ia),ci(ta))},Ll.\u0275dir=vt({type:Ll,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,t){1&e&&mi("change",(function(e){return t.onChange(e.target.value)}))("input",(function(e){return t.onChange(e.target.value)}))("blur",(function(e){return t.onTouched()}))},features:[$i([Ul])]}),Ll),zl='\n    <div [formGroup]="myGroup">\n       <div formGroupName="person">\n          <input formControlName="firstName">\n       </div>\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       person: new FormGroup({ firstName: new FormControl() })\n    });',Wl='\n    <form>\n       <div ngModelGroup="person">\n          <input [(ngModel)]="person.name" name="firstName">\n       </div>\n    </form>',Hl={provide:sl,useExisting:ke((function(){return Jl})),multi:!0};function Ql(e,t){return null==e?"".concat(t):(t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var Kl,Yl,Jl=((Yl=function(){function e(t,n){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this._optionMap=new Map,this._idCounter=0,this.onChange=function(e){},this.onTouched=function(){},this._compareWith=ti}return _createClass(e,[{key:"writeValue",value:function(e){this.value=e;var t=this._getOptionId(e);null==t&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);var n=Ql(t,e);this._renderer.setProperty(this._elementRef.nativeElement,"value",n)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){t.value=t._getOptionValue(n),e(t.value)}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_registerOption",value:function(){return(this._idCounter++).toString()}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r),e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}},{key:"compareWith",set:function(e){if("function"!=typeof e)throw new Error("compareWith must be a function, but received ".concat(JSON.stringify(e)));this._compareWith=e}}]),e}()).\u0275fac=function(e){return new(e||Yl)(ci(ia),ci(ta))},Yl.\u0275dir=vt({type:Yl,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,t){1&e&&mi("change",(function(e){return t.onChange(e.target.value)}))("blur",(function(e){return t.onTouched()}))},inputs:{compareWith:"compareWith"},features:[$i([Hl])]}),Yl),$l=((Kl=function(){function e(t,n,r){_classCallCheck(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption())}return _createClass(e,[{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}},{key:"ngValue",set:function(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(Ql(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}}]),e}()).\u0275fac=function(e){return new(e||Kl)(ci(ta),ci(ia),ci(Jl,9))},Kl.\u0275dir=vt({type:Kl,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),Kl),Zl={provide:sl,useExisting:ke((function(){return nh})),multi:!0};function Xl(e,t){return null==e?"".concat(t):("string"==typeof t&&(t="'".concat(t,"'")),t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var eh,th,nh=((th=function(){function e(t,n){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this._optionMap=new Map,this._idCounter=0,this.onChange=function(e){},this.onTouched=function(){},this._compareWith=ti}return _createClass(e,[{key:"writeValue",value:function(e){var t,n=this;if(this.value=e,Array.isArray(e)){var r=e.map((function(e){return n._getOptionId(e)}));t=function(e,t){e._setSelected(r.indexOf(t.toString())>-1)}}else t=function(e,t){e._setSelected(!1)};this._optionMap.forEach(t)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){var r=[];if(n.hasOwnProperty("selectedOptions"))for(var o=n.selectedOptions,i=0;i<o.length;i++){var a=o.item(i),s=t._getOptionValue(a.value);r.push(s)}else for(var u=n.options,c=0;c<u.length;c++){var l=u.item(c);if(l.selected){var h=t._getOptionValue(l.value);r.push(h)}}t.value=r,e(r)}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_registerOption",value:function(e){var t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r)._value,e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}},{key:"compareWith",set:function(e){if("function"!=typeof e)throw new Error("compareWith must be a function, but received ".concat(JSON.stringify(e)));this._compareWith=e}}]),e}()).\u0275fac=function(e){return new(e||th)(ci(ia),ci(ta))},th.\u0275dir=vt({type:th,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,t){1&e&&mi("change",(function(e){return t.onChange(e.target)}))("blur",(function(e){return t.onTouched()}))},inputs:{compareWith:"compareWith"},features:[$i([Zl])]}),th),rh=((eh=function(){function e(t,n,r){_classCallCheck(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption(this))}return _createClass(e,[{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"_setSelected",value:function(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}},{key:"ngValue",set:function(e){null!=this._select&&(this._value=e,this._setElementValue(Xl(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._select?(this._value=e,this._setElementValue(Xl(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}}]),e}()).\u0275fac=function(e){return new(e||eh)(ci(ta),ci(ia),ci(nh,9))},eh.\u0275dir=vt({type:eh,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),eh);function oh(e,t){return[].concat(_toConsumableArray(t.path),[e])}function ih(e,t){e||sh(t,"Cannot find control with"),t.valueAccessor||sh(t,"No value accessor for form control with"),e.validator=Il.compose([e.validator,t.validator]),e.asyncValidator=Il.composeAsync([e.asyncValidator,t.asyncValidator]),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange((function(n){e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&ah(e,t)}))}(e,t),function(e,t){e.registerOnChange((function(e,n){t.valueAccessor.writeValue(e),n&&t.viewToModelUpdate(e)}))}(e,t),function(e,t){t.valueAccessor.registerOnTouched((function(){e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&ah(e,t),"submit"!==e.updateOn&&e.markAsTouched()}))}(e,t),t.valueAccessor.setDisabledState&&e.registerOnDisabledChange((function(e){t.valueAccessor.setDisabledState(e)})),t._rawValidators.forEach((function(t){t.registerOnValidatorChange&&t.registerOnValidatorChange((function(){return e.updateValueAndValidity()}))})),t._rawAsyncValidators.forEach((function(t){t.registerOnValidatorChange&&t.registerOnValidatorChange((function(){return e.updateValueAndValidity()}))}))}function ah(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function sh(e,t){var n;throw n=e.path.length>1?"path: '".concat(e.path.join(" -> "),"'"):e.path[0]?"name: '".concat(e.path,"'"):"unspecified name attribute",new Error("".concat(t," ").concat(n))}function uh(e){return null!=e?Il.compose(e.map(Pl)):null}function ch(e){return null!=e?Il.composeAsync(e.map(xl)):null}var lh=[cl,Gl,Vl,Jl,nh,jl];function hh(e){var t=dh(e)?e.validators:e;return Array.isArray(t)?uh(t):t||null}function fh(e,t){var n=dh(t)?t.asyncValidators:e;return Array.isArray(n)?ch(n):n||null}function dh(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}var ph,yh,vh,mh,gh,bh,_h,wh,Ch=function(){function e(t,n){_classCallCheck(this,e),this.validator=t,this.asyncValidator=n,this._onCollectionChange=function(){},this.pristine=!0,this.touched=!1,this._onDisabledChange=[]}return _createClass(e,[{key:"setValidators",value:function(e){this.validator=hh(e)}},{key:"setAsyncValidators",value:function(e){this.asyncValidator=fh(e)}},{key:"clearValidators",value:function(){this.validator=null}},{key:"clearAsyncValidators",value:function(){this.asyncValidator=null}},{key:"markAsTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}},{key:"markAllAsTouched",value:function(){this.markAsTouched({onlySelf:!0}),this._forEachChild((function(e){return e.markAllAsTouched()}))}},{key:"markAsUntouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!1,this._pendingTouched=!1,this._forEachChild((function(e){e.markAsUntouched({onlySelf:!0})})),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"markAsDirty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}},{key:"markAsPristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!0,this._pendingDirty=!1,this._forEachChild((function(e){e.markAsPristine({onlySelf:!0})})),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"markAsPending",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.status="PENDING",!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}},{key:"disable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status="DISABLED",this.errors=null,this._forEachChild((function(t){t.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))})),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach((function(e){return e(!0)}))}},{key:"enable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status="VALID",this._forEachChild((function(t){t.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))})),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach((function(e){return e(!1)}))}},{key:"_updateAncestors",value:function(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}},{key:"setParent",value:function(e){this._parent=e}},{key:"updateValueAndValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),"VALID"!==this.status&&"PENDING"!==this.status||this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}},{key:"_updateTreeValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{emitEvent:!0};this._forEachChild((function(t){return t._updateTreeValidity(e)})),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}},{key:"_setInitialStatus",value:function(){this.status=this._allControlsDisabled()?"DISABLED":"VALID"}},{key:"_runValidator",value:function(){return this.validator?this.validator(this):null}},{key:"_runAsyncValidator",value:function(e){var t=this;if(this.asyncValidator){this.status="PENDING";var n=Dl(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe((function(n){return t.setErrors(n,{emitEvent:e})}))}}},{key:"_cancelExistingSubscription",value:function(){this._asyncValidationSubscription&&this._asyncValidationSubscription.unsubscribe()}},{key:"setErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}},{key:"get",value:function(e){return function(e,t,n){return null==t?null:(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length?null:t.reduce((function(e,t){return e instanceof Sh?e.controls.hasOwnProperty(t)?e.controls[t]:null:e instanceof Eh&&e.at(t)||null}),e))}(this,e)}},{key:"getError",value:function(e,t){var n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}},{key:"hasError",value:function(e,t){return!!this.getError(e,t)}},{key:"_updateControlsErrors",value:function(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}},{key:"_initObservables",value:function(){this.valueChanges=new Ha,this.statusChanges=new Ha}},{key:"_calculateStatus",value:function(){return this._allControlsDisabled()?"DISABLED":this.errors?"INVALID":this._anyControlsHaveStatus("PENDING")?"PENDING":this._anyControlsHaveStatus("INVALID")?"INVALID":"VALID"}},{key:"_anyControlsHaveStatus",value:function(e){return this._anyControls((function(t){return t.status===e}))}},{key:"_anyControlsDirty",value:function(){return this._anyControls((function(e){return e.dirty}))}},{key:"_anyControlsTouched",value:function(){return this._anyControls((function(e){return e.touched}))}},{key:"_updatePristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"_updateTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"_isBoxedValue",value:function(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}},{key:"_registerOnCollectionChange",value:function(e){this._onCollectionChange=e}},{key:"_setUpdateStrategy",value:function(e){dh(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}},{key:"_parentMarkedDirty",value:function(e){return!e&&this._parent&&this._parent.dirty&&!this._parent._anyControlsDirty()}},{key:"parent",get:function(){return this._parent}},{key:"valid",get:function(){return"VALID"===this.status}},{key:"invalid",get:function(){return"INVALID"===this.status}},{key:"pending",get:function(){return"PENDING"==this.status}},{key:"disabled",get:function(){return"DISABLED"===this.status}},{key:"enabled",get:function(){return"DISABLED"!==this.status}},{key:"dirty",get:function(){return!this.pristine}},{key:"untouched",get:function(){return!this.touched}},{key:"updateOn",get:function(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}},{key:"root",get:function(){for(var e=this;e._parent;)e=e._parent;return e}}]),e}(),kh=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0;return _classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,hh(r),fh(o,r))))._onChange=[],e._applyFormState(n),e._setUpdateStrategy(r),e.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),e._initObservables(),e}return _inherits(t,e),_createClass(t,[{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.value=this._pendingValue=e,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach((function(e){return e(t.value,!1!==n.emitViewToModelChange)})),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setValue(e,t)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}},{key:"_updateValue",value:function(){}},{key:"_anyControls",value:function(e){return!1}},{key:"_allControlsDisabled",value:function(){return this.disabled}},{key:"registerOnChange",value:function(e){this._onChange.push(e)}},{key:"_clearChangeFns",value:function(){this._onChange=[],this._onDisabledChange=[],this._onCollectionChange=function(){}}},{key:"registerOnDisabledChange",value:function(e){this._onDisabledChange.push(e)}},{key:"_forEachChild",value:function(e){}},{key:"_syncPendingControls",value:function(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}},{key:"_applyFormState",value:function(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}]),t}(Ch),Sh=function(e){function t(e,n,r){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,hh(n),fh(r,n)))).controls=e,o._initObservables(),o._setUpdateStrategy(n),o._setUpControls(),o.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),o}return _inherits(t,e),_createClass(t,[{key:"registerControl",value:function(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}},{key:"addControl",value:function(e,t){this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"removeControl",value:function(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange((function(){})),delete this.controls[e],this.updateValueAndValidity(),this._onCollectionChange()}},{key:"setControl",value:function(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange((function(){})),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"contains",value:function(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),Object.keys(e).forEach((function(r){t._throwIfControlMissing(r),t.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.keys(e).forEach((function(r){t.controls[r]&&t.controls[r].patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild((function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})})),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this._reduceChildren({},(function(e,t,n){return e[n]=t instanceof kh?t.value:t.getRawValue(),e}))}},{key:"_syncPendingControls",value:function(){var e=this._reduceChildren(!1,(function(e,t){return!!t._syncPendingControls()||e}));return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error("Cannot find form control with name: ".concat(e,"."))}},{key:"_forEachChild",value:function(e){var t=this;Object.keys(this.controls).forEach((function(n){return e(t.controls[n],n)}))}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild((function(t){t.setParent(e),t._registerOnCollectionChange(e._onCollectionChange)}))}},{key:"_updateValue",value:function(){this.value=this._reduceValue()}},{key:"_anyControls",value:function(e){var t=this,n=!1;return this._forEachChild((function(r,o){n=n||t.contains(o)&&e(r)})),n}},{key:"_reduceValue",value:function(){var e=this;return this._reduceChildren({},(function(t,n,r){return(n.enabled||e.disabled)&&(t[r]=n.value),t}))}},{key:"_reduceChildren",value:function(e,t){var n=e;return this._forEachChild((function(e,r){n=t(n,e,r)})),n}},{key:"_allControlsDisabled",value:function(){for(var e=0,t=Object.keys(this.controls);e<t.length;e++){var n=t[e];if(this.controls[n].enabled)return!1}return Object.keys(this.controls).length>0||this.disabled}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild((function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control with name: '".concat(n,"'."))}))}}]),t}(Ch),Eh=function(e){function t(e,n,r){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,hh(n),fh(r,n)))).controls=e,o._initObservables(),o._setUpdateStrategy(n),o._setUpControls(),o.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),o}return _inherits(t,e),_createClass(t,[{key:"at",value:function(e){return this.controls[e]}},{key:"push",value:function(e){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"insert",value:function(e,t){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity()}},{key:"removeAt",value:function(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange((function(){})),this.controls.splice(e,1),this.updateValueAndValidity()}},{key:"setControl",value:function(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange((function(){})),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),e.forEach((function(e,r){t._throwIfControlMissing(r),t.at(r).setValue(e,{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.forEach((function(e,r){t.at(r)&&t.at(r).patchValue(e,{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild((function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})})),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this.controls.map((function(e){return e instanceof kh?e.value:e.getRawValue()}))}},{key:"clear",value:function(){this.controls.length<1||(this._forEachChild((function(e){return e._registerOnCollectionChange((function(){}))})),this.controls.splice(0),this.updateValueAndValidity())}},{key:"_syncPendingControls",value:function(){var e=this.controls.reduce((function(e,t){return!!t._syncPendingControls()||e}),!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error("Cannot find form control at index ".concat(e))}},{key:"_forEachChild",value:function(e){this.controls.forEach((function(t,n){e(t,n)}))}},{key:"_updateValue",value:function(){var e=this;this.value=this.controls.filter((function(t){return t.enabled||e.disabled})).map((function(e){return e.value}))}},{key:"_anyControls",value:function(e){return this.controls.some((function(t){return t.enabled&&e(t)}))}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild((function(t){return e._registerControl(t)}))}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild((function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control at index: ".concat(n,"."))}))}},{key:"_allControlsDisabled",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.controls[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){if(r.value.enabled)return!1}}catch(i){t=!0,n=i}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}return this.controls.length>0||this.disabled}},{key:"_registerControl",value:function(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}},{key:"length",get:function(){return this.controls.length}}]),t}(Ch),Th={provide:pl,useExisting:ke((function(){return Ah}))},Ih=Promise.resolve(null),Ah=((yh=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).submitted=!1,r._directives=[],r.ngSubmit=new Ha,r.form=new Sh({},uh(e),ch(n)),r}return _inherits(t,e),_createClass(t,[{key:"ngAfterViewInit",value:function(){this._setUpdateStrategy()}},{key:"addControl",value:function(e){var t=this;Ih.then((function(){var n=t._findContainer(e.path);e.control=n.registerControl(e.name,e.control),ih(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),t._directives.push(e)}))}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){var t=this;Ih.then((function(){var n,r,o,i=t._findContainer(e.path);i&&i.removeControl(e.name),n=t._directives,r=e,(o=n.indexOf(r))>-1&&n.splice(o,1)}))}},{key:"addFormGroup",value:function(e){var t=this;Ih.then((function(){var n=t._findContainer(e.path),r=new Sh({});(function(e,t){null==e&&sh(t,"Cannot find control with"),e.validator=Il.compose([e.validator,t.validator]),e.asyncValidator=Il.composeAsync([e.asyncValidator,t.asyncValidator])})(r,e),n.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})}))}},{key:"removeFormGroup",value:function(e){var t=this;Ih.then((function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name)}))}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){var n=this;Ih.then((function(){n.form.get(e.path).setValue(t)}))}},{key:"setValue",value:function(e){this.control.setValue(e)}},{key:"onSubmit",value:function(e){return this.submitted=!0,t=this._directives,this.form._syncPendingControls(),t.forEach((function(e){var t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)})),this.ngSubmit.emit(e),!1;var t}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}},{key:"_findContainer",value:function(e){return e.pop(),e.length?this.form.get(e):this.form}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"controls",get:function(){return this.form.controls}}]),t}(pl)).\u0275fac=function(e){return new(e||yh)(ci(Sl,10),ci(El,10))},yh.\u0275dir=vt({type:yh,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,t){1&e&&mi("submit",(function(e){return t.onSubmit(e)}))("reset",(function(e){return t.onReset()}))},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[$i([Th]),Li]}),yh),Dh=((ph=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"ngOnInit",value:function(){this._checkParentType(),this.formDirective.addFormGroup(this)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeFormGroup(this)}},{key:"_checkParentType",value:function(){}},{key:"control",get:function(){return this.formDirective.getFormGroup(this)}},{key:"path",get:function(){return oh(null==this.name?this.name:this.name.toString(),this._parent)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"validator",get:function(){return uh(this._validators)}},{key:"asyncValidator",get:function(){return ch(this._asyncValidators)}}]),t}(pl)).\u0275fac=function(e){return Nh(e||ph)},ph.\u0275dir=vt({type:ph,features:[Li]}),ph),Nh=Mn(Dh),Ph=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"modelParentException",value:function(){throw new Error('\n      ngModel cannot be used to register form controls with a parent formGroup directive.  Try using\n      formGroup\'s partner directive "formControlName" instead.  Example:\n\n      \n    <div [formGroup]="myGroup">\n      <input formControlName="firstName">\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       firstName: new FormControl()\n    });\n\n      Or, if you\'d like to avoid registering this form control, indicate that it\'s standalone in ngModelOptions:\n\n      Example:\n\n      \n    <div [formGroup]="myGroup">\n       <input formControlName="firstName">\n       <input [(ngModel)]="showMoreControls" [ngModelOptions]="{standalone: true}">\n    </div>\n  ')}},{key:"formGroupNameException",value:function(){throw new Error("\n      ngModel cannot be used to register form controls with a parent formGroupName or formArrayName directive.\n\n      Option 1: Use formControlName instead of ngModel (reactive strategy):\n\n      ".concat(zl,"\n\n      Option 2:  Update ngModel's parent be ngModelGroup (template-driven strategy):\n\n      ").concat(Wl))}},{key:"missingNameException",value:function(){throw new Error('If ngModel is used within a form tag, either the name attribute must be set or the form\n      control must be defined as \'standalone\' in ngModelOptions.\n\n      Example 1: <input [(ngModel)]="person.firstName" name="first">\n      Example 2: <input [(ngModel)]="person.firstName" [ngModelOptions]="{standalone: true}">')}},{key:"modelGroupParentException",value:function(){throw new Error("\n      ngModelGroup cannot be used with a parent formGroup directive.\n\n      Option 1: Use formGroupName instead of ngModelGroup (reactive strategy):\n\n      ".concat(zl,"\n\n      Option 2:  Use a regular form tag instead of the formGroup directive (template-driven strategy):\n\n      ").concat(Wl))}}]),e}(),xh={provide:pl,useExisting:ke((function(){return Oh}))},Oh=((vh=function(e){function t(e,n,r){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._parent=e,o._validators=n,o._asyncValidators=r,o}return _inherits(t,e),_createClass(t,[{key:"_checkParentType",value:function(){this._parent instanceof t||this._parent instanceof Ah||Ph.modelGroupParentException()}}]),t}(Dh)).\u0275fac=function(e){return new(e||vh)(ci(pl,5),ci(Sl,10),ci(El,10))},vh.\u0275dir=vt({type:vh,selectors:[["","ngModelGroup",""]],inputs:{name:["ngModelGroup","name"]},exportAs:["ngModelGroup"],features:[$i([xh]),Li]}),vh),Mh={provide:bl,useExisting:ke((function(){return Lh}))},Rh=Promise.resolve(null),Lh=((wh=function(e){function t(e,n,r,o){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).control=new kh,i._registered=!1,i.update=new Ha,i._parent=e,i._rawValidators=n||[],i._rawAsyncValidators=r||[],i.valueAccessor=function(e,t){if(!t)return null;Array.isArray(t)||sh(e,"Value accessor was not provided as an array for form control with");var n=void 0,r=void 0,o=void 0;return t.forEach((function(t){var i;t.constructor===fl?n=t:(i=t,lh.some((function(e){return i.constructor===e}))?(r&&sh(e,"More than one built-in value accessor matches form control with"),r=t):(o&&sh(e,"More than one custom value accessor matches form control with"),o=t))})),o||r||n||(sh(e,"No valid value accessor for form control with"),null)}(_assertThisInitialized(i),o),i}return _inherits(t,e),_createClass(t,[{key:"ngOnChanges",value:function(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),function(e,t){if(!e.hasOwnProperty("model"))return!1;var n=e.model;return!!n.isFirstChange()||!ti(t,n.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"_setUpControl",value:function(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}},{key:"_isStandalone",value:function(){return!this._parent||!(!this.options||!this.options.standalone)}},{key:"_setUpStandalone",value:function(){ih(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}},{key:"_checkForErrors",value:function(){this._isStandalone()||this._checkParentType(),this._checkName()}},{key:"_checkParentType",value:function(){!(this._parent instanceof Oh)&&this._parent instanceof Dh?Ph.formGroupNameException():this._parent instanceof Oh||this._parent instanceof Ah||Ph.modelParentException()}},{key:"_checkName",value:function(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()||this.name||Ph.missingNameException()}},{key:"_updateValue",value:function(e){var t=this;Rh.then((function(){t.control.setValue(e,{emitViewToModelChange:!1})}))}},{key:"_updateDisabled",value:function(e){var t=this,n=e.isDisabled.currentValue,r=""===n||n&&"false"!==n;Rh.then((function(){r&&!t.control.disabled?t.control.disable():!r&&t.control.disabled&&t.control.enable()}))}},{key:"path",get:function(){return this._parent?oh(this.name,this._parent):[this.name]}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"validator",get:function(){return uh(this._rawValidators)}},{key:"asyncValidator",get:function(){return ch(this._rawAsyncValidators)}}]),t}(bl)).\u0275fac=function(e){return new(e||wh)(ci(pl,9),ci(Sl,10),ci(El,10),ci(sl,10))},wh.\u0275dir=vt({type:wh,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[$i([Mh]),Li,(Ui.ngInherit=!0,Ui)]}),wh),Fh=((_h=function e(){_classCallCheck(this,e)}).\u0275fac=function(e){return new(e||_h)},_h.\u0275dir=vt({type:_h,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),_h),Vh=((bh=function e(){_classCallCheck(this,e)}).\u0275mod=pt({type:bh}),bh.\u0275inj=he({factory:function(e){return new(e||bh)}}),bh),Bh=((gh=function e(){_classCallCheck(this,e)}).\u0275mod=pt({type:gh}),gh.\u0275inj=he({factory:function(e){return new(e||gh)},providers:[ql],imports:[Vh]}),gh),qh=((mh=function(){function e(t){_classCallCheck(this,e),this.http=t,this.terminadoInterno=new T,this.terminadoPublico=this.terminadoInterno.asObservable()}return _createClass(e,[{key:"getRenabap",value:function(){return this.http.get("./assets/renabap.geojson")}},{key:"getPartidos2015",value:function(){return this.http.get("./assets/partidos.geojson")}},{key:"buscarGeoJsonPartidos",value:function(){return this.http.get("./assets/partidos.geojson")}},{key:"getCircuitosElectorales",value:function(){return this.http.get("./assets/circuitosElectoralesBuenosAires.geojson")}},{key:"getEscuelas",value:function(){return this.http.get("./assets/escuelas.geojson")}},{key:"getWfsIgn",value:function(){return this.elJsonDelIGN=this.http.get("https://wms.ign.gob.ar/geoserver/ows?service=wfs&version=1.1.0&request=GetFeature&typeName=ign:departamento&outputFormat=application/json"),this.elJsonDelIGN}}]),e}()).\u0275fac=function(e){return new(e||mh)(Ke(qc))},mh.\u0275prov=le({token:mh,factory:mh.\u0275fac,providedIn:"root"}),mh);function jh(e){return function(e){return new _((function(t){return{unsubscribe:e.onSnapshot(t)}}))}(e).pipe(te())}function Uh(e){return jh(e).pipe(F((function(e){return{payload:e,type:"query"}})))}function Gh(e,t){var n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new zh(e,t,n))}}var zh=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,e),this.accumulator=t,this.seed=n,this.hasSeed=r}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Wh(e,this.accumulator,this.seed,this.hasSeed))}}]),e}(),Wh=function(e){function t(e,n,r,o){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).accumulator=n,i._seed=r,i.hasSeed=o,i.index=0,i}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)}},{key:"_tryNext",value:function(e){var t,n=this.index++;try{t=this.accumulator(this.seed,e,n)}catch(r){this.destination.error(r)}this.seed=t,this.destination.next(t)}},{key:"seed",get:function(){return this._seed},set:function(e){this.hasSeed=!0,this._seed=e}}]),t}(y);function Hh(e){return Uh(e).pipe(F((function(e){return e.payload.docChanges().map((function(e){return{type:e.type,payload:e}}))})))}function Qh(e,t){return Uh(e).pipe(F((function(e){return e.payload.docChanges()})),Gh((function(e,n){return function(e,t,n){return t.forEach((function(t){n.indexOf(t.type)>-1&&(e=function(e,t){switch(t.type){case"added":e[t.newIndex]&&e[t.newIndex].doc.ref.isEqual(t.doc.ref)||e.splice(t.newIndex,0,t);break;case"modified":(null==e[t.oldIndex]||e[t.oldIndex].doc.ref.isEqual(t.doc.ref))&&(t.oldIndex!==t.newIndex?(e.splice(t.oldIndex,1),e.splice(t.newIndex,0,t)):e.splice(t.newIndex,1,t));break;case"removed":e[t.oldIndex]&&e[t.oldIndex].doc.ref.isEqual(t.doc.ref)&&e.splice(t.oldIndex,1)}return e}(e,t))})),e}(e,n,t)}),[]),F((function(e){return e.map((function(e){return{type:e.type,payload:e}}))})))}var Kh=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).scheduler=e,r.work=n,r}return _inherits(t,e),_createClass(t,[{key:"schedule",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return n>0?_get(_getPrototypeOf(t.prototype),"schedule",this).call(this,e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}},{key:"execute",value:function(e,n){return n>0||this.closed?_get(_getPrototypeOf(t.prototype),"execute",this).call(this,e,n):this._execute(e,n)}},{key:"requestAsyncId",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!==r&&r>0||null===r&&this.delay>0?_get(_getPrototypeOf(t.prototype),"requestAsyncId",this).call(this,e,n,r):e.flush(this)}}]),t}(function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).scheduler=e,r.work=n,r.pending=!1,r}return _inherits(t,e),_createClass(t,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}},{key:"requestAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return setInterval(e.flush.bind(e,this),n)}},{key:"recycleAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)}},{key:"execute",value:function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(e,t){var n=!1,r=void 0;try{this.work(e)}catch(o){n=!0,r=!!o&&o||new Error(o)}if(n)return this.unsubscribe(),r}},{key:"_unsubscribe",value:function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}]),t}(function(e){function t(e,n){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))}return _inherits(t,e),_createClass(t,[{key:"schedule",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this}}]),t}(f))),Yh=function(){var e=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.now;_classCallCheck(this,e),this.SchedulerAction=t,this.now=n}return _createClass(e,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return new this.SchedulerAction(this,e).schedule(n,t)}}]),e}();return e.now=function(){return Date.now()},e}(),Jh=new(function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),t}(function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Yh.now;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,(function(){return t.delegate&&t.delegate!==_assertThisInitialized(n)?t.delegate.now():r()})))).actions=[],n.active=!1,n.scheduled=void 0,n}return _inherits(t,e),_createClass(t,[{key:"schedule",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;return t.delegate&&t.delegate!==this?t.delegate.schedule(e,n,r):_get(_getPrototypeOf(t.prototype),"schedule",this).call(this,e,n,r)}},{key:"flush",value:function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}}]),t}(Yh)))(Kh),$h=function(){function e(t,n){_classCallCheck(this,e),this.zone=t,this.platformId=n}return _createClass(e,[{key:"schedule",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.zone.runGuarded((function(){return Jh.schedule.apply(Jh,t)}))}},{key:"keepUnstableUntilFirst",value:function(e){return Du(this.platformId)?new _((function(t){var n=function(){},r=Zone.current.scheduleMacroTask("firebaseZoneBlock",n,{},n,n);e.subscribe((function(e){"scheduled"===r.state&&r.invoke(),t.next(e)}),(function(e){"scheduled"===r.state&&r.invoke(),t.error(e)}),(function(){"scheduled"===r.state&&r.invoke(),t.complete()}))})):e}},{key:"runOutsideAngular",value:function(e){var t=this;return new _((function(n){return t.zone.runOutsideAngular((function(){return e.subscribe((function(e){return t.zone.run((function(){return n.next(e)}))}),(function(e){return t.zone.run((function(){return n.error(e)}))}),(function(){return t.zone.run((function(){return n.complete()}))}))}))}))}}]),e}(),Zh=function(e){return function(t){return new _((function(n){return t.subscribe((function(t){return e.run((function(){return n.next(t)}))}),(function(t){return e.run((function(){return n.error(t)}))}),(function(){return e.run((function(){return n.complete()}))}))}))}};function Xh(e){return e&&0!==e.length||(e=["added","removed","modified"]),e}var ef,tf=function(){function e(t,n,r){_classCallCheck(this,e),this.ref=t,this.query=n,this.afs=r}return _createClass(e,[{key:"stateChanges",value:function(e){return e&&0!==e.length?this.afs.scheduler.keepUnstableUntilFirst(this.afs.scheduler.runOutsideAngular(Hh(this.query))).pipe(F((function(t){return t.filter((function(t){return e.indexOf(t.type)>-1}))})),fc((function(e){return e.length>0}))):this.afs.scheduler.keepUnstableUntilFirst(this.afs.scheduler.runOutsideAngular(Hh(this.query)))}},{key:"auditTrail",value:function(e){return this.stateChanges(e).pipe(Gh((function(e,t){return[].concat(_toConsumableArray(e),_toConsumableArray(t))}),[]))}},{key:"snapshotChanges",value:function(e){var t=Xh(e),n=Qh(this.query,t),r=this.afs.scheduler.runOutsideAngular(n);return this.afs.scheduler.keepUnstableUntilFirst(r)}},{key:"valueChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Uh(this.query),n=this.afs.scheduler.runOutsideAngular(t);return this.afs.scheduler.keepUnstableUntilFirst(n).pipe(F((function(t){return t.payload.docs.map((function(t){return e.idField?Object.assign({},t.data(),_defineProperty({},e.idField,t.id)):t.data()}))})))}},{key:"get",value:function(e){return j(this.query.get(e)).pipe(Zh(this.afs.scheduler.zone))}},{key:"add",value:function(e){return this.ref.add(e)}},{key:"doc",value:function(e){return new nf(this.ref.doc(e),this.afs)}}]),e}(),nf=function(){function e(t,n){_classCallCheck(this,e),this.ref=t,this.afs=n}return _createClass(e,[{key:"set",value:function(e,t){return this.ref.set(e,t)}},{key:"update",value:function(e){return this.ref.update(e)}},{key:"delete",value:function(){return this.ref.delete()}},{key:"collection",value:function(e,t){var n=gf(this.ref.collection(e),t),r=n.ref,o=n.query;return new tf(r,o,this.afs)}},{key:"snapshotChanges",value:function(){var e=jh(this.ref).pipe(F((function(e){return{payload:e,type:"value"}}))),t=this.afs.scheduler.runOutsideAngular(e);return this.afs.scheduler.keepUnstableUntilFirst(t)}},{key:"valueChanges",value:function(){return this.snapshotChanges().pipe(F((function(e){return e.payload.data()})))}},{key:"get",value:function(e){return j(this.ref.get(e)).pipe(Zh(this.afs.scheduler.zone))}}]),e}(),rf=function(){function e(t,n){_classCallCheck(this,e),this.query=t,this.afs=n}return _createClass(e,[{key:"stateChanges",value:function(e){return e&&0!==e.length?this.afs.scheduler.keepUnstableUntilFirst(this.afs.scheduler.runOutsideAngular(Hh(this.query))).pipe(F((function(t){return t.filter((function(t){return e.indexOf(t.type)>-1}))})),fc((function(e){return e.length>0}))):this.afs.scheduler.keepUnstableUntilFirst(this.afs.scheduler.runOutsideAngular(Hh(this.query)))}},{key:"auditTrail",value:function(e){return this.stateChanges(e).pipe(Gh((function(e,t){return[].concat(_toConsumableArray(e),_toConsumableArray(t))}),[]))}},{key:"snapshotChanges",value:function(e){var t=Xh(e),n=Qh(this.query,t),r=this.afs.scheduler.runOutsideAngular(n);return this.afs.scheduler.keepUnstableUntilFirst(r)}},{key:"valueChanges",value:function(){var e=Uh(this.query),t=this.afs.scheduler.runOutsideAngular(e);return this.afs.scheduler.keepUnstableUntilFirst(t).pipe(F((function(e){return e.payload.docs.map((function(e){return e.data()}))})))}},{key:"get",value:function(e){return j(this.query.get(e)).pipe(Zh(this.afs.scheduler.zone))}}]),e}(),of=n("Wcq6"),af=n.n(of),sf=new Be("angularfire2.app.options"),uf=new Be("angularfire2.app.nameOrConfig");function cf(e,t,n){var r="object"==typeof n&&n||{};return r.name=r.name||"string"==typeof n&&n||"[DEFAULT]",af.a.apps.filter((function(e){return e&&e.name===r.name}))[0]||t.runOutsideAngular((function(){return af.a.initializeApp(e,r)}))}var lf,hf={provide:function e(){_classCallCheck(this,e)},useFactory:cf,deps:[sf,ys,[new oe,uf]]},ff=((lf=ef=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"initializeApp",value:function(e,t){return{ngModule:ef,providers:[{provide:sf,useValue:e},{provide:uf,useValue:t}]}}}]),e}()).\u0275mod=pt({type:lf}),lf.\u0275inj=he({factory:function(e){return new(e||lf)},providers:[hf]}),lf),df=new Be("angularfire2.enableFirestorePersistence"),pf=new Be("angularfire2.firestore.persistenceSettings"),yf=new Be("angularfire2.firestore.settings"),vf=parseInt(af.a.SDK_VERSION.split(".")[0]),mf=vf<5||5==vf&&parseInt(af.a.SDK_VERSION.split(".")[1])<8?{timestampsInSnapshots:!0}:{};function gf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return{query:t(e),ref:e}}var bf,_f,wf,Cf,kf,Sf,Ef,Tf,If=((Ef=function(){function e(t,n,r,o,i,a,s){var u=this;_classCallCheck(this,e),this.scheduler=new $h(a,i),this.firestore=a.runOutsideAngular((function(){var e=cf(t,a,n).firestore();return e.settings(o||mf),e})),this.persistenceEnabled$=r&&!Du(i)?a.runOutsideAngular((function(){try{return j(u.firestore.enablePersistence(s||void 0).then((function(){return!0}),(function(){return!1})))}catch(e){return hc(!1)}})):hc(!1)}return _createClass(e,[{key:"collection",value:function(e,t){var n=gf("string"==typeof e?this.firestore.collection(e):e,t),r=n.ref,o=n.query;return new tf(r,o,this)}},{key:"collectionGroup",value:function(e,t){if(vf<6)throw"collection group queries require Firebase JS SDK >= 6.0";var n=t||function(e){return e},r=this.firestore.collectionGroup(e);return new rf(n(r),this)}},{key:"doc",value:function(e){var t;return t="string"==typeof e?this.firestore.doc(e):e,new nf(t,this)}},{key:"createId",value:function(){return this.firestore.collection("_").doc().id}}]),e}()).\u0275fac=function(e){return new(e||Ef)(Ke(sf),Ke(uf,8),Ke(df,8),Ke(yf,8),Ke(Xa),Ke(ys),Ke(pf,8))},Ef.\u0275prov=le({token:Ef,factory:Ef.\u0275fac}),Ef),Af=((Sf=function(){function e(t){_classCallCheck(this,e),this.afs=t,this.laColeccionPaso="provinciaba",this.laColeccionGenerales="provinciaGeneral",this.coleccionProvincias="provincias"}return _createClass(e,[{key:"saveMunicipio",value:function(e){return this.afs.collection(this.laColeccionPaso).add(e)}},{key:"saveMunicipioGenerales",value:function(e){return this.afs.collection(this.laColeccionGenerales).add(e)}},{key:"getMunicipios",value:function(){return this.municipios}},{key:"getMunicipiosPaso",value:function(){return this.afs.collection(this.laColeccionPaso,(function(e){return e.orderBy("idMuni","desc")})).get()}},{key:"getMunicipiosGenerales",value:function(){return this.afs.collection(this.laColeccionGenerales,(function(e){return e.orderBy("idMuni","desc")})).get()}},{key:"editMunicipios",value:function(e,t){return this.afs.collection(this.laColeccionPaso).doc(e).update(t)}},{key:"editMunicipiosGenerales",value:function(e,t){return this.afs.collection(this.laColeccionGenerales).doc(e).update(t)}}]),e}()).\u0275fac=function(e){return new(e||Sf)(Ke(If))},Sf.\u0275prov=le({token:Sf,factory:Sf.\u0275fac,providedIn:"root"}),Sf),Df=((kf=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getPartidos",value:function(e,t){return this.capaPartidos=L.geoJson(e,{filter:function(e){return""==t||e.properties.nam===t||void 0},style:function(e){return{color:"rgba(230, 230, 0, 1.0)",weight:1.5,opacity:1.4}},onEachFeature:function(e,t){var n="",r=0,o="";t.bindPopup('\n        <table class="table table-striped table-borderless table-sm" style="font-family: \'Arial Narrow\'">\n          <thead class="thead-dark">\n            <tr>\n              <th scope="col" class="text-center">Partido</th>\n              <th scope="col" class="text-center">Superficie km2</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td class="text-center">'.concat(e.properties.fna,'</td>  \n              <td class="text-center">').concat(e.properties.arl,"</td>\n            </tr>\n          </tbody>\n        </table>\n      ")),t.on({mouseover:function(i){n=i.target.options.color,r=i.target.options.weight,o=i.target.options.fillColor,t.setStyle({color:"rgba(0,255,0,0.5)",weight:4,fillColor:"#cc9900"});var a=i.target,s=L.tooltip({position:"bottom",noWrap:!0,offset:[0,-30],sticky:!0,opacity:.8}).setContent("<b>Pdo:</b>"+e.properties.fna).setLatLng(i.latlng);a.bindTooltip(s)},mouseout:function(e){t.setStyle({color:n,weight:r,fillColor:o})}})},pane:"partidos"}),this.capaPartidos}}]),e}()).\u0275fac=function(e){return new(e||kf)},kf.\u0275prov=le({token:kf,factory:kf.\u0275fac,providedIn:"root"}),kf),Nf=((Cf=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getEscuelas",value:function(e,t){var n={radius:4,fillColor:"#ff7800",color:"#000",weight:1,opacity:1,fillOpacity:.6},r={radius:8,fillColor:"#ff0800",color:"#ff0000",weight:1,opacity:.3,fillOpacity:.6};return this.capaEscuelas=L.geoJson(e,{pointToLayer:function(e,t){return L.circleMarker(t,n)},filter:function(e){return""==t||e.properties.partido===t||void 0},onEachFeature:function(e,t){t.bindPopup('\n        <table class="table table-striped table-borderless table-sm" style="font-family: \'Arial Narrow\'">\n          <thead class="thead-dark">\n            <tr>\n              <th scope="col" class="text-center">Nombre</th>\n              <th scope="col" class="text-center">Direccion</th>\n              <th scope="col" class="text-center">Partido</th>\n              <th scope="col" class="text-center">Tipo Organiz.</th>\n              <th scope="col" class="text-center">Gesti\xf3n</th>\n              <th scope="col" class="text-center">Modalidad</th>\n              <th scope="col" class="text-center">Nivel</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td class="text-center">'.concat(e.properties.nombre,'</td>  \n              <td class="text-center">').concat(e.properties.direccion_calle," nro ").concat(e.properties.direccion_nro,'</td>\n              <td class="text-center">').concat(e.properties.partido,'</td>\n              <td class="text-center">').concat(e.properties.tipo_organiz,'</td>\n              <td class="text-center">').concat(e.properties.sector_gestion,'</td>\n              <td class="text-center">').concat(e.properties.modalidad,'</td>\n              <td class="text-center">').concat(e.properties.nivel,"</td>\n            </tr>\n          </tbody>\n        </table>\n      "),{maxWidth:400}),t.on({mouseover:function(n){n.target.options.color,n.target.options.weight,n.target.options.fillColor,t.setStyle(r);var o=n.target,i=L.tooltip({position:"bottom",noWrap:!0,offset:[0,-30],sticky:!0,opacity:.8}).setContent("<b>Nombre:</b>"+e.properties.nombre).setLatLng(n.latlng);o.bindTooltip(i)},mouseout:function(e){t.setStyle(n)}})}}),this.capaEscuelas}}]),e}()).\u0275fac=function(e){return new(e||Cf)},Cf.\u0275prov=le({token:Cf,factory:Cf.\u0275fac,providedIn:"root"}),Cf),Pf=((wf=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getCircuitosDepurado",value:function(e,t){return this.capaCircuitos=L.geoJson(e,{filter:function(e){return""==t||e.properties.departamen===t||void 0},style:function(e){return{color:"rgb(255, 32, 0)",weight:.5,opacity:.6,fillColor:"#000000",fillOpacity:.1}},onEachFeature:function(e,t){var n="",r=0,o="";t.bindPopup('\n        <table class="table table-striped table-borderless table-sm" style="font-family: \'Arial Narrow\'">\n          <thead class="thead-dark">\n            <tr>\n              <th scope="col" class="text-center">Partido</th>\n              <th scope="col" class="text-center">Municipio</th>\n              <th scope="col" class="text-center">Circuito</th>\n              <th scope="col" class="text-center">Indec_d(?)</th>\n              <th scope="col" class="text-center">gid</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td class="text-center">'.concat(e.properties.departamen,'</td>  \n              <td class="text-center">').concat(e.properties.cabecera,'</td>\n              <td class="text-center">').concat(e.properties.circuito,'</td>\n              <td class="text-center">').concat(e.properties.indec_d,'</td>\n              <td class="text-center">').concat(e.properties.gid,"</td>\n            </tr>\n          </tbody>\n        </table>\n      ")),t.on({mouseover:function(i){n=i.target.options.color,r=i.target.options.weight,o=i.target.options.fillColor,t.setStyle({color:"rgba(0,255,0,0.5)",weight:4,fillColor:"#cc9900"});var a=i.target,s=L.tooltip({position:"bottom",noWrap:!0,offset:[0,-30],sticky:!0,opacity:.8}).setContent("<b>Pdo:</b>"+e.properties.departamen).setLatLng(i.latlng);a.bindTooltip(s)},mouseout:function(e){t.setStyle({color:n,weight:r,fillColor:o})}})},pane:"circuitos"}),this.capaCircuitos}}]),e}()).\u0275fac=function(e){return new(e||wf)},wf.\u0275prov=le({token:wf,factory:wf.\u0275fac,providedIn:"root"}),wf),xf=((_f=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getWfs",value:function(e,t){return this.capaIgn=L.geoJson(e,{filter:function(e){return""==t||e.properties.gna===t||void 0},style:function(e){return{color:"rgba(51, 102, 0, 0.5)",weight:8.5,opacity:.4}},onEachFeature:function(e,t){var n="",r=0,o="";t.bindPopup('\n        <table class="table table-striped table-borderless table-sm" style="font-family: \'Arial Narrow\'">\n          <thead class="thead-dark">\n            <tr>\n              <th scope="col" class="text-center">Partido</th>\n              <th scope="col" class="text-center">C\xf3digo</th>\n              <th scope="col" class="text-center">Origen del dato</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td class="text-center">'.concat(e.properties.fna,'</td>  \n              <td class="text-center">').concat(e.properties.in1,'</td>\n              <td class="text-center">').concat(e.properties.sag,"</td>\n            </tr>\n          </tbody>\n        </table>\n      ")),t.on({mouseover:function(i){n=i.target.options.color,r=i.target.options.weight,o=i.target.options.fillColor,t.setStyle({color:"rgba(0,255,0,0.5)",weight:4,fillColor:"#cc9900"});var a=i.target,s=L.tooltip({position:"bottom",noWrap:!0,offset:[0,-30],sticky:!0,opacity:.8}).setContent("<b>Pdo:</b>"+e.properties.fna).setLatLng(i.latlng);a.bindTooltip(s)},mouseout:function(e){t.setStyle({color:n,weight:r,fillColor:o})}})},pane:"partidos"}),this.capaIgn}}]),e}()).\u0275fac=function(e){return new(e||_f)},_f.\u0275prov=le({token:_f,factory:_f.\u0275fac,providedIn:"root"}),_f),Of=((bf=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getCapaRenabap",value:function(e,t){return this.capaRenabap=L.geoJson(e,{filter:function(e){return""==t||e.properties.nam===t||void 0},style:function(e){return{color:"rgba(51, 102, 0, 1.0)",weight:2.5,opacity:1.4}},onEachFeature:function(e,t){var n="",r=0,o="";t.bindPopup('\n        <div style="margin-top: 5px;">\n          <h5>Info</h5>\n          <ul class="list-group" style="height: 8rem; overflow:auto;">\n            <li class="list-group-item"><b>Provincia</b>: '.concat(e.properties.provincia,'</li>\n            <li class="list-group-item"><b>Departamento</b>: ').concat(e.properties.departamen,'</li>\n            <li class="list-group-item"><b>Localidad</b>: ').concat(e.properties.localidad,'</li>\n            <li class="list-group-item"><b>Municipio</b>: ').concat(e.properties.municipio2018,'</li>\n            <li class="list-group-item"><b>Nombre barrio</b>: ').concat(e.properties.nombre_bar,'</li>\n            <li class="list-group-item"><b>Familias</b>: ').concat(e.properties.cantidad_f,'</li>\n            <li class="list-group-item"><b>Creaci\xf3n</b>: ').concat(e.properties.creacionBarrio2018,'</li>\n            <li class="list-group-item"><b>Superficie</b>: ').concat(e.properties.superficie_m2_2018,' m2</li>\n            <li class="list-group-item"><b>Clasificaci\xf3n</b>: ').concat(e.properties.clasificacionBarrio2018,' </li>\n            <li class="list-group-item text-justify"><b>Situaci\xf3n dominial</b>: ').concat(e.properties.situacionDominial2018,' </li>\n            <li class="list-group-item text-justify"><b>Tipo tierra</b>: ').concat(e.properties.tipoTierra2018,' </li>\n            <li class="list-group-item text-justify"><b>Electricidad</b>: ').concat(e.properties.electricidad2018,' </li>\n            <li class="list-group-item text-justify"><b>Cloacas</b>: ').concat(e.properties.cloacas2018,' </li>\n            <li class="list-group-item text-justify"><b>Agua</b>: ').concat(e.properties.agua2018,' </li>\n            <li class="list-group-item text-justify"><b>Cocina</b>: ').concat(e.properties.cocina2018,' </li>\n            <li class="list-group-item text-justify"><b>Calefacci\xf3n</b>: ').concat(e.properties.calefaccion2018,' </li>\n            <li class="list-group-item text-justify"><b>Precariedad</b>: ').concat(e.properties.precariedad2019,' </li>\n          </ul>\n          <br>\n          <span class="text-justify" style="margin-top:5px; font-size:12px; font-style: italic;">\n          <b>Fuente:</b><br>\n            <ul> \n              <li>ReNaBap (https://www.argentina.gob.ar/barriospopulares). Ultima actualizaci\xf3n: 9 de nov. de 2018</li>\n              <li>TECHO (http://datos.techo.org/dataset)</li>\n            </ul>\n          </span>\n        </div>\n      ')),t.on({mouseover:function(i){n=i.target.options.color,r=i.target.options.weight,o=i.target.options.fillColor,t.setStyle({color:"rgba(0,255,0,0.5)",weight:4,fillColor:"#cc9900"});var a=i.target,s=L.tooltip({position:"bottom",noWrap:!0,offset:[0,-30],sticky:!0,opacity:.8}).setContent("<b>Pdo:</b>"+e.properties.departamen).setLatLng(i.latlng);a.bindTooltip(s)},mouseout:function(e){t.setStyle({color:n,weight:r,fillColor:o})}})},pane:"partidos"}),this.capaRenabap}}]),e}()).\u0275fac=function(e){return new(e||bf)},bf.\u0275prov=le({token:bf,factory:bf.\u0275fac,providedIn:"root"}),bf),Mf=function(e){return e[e["Sin datos"]=0]="Sin datos",e[e["Frente de todos"]=1]="Frente de todos",e[e["Juntos por el cambio"]=2]="Juntos por el cambio",e[e["Consenso federal"]=3]="Consenso federal",e[e.Otro=4]="Otro",e}({}),Rf=((Tf=function(){function e(){_classCallCheck(this,e),this.usuario="An\xf3nimo"}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"onSubmitLogin",value:function(){console.log("Nada por ahora...")}}]),e}()).\u0275fac=function(e){return new(e||Tf)},Tf.\u0275cmp=lt({type:Tf,selectors:[["app-usuario"]],decls:37,vars:1,consts:[["data-toggle","collapse","data-target","#menuUsuario",1,"btn","btn-link","btn-sm","botonMenu"],["src","assets/iconos/user.png","alt","","width","20px;",2,"background-color","white"],["id","menuUsuario",1,"collapse","card"],[1,"card-header","text-center"],[1,"list-group","list-group-flush"],[1,"list-group-item"],["src","assets/iconos/login3.png","alt","","width","20px;","data-toggle","modal","data-target","#exampleModal"],["data-toggle","modal","data-target","#exampleModal"],[1,"card-footer","text-muted"],["src","assets/iconos/logout.png","alt","","width","20px;",1,"mr-2"],["id","exampleModal","role","dialog","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[3,"submit"],[1,"form-group"],["for","email"],["type","email","name","email","id","email",1,"form-control"],["elCorreo",""],["for","password"],["type","password","name","password","id","password",1,"form-control"],["laClave",""],["type","submit","value","Enviar",1,"btn","btn-primary","btn-sm","btn-block"],[1,"modal-footer"]],template:function(e,t){1&e&&(fi(0,"button",0),pi(1,"img",1),di(),fi(2,"div",2),fi(3,"div",3),Pi(4),di(),fi(5,"ul",4),fi(6,"li",5),pi(7,"img",6),fi(8,"span",7),Pi(9,"Login"),di(),di(),di(),fi(10,"div",8),pi(11,"img",9),fi(12,"span"),Pi(13,"Logout"),di(),di(),di(),fi(14,"div",10),fi(15,"div",11),fi(16,"div",12),fi(17,"div",13),fi(18,"h5",14),Pi(19,"Conectarse"),di(),fi(20,"button",15),fi(21,"span",16),Pi(22,"\xd7"),di(),di(),di(),fi(23,"div",17),fi(24,"form",18),mi("submit",(function(e){return t.onSubmitLogin()})),fi(25,"div",19),fi(26,"label",20),Pi(27,"email"),di(),pi(28,"input",21,22),di(),fi(30,"div",19),fi(31,"label",23),Pi(32,"Contrase\xf1a"),di(),pi(33,"input",24,25),di(),pi(35,"input",26),di(),di(),pi(36,"div",27),di(),di(),di()),2&e&&(fr(4),Oi(" Usuario:",t.usuario," "))},directives:[Fh,Cl,Ah],styles:["div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], img[_ngcontent-%COMP%]:hover, span[_ngcontent-%COMP%]{cursor:pointer}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:rgba(226,216,216,.5)}.card-footer[_ngcontent-%COMP%], .card-header[_ngcontent-%COMP%], .list-group-item[_ngcontent-%COMP%]{background-color:#fff}@media (min-width:576px){.botonMenu[_ngcontent-%COMP%]{z-index:450}#menuUsuario[_ngcontent-%COMP%]{position:absolute;right:10rem}}@media (max-width:575.98px){.botonMenu[_ngcontent-%COMP%]{z-index:450}#menuUsuario[_ngcontent-%COMP%]{z-index:450;top:-3rem;left:45px}}"]}),Tf);function Lf(e,t){if(1&e&&(fi(0,"option"),Pi(1),di()),2&e){var n=t.$implicit;fr(1),xi(n)}}function Ff(e,t){if(1&e&&(fi(0,"option"),Pi(1),di()),2&e){var n=t.$implicit;fr(1),xi(n)}}function Vf(e,t){if(1&e&&(fi(0,"option"),Pi(1),di()),2&e){var n=t.$implicit;fr(1),xi(n)}}var Bf,qf,jf=((qf=function(){function e(t){_classCallCheck(this,e),this.servicioDatos=t,this.listadoPartidos=[],this.seleccionMenuNavBar=new Ha}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"menuSeleccionado",value:function(e,t){this.seleccionMenuNavBar.emit({seleccion:e,partido:t})}},{key:"buscarPartido",value:function(){var e=this;this.listadoPartidos.length>0||this.servicioDatos.buscarGeoJsonPartidos().subscribe((function(t){var n=0;t.features.forEach((function(t){e.listadoPartidos[n]=t.properties.nam,n+=1,e.listadoPartidos.sort()}))}))}}]),e}()).\u0275fac=function(e){return new(e||qf)(ci(qh))},qf.\u0275cmp=lt({type:qf,selectors:[["app-bnavega"]],outputs:{seleccionMenuNavBar:"seleccionMenuNavBar"},decls:143,vars:6,consts:[[1,"container"],[1,"navbar","navbar-expand-lg","navbar-light","bg-light","laNavBar"],["href","#",1,"navbar-brand"],["type","button","data-toggle","collapse","data-target","#navbarSupportedContent","aria-controls","navbarSupportedContent","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarSupportedContent",1,"collapse","navbar-collapse"],[1,"navbar-nav","mr-auto"],[1,"nav-item","dropdown"],["href","#","id","navbarDropdown","role","button","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"nav-link","dropdown-toggle","mt-3"],["aria-labelledby","navbarDropdown",1,"dropdown-menu"],["type","button",1,"dropdown-item",3,"click"],["src","assets/iconos/elecciones.png","alt","","width","20px;",1,"mr-2"],["type","button","data-toggle","collapse","data-target","#resumenPaso",1,"dropdown-item","flip"],["src","assets/iconos/resumen.png","alt","","width","20px;",1,"mr-2"],["src","assets/iconos/circuitoElectoral.png","alt","","width","20px;",1,"mr-2"],[1,"nav-item"],["href","#","title","Relevamiento Nacional de barrios populares",1,"nav-link",3,"click"],[1,"row"],[1,"col","offset-4"],["src","assets/iconos/estadisticas1.png","alt","","width","18px;",1,"mr-2"],[1,"col"],["href","#","data-toggle","collapse","data-target","#buscaPartido",1,"nav-link",3,"click"],["src","assets/iconos/partidos3.png","alt","","width","18px;",1,"mr-2"],["href","#","data-toggle","collapse","data-target","#buscaEscuela",1,"nav-link",3,"click"],["src","assets/iconos/escuela4.png","alt","","width","18px;",1,"mr-2"],["href","#","data-toggle","collapse","data-target","#buscaCircuito",1,"nav-link",3,"click"],["src","assets/iconos/circuitoElectoral.png","alt","","width","18px;",1,"mr-2"],["href","#","data-toggle","collapse","data-target","#fila",1,"nav-link"],[1,"col","offset-3"],["src","assets/iconos/geoloca0.png","alt","","width","15px;",1,"mr-2"],["href","#","data-toggle","collapse","data-target","#capaWFS",1,"nav-link"],["src","assets/iconos/capaWFS.png","alt","","width","15px;",1,"mr-2"],["href","#","data-toggle","collapse","data-target","#corona",1,"nav-link"],["src","assets/iconos/virus1.png","alt","","width","15px;",1,"mr-2"],[1,"mt-2","ml-3"],["id","buscaCircuito",1,"card","collapse",2,"position","absolute","z-index","2000","width","18rem"],[1,"card-body"],["type","button","data-toggle","collapse","data-target","#buscaCircuito",1,"close"],[1,"card-title"],[1,"form-group"],["for","selectCircuito"],["id","selectCircuito",1,"form-control",3,"ngModel","ngModelChange","change"],[4,"ngFor","ngForOf"],["id","buscaPartido",1,"card","collapse",2,"position","absolute","z-index","2000","width","18rem"],["type","button","data-toggle","collapse","data-target","#buscaPartido",1,"close"],["for","selectPartido"],["id","selectPartido",1,"form-control",3,"ngModel","ngModelChange","change"],["id","buscaEscuela",1,"card","collapse",2,"position","absolute","z-index","2000","width","18rem"],["type","button","data-toggle","collapse","data-target","#buscaEscuela",1,"close"],["for","selectEscuela"],["id","selectEscuela",1,"form-control",3,"ngModel","ngModelChange","change"],["id","capaWFS",1,"card","collapse","ml-5",2,"position","absolute","z-index","2000","width","15rem"],[1,"card-header"],[1,"card-title","h5"],["type","button","data-toggle","collapse","data-target","#capaWFS",1,"close"],[1,"form-group","form-group-sm"],[1,"input-group","input-group-sm"],[1,"input-group-prepend","input-group-prepend-sm"],["id","cargarWfsIgn",1,"input-group-text","ml-3"],["id","cargarWfsIgn",1,"btn","btn-info","btn-sm",3,"click"],[1,"fa","fa-check"]],template:function(e,t){1&e&&(fi(0,"div",0),fi(1,"nav",1),fi(2,"a",2),Pi(3,"Argengis"),di(),fi(4,"button",3),pi(5,"span",4),di(),fi(6,"div",5),fi(7,"ul",6),fi(8,"li",7),fi(9,"a",8),Pi(10," Men\xfa "),di(),fi(11,"div",9),fi(12,"button",10),mi("click",(function(e){return t.menuSeleccionado("paso2019")})),pi(13,"img",11),Pi(14," Elecc. Paso 2019 "),di(),fi(15,"button",12),pi(16,"img",13),Pi(17," Resum\xe9n Paso 2019 "),di(),fi(18,"button",10),mi("click",(function(e){return t.menuSeleccionado("generales2019")})),pi(19,"img",11),Pi(20," Elecc.Grales.2019 "),di(),fi(21,"button",10),mi("click",(function(e){return t.menuSeleccionado("circuitos")})),pi(22,"img",14),Pi(23," Circ. electorales (todos) "),di(),fi(24,"button",10),mi("click",(function(e){return t.menuSeleccionado("leerPartidos")})),pi(25,"img",14),Pi(26," Part.Pcia. Bs. As. (todos) "),di(),di(),di(),fi(27,"li",15),fi(28,"a",16),mi("click",(function(e){return t.menuSeleccionado("renabap")})),fi(29,"div",17),fi(30,"div",18),pi(31,"img",19),di(),di(),fi(32,"div",17),fi(33,"div",20),Pi(34," Renabap "),di(),di(),di(),di(),fi(35,"li",15),fi(36,"a",21),mi("click",(function(e){return t.buscarPartido()})),fi(37,"div",17),fi(38,"div",18),pi(39,"img",22),di(),di(),fi(40,"div",17),fi(41,"div",20),Pi(42," Partidos Pcia.Bs.As. "),di(),di(),di(),di(),fi(43,"li",15),fi(44,"a",23),mi("click",(function(e){return t.buscarPartido()})),fi(45,"div",17),fi(46,"div",18),pi(47,"img",24),di(),di(),fi(48,"div",17),fi(49,"div",20),Pi(50," Escuelas Pcia.Bs.As. "),di(),di(),di(),di(),fi(51,"li",15),fi(52,"a",25),mi("click",(function(e){return t.buscarPartido()})),fi(53,"div",17),fi(54,"div",18),pi(55,"img",26),di(),di(),fi(56,"div",17),fi(57,"div",20),Pi(58," Circ. Elect. Pcia.Bs.As. "),di(),di(),di(),di(),fi(59,"li",15),fi(60,"a",27),fi(61,"div",17),fi(62,"div",28),pi(63,"img",29),di(),di(),fi(64,"div",17),fi(65,"div",20),Pi(66," Geolocalizar "),di(),di(),di(),di(),fi(67,"li",15),fi(68,"a",30),fi(69,"div",17),fi(70,"div",28),pi(71,"img",31),di(),di(),fi(72,"div",17),fi(73,"div",20),Pi(74," Capas WFS "),di(),di(),di(),di(),fi(75,"li",15),fi(76,"a",32),fi(77,"div",17),fi(78,"div",28),pi(79,"img",33),di(),di(),fi(80,"div",17),fi(81,"div",20),Pi(82," Coronavirus "),di(),di(),di(),di(),fi(83,"li",15),fi(84,"div",34),pi(85,"app-usuario"),di(),di(),di(),di(),di(),di(),fi(86,"div",35),fi(87,"div",36),fi(88,"button",37),fi(89,"span"),Pi(90,"\xd7"),di(),di(),fi(91,"h5",38),Pi(92,"Buscar circuito electoral"),di(),fi(93,"div",39),fi(94,"label",40),Pi(95,"Desplegar para selecc."),di(),fi(96,"select",41),mi("ngModelChange",(function(e){return t.partidoSeleccionadoParaCircuito=e}))("change",(function(e){return t.menuSeleccionado("unPartido",t.partidoSeleccionadoParaCircuito)})),fi(97,"option"),Pi(98,"Seleccionar un partido"),di(),ui(99,Lf,2,1,"option",42),di(),di(),di(),di(),fi(100,"div",43),fi(101,"div",36),fi(102,"button",44),fi(103,"span"),Pi(104,"\xd7"),di(),di(),fi(105,"h5",38),Pi(106,"Buscar partidos"),di(),fi(107,"div",39),fi(108,"label",45),Pi(109,"Desplegar para seleccionar"),di(),fi(110,"select",46),mi("ngModelChange",(function(e){return t.partidoSeleccionado=e}))("change",(function(e){return t.menuSeleccionado("unPartidoPartido",t.partidoSeleccionado)})),fi(111,"option"),Pi(112,"Seleccionar un partido"),di(),ui(113,Ff,2,1,"option",42),di(),di(),di(),di(),fi(114,"div",47),fi(115,"div",36),fi(116,"button",48),fi(117,"span"),Pi(118,"\xd7"),di(),di(),fi(119,"h5",38),Pi(120,"Buscar escuelas por partido"),di(),fi(121,"div",39),fi(122,"label",49),Pi(123,"Desplegar para selecc."),di(),fi(124,"select",50),mi("ngModelChange",(function(e){return t.partidoSeleccionadoParaEscuela=e}))("change",(function(e){return t.menuSeleccionado("unaEscuela",t.partidoSeleccionadoParaEscuela)})),fi(125,"option"),Pi(126,"Seleccionar un partido"),di(),ui(127,Vf,2,1,"option",42),di(),di(),di(),di(),fi(128,"div",51),fi(129,"div",52),fi(130,"span",53),Pi(131,"Capas WFS"),di(),fi(132,"button",54),fi(133,"span"),Pi(134,"\xd7"),di(),di(),di(),fi(135,"div",36),fi(136,"div",55),fi(137,"div",56),fi(138,"div",57),fi(139,"span",58),Pi(140,"IGN, capa partidos"),di(),di(),fi(141,"button",59),mi("click",(function(e){return t.menuSeleccionado("partidosIgn")})),pi(142,"i",60),di(),di(),di(),di(),di()),2&e&&(fr(96),li("ngModel",t.partidoSeleccionadoParaCircuito),fr(3),li("ngForOf",t.listadoPartidos),fr(11),li("ngModel",t.partidoSeleccionado),fr(3),li("ngForOf",t.listadoPartidos),fr(11),li("ngModel",t.partidoSeleccionadoParaEscuela),fr(3),li("ngForOf",t.listadoPartidos))},directives:[Rf,Jl,wl,Lh,$l,rh,Eu],styles:["@media (min-width:576px){.laNavBar[_ngcontent-%COMP%]{position:relative;z-index:450}}@media (max-width:575.98px){.laNavBar[_ngcontent-%COMP%]{position:relative;z-index:450;margin-left:30px}}"]}),qf),Uf=((Bf=function(){function e(t){_classCallCheck(this,e),this.http=t}return _createClass(e,[{key:"getData",value:function(e){var t="https://apis.datos.gob.ar/georef/api/direcciones?direccion="+e;return console.log("La url qued\xf3: ",t),this.http.get(t)}}]),e}()).\u0275fac=function(e){return new(e||Bf)(Ke(qc))},Bf.\u0275prov=le({token:Bf,factory:Bf.\u0275fac,providedIn:"root"}),Bf);function Gf(e,t){if(1&e){var n=yi();fi(0,"a",14),mi("click",(function(e){return Pt(n),_i().busquedasGuardadas(e)})),Pi(1),di()}if(2&e){var r=t.$implicit,o=t.index;fr(1),Mi("",o," - ",r,"")}}function zf(e,t){if(1&e){var n=yi();fi(0,"button",15),mi("click",(function(e){return Pt(n),_i().atajar(e)})),Pi(1),di()}if(2&e){var r=t.$implicit,o=t.index;fr(1),Mi("",o," - ",r,"")}}var Wf,Hf,Qf=((Hf=function(){function e(t){_classCallCheck(this,e),this.buscaDirecc=t,this.listado=[],this.coordenadas=[],this.valorTexto="",this.vectorBusquedasGuardadas=[],this.vectorBusquedas=[],this.contador=0,this.infoBuscar="Buscar con la API de la Secretaria de Modernizaci\xf3n de la Naci\xf3n https://datos.gob.ar/apis",this.eventoMarcador=new Ha}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"buscaLugar",value:function(e){var t=this;this.listado=[],this.coordenadas=[];var n=e;this.buscaDirecc.getData(n).subscribe((function(e){console.log("Se busc\xf3: ",n,", y el servicio respondi\xf3: ",e),console.log("cantidad de elementos:",e.cantidad);var r=!0,o=!1,i=void 0;try{for(var a,s=e.direcciones[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;console.log("altura valor: ",u.altura.valor),console.log("calle nombre: ",u.calle.nombre),console.log("calle cruce 1: ",u.calle_cruce_1.nombre),console.log("calle cruce 2: ",u.calle_cruce_2.nombre),console.log("departamento: ",u.departamento.nombre),console.log("nomenclatura: ",u.nomenclatura),console.log("piso: ",u.piso),console.log("provincia: ",u.provincia.nombre),console.log("ubicacion lat: ",u.ubicacion.lat),console.log("ubicacion lon: ",u.ubicacion.lon),null!==u.ubicacion.lat&&(t.listado.push(u.nomenclatura),t.coordenadas.push(u.ubicacion.lat+", "+u.ubicacion.lon))}}catch(c){o=!0,i=c}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}console.log(t.listado),console.log(t.coordenadas)}))}},{key:"recargar",value:function(){location.reload()}},{key:"atajar",value:function(e){var t=e.currentTarget.childNodes[0].data.split("-"),n=t[0].trim(),r=t[1].trim(),o=this.coordenadas[n],i=o.split(","),a=i[0].trim(),s=i[1].trim(),u=parseFloat(a),c=parseFloat(s);this.latLon={lat:u,lon:c,texto:r},this.contador=this.contador+1,this.vectorBusquedas.push(r),this.eventoMarcador.emit(this.latLon),this.vectorBusquedasGuardadas.push({epsg:"",categoria:"",origin:"",geometry:o,nombre:r}),console.log("vector busquedas guardadas:",this.vectorBusquedasGuardadas),this.listado=[],this.coordenadas=[],this.valorTexto=""}},{key:"keyDownFunction",value:function(e){this.buscaLugar(this.valorTexto)}},{key:"busquedasGuardadas",value:function(e){var t=e.currentTarget.childNodes[0].data.split("-")[1].trim(),n=!0,r=!1,o=void 0;try{for(var i,a=this.vectorBusquedasGuardadas[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;if(s.nombre==t){var u=s.geometry.split(","),c=u[0].trim(),l=u[1].trim(),h=parseFloat(c),f=parseFloat(l);this.latLon={lat:h,lon:f,texto:t},this.eventoMarcador.emit(this.latLon)}}}catch(d){r=!0,o=d}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}}]),e}()).\u0275fac=function(e){return new(e||Hf)(ci(Uf))},Hf.\u0275cmp=lt({type:Hf,selectors:[["app-usa-api"]],outputs:{eventoMarcador:"eventoMarcador"},decls:16,vars:5,consts:[[1,"container"],[1,"row"],[1,"col","d-flex","justify-content-start"],[1,"dropdown"],["type","button","id","navbarDropdown","data-toggle","dropdown",1,"btn","btn-info","btn-sm","dropdown-toggle","mb-1"],[1,"fa","fa-undo"],[1,"badge","badge-pill","badge-info"],["aria-labelledby","navbarDropdown",1,"dropdown-menu","mt-5"],["class","dropdown-item","href","#","style","font-size: small;",3,"click",4,"ngFor","ngForOf"],[1,"col"],["type","text","placeholder","S.Modern.","aria-label","Search","data-toggle","tooltip","data-placement","top",1,"form-control","form-control-sm","mb-1",2,"font-size","small","max-height","2rem","border-color","#0dc6df","width","11rem",3,"ngModel","title","ngModelChange","keydown"],["direbuscar",""],[1,"list-group"],["type","button","class","list-group-item list-group-item-action",3,"click",4,"ngFor","ngForOf"],["href","#",1,"dropdown-item",2,"font-size","small",3,"click"],["type","button",1,"list-group-item","list-group-item-action",3,"click"]],template:function(e,t){1&e&&(fi(0,"div",0),fi(1,"div",1),fi(2,"div",2),fi(3,"div",3),fi(4,"button",4),pi(5,"i",5),fi(6,"span",6),Pi(7),di(),di(),fi(8,"div",7),ui(9,Gf,2,2,"a",8),di(),di(),di(),fi(10,"div",9),fi(11,"input",10,11),mi("ngModelChange",(function(e){return t.valorTexto=e}))("keydown",(function(e){return t.keyDownFunction(e)})),di(),di(),di(),di(),fi(13,"div",1),fi(14,"ul",12),ui(15,zf,2,2,"button",13),di(),di()),2&e&&(fr(7),xi(t.contador),fr(2),li("ngForOf",t.vectorBusquedas),fr(2),wi("title",t.infoBuscar),li("ngModel",t.valorTexto),fr(4),li("ngForOf",t.listado))},directives:[Eu,fl,wl,Lh],styles:["*[_ngcontent-%COMP%]{position:relative;z-index:2000}"]}),Hf),Kf=((Wf=function(){function e(t){_classCallCheck(this,e),this.http=t}return _createClass(e,[{key:"getData",value:function(e){return this.http.get("https://us1.locationiq.org/v1/search.php?key=7c041d46548c08&q="+e+"&format=json")}}]),e}()).\u0275fac=function(e){return new(e||Wf)(Ke(qc))},Wf.\u0275prov=le({token:Wf,factory:Wf.\u0275fac,providedIn:"root"}),Wf);function Yf(e,t){if(1&e){var n=yi();fi(0,"a",14),mi("click",(function(e){return Pt(n),_i().busquedasGuardadas(e)})),Pi(1),di()}if(2&e){var r=t.$implicit,o=t.index;fr(1),Mi("",o," - ",r,"")}}function Jf(e,t){if(1&e){var n=yi();fi(0,"button",15),mi("click",(function(e){return Pt(n),_i().atajar(e)})),Pi(1),di()}if(2&e){var r=t.$implicit,o=t.index;fr(1),Mi("",o," - ",r,"")}}var $f,Zf,Xf,ed,td,nd=((td=function(){function e(t){_classCallCheck(this,e),this.buscaDirecc=t,this.valorTexto="",this.listado=[],this.coordenadas=[],this.vectorBusquedasGuardadas=[],this.vectorBusquedas=[],this.contador=0,this.infoBuscar="Buscar con Location Iq: https://locationiq.com/",this.eventoMarcador=new Ha}return _createClass(e,[{key:"keyDownFunction",value:function(e){this.buscaLugar(this.valorTexto)}},{key:"buscaLugar",value:function(e){var t=this;this.listado=[],this.coordenadas=[],this.buscaDirecc.getData(e).subscribe((function(e){var n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;t.listado.push(s.display_name),t.coordenadas.push(s.lat+", "+s.lon)}}catch(u){r=!0,o=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}))}},{key:"atajar",value:function(e){var t=e.currentTarget.childNodes[0].data.split("-"),n=t[0].trim(),r=t[1].trim(),o=this.coordenadas[n],i=o.split(","),a=i[0].trim(),s=i[1].trim(),u=parseFloat(a),c=parseFloat(s);this.latLon={lat:u,lon:c,texto:r},this.contador=this.contador+1,this.vectorBusquedas.push(r),this.eventoMarcador.emit(this.latLon),this.vectorBusquedasGuardadas.push({epsg:"",categoria:"",origin:"",geometry:o,nombre:r}),console.log("vector busquedas guardadas:",this.vectorBusquedasGuardadas),this.listado=[],this.coordenadas=[],this.valorTexto=""}},{key:"busquedasGuardadas",value:function(e){var t=e.currentTarget.childNodes[0].data.split("-")[1].trim(),n=!0,r=!1,o=void 0;try{for(var i,a=this.vectorBusquedasGuardadas[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;if(s.nombre==t){var u=s.geometry.split(","),c=u[0].trim(),l=u[1].trim(),h=parseFloat(c),f=parseFloat(l);this.latLon={lat:h,lon:f,texto:t},this.eventoMarcador.emit(this.latLon)}}}catch(d){r=!0,o=d}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}}]),e}()).\u0275fac=function(e){return new(e||td)(ci(Kf))},td.\u0275cmp=lt({type:td,selectors:[["app-usa-api-location-iq"]],outputs:{eventoMarcador:"eventoMarcador"},decls:16,vars:5,consts:[[1,"container"],[1,"row"],[1,"col","d-flex","justify-content-start"],[1,"dropdown"],["type","button","id","navbarDropdown","data-toggle","dropdown",1,"btn","btn-success","btn-sm","dropdown-toggle"],[1,"fa","fa-undo"],[1,"badge","badge-pill","badge-success"],["aria-labelledby","navbarDropdown",1,"dropdown-menu","mt-1"],["class","dropdown-item","href","#","style","font-size: small;",3,"click",4,"ngFor","ngForOf"],[1,"col","d-flex","justify-content-end"],["type","text","placeholder","LocationIq","aria-label","Search","data-toggle","tooltip","data-placement","top",1,"form-control","form-control-sm",2,"font-size","small","border-color","#00b300","width","11rem",3,"ngModel","title","ngModelChange","keydown"],["direbuscar",""],[1,"list-group"],["type","button","class","list-group-item list-group-item-action",3,"click",4,"ngFor","ngForOf"],["href","#",1,"dropdown-item",2,"font-size","small",3,"click"],["type","button",1,"list-group-item","list-group-item-action",3,"click"]],template:function(e,t){1&e&&(fi(0,"div",0),fi(1,"div",1),fi(2,"div",2),fi(3,"div",3),fi(4,"button",4),pi(5,"i",5),fi(6,"span",6),Pi(7),di(),di(),fi(8,"div",7),ui(9,Yf,2,2,"a",8),di(),di(),di(),fi(10,"div",9),fi(11,"input",10,11),mi("ngModelChange",(function(e){return t.valorTexto=e}))("keydown",(function(e){return t.keyDownFunction(e)})),di(),di(),di(),di(),fi(13,"div",1),fi(14,"ul",12),ui(15,Jf,2,2,"button",13),di(),di()),2&e&&(fr(7),xi(t.contador),fr(2),li("ngForOf",t.vectorBusquedas),fr(2),wi("title",t.infoBuscar),li("ngModel",t.valorTexto),fr(4),li("ngForOf",t.listado))},directives:[Eu,fl,wl,Lh],styles:["*[_ngcontent-%COMP%]{position:relative;z-index:2000}"]}),td),rd=((ed=function(){function e(t){_classCallCheck(this,e),this.http=t}return _createClass(e,[{key:"getDatosCoronaTotales",value:function(){return this.http.get("https://coronavirus-19-api.herokuapp.com/all")}},{key:"getDatosCoronaPaises",value:function(){return this.http.get("https://coronavirus-19-api.herokuapp.com/countries")}}]),e}()).\u0275fac=function(e){return new(e||ed)(Ke(qc))},ed.\u0275prov=le({token:ed,factory:ed.\u0275fac,providedIn:"root"}),ed),od=((Xf=function(){function e(t){_classCallCheck(this,e),this.afs=t,this.coleccionCorona="corona"}return _createClass(e,[{key:"saveDatosCorona",value:function(e){return this.afs.collection(this.coleccionCorona).add(e)}}]),e}()).\u0275fac=function(e){return new(e||Xf)(Ke(If))},Xf.\u0275prov=le({token:Xf,factory:Xf.\u0275fac,providedIn:"root"}),Xf),id=((Zf=function(){function e(t,n){_classCallCheck(this,e),this.servicioDatos=t,this.servicioCorona=n,this.objetoCorona={},this.objetoCoronaArgentina={}}return _createClass(e,[{key:"ngOnInit",value:function(){this.mostrarDatos(!1),this.mostrarDatosArgentina(!1)}},{key:"mostrarDatos",value:function(e){var t=this;return this.servicioDatos.getDatosCoronaTotales().subscribe((function(n){t.objetoCorona.casosTot=n.cases,t.objetoCorona.fallecidosTot=n.deaths,t.objetoCorona.recuperados=n.recovered,t.objetoCorona.fecha=new Date,e&&console.log("Actualizaci\xf3n finalizada")})),!1}},{key:"mostrarDatosArgentina",value:function(e){var t=this;return this.servicioDatos.getDatosCoronaPaises().subscribe((function(e){e.forEach((function(e){"Argentina"==e.country&&(t.objetoCoronaArgentina.fallecidosTot=e.deaths,t.objetoCoronaArgentina.fallecidosHoy=e.todayDeaths,t.objetoCoronaArgentina.recuperados=e.recovered,t.objetoCoronaArgentina.casosTot=e.cases,t.objetoCoronaArgentina.casosHoy=e.todayCases,t.objetoCoronaArgentina.activos=e.active,t.objetoCoronaArgentina.criticos=e.critical,t.objetoCoronaArgentina.casosPorMillon=e.casesPerOneMillion,t.objetoCoronaArgentina.fecha=new Date)}))})),!1}},{key:"guardarDatos",value:function(){var e=this;return this.objetoCorona.pais="global",this.objetoCoronaArgentina.pais="Argentina",this.servicioCorona.saveDatosCorona(this.objetoCorona).then((function(t){console.log("Los datos se guardaron ok!."),console.log("Ahora guardando los datos locales..."),e.servicioCorona.saveDatosCorona(e.objetoCoronaArgentina).then((function(e){console.log("Los datos locales se guardaron ok.")})).catch((function(e){return console.error("Hubo un error en el save de los datos locales:",e)}))})).catch((function(e){return console.error("Hubo un error en el save de los datos globales:",e)})),!1}}]),e}()).\u0275fac=function(e){return new(e||Zf)(ci(rd),ci(od))},Zf.\u0275cmp=lt({type:Zf,selectors:[["app-corona"]],decls:44,vars:19,consts:[["id","corona",1,"card-deck","bg-light","container","text-center","corona","ml-3","mt-2"],[1,"card","mt-2","mb-2","tarjeta"],[1,"d-flex","justify-content-center","mt-2"],["src","assets/iconos/reload2.png","alt","","width","15px;",1,"mr-2",3,"click"],[1,"card-body"],[1,"card-title"],[1,"text-center","h6"],[1,"card-footer"],[1,"text-md-center","text-muted"],["type","button","data-toggle","collapse","data-target","#corona",1,"close","mr-3","cerrar"],[1,"d-flex","justify-content-center"],["type","button",1,"btn","btn-info","disabled",3,"click"]],template:function(e,t){1&e&&(fi(0,"div",0),fi(1,"div",1),fi(2,"div",2),fi(3,"img",3),mi("click",(function(e){return t.mostrarDatos(!0)})),di(),di(),fi(4,"div",4),fi(5,"h5",5),Pi(6,"Coronavirus. Casos totales."),di(),fi(7,"p",6),Pi(8),di(),fi(9,"p",6),Pi(10),di(),fi(11,"p",6),Pi(12),di(),di(),fi(13,"div",7),fi(14,"p",8),Pi(15),za(16,"date"),di(),di(),di(),fi(17,"div",1),fi(18,"div",2),fi(19,"img",3),mi("click",(function(e){return t.mostrarDatosArgentina(!0)})),di(),di(),fi(20,"div",4),fi(21,"h5",5),Pi(22,"Coronavirus. Argentina."),di(),fi(23,"p",6),Pi(24),di(),fi(25,"p",6),Pi(26),di(),fi(27,"p",6),Pi(28),di(),fi(29,"p",6),Pi(30),di(),di(),fi(31,"div",7),fi(32,"p",8),Pi(33),za(34,"date"),di(),di(),di(),fi(35,"div",1),fi(36,"div",4),fi(37,"button",9),fi(38,"span"),Pi(39,"\xd7"),di(),di(),fi(40,"div",10),fi(41,"button",11),mi("click",(function(e){return t.guardarDatos()})),fi(42,"span"),Pi(43,"Guardar todo"),di(),di(),di(),di(),di(),di()),2&e&&(fr(8),Oi("Casos totales:",t.objetoCorona.casosTot,""),fr(2),Oi("Fallecidos: ",t.objetoCorona.fallecidosTot,""),fr(2),Oi("Recuperados: ",t.objetoCorona.recuperados,""),fr(3),Oi(" Fuente de los datos: https://github.com/javieraviles/covidAPI Fecha: ",Wa(16,13,t.objetoCorona.fecha,"dd/MM/yyyy - H:mm:ss")," "),fr(9),Mi("Casos totales:",t.objetoCoronaArgentina.casosTot," / hoy:",t.objetoCoronaArgentina.casosHoy," "),fr(2),Mi("Fallecidos totales: ",t.objetoCoronaArgentina.fallecidosTot," / hoy: ",t.objetoCoronaArgentina.fallecidosHoy,""),fr(2),Mi("Recuperados: ",t.objetoCoronaArgentina.recuperados," - Activos:",t.objetoCoronaArgentina.activos,""),fr(2),Mi("Cr\xedticos: ",t.objetoCoronaArgentina.criticos," - Casos x millon:",t.objetoCoronaArgentina.casosPorMillon,""),fr(3),Oi(" Fuente de los datos: https://github.com/javieraviles/covidAPI Fecha: ",Wa(34,16,t.objetoCoronaArgentina.fecha,"dd/MM/yyyy - H:mm:ss")," "))},pipes:[Iu],styles:["img[_ngcontent-%COMP%]:hover{cursor:pointer}@media (min-width:576px){.corona[_ngcontent-%COMP%]{position:relative;z-index:500;width:55rem}}@media (max-width:575.98px){.corona[_ngcontent-%COMP%]{position:relative;z-index:500;width:18rem}.tarjeta[_ngcontent-%COMP%]{width:16rem;height:18rem}}"]}),Zf);function ad(e,t){if(1&e&&(fi(0,"option",82),Pi(1),di()),2&e){var n=t.$implicit;li("value",n.value),fr(1),Oi(" ",n.text," ")}}function sd(e,t){if(1&e&&(fi(0,"option",82),Pi(1),di()),2&e){var n=t.$implicit;li("value",n.value),fr(1),Oi(" ",n.text," ")}}var ud,cd,ld,hd,fd=!1,dd=(n("vyr2"),(ld=function(){function e(t,n,r,o,i,a,s){_classCallCheck(this,e),this.servicioDatos=t,this.servicioMunicipios=n,this.servicioCapasPartido=r,this.servicioCircuitos=o,this.servicioEscuelas=i,this.servicioWfsIgn=a,this.servicioCapasRenabap=s,this.edicion=!1,this.fpv=0,this.pro=0,this.cf=0,this.otro=0,this.espacios=[],this.arrayMunicipiosLeidos=[],this.arrayMunicipiosLeidosGenerales=[],this.listadoPartidos=[]}return _createClass(e,[{key:"ngOnInit",value:function(){this.version=L.version,this.armarTodo()}},{key:"administrarNavBarMenu",value:function(e){switch(e.seleccion){case"renabap":this.renabap();break;case"paso2019":this.elecciones2019Paso();break;case"generales2019":this.elecciones2019Generales();break;case"circuitos":this.leerCircuitos();break;case"unPartido":this.circuito(e.partido);break;case"leerPartidos":this.leerPartidos();break;case"unPartidoPartido":this.partidoElegido(e.partido);break;case"unaEscuela":this.escuelas(e.partido);break;case"partidosIgn":this.capaWFS()}}},{key:"renabap",value:function(){var e=this;$f.hasLayer(this.capaRenabap)&&$f.removeLayer(this.capaRenabap),this.servicioDatos.getRenabap().subscribe((function(t){e.capaRenabap=e.servicioCapasRenabap.getCapaRenabap(t,""),$f.addLayer(e.capaRenabap),$f.fitBounds(e.capaRenabap.getBounds())}))}},{key:"buscarPartido",value:function(){var e=this;this.listadoPartidos.length>0||this.servicioDatos.buscarGeoJsonPartidos().subscribe((function(t){var n=0;t.features.forEach((function(t){e.listadoPartidos[n]=t.properties.nam,n+=1,e.listadoPartidos.sort()}))}))}},{key:"leerPartidos",value:function(){var e=this;$f.hasLayer(this.laCapaDeLosPartidos)&&$f.removeLayer(this.laCapaDeLosPartidos),$f.hasLayer(this.elPartidoFiltrado)&&$f.removeLayer(this.elPartidoFiltrado),this.servicioDatos.buscarGeoJsonPartidos().subscribe((function(t){e.laCapaDeLosPartidos=e.servicioCapasPartido.getPartidos(t,""),$f.addLayer(e.laCapaDeLosPartidos),$f.fitBounds(e.laCapaDeLosPartidos.getBounds())}))}},{key:"partidoElegido",value:function(e){var t=this;$f.hasLayer(this.elPartidoFiltrado)&&$f.removeLayer(this.elPartidoFiltrado),$f.hasLayer(this.laCapaDeLosPartidos)&&$f.removeLayer(this.laCapaDeLosPartidos),this.servicioDatos.buscarGeoJsonPartidos().subscribe((function(n){t.elPartidoFiltrado=t.servicioCapasPartido.getPartidos(n,e),$f.addLayer(t.elPartidoFiltrado),$f.fitBounds(t.elPartidoFiltrado.getBounds())}))}},{key:"capaWFS",value:function(){var e=this;$f.hasLayer(this.layerWFS)&&$f.removeLayer(this.layerWFS),this.servicioDatos.getWfsIgn().subscribe((function(t){e.layerWFS=e.servicioWfsIgn.getWfs(t,"Partido"),$f.addLayer(e.layerWFS),$f.fitBounds(e.layerWFS.getBounds())}))}},{key:"leerCircuitos",value:function(){var e=this;$f.hasLayer(this.elCircuitoFiltrado)&&$f.removeLayer(this.elCircuitoFiltrado),$f.hasLayer(this.misCircuitos)&&$f.removeLayer(this.misCircuitos),this.servicioDatos.getCircuitosElectorales().subscribe((function(t){e.misCircuitos=e.servicioCircuitos.getCircuitosDepurado(t,""),$f.addLayer(e.misCircuitos),$f.fitBounds(e.misCircuitos.getBounds())}))}},{key:"circuito",value:function(e){var t=this;$f.hasLayer(this.misCircuitos)&&$f.removeLayer(this.misCircuitos),$f.hasLayer(this.elCircuitoFiltrado)&&$f.removeLayer(this.elCircuitoFiltrado),this.servicioDatos.getCircuitosElectorales().subscribe((function(n){t.elCircuitoFiltrado=t.servicioCircuitos.getCircuitosDepurado(n,e),$f.addLayer(t.elCircuitoFiltrado),$f.fitBounds(t.elCircuitoFiltrado.getBounds())}))}},{key:"escuelas",value:function(e){var t=this;$f.hasLayer(this.laEscuelaFiltrada)&&$f.removeLayer(this.laEscuelaFiltrada),$f.hasLayer(this.laEscuelaFiltrada)&&$f.removeLayer(this.laEscuelaFiltrada),this.servicioDatos.getEscuelas().subscribe((function(n){t.laEscuelaFiltrada=t.servicioEscuelas.getEscuelas(n,e),$f.addLayer(t.laEscuelaFiltrada),$f.fitBounds(t.laEscuelaFiltrada.getBounds())}))}},{key:"leerPartidos2019",value:function(){var e=this;this.servicioDatos.getPartidos2015().subscribe((function(t){ud=t,e.eleccionesGenerales=!0;var n=JSON.parse(sessionStorage.getItem("municipiosGenerales"));$f.hasLayer(e.miPcia2019)&&($f.removeLayer(e.miPcia2019),e.miPcia2019=""),e.miPcia2019=L.geoJson(ud,{style:function(e){for(var t=0;t<n.length;t++)if(n[t].idMuni===e.properties.cca){switch(String(n[t].paso2019espacioPrimero)){case"1":return{color:"#000000",weight:.3,opacity:1,fillColor:"#0066ff",fillOpacity:.4};case"2":return{color:"#000000",weight:.3,opacity:1,fillColor:"#ffff66",fillOpacity:.4};case"3":return{color:"#000000",weight:.3,opacity:1,fillColor:"#33cc33",fillOpacity:.4};case"4":return{color:"#ffbf80",weight:.3,opacity:1,fillColor:"#ffbf80",fillOpacity:.4}}break}return{color:"#ccccb3",weight:3,opacity:1.5,fillColor:"#ccccb3",fillOpacity:.2}},onEachFeature:function(e,t){var r="",o=0,i="";t.bindPopup('\n              <table class="table table-striped table-borderless table-sm" style="font-family: \'Arial Narrow\'">\n                <thead class="thead-dark">\n                  <tr>\n                    <th scope="col" class="text-center">Municipio</th>\n                    <th scope="col" class="text-center">Intendente</th>\n                    <th scope="col" class="text-center">Esp. pol.</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr>\n                    <td class="text-center">'.concat(e.properties.nam,'</td>  \n                    <td class="text-center">').concat(e.properties.actual_Int,'</td>\n                    <td class="text-center">').concat(e.properties.actual_Pdo,'</td>\n                  </tr>\n                  <tr>\n                    <td></td> \n                    <td></td>  \n                    <td><button class="mi-boton btn btn-secondary btn-sm ml-5"><i class="fa fa-edit"></i></button></td>\n                  </tr>\n                </tbody>\n              </table>\n            ')),t.on("popupopen",(function(){$(".mi-boton").on("click",(function(t){t.preventDefault(),$("#elmuniid").val(e.properties.cca),$("#elmuni").text(e.properties.cca),$("#nombreOculto").val(e.properties.nam),$("#elmuniNombre").text(e.properties.nam),n=JSON.parse(sessionStorage.getItem("municipiosGenerales")),sessionStorage.removeItem("edicion"),0==n.length&&(sessionStorage.setItem("edicion",JSON.stringify(!1)),!1);for(var r=0;r<n.length;r++){if(n[r].idMuni===e.properties.cca){$("#idOculto").val(n[r].id),$("#candidatoPrimero").val(n[r].paso2019candidatoPrimero),$("#candidatoSegundo").val(n[r].paso2019candidatoSegundo),$("#espacioPrimero").val(n[r].paso2019espacioPrimero),$("#espacioSegundo").val(n[r].paso2019espacioSegundo),$("#porcentajePrimero").val(n[r].paso2019porcPrimero),$("#porcentajeSegundo").val(n[r].paso2019porcSegundo),$("#votosEnBlanco").val(n[r].paso2019votosEnBlanco),$("#votosPositivos").val(n[r].paso2019votosPositivos),$("#obs").val(n[r].paso2019obs),$("#votosEnBlancoPorcentaje").val(n[r].paso2019porcVotosEnBlanco),$("#votosPositivosPorcentaje").val(n[r].paso2019porcVotosPositivos),n[r].paso2019recuperado?$("#recuperado").prop("checked",!0):$("#recuperado").prop("checked",!1),sessionStorage.setItem("edicion",JSON.stringify(!0)),!0;break}$("#idOculto").val(""),$("#candidatoPrimero").val(""),$("#candidatoSegundo").val(""),$("#espacioPrimero").val(""),$("#recuperado").prop("checked",!1),$("#espacioSegundo").val(""),$("#porcentajePrimero").val(0),$("#porcentajeSegundo").val(0),$("#votosEnBlanco").val(0),$("#votosPositivos").val(0),$("#obs").val(""),$("#votosEnBlancoPorcentaje").val(0),$("#votosPositivosPorcentaje").val(0),sessionStorage.setItem("edicion",JSON.stringify(!1)),!1}$("#formularioPaso").modal("show")}))})),t.on({mouseover:function(n){r=n.target.options.color,o=n.target.options.weight,i=n.target.options.fillColor,t.setStyle({color:"#cc9900",weight:2,fillColor:"#cc9900"});var a=n.target,s=L.tooltip({position:"bottom",noWrap:!0,offset:[0,-30],sticky:!0,opacity:.8}).setContent(e.properties.cca+", "+e.properties.nam).setLatLng(n.latlng).addTo($f);a.bindTooltip(s)},mouseout:function(e){t.setStyle({color:r,weight:o,fillColor:i})}})}}),$f.addLayer(e.miPcia2019),e.encenderReferenciasGenerales2019(),e.encendidoInicialGenerales()}))}},{key:"leerPartidos2015",value:function(){var e=this;this.servicioDatos.getPartidos2015().subscribe((function(t){ud=t,e.eleccionesGenerales=!1;var n,r=JSON.parse(sessionStorage.getItem("municipios"));$f.hasLayer(e.miPcia2015)?($f.removeLayer(e.miPcia2015),e.miPcia2015="",n=!0):n=!1,e.miPcia2015=L.geoJson(t,{style:function(e){for(var t=0;t<r.length;t++)if(r[t].idMuni===e.properties.cca){switch(String(r[t].paso2019espacioPrimero)){case"1":return{color:"#000000",weight:.3,opacity:1,fillColor:"#0066ff",fillOpacity:.4};case"2":return{color:"#000000",weight:.3,opacity:1,fillColor:"#ffff66",fillOpacity:.4};case"3":return{color:"#000000",weight:.3,opacity:1,fillColor:"#33cc33",fillOpacity:.4};case"4":return{color:"#ffbf80",weight:.3,opacity:1,fillColor:"#ffbf80",fillOpacity:.4}}break}return{color:"#ccccb3",weight:3,opacity:1.5,fillColor:"#ccccb3",fillOpacity:.2}},onEachFeature:function(e,t){var n=this,r="",o=0,i="";t.bindPopup('\n              <table class="table table-striped table-borderless table-sm" style="font-family: \'Arial Narrow\'">\n                <thead class="thead-dark">\n                  <tr>\n                    <th scope="col" class="text-center">Municipio</th>\n                    <th scope="col" class="text-center">Intendente</th>\n                    <th scope="col" class="text-center">Esp. pol.</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr>\n                    <td class="text-center">'.concat(e.properties.nam,'</td>  \n                    <td class="text-center">').concat(e.properties.actual_Int,'</td>\n                    <td class="text-center">').concat(e.properties.actual_Pdo,'</td>\n                  </tr>\n                  <tr>\n                    <td></td> \n                    <td></td>  \n                    <td><button class="mi-boton btn btn-secondary btn-sm ml-5"><i class="fa fa-edit"></i></button></td>\n                  </tr>\n                </tbody>\n              </table>\n            ')),t.on("popupopen",(function(){$(".mi-boton").on("click",(function(t){t.preventDefault(),$("#elmuniid").val(e.properties.cca),$("#elmuni").text(e.properties.cca),$("#nombreOculto").val(e.properties.nam),$("#elmuniNombre").text(e.properties.nam),n.municipiosLosDatos=JSON.parse(sessionStorage.getItem("municipios")),sessionStorage.removeItem("edicion"),0==n.municipiosLosDatos.length&&(sessionStorage.setItem("edicion",JSON.stringify(!1)),!1);for(var r=0;r<n.municipiosLosDatos.length;r++){if(n.municipiosLosDatos[r].idMuni===e.properties.cca){$("#idOculto").val(n.municipiosLosDatos[r].id),$("#candidatoPrimero").val(n.municipiosLosDatos[r].paso2019candidatoPrimero),$("#candidatoSegundo").val(n.municipiosLosDatos[r].paso2019candidatoSegundo),$("#espacioPrimero").val(n.municipiosLosDatos[r].paso2019espacioPrimero),$("#espacioSegundo").val(n.municipiosLosDatos[r].paso2019espacioSegundo),$("#porcentajePrimero").val(n.municipiosLosDatos[r].paso2019porcPrimero),$("#porcentajeSegundo").val(n.municipiosLosDatos[r].paso2019porcSegundo),$("#votosEnBlanco").val(n.municipiosLosDatos[r].paso2019votosEnBlanco),$("#votosPositivos").val(n.municipiosLosDatos[r].paso2019votosPositivos),$("#obs").val(n.municipiosLosDatos[r].paso2019obs),$("#votosEnBlancoPorcentaje").val(n.municipiosLosDatos[r].paso2019porcVotosEnBlanco),$("#votosPositivosPorcentaje").val(n.municipiosLosDatos[r].paso2019porcVotosPositivos),n.municipiosLosDatos[r].paso2019recuperado?$("#recuperado").prop("checked",!0):$("#recuperado").prop("checked",!1),sessionStorage.setItem("edicion",JSON.stringify(!0)),!0;break}$("#idOculto").val(""),$("#candidatoPrimero").val(""),$("#candidatoSegundo").val(""),$("#espacioPrimero").val(""),$("#recuperado").prop("checked",!1),$("#espacioSegundo").val(""),$("#porcentajePrimero").val(0),$("#porcentajeSegundo").val(0),$("#votosEnBlanco").val(0),$("#votosPositivos").val(0),$("#obs").val(""),$("#votosEnBlancoPorcentaje").val(0),$("#votosPositivosPorcentaje").val(0),sessionStorage.setItem("edicion",JSON.stringify(!1)),!1}$("#formularioPaso").modal("show")}))})),t.on({mouseover:function(n){r=n.target.options.color,o=n.target.options.weight,i=n.target.options.fillColor,t.setStyle({color:"#cc9900",weight:2,fillColor:"#cc9900"});var a=n.target,s=L.tooltip({position:"bottom",noWrap:!0,offset:[0,-30],sticky:!0,opacity:.8}).setContent(e.properties.cca+", "+e.properties.nam).setLatLng(n.latlng).addTo($f);a.bindTooltip(s)},mouseout:function(e){t.setStyle({color:r,weight:o,fillColor:i})}})}}),n&&$f.addLayer(e.miPcia2015),e.encendidoInicialPaso()}))}},{key:"verCoordenadas",value:function(e){L.popup().setLatLng(e.latlng).setContent("Coordenadas: "+e.latlng).openOn($f)}},{key:"centrarMapa",value:function(e){$f.panTo(e.latlng)}},{key:"acercar",value:function(e){$f.zoomIn()}},{key:"alejar",value:function(e){$f.zoomOut()}},{key:"ponerMarcador",value:function(e){var t=[];t[0]=e.lat,t[1]=e.lon,$f.setView(t,17);var n=L.marker(t,{icon:L.icon({iconSize:[35,40],iconAnchor:[20,40],iconUrl:"assets/images/location.png"})}).addTo($f),r=L.popup({offset:L.point(-3,-33)});r.setContent("<h5><b>Ubicaci&oacute;n:</b></h5><hr><h6><p>"+e.texto+"</p></h6>"),r.setLatLng(t),r.openOn($f),n.bindPopup(r)}},{key:"hacerRecuentoPaso2019",value:function(e){var t=this;e.forEach((function(e){switch(String(e.paso2019espacioPrimero)){case"1":return t.fpv=t.fpv+1;case"2":return t.pro=t.pro+1;case"3":return t.cf=t.cf+1;case"4":return t.otro=t.otro+1}}))}},{key:"encendidoInicialPaso",value:function(){$f.addLayer(this.miPcia2015),$f.fitBounds(this.miPcia2015.getBounds()),this.encenderReferenciasPaso2019(),this.apagarReferenciasGenerales2019()}},{key:"encendidoInicialGenerales",value:function(){$f.addLayer(this.miPcia2019),fd||$f.fitBounds(this.miPcia2019.getBounds()),this.apagarReferenciasPaso2019(),this.encenderReferenciasGenerales2019()}},{key:"elecciones2019Paso",value:function(){$f.hasLayer(this.miPcia2015)?($f.removeLayer(this.miPcia2015),this.apagarReferenciasPaso2019()):($f.hasLayer(this.miPcia2019)&&($f.removeLayer(this.miPcia2019),this.apagarReferenciasGenerales2019()),this.miPcia2015?($f.addLayer(this.miPcia2015),this.encenderReferenciasPaso2019()):this.leerPartidos2015())}},{key:"elecciones2019Generales",value:function(){$f.hasLayer(this.miPcia2019)?($f.removeLayer(this.miPcia2019),this.apagarReferenciasGenerales2019()):($f.hasLayer(this.miPcia2015)&&($f.removeLayer(this.miPcia2015),this.apagarReferenciasPaso2019()),this.miPcia2019?($f.addLayer(this.miPcia2019),this.encenderReferenciasGenerales2019()):this.leerPartidos2019())}},{key:"apagarReferenciasPaso2019",value:function(){var e;e=document.getElementsByClassName("footer");for(var t=0;t<e.length;t++)e[t].style.display="none"}},{key:"apagarReferenciasGenerales2019",value:function(){var e;e=document.getElementsByClassName("footerGenerales");for(var t=0;t<e.length;t++)e[t].style.display="none"}},{key:"encenderReferenciasPaso2019",value:function(){var e;e=document.getElementsByClassName("footer");for(var t=0;t<e.length;t++)e[t].style.display="block"}},{key:"encenderReferenciasGenerales2019",value:function(){var e;e=document.getElementsByClassName("footerGenerales");for(var t=0;t<e.length;t++)e[t].style.display="block"}},{key:"elecciones2019PasoResumenPcia",value:function(){this.resumenPaso2019=!this.resumenPaso2019}},{key:"actualizar",value:function(){sessionStorage.clear(),fd=!0,this.leerDatos()}},{key:"submit",value:function(){var e=this;this.modeloPaso2019={id:$("#idOculto").val(),idMuni:$("#elmuniid").val(),nombrePartido:$("#nombreOculto").val(),paso2019candidatoPrimero:$("#candidatoPrimero").val(),paso2019candidatoSegundo:$("#candidatoSegundo").val(),paso2019recuperado:$("#recuperado").prop("checked"),paso2019espacioPrimero:$("#espacioPrimero").val(),paso2019espacioSegundo:$("#espacioSegundo").val(),paso2019porcPrimero:$("#porcentajePrimero").val(),paso2019porcSegundo:$("#porcentajeSegundo").val(),paso2019votosEnBlanco:$("#votosEnBlanco").val(),paso2019votosPositivos:$("#votosPositivos").val(),paso2019obs:$("#obs").val(),paso2019porcVotosEnBlanco:$("#votosEnBlancoPorcentaje").val(),paso2019porcVotosPositivos:$("#votosPositivosPorcentaje").val()},this.edicion=JSON.parse(sessionStorage.getItem("edicion")),this.edicion?this.eleccionesGenerales?this.servicioMunicipios.editMunicipiosGenerales(this.modeloPaso2019.id,this.modeloPaso2019).then((function(){console.log("edici\xf3n ok!"),$("#formularioPaso").modal("hide"),e.inicializarModelo()})):this.servicioMunicipios.editMunicipios(this.modeloPaso2019.id,this.modeloPaso2019).then((function(){console.log("edici\xf3n ok!"),$("#formularioPaso").modal("hide"),e.inicializarModelo()})):this.eleccionesGenerales?this.servicioMunicipios.saveMunicipioGenerales(this.modeloPaso2019).then((function(t){console.log("la respuesta:",t),$("#formularioPaso").modal("hide"),e.inicializarModelo()})).catch((function(e){console.log("error: ",e)})):this.servicioMunicipios.saveMunicipio(this.modeloPaso2019).then((function(t){console.log("la respuesta:",t),$("#formularioPaso").modal("hide"),e.inicializarModelo()})).catch((function(e){console.log("error: ",e)})),this.actualizar()}},{key:"leerDatos",value:function(){var e=this;this.servicioMunicipios.getMunicipiosPaso().subscribe((function(t){e.arrayMunicipiosLeidos=[],t.docs.forEach((function(t){var n=t.data();e.arrayMunicipiosLeidos.push({id:t.id,idMuni:n.idMuni,nombrePartido:n.nombrePartido,paso2019candidatoPrimero:n.paso2019candidatoPrimero,paso2019candidatoSegundo:n.paso2019candidatoSegundo,paso2019recuperado:n.paso2019recuperado,paso2019espacioPrimero:n.paso2019espacioPrimero,paso2019espacioSegundo:n.paso2019espacioSegundo,paso2019porcPrimero:n.paso2019porcPrimero,paso2019porcSegundo:n.paso2019porcSegundo,paso2019votosEnBlanco:n.paso2019votosEnBlanco,paso2019votosPositivos:n.paso2019votosPositivos,paso2019obs:n.paso2019obs,paso2019porcVotosEnBlanco:n.paso2019porcVotosEnBlanco,paso2019porcVotosPositivos:n.paso2019porcVotosPositivos})})),sessionStorage.setItem("municipios",JSON.stringify(e.arrayMunicipiosLeidos)),e.hacerRecuentoPaso2019(e.arrayMunicipiosLeidos)})),this.servicioMunicipios.getMunicipiosGenerales().subscribe((function(t){e.arrayMunicipiosLeidosGenerales=[],t.docs.forEach((function(t){var n=t.data();e.arrayMunicipiosLeidosGenerales.push({id:t.id,idMuni:n.idMuni,nombrePartido:n.nombrePartido,paso2019candidatoPrimero:n.paso2019candidatoPrimero,paso2019candidatoSegundo:n.paso2019candidatoSegundo,paso2019recuperado:n.paso2019recuperado,paso2019espacioPrimero:n.paso2019espacioPrimero,paso2019espacioSegundo:n.paso2019espacioSegundo,paso2019porcPrimero:n.paso2019porcPrimero,paso2019porcSegundo:n.paso2019porcSegundo,paso2019votosEnBlanco:n.paso2019votosEnBlanco,paso2019votosPositivos:n.paso2019votosPositivos,paso2019obs:n.paso2019obs,paso2019porcVotosEnBlanco:n.paso2019porcVotosEnBlanco,paso2019porcVotosPositivos:n.paso2019porcVotosPositivos})})),sessionStorage.setItem("municipiosGenerales",JSON.stringify(e.arrayMunicipiosLeidosGenerales)),fd&&(fd=!1,$f.hasLayer(e.miPcia2019)&&($f.removeLayer(e.miPcia2019),e.leerPartidos2019()),$f.hasLayer(e.miPcia2015)&&($f.removeLayer(e.miPcia2015),e.leerPartidos2015()))}))}},{key:"inicializarModelo",value:function(){this.modeloPaso2019={id:"",idMuni:"",paso2019candidatoPrimero:"",paso2019candidatoSegundo:"",paso2019espacioPrimero:Mf["Sin datos"],paso2019espacioSegundo:Mf["Sin datos"],paso2019recuperado:!1,nombrePartido:"",paso2019porcPrimero:0,paso2019porcSegundo:0,paso2019votosEnBlanco:0,paso2019votosPositivos:0,paso2019obs:"",paso2019porcVotosEnBlanco:0,paso2019porcVotosPositivos:0}}},{key:"armarTodo",value:function(){for(var e in this.inicializarModelo(),Mf)isNaN(Number(e))&&this.espacios.push({text:e,value:Mf[e]});var t=L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw",{attribution:'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery \xa9 <a href="http://mapbox.com">Mapbox</a>',id:"mapbox.streets"}),n=L.tileLayer("http://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",{attribution:"terms and feedback"}),r=L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:20}),o=L.tileLayer("http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"],detectRetina:!0}),i=L.tileLayer("http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"],detectRetina:!0}),a=L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{maxZoom:22}),s=L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}");($f=L.map("map",{contextmenu:!0,contextmenuWidth:180,contextmenuItems:[{text:"Ver las coordenadas",callback:this.verCoordenadas,icon:"assets/images/coordenadas.png"},{text:"Centrar aqui",callback:this.centrarMapa,icon:"assets/images/banderita.png"},"-",{text:"Acercar",callback:this.acercar,icon:"assets/images/zoom-in.png"},{text:"Alejar",callback:this.alejar,icon:"assets/images/zoom-out.png"}],center:[-34.921136,-57.954712],zoom:8,zoomControl:!1,maxZoom:20}).addLayer(r)).createPane("circuitos"),$f.getPane("circuitos").style.zIndex=370,$f.createPane("colegios"),$f.getPane("colegios").style.zIndex=650,$f.createPane("partidos"),$f.getPane("partidos").style.zIndex=360,L.control.scale().addTo($f),L.control.zoom({position:"bottomright"}).addTo($f),L.control.layers({"Open Street Map":r,Mapbox:t,"Google callejero ":o,"Google hibrido":i,"ArcGis OnLine":n,"Esri sat":a,"Esri transportes":s},{},{position:"topleft"}).addTo($f),sessionStorage.clear(),this.leerDatos()}}]),e}()).\u0275fac=function(e){return new(e||ld)(ci(qh),ci(Af),ci(Df),ci(Pf),ci(Nf),ci(xf),ci(Of))},ld.\u0275cmp=lt({type:ld,selectors:[["app-mapa"]],decls:296,vars:23,consts:[["id","map",1,"container-fluid"],[1,"mt-2"],[3,"seleccionMenuNavBar"],["id","fila",1,"card","collapse",2,"position","relative","z-index","450","width","20rem"],[1,"card-header","text-center","mt-2",2,"padding","0"],["type","button","data-toggle","collapse","data-target","#fila",1,"close","mr-3"],[1,"card-body"],[1,"row"],[3,"eventoMarcador"],["id","corona",1,"collapse",2,"position","relative","z-index","450","width","20rem"],[1,"footer","container"],[1,"row","fila"],[1,"col"],[2,"background-color","rgba(0,102,255,0.7)"],[2,"background-color","rgba(255,255,102,0.7)"],[2,"background-color","rgba(51,204,51,0.7)"],[2,"background-color","rgba(161, 159, 159, 0.7)"],[1,"footerGenerales","centradoras"],[1,"col","text-center"],[1,"col-8","col-md-3","ml-5",3,"hidden"],[1,"card","text-center","mx-1",2,"z-index","999"],[1,"table","table-striped","table-borderless","table-sm"],[1,"thead-dark"],["scope","col",1,"pb-1"],[1,"text-left",2,"background-color","rgba(0,102,255,0.5)"],[1,"text-right"],[1,"text-left",2,"background-color","rgba(255,255,102,0.5)"],[1,"text-left",2,"background-color","rgba(51,204,51,0.5)"],[1,"text-left",2,"background-color","rgba(161, 159, 159, 0.5)"],["id","resumenPaso",1,"collapse","row","mx-4","my-4"],[1,"col-xs-3","col-md-3"],["type","button","data-toggle","collapse","data-target","#resumenPaso",1,"close",2,"position","relative","z-index","2000","left","-20px"],["scope","col",1,"pb-4"],["scope","col",1,"pb-3"],["scope","col"],[1,"text-left"],[1,"table-primary"],["id","formularioPaso",1,"modal","fade"],[1,"modal-dialog","modal-dialog-scrollable"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],["id","formularioPaso",1,"form-inline",3,"submit"],["formularioPaso","ngForm"],["role","alert",1,"alert","alert-primary",2,"width","100%"],[1,"text-center"],["id","elmuniNombre"],["id","elmuni"],["type","hidden","id","nombreOculto","name","nombreOculto",1,"form-control"],["type","hidden","id","elmuniid","name","elmuniid",1,"form-control"],["type","hidden","id","idOculto","name","idOculto",1,"form-control"],[1,"form-row"],[1,"col-sm-6"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text","form-control-sm"],["type","text","id","candidatoPrimero","name","candidatoPrimero",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["candidatoPrimero","ngModel"],["type","text","id","candidatoSegundo","name","candidatoSegundo",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["candidatoSegundo","ngModel"],[1,"form-row","my-1"],["id","espacioPrimero","name","espacioPrimero",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["id","espacioSegundo","name","espacioSegundo",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["type","number","id","porcentajePrimero","name","porcentajePrimero",1,"form-control","form-control-sm","text-right",3,"ngModel","ngModelChange"],["type","number","id","porcentajeSegundo","name","porcentajeSegundo",1,"form-control","form-control-sm","text-right",3,"ngModel","ngModelChange"],["type","number","id","votosEnBlanco","name","votosEnBlanco",1,"form-control","form-control-sm","text-right",3,"ngModel","ngModelChange"],["type","number","id","votosPositivos","name","votosPositivos",1,"form-control","form-control-sm","text-right",3,"ngModel","ngModelChange"],["type","number","id","votosEnBlancoPorcentaje","name","votosEnBlancoPorcentaje",1,"form-control","form-control-sm","text-right",3,"ngModel","ngModelChange"],["type","number","id","votosPositivosPorcentaje","name","votosPositivosPorcentaje",1,"form-control","form-control-sm","text-right",3,"ngModel","ngModelChange"],["for","obs"],["id","obs","rows","2",1,"form-control","form-control-sm","rounded-4",2,"width","14.5rem"],["type","checkbox","id","recuperado","name","recuperado",1,"form-check-input","mt-4","ml-4",3,"ngModel","ngModelChange"],["for","recuperado",1,"ml-5","mt-4"],[1,"form-row","my-4"],[1,"form-row","ml-2"],["type","button","data-dismiss","modal",1,"btn","btn-secondary","form-control-sm"],[1,"input-group",2,"display","block"],["type","submit",1,"btn","btn-primary","form-control-sm",3,"disabled"],[3,"value"]],template:function(e,t){if(1&e&&(fi(0,"div",0),fi(1,"div",1),fi(2,"app-bnavega",2),mi("seleccionMenuNavBar",(function(e){return t.administrarNavBarMenu(e)})),di(),di(),fi(3,"div",3),fi(4,"div",4),fi(5,"button",5),fi(6,"span"),Pi(7,"\xd7"),di(),di(),fi(8,"h6"),Pi(9,"Geolocalizar"),di(),di(),fi(10,"div",6),fi(11,"div",7),fi(12,"div"),fi(13,"app-usa-api",8),mi("eventoMarcador",(function(e){return t.ponerMarcador(e)})),di(),di(),di(),fi(14,"div",7),fi(15,"div"),fi(16,"app-usa-api-location-iq",8),mi("eventoMarcador",(function(e){return t.ponerMarcador(e)})),di(),di(),di(),di(),di(),fi(17,"div",9),pi(18,"app-corona"),di(),fi(19,"div",10),fi(20,"div",11),fi(21,"div",12),fi(22,"p",13),Pi(23),di(),di(),fi(24,"div",12),fi(25,"p",14),Pi(26),di(),di(),fi(27,"div",12),fi(28,"p",15),Pi(29),di(),di(),fi(30,"div",12),fi(31,"p",16),Pi(32),di(),di(),di(),di(),fi(33,"div",17),fi(34,"div",7),fi(35,"div",18),fi(36,"h6",1),Pi(37,"Datos NO reales, provisorios a modo ilustrativo."),di(),di(),di(),di(),fi(38,"div",7),fi(39,"div",19),fi(40,"div",20),fi(41,"div",6),fi(42,"table",21),fi(43,"thead",22),fi(44,"tr"),fi(45,"th",23),fi(46,"h6"),Pi(47,"Espacio pol\xedtico"),di(),di(),fi(48,"th",23),fi(49,"h6"),Pi(50,"Municipios"),di(),di(),di(),di(),fi(51,"tbody"),fi(52,"tr"),fi(53,"td",24),Pi(54,"Frente de todos"),di(),fi(55,"td",25),Pi(56),di(),di(),fi(57,"tr"),fi(58,"td",26),Pi(59,"Juntos por el cambio"),di(),fi(60,"td",25),Pi(61),di(),di(),fi(62,"tr"),fi(63,"td",27),Pi(64,"Consenso Federal "),di(),fi(65,"td",25),Pi(66),di(),di(),fi(67,"tr"),fi(68,"td",28),Pi(69,"Otros"),di(),fi(70,"td",25),Pi(71),di(),di(),di(),di(),di(),di(),di(),di(),fi(72,"div",29),fi(73,"div",30),fi(74,"button",31),fi(75,"span"),Pi(76,"\xd7"),di(),di(),fi(77,"div",20),fi(78,"div",6),fi(79,"table",21),fi(80,"thead",22),fi(81,"tr"),fi(82,"th",32),Pi(83,"Espacio pol\xedtico"),di(),fi(84,"th",33),Pi(85,"Cantidad de votos"),di(),fi(86,"th",34),Pi(87,"% de votos v\xe1lidos"),di(),di(),di(),fi(88,"tbody"),fi(89,"tr"),fi(90,"td",24),Pi(91,"Frente de todos"),di(),fi(92,"td",25),Pi(93,"11.622.085"),di(),fi(94,"td",25),Pi(95,"47,65"),di(),di(),fi(96,"tr"),fi(97,"td",26),Pi(98,"Juntos por el cambio"),di(),fi(99,"td",25),Pi(100,"7.824.961"),di(),fi(101,"td",25),Pi(102,"32,08"),di(),di(),fi(103,"tr"),fi(104,"td",27),Pi(105,"Consenso Federal "),di(),fi(106,"td",25),Pi(107,"2.006.964"),di(),fi(108,"td",25),Pi(109,"8,22"),di(),di(),fi(110,"tr"),fi(111,"td",35),Pi(112,"Izquierda (Del Ca\xf1o)"),di(),fi(113,"td",25),Pi(114,"697.745"),di(),fi(115,"td",25),Pi(116,"2,86"),di(),di(),fi(117,"tr"),fi(118,"td",35),Pi(119,"Frente NOS (G\xf3mez Centuri\xf3n)"),di(),fi(120,"td",25),Pi(121,"642.650"),di(),fi(122,"td",25),Pi(123,"2,63"),di(),di(),fi(124,"tr"),fi(125,"td",35),Pi(126,"Unite (Jos\xe9 L. Espert)"),di(),fi(127,"td",25),Pi(128,"533.079"),di(),fi(129,"td",25),Pi(130,"2,18"),di(),di(),fi(131,"tr"),pi(132,"td",36),pi(133,"td",36),pi(134,"td",36),di(),fi(135,"tr"),fi(136,"td",35),Pi(137,"Votos afirmativos"),di(),fi(138,"td",25),Pi(139,"23.628.526"),di(),fi(140,"td",25),Pi(141,"96.88"),di(),di(),fi(142,"tr"),fi(143,"td",35),Pi(144,"Votos en blanco"),di(),fi(145,"td",25),Pi(146,"758.944"),di(),fi(147,"td",25),Pi(148,"3.12"),di(),di(),fi(149,"tr"),fi(150,"td",35),Pi(151,"Votos v\xe1lidos"),di(),fi(152,"td",25),Pi(153,"24.387.470"),di(),fi(154,"td",25),Pi(155,"98.78"),di(),di(),fi(156,"tr"),fi(157,"td",35),Pi(158,"Participaci\xf3n"),di(),fi(159,"td",25),Pi(160,"24.687.487"),di(),fi(161,"td",25),Pi(162,"75.78"),di(),di(),fi(163,"tr"),fi(164,"td",35),Pi(165,"Abstenciones"),di(),fi(166,"td",25),Pi(167,"7.898.275"),di(),fi(168,"td",25),Pi(169,"24.15"),di(),di(),fi(170,"tr"),fi(171,"td",35),Pi(172,"Electores registrados"),di(),fi(173,"td",25),Pi(174,"32.621.468"),di(),fi(175,"td",25),Pi(176,"100.00"),di(),di(),di(),di(),di(),di(),di(),di(),fi(177,"div",37),fi(178,"div",38),fi(179,"div",39),fi(180,"div",40),fi(181,"h5",41),Pi(182,"Elecciones 2019"),di(),fi(183,"button",42),fi(184,"span",43),Pi(185,"\xd7"),di(),di(),di(),fi(186,"div",44),fi(187,"form",45,46),mi("submit",(function(e){return t.submit()})),fi(189,"div",47),fi(190,"h5",48),fi(191,"i"),Pi(192,"Municipio: "),di(),pi(193,"i",49),fi(194,"i"),Pi(195,", Id Pcial.:"),di(),pi(196,"i",50),di(),di(),pi(197,"input",51),pi(198,"input",52),pi(199,"input",53),fi(200,"div",54),fi(201,"div",55),fi(202,"div",56),fi(203,"div",57),fi(204,"div",58),Pi(205,"Primero"),di(),di(),fi(206,"input",59,60),mi("ngModelChange",(function(e){return t.modeloPaso2019.paso2019candidatoPrimero=e})),di(),di(),di(),fi(208,"div",55),fi(209,"div",56),fi(210,"div",57),fi(211,"div",58),Pi(212,"Segundo"),di(),di(),fi(213,"input",61,62),mi("ngModelChange",(function(e){return t.modeloPaso2019.paso2019candidatoSegundo=e})),di(),di(),di(),di(),pi(215,"div",63),fi(216,"div",54),fi(217,"div",55),fi(218,"div",56),fi(219,"div",57),fi(220,"div",58),Pi(221,"Esp.Pol. 1"),di(),di(),fi(222,"select",64),mi("ngModelChange",(function(e){return t.modeloPaso2019.paso2019espacioPrimero=e})),ui(223,ad,2,2,"option",65),di(),di(),di(),fi(224,"div",55),fi(225,"div",56),fi(226,"div",57),fi(227,"div",58),Pi(228,"Esp.Pol. 2"),di(),di(),fi(229,"select",66),mi("ngModelChange",(function(e){return t.modeloPaso2019.paso2019espacioSegundo=e})),ui(230,sd,2,2,"option",65),di(),di(),di(),di(),pi(231,"div",63),fi(232,"div",54),fi(233,"div",55),fi(234,"div",56),fi(235,"div",57),fi(236,"div",58),Pi(237,"Porc. primero"),di(),di(),fi(238,"input",67),mi("ngModelChange",(function(e){return t.modeloPaso2019.paso2019porcPrimero=e})),di(),di(),di(),fi(239,"div",55),fi(240,"div",56),fi(241,"div",57),fi(242,"div",58),Pi(243,"Porc. segundo"),di(),di(),fi(244,"input",68),mi("ngModelChange",(function(e){return t.modeloPaso2019.paso2019porcSegundo=e})),di(),di(),di(),di(),pi(245,"div",63),fi(246,"div",54),fi(247,"div",55),fi(248,"div",56),fi(249,"div",57),fi(250,"div",58),Pi(251,"Votos en blanco"),di(),di(),fi(252,"input",69),mi("ngModelChange",(function(e){return t.modeloPaso2019.paso2019votosEnBlanco=e})),di(),di(),di(),fi(253,"div",55),fi(254,"div",56),fi(255,"div",57),fi(256,"div",58),Pi(257,"Votos positivos"),di(),di(),fi(258,"input",70),mi("ngModelChange",(function(e){return t.modeloPaso2019.paso2019votosPositivos=e})),di(),di(),di(),di(),pi(259,"div",63),fi(260,"div",54),fi(261,"div",55),fi(262,"div",56),fi(263,"div",57),fi(264,"div",58),Pi(265,"% Votos en blanco"),di(),di(),fi(266,"input",71),mi("ngModelChange",(function(e){return t.modeloPaso2019.paso2019porcVotosEnBlanco=e})),di(),di(),di(),fi(267,"div",55),fi(268,"div",56),fi(269,"div",57),fi(270,"div",58),Pi(271,"% Votos positivos"),di(),di(),fi(272,"input",72),mi("ngModelChange",(function(e){return t.modeloPaso2019.paso2019porcVotosPositivos=e})),di(),di(),di(),di(),pi(273,"div",63),fi(274,"div",54),fi(275,"div",55),fi(276,"div",56),fi(277,"label",73),Pi(278,"Observaciones"),di(),pi(279,"textarea",74),di(),di(),fi(280,"div",55),fi(281,"div",56),fi(282,"input",75),mi("ngModelChange",(function(e){return t.modeloPaso2019.paso2019recuperado=e})),di(),fi(283,"label",76),fi(284,"h6"),Pi(285,"Recuperado"),di(),di(),di(),di(),di(),pi(286,"div",77),fi(287,"div",78),fi(288,"div",55),fi(289,"div",56),fi(290,"button",79),Pi(291,"Cerrar"),di(),di(),di(),fi(292,"div",55),fi(293,"div",80),fi(294,"button",81),Pi(295,"Guardar "),di(),di(),di(),di(),di(),di(),di(),di(),di(),di()),2&e){var n=Hn(It.lFrame.contextLView,188);fr(23),Oi("Frente de todos ",t.fpv,""),fr(3),Oi("Juntos por el cambio ",t.pro,""),fr(3),Oi("Consenso Federal ",t.cf,""),fr(3),Oi("Otros ",t.otro,""),fr(7),li("hidden",!t.resumenPaso2019),fr(17),xi(t.fpv),fr(5),xi(t.pro),fr(5),xi(t.cf),fr(5),xi(t.otro),fr(135),li("ngModel",t.modeloPaso2019.paso2019candidatoPrimero),fr(7),li("ngModel",t.modeloPaso2019.paso2019candidatoSegundo),fr(9),li("ngModel",t.modeloPaso2019.paso2019espacioPrimero),fr(1),li("ngForOf",t.espacios),fr(6),li("ngModel",t.modeloPaso2019.paso2019espacioSegundo),fr(1),li("ngForOf",t.espacios),fr(8),li("ngModel",t.modeloPaso2019.paso2019porcPrimero),fr(6),li("ngModel",t.modeloPaso2019.paso2019porcSegundo),fr(8),li("ngModel",t.modeloPaso2019.paso2019votosEnBlanco),fr(6),li("ngModel",t.modeloPaso2019.paso2019votosPositivos),fr(8),li("ngModel",t.modeloPaso2019.paso2019porcVotosEnBlanco),fr(6),li("ngModel",t.modeloPaso2019.paso2019porcVotosPositivos),fr(10),li("ngModel",t.modeloPaso2019.paso2019recuperado),fr(12),li("disabled",!n.form.valid)}},directives:[jf,Qf,nd,id,Fh,Cl,Ah,fl,wl,Lh,Jl,Eu,Vl,cl,$l,rh],styles:["#map[_ngcontent-%COMP%]{position:absolute;height:100%;width:100%;left:0}.footer[_ngcontent-%COMP%]{text-align:center}.footer[_ngcontent-%COMP%], .footerGenerales[_ngcontent-%COMP%]{position:relative;z-index:2000;top:85%;background-color:#fff;display:none}.fila[_ngcontent-%COMP%]{position:absolute;width:100%;height:0}.centradora[_ngcontent-%COMP%]{-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center}.menu[_ngcontent-%COMP%]{z-index:2000;background-color:rgba(225,228,228,.7);width:15em;top:2rem}.menu[_ngcontent-%COMP%], .menu[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:relative}.menu[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{right:15px}.dropdown-divider[_ngcontent-%COMP%]{border-top:1px solid #173c61;margin:15px}.card-body[_ngcontent-%COMP%]{background-color:#fff;text-align:center}.card[_ngcontent-%COMP%]{position:relative;z-index:450;box-shadow:10px 10px 15px #888;-webkit-transition:.2s;transition:.2s}.card[_ngcontent-%COMP%]:hover{-webkit-transform:translateY(-3px);transform:translateY(-3px)}@media (min-width:576px){.usuario[_ngcontent-%COMP%]{position:relative;top:-3.5rem;right:1rem}}@media (max-width:575.98px){.usuario[_ngcontent-%COMP%]{clear:both;left:-1rem}}"]}),ld),pd=((cd=function(){function e(){_classCallCheck(this,e),this.title="test02"}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||cd)},cd.\u0275cmp=lt({type:cd,selectors:[["app-root"]],decls:1,vars:0,template:function(e,t){1&e&&pi(0,"app-mapa")},directives:[dd],styles:[""]}),cd);n("6Joi");var yd,vd,md=((vd=hd=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"enablePersistence",value:function(e){return{ngModule:hd,providers:[{provide:df,useValue:!0},{provide:pf,useValue:e}]}}}]),e}()).\u0275mod=pt({type:vd}),vd.\u0275inj=he({factory:function(e){return new(e||vd)},providers:[If]}),vd),gd=((yd=function e(){_classCallCheck(this,e)}).\u0275mod=pt({type:yd,bootstrap:[pd]}),yd.\u0275inj=he({factory:function(e){return new(e||yd)},providers:[Uf,Af,rd],imports:[[lc,tl,Bh,ff,ff.initializeApp(Bs,"Argengis"),md]]}),yd);(function(){if(qn)throw new Error("Cannot enable prod mode after platform setup.");Bn=!1})(),uc().bootstrapModule(gd).catch((function(e){return console.error(e)}))},zVF4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("+7AZ"),o={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},i=function(e,t){if(!e)throw a(t)},a=function(e){return new Error("Firebase Database ("+o.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},s=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var o=e.charCodeAt(r);o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=63&o|128):55296==(64512&o)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(o=65536+((1023&o)<<10)+(1023&e.charCodeAt(++r)),t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=63&o|128):(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=63&o|128)}return t},u={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],o=0;o<e.length;o+=3){var i=e[o],a=o+1<e.length,s=a?e[o+1]:0,u=o+2<e.length,c=u?e[o+2]:0,l=(15&s)<<2|c>>6,h=63&c;u||(h=64,a||(l=64)),r.push(n[i>>2],n[(3&i)<<4|s>>4],n[l],n[h])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(s(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var o=e[n++];if(o<128)t[r++]=String.fromCharCode(o);else if(o>191&&o<224){var i=e[n++];t[r++]=String.fromCharCode((31&o)<<6|63&i)}else if(o>239&&o<365){var a=((7&o)<<18|(63&(i=e[n++]))<<12|(63&(s=e[n++]))<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(a>>10)),t[r++]=String.fromCharCode(56320+(1023&a))}else{i=e[n++];var s=e[n++];t[r++]=String.fromCharCode((15&o)<<12|(63&i)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],o=0;o<e.length;){var i=n[e.charAt(o++)],a=o<e.length?n[e.charAt(o)]:0,s=++o<e.length?n[e.charAt(o)]:64,u=++o<e.length?n[e.charAt(o)]:64;if(++o,null==i||null==a||null==s||null==u)throw Error();r.push(i<<2|a>>4),64!==s&&(r.push(a<<4&240|s>>2),64!==u&&r.push(s<<6&192|u))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},c=function(e){try{return u.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function l(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&(e[n]=l(e[n],t[n]));return e}var h=function(){function e(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))}return e.prototype.wrapCallback=function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}},e}();function f(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d=function(e){function t(n,r){var o=e.call(this,r)||this;return o.code=n,o.name="FirebaseError",Object.setPrototypeOf(o,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,p.prototype.create),o}return r.__extends(t,e),t}(Error),p=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n}return e.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=t[0]||{},o=this.service+"/"+e,i=this.errors[e],a=i?y(i,r):"Error",s=this.serviceName+": "+a+" ("+o+").",u=new d(o,s),c=0,l=Object.keys(r);c<l.length;c++){var h=l[c];"_"!==h.slice(-1)&&(h in u&&console.warn('Overwriting FirebaseError base field "'+h+'" can cause unexpected behavior.'),u[h]=r[h])}return u},e}();function y(e,t){return e.replace(v,(function(e,n){var r=t[n];return null!=r?r.toString():"<"+n+"?>"}))}var v=/\{\$([^}]+)}/g;function m(e){return JSON.parse(e)}var g=function(e){var t={},n={},r={},o="";try{var i=e.split(".");t=m(c(i[0])||""),n=m(c(i[1])||""),o=i[2],r=n.d||{},delete n.d}catch(a){}return{header:t,claims:n,data:r,signature:o}},b=function(){function e(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}return e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++)n[r]=4294967295&((h=n[r-3]^n[r-8]^n[r-14]^n[r-16])<<1|h>>>31);var o,i,a=this.chain_[0],s=this.chain_[1],u=this.chain_[2],c=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=c^s&(u^c),i=1518500249):(o=s^u^c,i=1859775393):r<60?(o=s&u|c&(s|u),i=2400959708):(o=s^u^c,i=3395469782);var h=(a<<5|a>>>27)+o+l+i+n[r]&4294967295;l=c,c=u,u=4294967295&(s<<30|s>>>2),s=a,a=h}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},e.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,o=this.buf_,i=this.inbuf_;r<t;){if(0===i)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(o[i]=e.charCodeAt(r),++r,++i===this.blockSize){this.compress_(o),i=0;break}}else for(;r<t;)if(o[i]=e[r],++r,++i===this.blockSize){this.compress_(o),i=0;break}}this.inbuf_=i,this.total_+=t}},e.prototype.digest=function(){var e=[],t=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var o=24;o>=0;o-=8)e[r]=this.chain_[n]>>o&255,++r;return e},e}(),_=function(){function e(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((function(){e(n)})).catch((function(e){n.error(e)}))}return e.prototype.next=function(e){this.forEachObserver((function(t){t.next(e)}))},e.prototype.error=function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)},e.prototype.complete=function(){this.forEachObserver((function(e){e.complete()})),this.close()},e.prototype.subscribe=function(e,t,n){var r,o=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var o=r[n];if(o in e&&"function"==typeof e[o])return!0}return!1}(e)?e:{next:e,error:t,complete:n}).next&&(r.next=w),void 0===r.error&&(r.error=w),void 0===r.complete&&(r.complete=w);var i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{o.finalError?r.error(o.finalError):r.complete()}catch(e){}})),this.observers.push(r),i},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}}))},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))},e}();function w(){}function C(e,t,n){var r="";switch(t){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return e+" failed: "+r+" argument "}t.CONSTANTS=o,t.Deferred=h,t.ErrorFactory=p,t.FirebaseError=d,t.Sha1=b,t.assert=i,t.assertionError=a,t.async=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then((function(){e.apply(void 0,n)})).catch((function(e){t&&t(e)}))}},t.base64=u,t.base64Decode=c,t.base64Encode=function(e){var t=s(e);return u.encodeByteArray(t,!0)},t.contains=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.createSubscribe=function(e,t){var n=new _(e,t);return n.subscribe.bind(n)},t.decode=g,t.deepCopy=function(e){return l(void 0,e)},t.deepExtend=l,t.errorPrefix=C,t.getUA=f,t.isAdmin=function(e){var t=g(e).claims;return"object"==typeof t&&!0===t.admin},t.isBrowser=function(){return"object"==typeof self&&self.self===self},t.isEmpty=function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},t.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(f())},t.isNode=function(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(e){return!1}},t.isNodeSdk=function(){return!0===o.NODE_CLIENT||!0===o.NODE_ADMIN},t.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},t.isValidFormat=function(e){var t=g(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},t.isValidTimestamp=function(e){var t=g(e).claims,n=Math.floor((new Date).getTime()/1e3),r=0,o=0;return"object"==typeof t&&(t.hasOwnProperty("nbf")?r=t.nbf:t.hasOwnProperty("iat")&&(r=t.iat),o=t.hasOwnProperty("exp")?t.exp:r+86400),!!n&&!!r&&!!o&&n>=r&&n<=o},t.issuedAtTime=function(e){var t=g(e).claims;return"object"==typeof t&&t.hasOwnProperty("iat")?t.iat:null},t.jsonEval=m,t.map=function(e,t,n){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=t.call(n,e[o],o,e));return r},t.querystring=function(e){for(var t=[],n=function(e,n){Array.isArray(n)?n.forEach((function(n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))})):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))},r=0,o=Object.entries(e);r<o.length;r++){var i=o[r];n(i[0],i[1])}return t.length?"&"+t.join("&"):""},t.querystringDecode=function(e){var t={};return e.replace(/^\?/,"").split("&").forEach((function(e){if(e){var n=e.split("=");t[n[0]]=n[1]}})),t},t.safeGet=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0},t.stringLength=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t},t.stringToByteArray=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var o=e.charCodeAt(r);if(o>=55296&&o<=56319){var a=o-55296;r++,i(r<e.length,"Surrogate pair missing trail surrogate."),o=65536+(a<<10)+(e.charCodeAt(r)-56320)}o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=63&o|128):o<65536?(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=63&o|128):(t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=63&o|128)}return t},t.stringify=function(e){return JSON.stringify(e)},t.validateArgCount=function(e,t,n,r){var o;if(r<t?o="at least "+t:r>n&&(o=0===n?"none":"no more than "+n),o)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+o+".")},t.validateCallback=function(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(C(e,t,r)+"must be a valid function.")},t.validateContextObject=function(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(C(e,t,r)+"must be a valid context object.")},t.validateNamespace=function(e,t,n,r){if((!r||n)&&"string"!=typeof n)throw new Error(C(e,t,r)+"must be a valid firebase namespace.")}}},[[0,0]]]);